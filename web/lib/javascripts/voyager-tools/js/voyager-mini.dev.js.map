{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////app/libs/ff-browser/source/ManipTarget.ts","webpack:////app/libs/ff-browser/source/parseUrlParameter.ts","webpack:////app/libs/ff-core/source/ClassRegistry.ts","webpack:////app/libs/ff-core/source/Command.ts","webpack:////app/libs/ff-core/source/Commander.ts","webpack:////app/libs/ff-core/source/ObjectRegistry.ts","webpack:////app/libs/ff-core/source/Publisher.ts","webpack:////app/libs/ff-core/source/easing.ts","webpack:////app/libs/ff-core/source/isSubclass.ts","webpack:////app/libs/ff-core/source/math.ts","webpack:////app/libs/ff-core/source/text.ts","webpack:////app/libs/ff-core/source/types.ts","webpack:////app/libs/ff-core/source/uniqueId.ts","webpack:////app/libs/ff-graph/source/Component.ts","webpack:////app/libs/ff-graph/source/ComponentReference.ts","webpack:////app/libs/ff-graph/source/ComponentTracker.ts","webpack:////app/libs/ff-graph/source/Graph.ts","webpack:////app/libs/ff-graph/source/LinkableSorter.ts","webpack:////app/libs/ff-graph/source/Node.ts","webpack:////app/libs/ff-graph/source/Property.ts","webpack:////app/libs/ff-graph/source/PropertyGroup.ts","webpack:////app/libs/ff-graph/source/PropertyLink.ts","webpack:////app/libs/ff-graph/source/System.ts","webpack:////app/libs/ff-graph/source/components/CController.ts","webpack:////app/libs/ff-graph/source/components/CGraph.ts","webpack:////app/libs/ff-graph/source/components/CHierarchy.ts","webpack:////app/libs/ff-graph/source/components/COscillator.ts","webpack:////app/libs/ff-graph/source/components/CPulse.ts","webpack:////app/libs/ff-graph/source/components/CSelection.ts","webpack:////app/libs/ff-graph/source/components/index.ts","webpack:////app/libs/ff-graph/source/convert.ts","webpack:////app/libs/ff-graph/source/propertyTypes.ts","webpack:////app/libs/ff-scene/source/RenderQuadView.ts","webpack:////app/libs/ff-scene/source/RenderView.ts","webpack:////app/libs/ff-scene/source/components/CBasicMaterial.ts","webpack:////app/libs/ff-scene/source/components/CBox.ts","webpack:////app/libs/ff-scene/source/components/CCamera.ts","webpack:////app/libs/ff-scene/source/components/CDirectionalLight.ts","webpack:////app/libs/ff-scene/source/components/CGeometry.ts","webpack:////app/libs/ff-scene/source/components/CGrid.ts","webpack:////app/libs/ff-scene/source/components/CLight.ts","webpack:////app/libs/ff-scene/source/components/CMain.ts","webpack:////app/libs/ff-scene/source/components/CMaterial.ts","webpack:////app/libs/ff-scene/source/components/CMesh.ts","webpack:////app/libs/ff-scene/source/components/CObject3D.ts","webpack:////app/libs/ff-scene/source/components/COrbitManipulator.ts","webpack:////app/libs/ff-scene/source/components/CPhongMaterial.ts","webpack:////app/libs/ff-scene/source/components/CPickSelection.ts","webpack:////app/libs/ff-scene/source/components/CPointLight.ts","webpack:////app/libs/ff-scene/source/components/CRenderGraph.ts","webpack:////app/libs/ff-scene/source/components/CRenderer.ts","webpack:////app/libs/ff-scene/source/components/CScene.ts","webpack:////app/libs/ff-scene/source/components/CSpotLight.ts","webpack:////app/libs/ff-scene/source/components/CTorus.ts","webpack:////app/libs/ff-scene/source/components/CTransform.ts","webpack:////app/libs/ff-scene/source/components/index.ts","webpack:////app/libs/ff-three/source/Bracket.ts","webpack:////app/libs/ff-three/source/GPUPicker.ts","webpack:////app/libs/ff-three/source/Grid.ts","webpack:////app/libs/ff-three/source/OrbitManipulator.ts","webpack:////app/libs/ff-three/source/UniversalCamera.ts","webpack:////app/libs/ff-three/source/Viewport.ts","webpack:////app/libs/ff-three/source/helpers.ts","webpack:////app/libs/ff-three/source/math.ts","webpack:////app/libs/ff-three/source/shaders/IndexShader.ts","webpack:////app/libs/ff-three/source/shaders/NormalShader.ts","webpack:////app/libs/ff-three/source/shaders/PositionShader.ts","webpack:////app/libs/ff-ui/source/CustomElement.ts","webpack:////app/libs/ff-ui/source/QuadSplitter.ts","webpack:////app/libs/ff-ui/source/Splitter.ts","webpack:////app/node_modules/ajv/lib/ajv.js","webpack:////app/node_modules/ajv/lib/cache.js","webpack:////app/node_modules/ajv/lib/compile/async.js","webpack:////app/node_modules/ajv/lib/compile/error_classes.js","webpack:////app/node_modules/ajv/lib/compile/formats.js","webpack:////app/node_modules/ajv/lib/compile/index.js","webpack:////app/node_modules/ajv/lib/compile/resolve.js","webpack:////app/node_modules/ajv/lib/compile/rules.js","webpack:////app/node_modules/ajv/lib/compile/schema_obj.js","webpack:////app/node_modules/ajv/lib/compile/ucs2length.js","webpack:////app/node_modules/ajv/lib/compile/util.js","webpack:////app/node_modules/ajv/lib/data.js","webpack:////app/node_modules/ajv/lib/dotjs/_limit.js","webpack:////app/node_modules/ajv/lib/dotjs/_limitItems.js","webpack:////app/node_modules/ajv/lib/dotjs/_limitLength.js","webpack:////app/node_modules/ajv/lib/dotjs/_limitProperties.js","webpack:////app/node_modules/ajv/lib/dotjs/allOf.js","webpack:////app/node_modules/ajv/lib/dotjs/anyOf.js","webpack:////app/node_modules/ajv/lib/dotjs/comment.js","webpack:////app/node_modules/ajv/lib/dotjs/const.js","webpack:////app/node_modules/ajv/lib/dotjs/contains.js","webpack:////app/node_modules/ajv/lib/dotjs/custom.js","webpack:////app/node_modules/ajv/lib/dotjs/dependencies.js","webpack:////app/node_modules/ajv/lib/dotjs/enum.js","webpack:////app/node_modules/ajv/lib/dotjs/format.js","webpack:////app/node_modules/ajv/lib/dotjs/if.js","webpack:////app/node_modules/ajv/lib/dotjs/index.js","webpack:////app/node_modules/ajv/lib/dotjs/items.js","webpack:////app/node_modules/ajv/lib/dotjs/multipleOf.js","webpack:////app/node_modules/ajv/lib/dotjs/not.js","webpack:////app/node_modules/ajv/lib/dotjs/oneOf.js","webpack:////app/node_modules/ajv/lib/dotjs/pattern.js","webpack:////app/node_modules/ajv/lib/dotjs/properties.js","webpack:////app/node_modules/ajv/lib/dotjs/propertyNames.js","webpack:////app/node_modules/ajv/lib/dotjs/ref.js","webpack:////app/node_modules/ajv/lib/dotjs/required.js","webpack:////app/node_modules/ajv/lib/dotjs/uniqueItems.js","webpack:////app/node_modules/ajv/lib/dotjs/validate.js","webpack:////app/node_modules/ajv/lib/keyword.js","webpack:////app/node_modules/fast-deep-equal/index.js","webpack:////app/node_modules/fast-json-stable-stringify/index.js","webpack:////app/node_modules/json-schema-traverse/index.js","webpack:///../src/lib/css-tag.ts","webpack:///../src/lib/decorators.ts","webpack:///../src/lib/updating-element.ts","webpack:///src/lit-element.ts","webpack:///../src/directives/repeat.ts","webpack:///../src/lib/default-template-processor.ts","webpack:///../src/lib/directive.ts","webpack:///../src/lib/dom.ts","webpack:///../src/lib/modify-template.ts","webpack:///../src/lib/part.ts","webpack:///../src/lib/parts.ts","webpack:///../src/lib/render.ts","webpack:///../src/lib/shady-render.ts","webpack:///../src/lib/template-factory.ts","webpack:///../src/lib/template-instance.ts","webpack:///../src/lib/template-result.ts","webpack:///../src/lib/template.ts","webpack:///src/lit-html.ts","webpack:///./core/shaders/uberPBRShader.frag","webpack:///./core/shaders/uberPBRShader.vert","webpack:////app/node_modules/resolve-pathname/esm/resolve-pathname.js","webpack:////app/node_modules/three/examples/js/loaders/DRACOLoader.js","webpack:////app/node_modules/three/examples/js/loaders/GLTFLoader.js","webpack:////app/node_modules/three/examples/js/loaders/OBJLoader.js","webpack:////app/node_modules/three/examples/js/loaders/PLYLoader.js","webpack:///../../src/util.ts","webpack:///../../src/regexps-uri.ts","webpack:///../../src/regexps-iri.ts","webpack:///../../node_modules/punycode/punycode.es6.js","webpack:///../../src/uri.ts","webpack:///../../src/schemes/http.ts","webpack:///../../src/schemes/https.ts","webpack:///../../src/schemes/mailto.ts","webpack:///../../src/schemes/urn.ts","webpack:///../../src/schemes/urn-uuid.ts","webpack:///../../src/index.ts","webpack:///../common/types/config.ts","webpack:///../common/types/item.ts","webpack:///./core/components/CVLoaders.ts","webpack:///./core/components/CVModel.ts","webpack:///./core/components/CVNavigation.ts","webpack:///./core/components/CVOrbitNavigation.ts","webpack:///./core/components/CVScene.ts","webpack:///./core/components/index.ts","webpack:///./core/loaders/GeometryLoader.ts","webpack:///./core/loaders/JSONLoader.ts","webpack:///./core/loaders/JSONValidator.ts","webpack:///./core/loaders/ModelLoader.ts","webpack:///./core/loaders/TextureLoader.ts","webpack:///./core/models/Asset.ts","webpack:///./core/models/Derivative.ts","webpack:///./core/models/DerivativeList.ts","webpack:///./core/shaders/UberPBRMaterial.ts","webpack:///./explorer/ui/ContentView.ts","webpack:///./mini/MiniApplication.ts","webpack:///./mini/components/CMini.ts","webpack:///./mini/components/index.ts","webpack:///./mini/ui/MainView.ts","webpack:///./mini/ui/styles.scss?ca48","webpack:///external \"THREE\""],"names":["merge","sets","length","slice","xl","x","join","subexp","str","typeOf","o","undefined","Object","prototype","toString","call","split","pop","shift","toLowerCase","toUpperCase","toArray","obj","Array","setInterval","assign","target","source","key","buildExps","isIRI","ALPHA$$","CR$","DIGIT$$","DQUOTE$$","HEXDIG$$","SP$$","PCT_ENCODED$","SUB_DELIMS$$","RESERVED$$","GEN_DELIMS$$","UCSCHAR$$","SCHEME$","USERINFO$","UNRESERVED$$","DEC_OCTET$","DEC_OCTET_RELAXED$","H16$","LS32$","IPV4ADDRESS$","IPV6ADDRESS1$","IPV6ADDRESS2$","IPV6ADDRESS3$","IPV6ADDRESS4$","IPV6ADDRESS5$","IPV6ADDRESS6$","IPV6ADDRESS7$","IPV6ADDRESS8$","IPV6ADDRESS9$","ZONEID$","IPV6ADDRESS$","IP_LITERAL$","IPV6ADDRZ_RELAXED$","IPVFUTURE$","HOST$","REG_NAME$","PORT$","AUTHORITY$","PCHAR$","SEGMENT$","SEGMENT_NZ$","SEGMENT_NZ_NC$","PATH_ABEMPTY$","PATH_ABSOLUTE$","PATH$","PATH_NOSCHEME$","PATH_ROOTLESS$","PATH_EMPTY$","QUERY$","IPRIVATE$$","FRAGMENT$","HIER_PART$","URI$","RELATIVE_PART$","RELATIVE$","URI_REFERENCE$","ABSOLUTE_URI$","GENERIC_REF$","RELATIVE_REF$","ABSOLUTE_REF$","SAMEDOC_REF$","AUTHORITY_REF$","RegExp","maxInt","base","tMin","tMax","skew","damp","initialBias","initialN","delimiter","regexPunycode","regexNonASCII","regexSeparators","errors","baseMinusTMin","floor","Math","stringFromCharCode","String","fromCharCode","error","type","RangeError","map","array","fn","result","mapDomain","string","parts","replace","labels","encoded","ucs2decode","output","counter","value","charCodeAt","extra","push","ucs2encode","fromCodePoint","basicToDigit","codePoint","digitToBasic","digit","flag","adapt","delta","numPoints","firstTime","k","decode","input","inputLength","i","n","bias","basic","lastIndexOf","j","index","oldi","w","t","baseMinusT","out","splice","encode","currentValue","basicLength","handledCPCount","m","handledCPCountPlusOne","q","qMinusT","toUnicode","test","toASCII","punycode","SCHEMES","pctEncChar","chr","c","e","pctDecChars","newStr","il","parseInt","substr","c2","c3","_normalizeComponentEncoding","components","protocol","decodeUnreserved","decStr","match","UNRESERVED","scheme","PCT_ENCODED","NOT_SCHEME","userinfo","NOT_USERINFO","host","NOT_HOST","path","NOT_PATH","NOT_PATH_NOSCHEME","query","NOT_QUERY","fragment","NOT_FRAGMENT","_stripLeadingZeros","_normalizeIPv4","matches","IPV4ADDRESS","address","_normalizeIPv6","IPV6ADDRESS","zone","reverse","last","first","firstFields","lastFields","isLastFieldIPv4Address","fieldCount","lastFieldsStart","fields","allZeroFields","reduce","acc","field","lastLongest","longestZeroFields","sort","a","b","newHost","newFirst","newLast","URI_PARSE","NO_MATCH_IS_UNDEFINED","parse","uriString","options","iri","IRI_PROTOCOL","URI_PROTOCOL","reference","port","isNaN","indexOf","schemeHandler","unicodeSupport","domainHost","_recomposeAuthority","uriTokens","_","$1","$2","RDS1","RDS2","RDS3","RDS5","removeDotSegments","im","s","Error","serialize","authority","charAt","absolutePath","resolveComponents","relative","skipNormalization","tolerant","resolve","baseURI","relativeURI","schemelessOptions","normalize","uri","equal","uriA","uriB","escapeComponent","ESCAPE","unescapeComponent","handler","http","O","ATEXT$$","QTEXT$$","VCHAR$$","SOME_DELIMS$$","NOT_LOCAL_PART","NOT_HFNAME","NOT_HFVALUE","mailtoComponents","to","unknownHeaders","headers","hfields","hfield","toAddrs","subject","body","addr","toAddr","atIdx","localPart","domain","name","URN_PARSE","urnComponents","nid","nss","urnScheme","uriComponents","UUID","uuidComponents","uuid","https","mailto","urn"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;;AClFA;;;;;GAKG;;AAsDH,MAAqB,WAAW;IAU5B;QAEI,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACnD,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACnD,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/D,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACnD,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACnD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEvC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;QACrB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;QACjB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;IACrB,CAAC;IAED,aAAa,CAAC,KAAmB;QAE7B,gEAAgE;QAChE,IAAI,IAAI,CAAC,UAAU,IAAI,KAAK,CAAC,WAAW,KAAK,IAAI,CAAC,UAAU,EAAE;YAC1D,OAAO;SACV;QAED,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC,WAAW,CAAC;QACpC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC;YACtB,EAAE,EAAE,KAAK,CAAC,SAAS;YACnB,OAAO,EAAE,KAAK,CAAC,OAAO;YACtB,OAAO,EAAE,KAAK,CAAC,OAAO;SACzB,CAAC,CAAC;QAEF,KAAK,CAAC,aAA6B,CAAC,iBAAiB,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QAExE,MAAM,UAAU,GAAG,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,cAAc,CAAC,CAAC;QAEvE,IAAI,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,EAAE;YACnC,KAAK,CAAC,eAAe,EAAE,CAAC;SAC3B;QAED,KAAK,CAAC,cAAc,EAAE,CAAC;IAC3B,CAAC;IAED,aAAa,CAAC,KAAmB;QAE7B,MAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;QAE7C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,eAAe,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YACpD,MAAM,QAAQ,GAAG,eAAe,CAAC,CAAC,CAAC,CAAC;YACpC,IAAI,KAAK,CAAC,SAAS,KAAK,QAAQ,CAAC,EAAE,EAAE;gBACjC,QAAQ,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;gBACjC,QAAQ,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;aACpC;SACJ;QAED,MAAM,SAAS,GAAG,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,eAAe,CAAC;QAC5E,MAAM,UAAU,GAAG,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;QAElE,IAAI,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,EAAE;YACnC,KAAK,CAAC,eAAe,EAAE,CAAC;SAC3B;QAED,KAAK,CAAC,cAAc,EAAE,CAAC;IAC3B,CAAC;IAED,mBAAmB,CAAC,KAAmB;QAEnC,MAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;QAC7C,IAAI,KAAK,GAAG,KAAK,CAAC;QAElB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,eAAe,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YACpD,IAAI,KAAK,CAAC,SAAS,KAAK,eAAe,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE;gBAC3C,eAAe,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBAC7B,KAAK,GAAG,IAAI,CAAC;gBACb,MAAM;aACT;SACJ;QAED,IAAI,CAAC,KAAK,EAAE;YACR,sEAAsE;YACtE,OAAO;SACV;QAED,MAAM,UAAU,GAAG,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;QACrE,IAAI,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE;YAC9B,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;SACxB;QAED,IAAI,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,EAAE;YACnC,KAAK,CAAC,eAAe,EAAE,CAAC;SAC3B;QAED,KAAK,CAAC,cAAc,EAAE,CAAC;IAC3B,CAAC;IAED,aAAa,CAAC,KAAiB;QAE3B,MAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAClC,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,cAAc,CAAC,CACtD,CAAC;QAEF,IAAI,QAAQ,EAAE;YACV,KAAK,CAAC,cAAc,EAAE,CAAC;SAC1B;IACL,CAAC;IAED,aAAa,CAAC,KAAiB;QAE3B,IAAI,CAAC,gBAAgB,CACjB,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,cAAc,CAAC,CACtD,CAAC;QAEF,+EAA+E;QAC/E,KAAK,CAAC,cAAc,EAAE,CAAC;IAC3B,CAAC;IAED,OAAO,CAAC,KAAiB;QAErB,MAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAClC,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE,OAAO,CAAC,CAC/C,CAAC;QAEF,IAAI,QAAQ,EAAE;YACV,KAAK,CAAC,cAAc,EAAE,CAAC;SAC1B;IACL,CAAC;IAES,uBAAuB,CAAC,KAAmB,EAAE,IAAsB;QAEzE,gCAAgC;QAChC,IAAI,OAAO,GAAG,CAAC,CAAC;QAChB,IAAI,OAAO,GAAG,CAAC,CAAC;QAChB,IAAI,MAAM,GAAG,CAAC,CAAC;QACf,IAAI,MAAM,GAAG,CAAC,CAAC;QACf,IAAI,SAAS,GAAG,CAAC,CAAC;QAClB,IAAI,SAAS,GAAG,CAAC,CAAC;QAElB,MAAM,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC;QACvC,MAAM,KAAK,GAAG,SAAS,CAAC,MAAM,CAAC;QAE/B,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,EAAE,CAAC,EAAE;gBAC5B,OAAO,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;gBAChC,OAAO,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;aACnC;YAED,OAAO,IAAI,KAAK,CAAC;YACjB,OAAO,IAAI,KAAK,CAAC;YAEjB,IAAI,IAAI,KAAK,cAAc,IAAI,IAAI,KAAK,eAAe,EAAE;gBACrD,SAAS,GAAG,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;gBACnC,SAAS,GAAG,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;aACtC;YAED,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;YACvB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;SAC1B;aACI;YACD,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;YACvB,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;SAC1B;QAED,MAAM,OAAO,GAAG,KAAK,CAAC,aAAa,CAAC;QACpC,IAAI,OAAO,YAAY,OAAO,EAAE;YAC5B,MAAM,IAAI,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAC;YAC7C,MAAM,GAAG,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC;YACnC,MAAM,GAAG,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC;SACrC;QAED,OAAO;YACH,aAAa,EAAE,KAAK;YACpB,IAAI,EAAE,IAAI;YACV,MAAM,EAAE,KAAK,CAAC,WAAiC;YAE/C,SAAS,EAAE,KAAK,CAAC,SAAS;YAC1B,eAAe,EAAE,SAAS;YAC1B,YAAY,EAAE,KAAK;YAEnB,OAAO;YACP,OAAO;YACP,MAAM;YACN,MAAM;YACN,SAAS;YACT,SAAS;YAET,QAAQ,EAAE,KAAK,CAAC,QAAQ;YACxB,OAAO,EAAE,KAAK,CAAC,OAAO;YACtB,MAAM,EAAE,KAAK,CAAC,MAAM;YACpB,OAAO,EAAE,KAAK,CAAC,OAAO;SACzB,CAAC;IACN,CAAC;IAES,uBAAuB,CAAC,KAAiB,EAAE,IAAsB;QAEvE,IAAI,KAAK,GAAG,CAAC,CAAC;QAEd,IAAI,IAAI,KAAK,OAAO,EAAE;YAClB,KAAK,GAAI,KAAoB,CAAC,MAAM,CAAC;SACxC;QAED,IAAI,MAAM,GAAG,CAAC,CAAC;QACf,IAAI,MAAM,GAAG,CAAC,CAAC;QAEf,MAAM,OAAO,GAAG,KAAK,CAAC,aAAa,CAAC;QACpC,IAAI,OAAO,YAAY,OAAO,EAAE;YAC5B,MAAM,IAAI,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAC;YAC7C,MAAM,GAAG,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC;YACnC,MAAM,GAAG,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC;SACrC;QAED,OAAO;YACH,aAAa,EAAE,KAAK;YAEpB,IAAI;YACJ,KAAK;YAEL,OAAO,EAAE,KAAK,CAAC,OAAO;YACtB,OAAO,EAAE,KAAK,CAAC,OAAO;YACtB,MAAM;YACN,MAAM;YAEN,QAAQ,EAAE,KAAK,CAAC,QAAQ;YACxB,OAAO,EAAE,KAAK,CAAC,OAAO;YACtB,MAAM,EAAE,KAAK,CAAC,MAAM;YACpB,OAAO,EAAE,KAAK,CAAC,OAAO;SACzB;IACL,CAAC;IAES,gBAAgB,CAAC,KAAoB;QAE3C,OAAO,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;IACnD,CAAC;IAES,gBAAgB,CAAC,KAAoB;QAE3C,OAAO,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;IACnD,CAAC;CACJ;AArPD,8BAqPC;;;;;;;;;;;;;;AChTD;;;;;GAKG;;AAEH;;;;;;GAMG;AACH,mBAAwB,IAAY,EAAE,GAAY;IAE9C,IAAI,CAAC,GAAG,EAAE;QACN,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;KAC9B;IAED,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;IAEvC,MAAM,KAAK,GAAG,IAAI,MAAM,CAAC,MAAM,GAAG,IAAI,GAAG,mBAAmB,CAAC,CAAC;IAC9D,MAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAEhC,IAAI,CAAC,OAAO,EAAE;QACV,OAAO,SAAS,CAAC;KACpB;IAED,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;QACb,OAAO,EAAE,CAAC;KACb;IAED,OAAO,kBAAkB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,CAAC;AAC9D,CAAC;AApBD,4BAoBC;;;;;;;;;;;;;;AClCD;;;;;GAKG;;AAGH,qGAAqD;AAYrD,MAAqB,aAAc,SAAQ,mBAAS;IAIhD;QAEI,KAAK,EAAE,CAAC;QAJF,UAAK,GAAsB,EAAE,CAAC;QAKpC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;IAC3B,CAAC;IAED,GAAG,CAAC,SAA0B;QAE1B,IAAI,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;YAC1B,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;YAC1C,OAAO;SACV;QAED,MAAM,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC;QAC5B,IAAI,CAAC,IAAI,EAAE;YACP,MAAM,IAAI,KAAK,CAAC,oBAAoB,CAAC,CAAC;SACzC;QAED,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;YAClB,MAAM,IAAI,KAAK,CAAC,UAAU,IAAI,sBAAsB,CAAC,CAAC;SACzD;QAED,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,SAAS,CAAC;QAC7B,IAAI,CAAC,IAAI,CAAc,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC,CAAC;IACnF,CAAC;IAED,MAAM,CAAC,SAA0B;QAE7B,IAAI,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;YAC1B,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;YAC7C,OAAO;SACV;QAED,MAAM,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC;QAC5B,IAAI,CAAC,IAAI,EAAE;YACP,MAAM,IAAI,KAAK,CAAC,oBAAoB,CAAC,CAAC;SACzC;QAED,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;YACnB,MAAM,IAAI,KAAK,CAAC,UAAU,IAAI,kBAAkB,CAAC,CAAC;SACrD;QAED,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACxB,IAAI,CAAC,IAAI,CAAc,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC;IACnF,CAAC;IAED,QAAQ,CAAC,SAAkC;QAEvC,IAAI,OAAO,SAAS,KAAK,UAAU,EAAE;YACjC,SAAS,GAAG,SAAS,CAAC,IAAI,CAAC;SAC9B;aACI,IAAI,OAAO,SAAS,KAAK,QAAQ,EAAE;YACpC,SAAS,GAAG,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC;SAC1C;QAED,OAAO,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;IACjC,CAAC;IAED,cAAc,CAAC,SAAkC,EAAE,GAAG,IAAI;QAEtD,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QACvC,IAAI,CAAC,KAAK,EAAE;YACR,MAAM,IAAI,KAAK,CAAC,UAAU,SAAS,kBAAkB,CAAC,CAAC;SAC1D;QAED,OAAO,IAAI,KAAK,CAAC,GAAG,IAAI,CAAC,CAAC;IAC9B,CAAC;CACJ;AAvED,gCAuEC;;;;;;;;;;;;;;AC3FD;;;;;GAKG;;AAEH,sFAAmC;AAuBnC,MAAqB,OAAO;IAMxB,YAAY,IAAW,EAAE,KAAuB;QAE5C,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IACvB,CAAC;IAED,IAAI,IAAI;QACJ,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,gBAAS,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;IAC9D,CAAC;IAED,EAAE;QAEE,IAAI,IAAI,CAAC,MAAM,EAAE;YACb,MAAM,IAAI,KAAK,CAAC,2DAA2D,CAAC,CAAC;SAChF;QAED,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IACvE,CAAC;IAED,IAAI;QAEA,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;YACnB,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;SAC9C;QACD,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YACd,MAAM,IAAI,KAAK,CAAC,qDAAqD,CAAC,CAAC;SAC1E;QAED,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;QACvD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IACvB,CAAC;IAED,KAAK;QAED,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;IAC1D,CAAC;IAED,OAAO;QAEH,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;IAC9B,CAAC;CACJ;AAjDD,0BAiDC;;;;;;;;;;;;;;AC/ED;;;;;GAKG;;AAEH,qGAAoC;AACpC,+FAA6D;AAS7D,MAAqB,SAAU,SAAQ,mBAAS;IAQ5C,YAAY,QAAiB;QAEzB,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAExB,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;QAChB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;QAClB,IAAI,CAAC,QAAQ,GAAG,QAAQ,KAAK,SAAS,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,SAAS,CAAC,eAAe,CAAC;IAClF,CAAC;IAID,QAAQ,CAAqB,cAAmB;QAE5C,IAAI,OAAoC,CAAC;QAEzC,IAAI,OAAO,cAAc,KAAK,UAAU,EAAE;YACtC,OAAO,GAAG,cAAc,CAAC;SAC5B;aACI;YACD,OAAO,GAAG,CAAC,IAAW,EAAE,EAAE,CAAC,IAAI,iBAAO,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;SAChE;QAED,MAAM,MAAM,GAAQ,CAAC,GAAG,IAAW,EAAE,EAAE;YACnC,MAAM,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;YAC9B,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;QACrB,CAAC,CAAC;QAEF,OAAO,MAAW,CAAC;IACvB,CAAC;IAED,WAAW,CAAC,QAAgB;QAExB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAEzB,OAAM,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,QAAQ,EAAE;YAChC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;YACnB,IAAI,CAAC,OAAO,EAAE,CAAC;SAClB;QAED,IAAI,IAAI,CAAC,OAAO,GAAG,CAAC,EAAE;YAClB,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;YAChB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;SACrB;IACL,CAAC;IAED,EAAE,CAAC,OAAiB;QAEhB,OAAO,CAAC,GAAG,CAAC,mBAAmB,OAAO,CAAC,IAAI,GAAG,CAAC,CAAC;QAEhD,OAAO,CAAC,EAAE,EAAE,CAAC;QAEb,IAAI,OAAO,CAAC,OAAO,EAAE,EAAE;YACnB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;YACpC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAEzB,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,QAAQ,EAAE;gBACnC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;aACtB;YAED,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;YAErC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACvB;IACL,CAAC;IAED,IAAI;QAEA,IAAI,IAAI,CAAC,OAAO,IAAI,CAAC,EAAE;YACnB,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACzC,OAAO,CAAC,IAAI,EAAE,CAAC;YACf,IAAI,CAAC,OAAO,EAAE,CAAC;YAEf,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACvB;IACL,CAAC;IAGD,IAAI;QAEA,IAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACtC,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACzC,OAAO,CAAC,EAAE,EAAE,CAAC;YAEb,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACvB;IACL,CAAC;IAED,KAAK;QAED,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACvB,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;YAChB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC;YAElB,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACvB;IACL,CAAC;IAED,OAAO;QAEH,OAAO,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC;IAC7B,CAAC;IAED,OAAO;QAEH,OAAO,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;IAChD,CAAC;IAED,WAAW;QAEP,IAAI,IAAI,CAAC,OAAO,IAAI,CAAC,EAAE;YACnB,OAAO,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC;SAClD;QAED,OAAO,YAAY,CAAC;IACxB,CAAC;IAED,WAAW;QAEP,IAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACtC,OAAO,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC;SACtD;QAED,OAAO,YAAY,CAAC;IACxB,CAAC;;AAnIyB,yBAAe,GAAG,EAAE,CAAC;AAFnD,4BAsIC;;;;;;;;;;;;;;ACvJD;;;;;GAKG;;AAGH,qGAAqD;AAErD,gFAAgF;AAEhF,MAAM,YAAY,GAAG,EAAE,CAAC;AAEX,oBAAY,GAAG,UAAS,KAA0B;IAE3D,OAAO,OAAO,KAAK,KAAK,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,KAAK,QAAQ;QACxE,CAAC,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;AAC1C,CAAC;AAYD;;GAEG;AACH,MAAqB,cAA0C,SAAQ,mBAAS;IAO5E,YAAY,SAAqB;QAE7B,KAAK,CAAC,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC,CAAC;QAE9B,IAAI,SAAS,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE;YAC9B,MAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;SACtE;QAED,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC;QAE/D,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE,EAAE,EAAE,CAAC;QAC/C,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;IACvB,CAAC;IAED;;;;;OAKG;IACH,GAAG,CAAC,MAAS;QAET,MAAM,EAAE,GAAI,MAAc,CAAC,EAAE,CAAC;QAC9B,IAAI,OAAO,EAAE,KAAK,QAAQ,EAAE;YAExB,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,SAAS,EAAE;gBACjC,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;aAChD;YAED,iCAAiC;YACjC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC;SAC9B;QAED,IAAI,SAAS,GAAQ,MAAM,CAAC;QAC5B,IAAI,SAAS,CAAC;QACd,MAAM,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC;QAE1C,MAAM,KAAK,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC;QAE7D,mCAAmC;QACnC,GAAG;YACC,SAAS,GAAG,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;YAC7C,SAAS,GAAG,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC;YAEvC,IAAI,SAAS,EAAE;gBACX,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAE7E,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC;gBACvB,IAAI,CAAC,IAAI,CAAe,KAAK,CAAC,CAAC;aAClC;SAEJ,QAAQ,SAAS,KAAK,aAAa,EAAE;IAC1C,CAAC;IAED;;;OAGG;IACH,MAAM,CAAC,MAAS;QAEZ,MAAM,EAAE,GAAI,MAAc,CAAC,EAAE,CAAC;QAC9B,IAAI,OAAO,EAAE,KAAK,QAAQ,EAAE;YAExB,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,MAAM,EAAE;gBAC9B,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;aAC5C;YAED,mBAAmB;YACnB,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;SAC5B;QAED,IAAI,SAAS,GAAQ,MAAM,CAAC;QAC5B,IAAI,SAAS,CAAC;QACd,MAAM,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC;QAC1C,MAAM,KAAK,GAAG,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;QAE7D,sCAAsC;QACtC,GAAG;YACC,SAAS,GAAG,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;YAC7C,SAAS,GAAG,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC;YAEvC,IAAI,SAAS,EAAE;gBACX,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;gBAC1C,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;gBAE3C,KAAK,CAAC,IAAI,GAAG,SAAS,CAAC;gBACvB,IAAI,CAAC,IAAI,CAAe,KAAK,CAAC,CAAC;aAClC;SAEJ,QAAQ,SAAS,KAAK,aAAa,EAAE;IAC1C,CAAC;IAED;;OAEG;IACH,KAAK;QAED,MAAM,OAAO,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;QAClC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;IACnD,CAAC;IAED;;OAEG;IACH,IAAI,MAAM;QACN,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,MAAM,CAAC;IACtD,CAAC;IAED;;;OAGG;IACH,KAAK,CAAC,KAA2B;QAE7B,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;QACzD,OAAO,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;IACxC,CAAC;IAED;;;OAGG;IACH,GAAG,CAAc,KAA6B;QAE1C,IAAI,OAAO,KAAK,KAAK,UAAU,EAAE;YAC7B,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAC3C,OAAO,CAAC,CAAC,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC;SAC1C;QACD,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;YAC3B,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YACtC,OAAO,CAAC,CAAC,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC;SAC1C;QAED,MAAM,EAAE,GAAI,KAAa,CAAC,EAAE,CAAC;QAC7B,IAAI,OAAO,EAAE,KAAK,QAAQ,EAAE;YACxB,OAAO,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;SAC9B;QAED,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QACvD,OAAO,OAAO,IAAI,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IAClD,CAAC;IAED;;;OAGG;IACH,QAAQ,CAAc,MAAS;QAE3B,MAAM,EAAE,GAAI,MAAc,CAAC,EAAE,CAAC;QAC9B,IAAI,OAAO,EAAE,KAAK,QAAQ,EAAE;YACxB,OAAO,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;SAC9B;QAED,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QACxD,OAAO,OAAO,IAAI,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IACnD,CAAC;IAED;;;;;OAKG;IACH,GAAG,CAAkB,KAA8B,EAAE,UAAmB,KAAK;QAEzE,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QAC3C,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QAC1C,MAAM,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAM,CAAC,CAAC,CAAC,SAAS,CAAC;QAErD,IAAI,CAAC,OAAO,IAAI,CAAC,MAAM,EAAE;YACrB,MAAM,IAAI,KAAK,CAAC,0BAA0B,SAAS,eAAe,CAAC,CAAC;SACvE;QAED,OAAO,MAAM,CAAC;IAClB,CAAC;IAED;;;;;OAKG;IACH,QAAQ,CAAkB,KAA8B;QAEpD,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,IAAI,YAAY,CAAC;IACpE,CAAC;IAED;;;OAGG;IACH,UAAU,CAAkB,KAA8B;QAEtD,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,CAAC;IACxC,CAAC;IAED;;;OAGG;IACH,OAAO,CAAC,EAAU;QAEd,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;IAC7B,CAAC;IAED;;;OAGG;IACH,aAAa;QAET,OAAO,IAAI,CAAC,QAAQ,CAAC;IACzB,CAAC;IAED;;;;;OAKG;IACH,EAAE,CAAc,KAA6B,EAAE,QAA0C,EAAE,OAAgB;QAEvG,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;IAC1D,CAAC;IAED;;;;;OAKG;IACH,IAAI,CAAc,KAA6B,EAAE,QAA0C,EAAE,OAAgB;QAEzG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;IAC5D,CAAC;IAED;;;;;OAKG;IACH,GAAG,CAAc,KAA6B,EAAE,QAA0C,EAAE,OAAgB;QAExG,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;IAC3D,CAAC;IAED;;;OAGG;IACH,YAAY,CAAC,KAA2B;QAEpC,OAAO,OAAO,KAAK,KAAK,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,KAAK,QAAQ;YACxE,CAAC,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;IACnE,CAAC;CACJ;AAvQD,iCAuQC;;;;;;;;;;;;;;ACxSD;;;;;GAKG;;AAEH,MAAM,GAAG,GAAG,MAAM,CAAC,wBAAwB,CAAC,CAAC;AAC7C,MAAM,OAAO,GAAG,MAAM,CAAC,yBAAyB,CAAC,CAAC;AAoBlD;;GAEG;AACH,MAAqB,SAAS;IAE1B,YAAY,OAAkC;QAE1C,MAAM,WAAW,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC;QACzD,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,EAAE,WAAW,EAAE,CAAC;IAC3C,CAAC;IAUD,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,OAAQ;QAEvB,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACrB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;gBAChB,IAAI,CAAC,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;YACrC,CAAC,CAAC,CAAC;YAEH,OAAO;SACV;QAED,IAAI,CAAC,QAAQ,EAAE;YACX,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;SAChD;QAED,IAAI,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;QAClC,IAAI,CAAC,WAAW,EAAE;YACd,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,EAAE;gBACpB,MAAM,IAAI,KAAK,CAAC,oCAAoC,IAAI,GAAG,CAAC,CAAC;aAChE;YAED,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;SACtC;QAED,IAAI,UAAU,GAAG,EAAE,QAAQ,EAAE,OAAO,EAAE,CAAC;QACvC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IACjC,CAAC;IAED;;;;;OAKG;IACH,gBAAgB,CAAC,IAAY,EAAE,QAA8B,EAAE,OAAgB;QAE3E,IAAI,CAAC,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;IACrC,CAAC;IAUD,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,OAAQ;QAEzB,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACrB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;gBAChB,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;YACvC,CAAC,CAAC,CAAC;YAEH,OAAO;SACV;QAED,MAAM,QAAQ,GAAQ,KAAK,CAAC,EAAE;YAC1B,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;YAClC,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;QAClC,CAAC,CAAC;QAEF,QAAQ,CAAC,EAAE,GAAG,QAAQ,CAAC;QAEvB,IAAI,CAAC,EAAE,CAAC,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;IACrC,CAAC;IAUD,GAAG,CAAC,IAAI,EAAE,QAAS,EAAE,OAAQ;QAEzB,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;YAE1B,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;gBACrB,8EAA8E;gBAC9E,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;oBAClB,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;gBACtC,CAAC,CAAC,CAAC;aACN;iBACI;gBACD,uGAAuG;gBACvG,MAAM,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;gBACzB,MAAM,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAElC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,EAAE,EAAE,CAAC,EAAE;oBAC5C,MAAM,WAAW,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;oBACjC,MAAM,oBAAoB,GAAG,EAAE,CAAC;oBAChC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,EAAE,EAAE,CAAC,EAAE;wBAClD,MAAM,UAAU,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;wBAClC,IAAI,IAAI,IAAI,UAAU,CAAC,OAAO,KAAK,IAAI,EAAE;4BACrC,oBAAoB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;yBACzC;qBACJ;oBACD,MAAM,CAAC,IAAI,CAAC,GAAG,oBAAoB,CAAC;iBACvC;aACJ;YAED,OAAO;SACV;QAED,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;QACpC,IAAI,CAAC,WAAW,EAAE;YACd,MAAM,IAAI,KAAK,CAAC,2CAA2C,IAAI,GAAG,CAAC,CAAC;SACvE;QAED,MAAM,oBAAoB,GAAG,EAAE,CAAC;QAChC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAChD,MAAM,UAAU,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;YAClC,IAAI,CAAC,QAAQ,IAAI,QAAQ,KAAK,UAAU,CAAC,QAAQ,IAAI,QAAQ,KAAK,UAAU,CAAC,QAAQ,CAAC,EAAE,CAAC;mBAClF,CAAC,OAAO,IAAI,OAAO,KAAK,UAAU,CAAC,OAAO,CAAC,EAAE;gBAChD,oBAAoB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aACzC;SACJ;QACD,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,oBAAoB,CAAC;IAC3C,CAAC;IAED;;;;;OAKG;IACH,mBAAmB,CAAC,IAAY,EAAE,QAA+B,EAAE,OAAgB;QAE/E,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;IACtC,CAAC;IAaD,IAAI,CAAC,WAAW,EAAE,OAAQ;QAEtB,IAAI,IAAI,EAAE,OAAO,CAAC;QAClB,IAAI,OAAO,WAAW,KAAK,QAAQ,EAAE;YACjC,IAAI,GAAG,WAAW,CAAC;YACnB,OAAO,GAAG,OAAO,CAAC;SACrB;aACI;YACD,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC;YACxB,OAAO,GAAG,WAAW,CAAC;SACzB;QAED,IAAI,CAAC,IAAI,EAAE;YACP,MAAM,IAAI,KAAK,CAAC,iCAAiC,IAAI,GAAG,CAAC,CAAC;SAC7D;QAED,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;QACvB,MAAM,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;QAE/B,IAAI,CAAC,WAAW,EAAE;YACd,IAAI,IAAI,CAAC,OAAO,CAAC,EAAE;gBACf,MAAM,IAAI,KAAK,CAAC,oCAAoC,IAAI,GAAG,CAAC,CAAC;aAChE;YAED,OAAO;SACV;QAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAChD,MAAM,UAAU,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;YAClC,IAAI,UAAU,CAAC,OAAO,EAAE;gBACpB,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;aACzD;iBACI;gBACD,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;aAChC;SACJ;IACL,CAAC;IAED;;;OAGG;IACH,QAAQ,CAAC,IAAY;QAEjB,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE;YAClB,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;SACxB;IACL,CAAC;IAED;;;OAGG;IACH,SAAS,CAAC,GAAG,KAAe;QAExB,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACjB,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE;gBAClB,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;aACxB;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;;;OAIG;IACH,QAAQ,CAAC,IAAY;QAEjB,OAAO,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAED;;;OAGG;IACH,UAAU;QAEN,OAAO,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;IACjD,CAAC;CACJ;AA/OD,4BA+OC;;;;;;;;;;;;;;AC9QD;;;;;GAKG;;AAEH,MAAM,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC;AACnB,MAAM,OAAO,GAAG,EAAE,GAAG,GAAG,CAAC;AAEzB,IAAY,YAiBX;AAjBD,WAAY,YAAY;IACpB,mDAAM;IACN,uDAAQ;IACR,2DAAU;IACV,6DAAW;IACX,yDAAS;IACT,6DAAW;IACX,+DAAY;IACZ,yDAAS;IACT,6DAAW;IACX,+DAAY;IACZ,0DAAS;IACT,8DAAW;IACX,gEAAY;IACZ,wDAAQ;IACR,4DAAU;IACV,8DAAW;AACf,CAAC,EAjBW,YAAY,GAAZ,oBAAY,KAAZ,oBAAY,QAiBvB;AAED,SAAgB,iBAAiB,CAAC,KAAmB;IAEjD,OAAO,uBAAe,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;AAChD,CAAC;AAHD,8CAGC;AAEY,uBAAe,GAAG;IAC3B,MAAM,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,EAAC,CAAC;IAEjC,QAAQ,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,EAAC,CAAC;IAChE,UAAU,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAC,CAAC,EAAC,CAAC;IACvC,WAAW,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,CAAC,EAAC,CAAC;IAE5C,SAAS,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,EAAC,CAAC;IAC9E,WAAW,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAC,CAAC,GAAC,CAAC,EAAC,CAAC;IAC1C,YAAY,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,EAAE,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,EAAC,CAAC;IAEjD,SAAS,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,EAAE,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,EAAC,CAAC;IACxE,WAAW,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,EAAC,CAAC;IAC5C,YAAY,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAC,CAAC,EAAE,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,EAAC,CAAC;IAEnD,SAAS,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,EAAE,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAC,EAAE,GAAC,CAAC,EAAE,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,EAAC,CAAC;IAC9E,WAAW,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,EAAC,CAAC;IAC9C,YAAY,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAC,CAAC,EAAE,CAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,GAAC,CAAC,EAAC,CAAC;IAErD,QAAQ,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAChE,UAAU,EAAE,UAAU,CAAC,IAAI,OAAO,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;IAC9D,WAAW,EAAE,UAAU,CAAC,IAAI,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;CAC9D,CAAC;;;;;;;;;;;;;;ACxDF;;;;;GAKG;;AAIH,SAAwB,UAAU,CAAC,OAAoB,EAAE,IAAiB;IAEtE,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,EAAE;QACnB,OAAO,KAAK,CAAC;KAChB;IAED,IAAI,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;IAClC,OAAO,SAAS,EAAE;QACd,IAAI,SAAS,KAAK,IAAI,CAAC,SAAS,EAAE;YAC9B,OAAO,IAAI,CAAC;SACf;QAED,SAAS,GAAG,SAAS,CAAC,SAAS,CAAC;KACnC;IAED,OAAO,KAAK,CAAC;AACjB,CAAC;AAhBD,6BAgBC;;;;;;;;;;;;;;ACzBD;;;;;GAKG;;AAEH,MAAM,IAAI,GAAG;IAET,EAAE,EAAE,iCAAiC;IACrC,SAAS,EAAE,gCAAgC;IAC3C,OAAO,EAAE,iCAAiC;IAC1C,UAAU,EAAE,kCAAkC;IAC9C,OAAO,EAAE,kCAAkC;IAC3C,OAAO,EAAE,iCAAiC;IAE1C,KAAK,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAE3D,QAAQ,EAAE,UAAS,CAAC,EAAE,GAAG,EAAE,GAAG;QAC1B,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAClB,OAAO,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC/C,CAAC;IAED,SAAS,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC;IAEnD,cAAc,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;QAC5B,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC;QAC5B,OAAO,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC/C,CAAC;IAED,WAAW,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC;IAErD,KAAK,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE,CACvC,MAAM,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,MAAM,GAAG,MAAM,CAAC;IAE9D,UAAU,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE;QAC5C,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAChD,OAAO,MAAM,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC;IACtE,CAAC;IAED,OAAO,EAAE,UAAS,OAAO;QACrB,OAAO,OAAO,GAAG,kCAAkC,CAAC;IACxD,CAAC;IAED,OAAO,EAAE,UAAS,OAAO;QACrB,OAAO,OAAO,GAAG,iCAAiC,CAAC;IACvD,CAAC;IAED,YAAY,EAAE,UAAS,IAAI,EAAE,IAAI;QAC7B,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC;QACvB,IAAI,GAAG,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC;QAC/C,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC;QACvB,IAAI,GAAG,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC;QAE/C,IAAI,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,EAAE,EAAE;YACvB,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC;SAC1B;QAED,OAAO,IAAI,GAAG,IAAI,CAAC;IACvB,CAAC;IAED,YAAY,EAAE,UAAS,IAAI,EAAE,IAAI;QAC7B,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC;QACvB,IAAI,GAAG,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC;QAC/C,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC;QACvB,IAAI,GAAG,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC;QAE/C,IAAI,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,EAAE,EAAE;YACvB,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC;SAC1B;QAED,OAAO,IAAI,GAAG,IAAI,CAAC;IACvB,CAAC;IAED,MAAM,EAAE;QACJ,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;QAEd,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC;QACvC,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,EAAE,CAAC,GAAG,GAAG;QACxD,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC,GAAG,GAAG,GAAG,GAAG;QAEtD,UAAU,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC;QACtB,WAAW,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;QAC7B,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC;QAEzD,WAAW,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC;QAC3B,YAAY,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;QACpC,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC;QAEjF,WAAW,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;QAC/B,YAAY,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;QACxC,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;KAC1E;CACJ,CAAC;AAEF,kBAAe,IAAI,CAAC;;;;;;;;;;;;;;AC/FpB;;;;;GAKG;;AAEH,SAAgB,QAAQ,CAAC,IAAY;IAEjC,OAAO,IAAI,CAAC,OAAO,CAAC,qBAAqB,EAAE,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE,CACzD,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,WAAW,EAAE,CAC3D,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;AAC1B,CAAC;AALD,4BAKC;AAED,SAAgB,SAAS,CAAC,IAAY;IAElC,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,KAAK,CAAC;SACjC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC,CAAC;AACjD,CAAC;AAJD,8BAIC;;;;;;;;;;;;;;AClBD;;;;;GAKG;;AAwDH,gFAAgF;AAChF,wBAAwB;AAEX,mBAAW,GAAG,UAAS,CAAM;IACtC,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;AAC5D,CAAC,CAAC;;;;;;;;;;;;;;AClEF;;;;;GAKG;;AAEH,IAAI,MAAM,GAAG,gEAAgE,CAAC;AAE9E;;;;;;;GAOG;AACH,SAAwB,QAAQ,CAAC,MAAe,EAAE,UAAe;IAE7D,IAAI,CAAC,MAAM,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;QACvC,MAAM,GAAG,EAAE,CAAC;KACf;IAED,IAAI,EAAE,CAAC;IAEP,GAAG;QACC,EAAE,GAAG,EAAE,CAAC;QACR,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,EAAE,CAAC,EAAE;YAC7B,EAAE,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;SACxC;KACJ,QAAO,UAAU,IAAI,UAAU,CAAC,EAAE,CAAC,EAAE;IAEtC,OAAO,EAAE,CAAC;AACd,CAAC;AAhBD,2BAgBC;;;;;;;;;;;;;;ACjCD;;;;;GAKG;;AAGH,4GAA+E;AAG/E,mGAA+E;AAUtE,gBAVA,gBAAK,CAUA;AATd,kHAA2D;AAC3D,2HAAkD;AAClD,iIAAsD;AAwCtD,gFAAgF;AAEhF;;;;;;;;;;;;;;;GAeG;AACH,MAAqB,SAAU,SAAQ,mBAAS;IA+B5C;;;;;;;;OAQG;IACH,YAAY,EAAU;QAElB,KAAK,CAAC,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC,CAAC;QAtBlC,QAAG,GAAkB,IAAI,uBAAa,CAAC,IAAI,CAAC,CAAC;QAC7C,SAAI,GAAkB,IAAI,uBAAa,CAAC,IAAI,CAAC,CAAC;QAE9C,YAAO,GAAY,IAAI,CAAC;QACxB,YAAO,GAAY,KAAK,CAAC;QAEjB,UAAK,GAAS,IAAI,CAAC;QACnB,UAAK,GAAW,EAAE,CAAC;QACnB,cAAS,GAAuB,EAAE,CAAC;QACnC,mBAAc,GAAG,KAAK,CAAC;QAc3B,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;IACjB,CAAC;IAjCD,MAAM,CAAC,YAAY,CAAsB,KAA2B;QAEhE,OAAO,OAAO,KAAK,KAAK,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,KAAK,QAAQ;YACxE,CAAC,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;IAC9D,CAAC;IA+BD;;OAEG;IACH,IAAI,eAAe;QACf,OAAQ,IAAI,CAAC,WAAgC,CAAC,eAAe,CAAC;IAClE,CAAC;IAED;;OAEG;IACH,IAAI,gBAAgB;QAChB,OAAQ,IAAI,CAAC,WAAgC,CAAC,gBAAgB,CAAC;IACnE,CAAC;IAED;;OAEG;IACH,IAAI,iBAAiB;QACjB,OAAQ,IAAI,CAAC,WAAgC,CAAC,iBAAiB,CAAC;IACpE,CAAC;IAED;;;OAGG;IACH,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;IACjC,CAAC;IACD,IAAI,gBAAgB;QAChB,MAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;QACnC,OAAO,IAAI,KAAK,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;IACxD,CAAC;IAED,IAAI,IAAI;QACJ,OAAQ,IAAI,CAAC,WAAgC,CAAC,IAAI,CAAC;IACvD,CAAC;IAED,IAAI,IAAI;QACJ,OAAQ,IAAI,CAAC,WAAgC,CAAC,IAAI,CAAC;IACvD,CAAC;IAED;;OAEG;IACH,IAAI,IAAI;QACJ,OAAO,IAAI,CAAC,KAAK,CAAC;IACtB,CAAC;IAED,IAAI,WAAW;QACX,OAAO,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,gBAAgB,CAAC;IAC5D,CAAC;IAED;;;;OAIG;IACH,IAAI,IAAI,CAAC,KAAa;QAElB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,IAAI,CAAwB,EAAE,IAAI,EAAE,QAAQ,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;IACxF,CAAC;IAED;;OAEG;IACH,IAAI,IAAI;QACJ,OAAO,IAAI,CAAC,KAAK,CAAC;IACtB,CAAC;IAED;;OAEG;IACH,IAAI,KAAK;QACL,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;IAC5B,CAAC;IAED;;OAEG;IACH,IAAI,MAAM;QACN,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;IAC7B,CAAC;IAED;;;OAGG;IACH,IAAI,UAAU;QACV,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC;IACjC,CAAC;IAED;;OAEG;IACH,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAa,YAAY,CAAC,CAAC;IAC/D,CAAC;IAED,YAAY,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAC1G,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IAChE,CAAC;IAED,aAAa,CAAkC,gBAAsC;QACjF,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IAC5D,CAAC;IAED,YAAY,CAAC,gBAAkC;QAC3C,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IACvD,CAAC;IAED,iBAAiB,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAC/G,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IACtE,CAAC;IAED,kBAAkB,CAAkC,gBAAsC;QACtF,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IAClE,CAAC;IAED,iBAAiB,CAAC,gBAAkC;QAChD,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IAC7D,CAAC;IAED,gBAAgB,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAC9G,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IAC7E,CAAC;IAED,iBAAiB,CAAkC,gBAAsC;QACrF,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IACzE,CAAC;IAED,gBAAgB,CAAC,gBAAkC;QAC/C,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IACpE,CAAC;IAED,kBAAkB,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAChH,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IACvE,CAAC;IAED,mBAAmB,CAAkC,gBAAsC;QACvF,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IACnE,CAAC;IAED,kBAAkB,CAAC,gBAAkC;QACjD,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IAC9D,CAAC;IAED,gBAAgB,CAAC,EAAU;QACvB,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IACpD,CAAC;IAED,OAAO,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACjF,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IAC5D,CAAC;IAED,QAAQ,CAAwB,WAA4B;QACxD,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IACxD,CAAC;IAED,OAAO,CAAC,WAAwB;QAC5B,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IACnD,CAAC;IAED,WAAW,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACrF,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IACnE,CAAC;IAED,YAAY,CAAwB,WAA4B;QAC5D,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IAC/D,CAAC;IAED,WAAW,CAAC,WAAwB;QAChC,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IAC1D,CAAC;IAED,aAAa,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACvF,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IAC7D,CAAC;IAED,cAAc,CAAwB,WAA4B;QAC9D,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IACzD,CAAC;IAED,aAAa,CAAC,WAAwB;QAClC,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IACpD,CAAC;IAED,WAAW,CAAC,EAAU;QAClB,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IAC/C,CAAC;IAED;;;OAGG;IACH,MAAM,CAAC,IAAU;QAEb,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,IAAI,CAAC,MAAM,EAAE,CAAC;SACjB;QAED,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAElB,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;YACtB,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;YAC3B,IAAI,CAAC,MAAM,EAAE,CAAC;SACjB;QAED,kFAAkF;QAClF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAED;;;OAGG;IACH,MAAM;IAEN,CAAC;IAED;;;;;OAKG;IACH,MAAM,CAAC,OAAuB;QAE1B,MAAM,IAAI,KAAK,CAAC,6BAA6B,CAAC,CAAC;IACnD,CAAC;IAED;;;;OAIG;IACH,IAAI,CAAC,OAAuB;QAExB,MAAM,IAAI,KAAK,CAAC,6BAA6B,CAAC,CAAC;IACnD,CAAC;IAED;;;;;OAKG;IACH,QAAQ,CAAC,OAAuB;QAE5B,MAAM,IAAI,KAAK,CAAC,6BAA6B,CAAC,CAAC;IACnD,CAAC;IAED;;OAEG;IACH,MAAM;QAEF,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;YAClC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;SACrB;IACL,CAAC;IAED;;;;OAIG;IACH,OAAO;QAEH,gCAAgC;QAChC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;QACnB,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;QAEpB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC,CAAC;QAErD,6BAA6B;QAC7B,IAAI,CAAC,MAAM,EAAE,CAAC;QAEd,qBAAqB;QACrB,IAAI,CAAC,IAAI,CAAyB,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;IAC5E,CAAC;IAED,WAAW;QAEP,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;IAC7B,CAAC;IAED;;;OAGG;IACH,EAAE,CAAC,KAAuB;QAEtB,MAAM,SAAS,GAAG,SAAS,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QAEhD,IAAI,SAAS,GAAG,IAAI,CAAC;QAErB,GAAG;YACC,SAAS,GAAG,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;YAE7C,IAAI,SAAS,CAAC,WAAW,CAAC,IAAI,KAAK,SAAS,EAAE;gBAC1C,OAAO,IAAI,CAAC;aACf;SAEJ,QAAQ,SAAS,CAAC,WAAW,CAAC,IAAI,KAAK,SAAS,CAAC,IAAI,EAAE;QAExD,OAAO,KAAK,CAAC;IACjB,CAAC;IAED;;OAEG;IACH,mBAAmB;QAEf,IAAI,CAAC,GAAG,CAAC,mBAAmB,EAAE,CAAC;QAC/B,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC;IACpC,CAAC;IAED;;OAEG;IACH,YAAY;QAER,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACrB,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC;QAChC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YACxC,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,GAAG,KAAK,CAAC;SAC1B;IACL,CAAC;IAED;;;;;;OAMG;IACH,cAAc,CAAsB,gBAAqC,EACrE,MAA+B,EAAE,UAAmC;QAEpE,MAAM,OAAO,GAAG,IAAI,0BAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,gBAAgB,EAAE,MAAM,EAAE,UAAU,CAAC,CAAC;QAClG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC7B,OAAO,OAAO,CAAC;IACnB,CAAC;IAED;;;;OAIG;IACH,kBAAkB,CAAsB,gBAAqC;QAEzE,OAAO,IAAI,4BAAkB,CAAI,IAAI,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;IACpE,CAAC;IAED;;;;;;;;;OASG;IACH,WAAW,CAAC,KAAgC;QAExC,IAAI,MAAM,GAAG,IAAiB,CAAC;QAE/B,OAAO,MAAM,EAAE;YACX,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAEnB,IAAI,KAAK,CAAC,eAAe,EAAE;gBACvB,OAAO;aACV;YAED,MAAM,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;YAChD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;gBAC/C,MAAM,SAAS,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;gBAChC,IAAI,SAAS,KAAK,MAAM,EAAE;oBACtB,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;oBAEtB,IAAI,KAAK,CAAC,eAAe,EAAE;wBACvB,OAAO;qBACV;iBACJ;aACJ;YAED,MAAM,SAAS,GAAG,MAAM,CAAC,UAAU,CAAC,GAAG,CAAa,YAAY,CAAC,CAAC;YAClE,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC;YAE7C,gDAAgD;YAChD,iBAAiB;YACjB,uCAAuC;YACvC,IAAI;SACP;QAED,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE;YACxB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC3B;IACL,CAAC;IAED;;;;;OAKG;IACH,aAAa,CAAC,KAAgC;QAE1C,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAa,YAAY,CAAC,CAAC;QAChE,MAAM,QAAQ,GAAG,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC;QAEvD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC7C,MAAM,UAAU,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;YACrD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;gBAC/C,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBAC1B,IAAI,KAAK,CAAC,eAAe,EAAE;oBACvB,OAAO;iBACV;aACJ;YACD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;gBAC/C,UAAU,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;gBACnC,IAAI,KAAK,CAAC,eAAe,EAAE;oBACvB,OAAO;iBACV;aACJ;SACJ;IACL,CAAC;IAED;;;OAGG;IACH,QAAQ;QAEJ,OAAO,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;IACzE,CAAC;IAED,OAAO;QAEH,IAAI,IAAI,GAAQ,EAAE,CAAC;QAEnB,MAAM,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;QACnC,IAAI,OAAO,EAAE;YACT,IAAI,CAAC,GAAG,GAAG,OAAO,CAAC;SACtB;QACD,MAAM,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;QACrC,IAAI,QAAQ,EAAE;YACV,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC;SACxB;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,OAAO,CAAC,IAAS;QAEb,IAAI,IAAI,CAAC,GAAG,EAAE;YACV,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SAC9B;QACD,IAAI,IAAI,CAAC,IAAI,EAAE;YACX,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAChC;IACL,CAAC;IAED,iBAAiB,CAAC,IAAS;QAEvB,MAAM,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,aAAa,EAAE,CAAC;QAEpD,IAAI,IAAI,CAAC,GAAG,EAAE;YACV,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;SACzC;QACD,IAAI,IAAI,CAAC,IAAI,EAAE;YACX,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;SAC3C;IACL,CAAC;IAEA;;;;MAIE;IACO,SAAS,CAClB,SAAY,EAAE,KAAc;QAEzB,OAAO,IAAI,CAAC,GAAG,CAAC,6BAA6B,CAAC,SAAS,EAAE,KAAK,CAAQ,CAAC;IAC3E,CAAC;IAED;;;;OAIG;IACO,UAAU,CACnB,SAAY,EAAE,KAAc;QAEzB,OAAO,IAAI,CAAC,IAAI,CAAC,6BAA6B,CAAC,SAAS,EAAE,KAAK,CAAQ,CAAC;IAC5E,CAAC;;AA9hBe,cAAI,GAAW,WAAW,CAAC;AAE3B,cAAI,GAAW,EAAE,CAAC;AAClB,cAAI,GAAW,EAAE,CAAC;AAElB,yBAAe,GAAY,IAAI,CAAC;AAChC,0BAAgB,GAAY,KAAK,CAAC;AAClC,2BAAiB,GAAY,KAAK,CAAC;AATvD,4BAiiBC;AAED,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC;AAClC,SAAS,CAAC,SAAS,CAAC,IAAI,GAAG,IAAI,CAAC;AAChC,SAAS,CAAC,SAAS,CAAC,QAAQ,GAAG,IAAI,CAAC;;;;;;;;;;;;;;AC7mBpC;;;;;GAKG;;AAEH,sGAA0D;AAG1D,gFAAgF;AAEhF;;;GAGG;AACH,MAAqB,kBAAkB;IAMnC,YAAY,MAAc,EAAE,KAA2B;QACnD,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC,CAAC,CAAC,mBAAS,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAC/D,IAAI,CAAC,GAAG,GAAG,KAAK,YAAY,mBAAS,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC;QAC7D,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;IAC1B,CAAC;IAED,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAM,IAAI,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC;IACpF,CAAC;IACD,IAAI,SAAS,CAAC,SAAY;QACtB,IAAI,SAAS,IAAI,IAAI,CAAC,UAAU,IAAI,CAAC,CAAC,SAAS,YAAY,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE;YACzG,MAAM,IAAI,KAAK,CAAC,oCAAqC,SAAuB,CAAC,WAAW,CAAC,IAAI,IAAI,SAAS,uBAAuB,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC;SACxJ;QACD,IAAI,CAAC,GAAG,GAAG,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC;IACpD,CAAC;CACJ;AArBD,qCAqBC;;;;;;;;;;;;;;ACrCD;;;;;GAKG;;AAEH,2HAAqF;AAIrF,gFAAgF;AAEhF;;;;GAIG;AACH,MAAqB,gBAAgB;IAajC,YAAY,QAAmC,EAAE,KAA0B,EAC/D,MAA+B,EAAE,UAAmC;QAE5E,IAAI,CAAC,SAAS,GAAG,6BAAY,CAAC,KAAK,CAAC,CAAC;QACrC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAE7B,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAE1B,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;QACpD,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;QAE3C,IAAI,IAAI,CAAC,SAAS,IAAI,MAAM,EAAE;YAC1B,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SAC1B;IACL,CAAC;IAED,OAAO;QAEH,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;QAC3D,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACnB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;IAE3B,CAAC;IAES,WAAW,CAAC,KAAsB;QAExC,IAAI,KAAK,CAAC,GAAG,EAAE;YACX,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,MAAM,CAAC;YAC9B,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SAC5C;aACI,IAAI,KAAK,CAAC,MAAM,EAAE;YACnB,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YACjD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;SACzB;IACL,CAAC;CACJ;AAlDD,mCAkDC;;;;;;;;;;;;;;ACpED;;;;;GAKG;;AAEH,yGAAyC;AACzC,4GAA2C;AAE3C,qHAA8C;AAC9C,sGAA0E;AAC1E,uFAA2C;AAK3C,2HAAqD;AAErD,gFAAgF;AAEhF;;;;;;;;GAQG;AACH,MAAqB,KAAM,SAAQ,mBAAS;IAkBxC;;;;OAIG;IACH,YAAY,MAAc,EAAE,MAAqB;QAE7C,KAAK,CAAC,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC,CAAC;QAlBlC,6CAA6C;QACpC,UAAK,GAAG,IAAI,wBAAc,CAAO,cAAI,CAAC,CAAC;QAChD,kDAAkD;QACzC,eAAU,GAAG,IAAI,wBAAc,CAAY,mBAAS,CAAC,CAAC;QAGvD,YAAO,GAAG,IAAI,wBAAc,EAAE,CAAC;QAC/B,mBAAc,GAAG,IAAI,CAAC;QACtB,gBAAW,GAAgB,IAAI,CAAC;QAChC,kBAAa,GAAgB,EAAE,CAAC;QAUpC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACzB,CAAC;IAED,yDAAyD;IAEzD,uDAAuD;IACvD,IAAI,IAAI,CAAC,IAAgB;QACrB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAElB,IAAI,IAAI,CAAC,MAAM,EAAE;YACb,IAAI,CAAC,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC;SAChC;IACL,CAAC;IAED,0DAA0D;IAC1D,IAAI,IAAI;QACJ,OAAO,IAAI,CAAC,KAAK,CAAC;IACtB,CAAC;IAED,YAAY,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAC1G,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IAC1D,CAAC;IAED,aAAa,CAAkC,gBAAsC;QACjF,OAAO,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IACtD,CAAC;IAED,YAAY,CAAC,gBAAkC;QAC3C,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IACjD,CAAC;IAED,gBAAgB,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAC9G,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IACvE,CAAC;IAED,iBAAiB,CAAkC,gBAAsC;QACrF,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IACnE,CAAC;IAED,gBAAgB,CAAC,gBAAkC;QAC/C,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IAC9D,CAAC;IAED,kBAAkB,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAChH,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IACjE,CAAC;IAED,mBAAmB,CAAkC,gBAAsC;QACvF,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IAC7D,CAAC;IAED,kBAAkB,CAAC,gBAAkC;QACjD,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IACxD,CAAC;IAED,gBAAgB,CAAC,EAAU;QACvB,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IAC9C,CAAC;IAED,OAAO,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACjF,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IAChD,CAAC;IAED,QAAQ,CAAwB,WAA4B;QACxD,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IAC5C,CAAC;IAED,OAAO,CAAC,WAAwB;QAC5B,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IACvC,CAAC;IAED,WAAW,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACrF,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IAC7D,CAAC;IAED,YAAY,CAAwB,WAA4B;QAC5D,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IACzD,CAAC;IAED,WAAW,CAAC,WAAwB;QAChC,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IACpD,CAAC;IAED,aAAa,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACvF,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IACvD,CAAC;IAED,cAAc,CAAwB,WAA4B;QAC9D,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IACnD,CAAC;IAED,aAAa,CAAC,WAAwB;QAClC,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IAC9C,CAAC;IAED,WAAW,CAAC,EAAU;QAClB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IACzC,CAAC;IAED;;;;;;OAMG;IACH,IAAI,CAAC,OAAuB;QAExB,IAAI,IAAI,CAAC,cAAc,EAAE;YACrB,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;YAC5B,IAAI,CAAC,IAAI,EAAE,CAAC;SACf;QAED,sDAAsD;QACtD,MAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC;QACpC,IAAI,OAAO,GAAG,KAAK,CAAC;QAEpB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC/C,MAAM,SAAS,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;YAChC,SAAS,CAAC,OAAO,GAAG,KAAK,CAAC;YAE1B,IAAI,SAAS,CAAC,OAAO,EAAE;gBACnB,IAAI,SAAS,CAAC,MAAM,IAAI,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE;oBAC/C,OAAO,GAAG,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC;iBACtC;gBAED,SAAS,CAAC,YAAY,EAAE,CAAC;aAC5B;YAED,IAAI,SAAS,CAAC,IAAI,IAAI,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;gBAC3C,OAAO,GAAG,IAAI,CAAC;aAClB;SACJ;QAED,OAAO,OAAO,CAAC;IACnB,CAAC;IAED;;;;OAIG;IACH,QAAQ,CAAC,OAAuB;QAE5B,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC;QACtC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC/C,UAAU,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;SACnC;IACL,CAAC;IAED,KAAK;QAED,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,CAAC;QACtC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC1C,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC;SACtB;IACL,CAAC;IAED;;;OAGG;IACH,WAAW;QAEP,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;IAC/B,CAAC;IAED,IAAI;QAEA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAgB,CAAC;QAEhF,MAAM,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,QAAQ,CAAC;QAChF,OAAO,CAAC,GAAG,CAAC,uCAAuC,EAAE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;IACxF,CAAC;IAED;;;;;OAKG;IACH,gBAAgB,CAAiB,WAA2B,EAAE,IAAa,EAAE,EAAW;QAEpF,MAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;QAC7D,MAAM,IAAI,GAAG,IAAI,SAAS,CAAC,EAAE,IAAI,kBAAQ,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC,CAAM,CAAC;QAEvF,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAElB,IAAI,IAAI,EAAE;YACN,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;SACpB;QAED,IAAI,CAAC,EAAE,EAAE;YACL,IAAI,CAAC,gBAAgB,EAAE,CAAC;SAC3B;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED;;;;OAIG;IACH,UAAU,CAAC,IAAa,EAAE,EAAW;QAEjC,MAAM,IAAI,GAAG,IAAI,cAAI,CAAC,EAAE,IAAI,kBAAQ,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;QAE7E,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAElB,IAAI,IAAI,EAAE;YACN,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;SACpB;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,cAAc,CAAwB,IAAY,EAAE,WAA4B;QAE5E,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;QAE/C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC1C,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,IAAI,EAAE;gBACxB,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC;aACnB;SACJ;QAED,OAAO,SAAS,CAAC;IACrB,CAAC;IAED,aAAa,CAAwB,UAA2B;QAE5D,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAC9C,MAAM,MAAM,GAAG,EAAE,CAAC;QAElB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC1C,MAAM,SAAS,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,CAAa,YAAY,EAAE,IAAI,CAAC,CAAC;YAC1E,IAAI,CAAC,SAAS,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE;gBACjC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;aACzB;SACJ;QAED,OAAO,MAAM,CAAC;IAClB,CAAC;IAED;;;OAGG;IACH,QAAQ,CAAC,UAAmB,KAAK;QAE7B,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;QACpC,MAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;QAE9C,MAAM,IAAI,GAAG,WAAW,KAAK,CAAC,MAAM,WAAW,aAAa,cAAc,CAAC;QAE3E,IAAI,OAAO,EAAE;YACT,OAAO,IAAI,GAAG,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC1E;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED;;;OAGG;IACH,OAAO;QAEH,MAAM,IAAI,GAAQ,EAAE,CAAC;QACrB,MAAM,SAAS,GAAG,EAAE,CAAC;QAErB,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;QACpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC1C,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YAEtB,MAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAExC,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC;YAC/B,QAAQ,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC;YAEtB,IAAI,IAAI,CAAC,IAAI,EAAE;gBACX,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;aAC7B;YAED,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAC5B;QAED,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;YACtB,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;SAC1B;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED;;;OAGG;IACH,OAAO,CAAC,IAAI;QAER,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;gBAC1B,MAAM,IAAI,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,EAAE,CAAC,CAAC;gBAC9E,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;YAC3B,CAAC,CAAC,CAAC;SACN;IACL,CAAC;IAED;;;OAGG;IACH,iBAAiB,CAAC,IAAI;QAElB,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;gBAC1B,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;gBAC7C,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;YACrC,CAAC,CAAC,CAAC;SACN;IACL,CAAC;IAED;;;;OAIG;IACO,WAAW,CAAC,IAAU;QAE5B,OAAO,IAAI,CAAC,OAAO,EAAE,CAAC;IAC1B,CAAC;IAED;;;;OAIG;IACH,QAAQ,CAAC,IAAU;QAEf,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QAC3B,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACzB,CAAC;IAED;;;;OAIG;IACH,WAAW,CAAC,IAAU;QAElB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QACxB,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;IAClC,CAAC;IAED;;;;OAIG;IACH,aAAa,CAAC,SAAoB;QAE9B,IAAI,SAAS,CAAC,gBAAgB,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;YAC9D,MAAM,IAAI,KAAK,CAAC,gCAAgC,SAAS,CAAC,SAAS,qBAAqB,CAAC,CAAC;SAC7F;QAED,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;QACrC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;QAE/B,IAAI,SAAS,CAAC,QAAQ,EAAE;YACpB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACtC;QAED,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;IAC/B,CAAC;IAED;;;;OAIG;IACH,gBAAgB,CAAC,SAAoB;QAEjC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QAClC,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;QAExC,IAAI,SAAS,CAAC,QAAQ,EAAE;YACpB,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;SACvE;QAED,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;IAC/B,CAAC;CACJ;AAnaD,wBAmaC;;;;;;;;;;;;;;ACjcD;;;;;GAKG;;AAKH,gFAAgF;AAEhF;;GAEG;AACH,MAAqB,cAAc;IAM/B;QAEI,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;QAClB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QACnB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;IACrB,CAAC;IAED,IAAI,CAAC,SAAsB;QAEvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC9C,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;SAC5B;QAED,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAE3B,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;QAClB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QACnB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QAEjB,OAAO,MAAM,CAAC;IAClB,CAAC;IAES,KAAK,CAAC,QAAmB;QAE/B,MAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC7B,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAE/B,IAAI,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE;YAC/C,OAAO;SACV;QAED,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;QAE7B,sDAAsD;QACtD,MAAM,QAAQ,GAAG,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC;QAC1C,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,QAAQ,CAAC,MAAM,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE;YAClD,MAAM,QAAQ,GAAG,QAAQ,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC;YACvC,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,QAAQ,CAAC,MAAM,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE;gBAClD,MAAM,GAAG,GAAG,QAAQ,CAAC,EAAE,CAAC,CAAC,WAAW,CAAC,KAAK,CAAC;gBAE3C,4CAA4C;gBAC5C,MAAM,OAAO,GAAG,GAAG,CAAC,UAAU,CAAC;gBAC/B,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,OAAO,CAAC,MAAM,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE;oBACjD,MAAM,KAAK,GAAG,OAAO,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC;oBACnC,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,MAAM,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE;wBAC/C,MAAM,SAAS,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,WAAW,CAAC,KAAK,CAAC;wBAC9C,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;qBAClC;iBACJ;gBAED,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;aAC5B;SACJ;QAED,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC;QAClC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;QAE5B,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;IAClC,CAAC;CACJ;AAjED,iCAiEC;;;;;;;;;;;;;;AChFD;;;;;GAKG;;AAEH,yGAAyC;AAEzC,4GAA4D;AAC5D,2HAAuE;AAGvE,sGAA2E;AAiC3E;;;;;;;;;;;GAWG;AACH,MAAqB,IAAK,SAAQ,mBAAS;IAsBvC;;;;;;;OAOG;IACH,YAAY,EAAU;QAElB,KAAK,CAAC,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC,CAAC;QAhBlC,iDAAiD;QACxC,eAAU,GAAG,IAAI,wBAAc,CAAY,mBAAS,CAAC,CAAC;QAEvD,WAAM,GAAU,IAAI,CAAC;QACrB,UAAK,GAAW,EAAE,CAAC;QAavB,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;IACjB,CAAC;IA3BD,MAAM,CAAC,YAAY,CAAiB,KAAsB;QAEtD,OAAO,OAAO,KAAK,KAAK,UAAU,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,KAAK,QAAQ;YACxE,CAAC,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACzD,CAAC;IAyBD;;OAEG;IACH,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;IACjC,CAAC;IACD,IAAI,gBAAgB;QAChB,MAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;QACnC,OAAO,IAAI,KAAK,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;IACnD,CAAC;IAED,IAAI,IAAI;QACJ,OAAQ,IAAI,CAAC,WAAgC,CAAC,IAAI,CAAC;IACvD,CAAC;IAED,IAAI,IAAI;QACJ,OAAQ,IAAI,CAAC,WAAgC,CAAC,IAAI,CAAC;IACvD,CAAC;IAED;;OAEG;IACH,IAAI,IAAI;QACJ,OAAO,IAAI,CAAC,KAAK,CAAC;IACtB,CAAC;IAED,IAAI,WAAW;QACX,OAAO,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,gBAAgB,CAAC;IAC5D,CAAC;IAED;;;;OAIG;IACH,IAAI,IAAI,CAAC,KAAa;QAClB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,IAAI,CAAmB,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;IAC9E,CAAC;IAED;;OAEG;IACH,IAAI,KAAK;QACL,OAAO,IAAI,CAAC,MAAM,CAAC;IACvB,CAAC;IAED;;OAEG;IACH,IAAI,MAAM;QACN,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;IAC9B,CAAC;IAED,YAAY,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAC1G,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IAC1D,CAAC;IAED,aAAa,CAAkC,gBAAsC;QACjF,OAAO,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IACtD,CAAC;IAED,YAAY,CAAC,gBAAkC;QAC3C,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IACjD,CAAC;IAED,iBAAiB,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAC/G,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IAChE,CAAC;IAED,kBAAkB,CAAkC,gBAAsC;QACtF,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IAC5D,CAAC;IAED,iBAAiB,CAAC,gBAAkC;QAChD,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IACvD,CAAC;IAED,gBAAgB,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAC9G,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IAC9E,CAAC;IAED,iBAAiB,CAAkC,gBAAsC;QACrF,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IAC1E,CAAC;IAED,gBAAgB,CAAC,gBAAkC;QAC/C,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IACrE,CAAC;IAED,kBAAkB,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAChH,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IACxE,CAAC;IAED,mBAAmB,CAAkC,gBAAsC;QACvF,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IACpE,CAAC;IAED,kBAAkB,CAAC,gBAAkC;QACjD,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IAC/D,CAAC;IAED,gBAAgB,CAAC,EAAU;QACvB,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IACrD,CAAC;IAED,OAAO,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACjF,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IACvD,CAAC;IAED,QAAQ,CAAwB,WAA4B;QACxD,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IACnD,CAAC;IAED,OAAO,CAAC,WAAwB;QAC5B,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IAC9C,CAAC;IAED,WAAW,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACrF,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IACpE,CAAC;IAED,YAAY,CAAwB,WAA4B;QAC5D,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IAChE,CAAC;IAED,WAAW,CAAC,WAAwB;QAChC,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IAC3D,CAAC;IAED,aAAa,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACvF,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IAC9D,CAAC;IAED,cAAc,CAAwB,WAA4B;QAC9D,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IAC1D,CAAC;IAED,aAAa,CAAC,WAAwB;QAClC,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IACrD,CAAC;IAED,WAAW,CAAC,EAAU;QAClB,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IAChD,CAAC;IAED;;;OAGG;IACH,MAAM,CAAC,KAAY;QAEf,IAAI,IAAI,CAAC,MAAM,EAAE;YACb,IAAI,CAAC,MAAM,EAAE,CAAC;SACjB;QAED,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IACzB,CAAC;IAED;;OAEG;IACH,MAAM;QAEF,IAAI,IAAI,CAAC,MAAM,EAAE;YACb,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAC9B,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;SACtB;IACL,CAAC;IAED;;;OAGG;IACH,gBAAgB;IAEhB,CAAC;IAED,KAAK;QAED,qBAAqB;QACrB,MAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC,KAAK,EAAE,CAAC;QACzD,aAAa,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC,CAAC;IAC5D,CAAC;IAED;;;OAGG;IACH,OAAO;QAEH,qBAAqB;QACrB,MAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC,KAAK,EAAE,CAAC;QACzD,aAAa,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC,CAAC;QAExD,oCAAoC;QACpC,IAAI,CAAC,MAAM,EAAE,CAAC;QAEd,qBAAqB;QACrB,IAAI,CAAC,IAAI,CAAoB,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;IAClE,CAAC;IAED;;;;;OAKG;IACH,eAAe,CAAsB,eAAoC,EAAE,IAAa,EAAE,EAAW;QAEjG,MAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;QACjE,MAAM,SAAS,GAAG,IAAI,SAAS,CAAC,EAAE,IAAI,kBAAQ,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,aAAa,EAAE,CAAC,CAAM,CAAC;QAEjG,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAEvB,IAAI,IAAI,EAAE;YACN,SAAS,CAAC,IAAI,GAAG,IAAI,CAAC;SACzB;QAED,OAAO,SAAS,CAAC;IACrB,CAAC;IAED;;;OAGG;IACH,EAAE,CAAC,KAAkB;QAEjB,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QAE3C,IAAI,SAAS,GAAG,IAAI,CAAC;QAErB,GAAG;YACC,SAAS,GAAG,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;YAE7C,IAAI,SAAS,CAAC,WAAW,CAAC,IAAI,KAAK,SAAS,EAAE;gBAC1C,OAAO,IAAI,CAAC;aACf;SAEJ,QAAO,SAAS,CAAC,WAAW,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI,EAAE;QAElD,OAAO,KAAK,CAAC;IACjB,CAAC;IAED;;;OAGG;IACH,QAAQ,CAAC,UAAmB,KAAK;QAE7B,MAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;QAC9C,MAAM,IAAI,GAAG,SAAS,IAAI,CAAC,IAAI,OAAO,UAAU,CAAC,MAAM,aAAa,CAAC;QAErE,IAAI,OAAO,EAAE;YACT,OAAO,IAAI,GAAG,IAAI,GAAG,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,GAAG,SAAS,CAAC,QAAQ,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC5F;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED;;;OAGG;IACH,OAAO;QAEH,MAAM,IAAI,GAAQ,EAAE,CAAC;QACrB,MAAM,cAAc,GAAG,EAAE,CAAC;QAE1B,MAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;QAC9C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC/C,MAAM,SAAS,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;YAEhC,MAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;YAElD,QAAQ,CAAC,IAAI,GAAG,SAAS,CAAC,SAAS,CAAC;YACpC,QAAQ,CAAC,EAAE,GAAG,SAAS,CAAC,EAAE,CAAC;YAE3B,IAAI,SAAS,CAAC,IAAI,EAAE;gBAChB,QAAQ,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC;aAClC;YAED,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SACjC;QAED,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3B,IAAI,CAAC,UAAU,GAAG,cAAc,CAAC;SACpC;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED;;;;OAIG;IACH,OAAO,CAAC,IAAI,EAAE,YAAmC;QAE7C,IAAI,IAAI,CAAC,UAAU,EAAE;YACjB,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;gBACpB,MAAM,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,EAAE,CAAC,CAAC;gBAClF,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;YAChC,CAAC,CAAC,CAAC;SACN;IACL,CAAC;IAED;;;OAGG;IACH,iBAAiB,CAAC,IAAI;QAElB,IAAI,IAAI,CAAC,UAAU,EAAE;YACjB,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;gBAC/B,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;gBACvD,SAAS,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;YAC1C,CAAC,CAAC,CAAC;SACN;IACL,CAAC;IAED;;;;OAIG;IACO,gBAAgB,CAAC,SAAoB;QAE3C,OAAO,SAAS,CAAC,OAAO,EAAE,CAAC;IAC/B,CAAC;IAED;;;;;OAKG;IACH,aAAa,CAAC,SAAoB;QAE9B,IAAI,SAAS,CAAC,eAAe,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;YAC7D,MAAM,IAAI,KAAK,CAAC,gCAAgC,SAAS,CAAC,SAAS,oBAAoB,CAAC,CAAC;SAC5F;QAED,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;QACpC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;IACnC,CAAC;IAED;;;;;OAKG;IACH,gBAAgB,CAAC,SAAoB;QAEjC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QAClC,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;IAC3C,CAAC;;AAxYe,SAAI,GAAW,MAAM,CAAC;AAEtB,SAAI,GAAW,EAAE,CAAC;AAClB,SAAI,GAAW,EAAE,CAAC;AALtC,uBA4YC;;;;;;;;;;;;;;ACtcD;;;;;GAKG;;AAEH,+GAA6C;AAE7C,4GAA4D;AAE5D,gGAAkD;AAElD,+GAA0C;AAC1C,kHAAqF;AAI5E,kBAJA,uBAAO,CAIA;AAAE,gBAJA,qBAAK,CAIA;AAuBvB;;GAEG;AACH,MAAqB,QAAkB,SAAQ,mBAAS;IAiBpD;;;;;OAKG;IACH,YAAY,IAAY,EAAE,MAA0B,EAAE,IAAc;QAEhE,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;QAErD,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,MAAM,KAAK,SAAS,EAAE;YACxC,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;SAC5C;QAED,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;QAC7B,MAAM,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAEtC,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAc,CAAC;QAC/D,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,IAAI,GAAG,IAAI,IAAI,KAAK,CAAC;QAC1B,IAAI,CAAC,YAAY,GAAG,OAAO,CAAC,CAAC,CAAE,MAAc,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QAEzD,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;QAClB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QAEnB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACnB,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;QACf,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAElB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,KAAK,EAAE,CAAC;QACb,IAAI,CAAC,OAAO,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC;IACjC,CAAC;IAED,IAAI,KAAK;QACL,OAAO,IAAI,CAAC,MAAM,CAAC;IACvB,CAAC;IACD,IAAI,GAAG;QACH,OAAO,IAAI,CAAC,IAAI,CAAC;IACrB,CAAC;IAED,IAAI,IAAI;QACJ,OAAO,IAAI,CAAC,KAAK,CAAC;IACtB,CAAC;IACD,IAAI,IAAI,CAAC,IAAY;QACjB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,IAAI,CAAuB,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;IACtF,CAAC;IAED;;;;;OAKG;IACH,MAAM,CAAC,KAAoB,EAAE,GAAY,EAAE,KAAc;QAErD,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;IACzC,CAAC;IAED;;;OAGG;IACH,MAAM;QAEF,IAAI,IAAI,CAAC,MAAM,EAAE;YACb,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;SACrC;IACL,CAAC;IAED;;;OAGG;IACH,OAAO;QAEH,IAAI,CAAC,MAAM,EAAE,CAAC;QACd,IAAI,CAAC,MAAM,EAAE,CAAC;QAEd,IAAI,CAAC,IAAI,CAAwB,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;IAC1E,CAAC;IAED,QAAQ,CAAC,KAAQ,EAAE,MAAgB;QAE/B,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QAEnB,IAAI,CAAC,MAAM,EAAE;YACT,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YAEpB,IAAI,IAAI,CAAC,OAAO,EAAE,EAAE;gBAChB,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,GAAG,IAAI,CAAC;aACvC;SACJ;QAED,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;QAE1B,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC7C,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;SACtB;IACL,CAAC;IAED,SAAS,CAAC,KAAQ,EAAE,MAAgB;QAEhC,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YACtB,KAAK,GAAG,KAAK,CAAC,KAAK,EAAS,CAAC;SAChC;QAED,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;IACjC,CAAC;IAED,GAAG,CAAC,MAAgB;QAEhB,IAAI,CAAC,MAAM,EAAE;YACT,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YAEpB,IAAI,IAAI,CAAC,OAAO,EAAE,EAAE;gBAChB,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,GAAG,IAAI,CAAC;aACvC;SACJ;QAED,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QAE/B,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC7C,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;SACtB;IACL,CAAC;IAED,UAAU;QAEN,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,OAAO,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,EAAS,CAAC,CAAC,CAAC,KAAK,CAAC;IAC/D,CAAC;IAED;;;OAGG;IACH,iBAAiB,CAAC,MAAU;QAExB,MAAM,KAAK,GAAG,IAAI,CAAC,KAAY,CAAC;QAEhC,IAAI,IAAI,CAAC,OAAO,EAAE,EAAE;YAChB,MAAM,GAAG,MAAM,IAAI,EAAc,CAAC;YAClC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;gBAC1C,MAAM,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;aAC5C;YACD,OAAO,MAAM,CAAC;SACjB;QAED,OAAO,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IACrC,CAAC;IAED,MAAM,CAAC,WAAqB,EAAE,WAAoB,EAAE,gBAAyB;QAEzE,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,WAAW,EAAE,gBAAgB,CAAC,CAAC;IAC9D,CAAC;IAED,QAAQ,CAAC,MAAgB,EAAE,WAAoB,EAAE,gBAAyB;QAEtE,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,WAAW,EAAE,gBAAgB,CAAC,EAAE;YAC1D,MAAM,IAAI,KAAK,CAAC,YAAY,CAAC,CAAC;SACjC;QAED,MAAM,IAAI,GAAG,IAAI,sBAAY,CAAC,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,gBAAgB,CAAC,CAAC;QAC3E,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QACxB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;IACzB,CAAC;IAED,QAAQ,CAAC,WAAqB,EAAE,WAAoB,EAAE,gBAAyB;QAE3E,WAAW,CAAC,UAAU,CAAC,IAAI,EAAE,WAAW,EAAE,gBAAgB,CAAC,CAAC;IAChE,CAAC;IAED,UAAU,CAAC,MAAgB,EAAE,WAAoB,EAAE,gBAAyB;QAExE,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAClC,IAAI,CAAC,MAAM,KAAK,MAAM;eACnB,IAAI,CAAC,WAAW,KAAK,WAAW;eAChC,IAAI,CAAC,gBAAgB,KAAK,gBAAgB,CAChD,CAAC;QAEF,IAAI,CAAC,IAAI,EAAE;YACP,OAAO,KAAK,CAAC;SAChB;QAED,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;QAC3B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;QAExB,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,MAAM;QAEF,MAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;QACrC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACnB,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;YAChC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;QAC3B,CAAC,CAAC,CAAC;QAEH,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;QACvC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACpB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;YACzB,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;QACxC,CAAC,CAAC,CAAC;QAEH,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;YACzD,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;SAC5C;IACL,CAAC;IAED,SAAS,CAAC,IAAkB;QAExB,IAAG,IAAI,CAAC,WAAW,KAAK,IAAI,EAAE;YAC1B,MAAM,IAAI,KAAK,CAAC,0CAA0C,CAAC,CAAC;SAC/D;QAED,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACxB,IAAI,CAAC,WAAW,EAAE,CAAC;QAEnB,IAAI,CAAC,IAAI,CAAqB;YAC1B,IAAI,EAAE,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI;SAC/C,CAAC,CAAC;IACP,CAAC;IAED,UAAU,CAAC,IAAkB;QAEzB,IAAG,IAAI,CAAC,MAAM,KAAK,IAAI,EAAE;YACrB,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;SAC3D;QAED,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACzB,IAAI,CAAC,WAAW,EAAE,CAAC;QAEnB,gCAAgC;QAChC,IAAI,CAAC,IAAI,EAAE,CAAC;IAChB,CAAC;IAED,YAAY,CAAC,IAAkB;QAE3B,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACzC,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,MAAM,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;SAC3C;QAED,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QAC9B,IAAI,CAAC,WAAW,EAAE,CAAC;QAEX,gFAAgF;QACxF,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,EAAE;YACrD,IAAI,CAAC,KAAK,EAAE,CAAC;SAChB;QAED,IAAI,CAAC,IAAI,CAAqB;YAC1B,IAAI,EAAE,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI;SAC/C,CAAC,CAAC;IACP,CAAC;IAED,aAAa,CAAC,IAAkB;QAE5B,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAC1C,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;SAC5C;QAED,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QAC/B,IAAI,CAAC,WAAW,EAAE,CAAC;IACvB,CAAC;IAED,SAAS,CAAC,WAAqB,EAAE,WAAoB,EAAE,gBAAyB;QAE5E,OAAO,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,WAAW,EAAE,gBAAgB,CAAC,CAAC;IACxE,CAAC;IAED,WAAW,CAAC,MAAgB,EAAE,WAAoB,EAAE,gBAAyB;QAEzE,mCAAmC;QACnC,IAAI,IAAI,CAAC,QAAQ,EAAE,EAAE;YACjB,OAAO,KAAK,CAAC;SAChB;QAED,MAAM,WAAW,GAAG,WAAW,IAAI,CAAC,CAAC;QACrC,MAAM,WAAW,GAAG,gBAAgB,IAAI,CAAC,CAAC;QAE1C,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,WAAW,EAAE;YAClC,MAAM,IAAI,KAAK,CAAC,kDAAkD,CAAC,CAAC;SACvE;QACD,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,WAAW,EAAE;YAChC,MAAM,IAAI,KAAK,CAAC,uDAAuD,CAAC,CAAC;SAC5E;QAED,MAAM,UAAU,GAAG,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC;QACpD,MAAM,UAAU,GAAG,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC;QAElD,IAAI,UAAU,KAAK,UAAU,EAAE;YAC3B,OAAO,KAAK,CAAC;SAChB;QACD,IAAI,UAAU,IAAI,MAAM,CAAC,YAAY,KAAK,IAAI,CAAC,YAAY,EAAE;YACzD,OAAO,KAAK,CAAC;SAChB;QAED,IAAI,MAAM,CAAC,IAAI,KAAK,QAAQ,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,EAAE;YACpD,IAAI,CAAC,oBAAU,CAAC,MAAM,CAAC,MAAM,CAAC,UAAU,EAAE,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE;gBAC/D,OAAO,KAAK,CAAC;aAChB;SACJ;QAED,OAAO,oBAAU,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;IAC9C,CAAC;IAED,KAAK;QAED,IAAI,KAAK,CAAC;QAEV,IAAI,IAAI,CAAC,OAAO,EAAE,EAAE;YAChB,IAAI,UAAU,GAAQ,IAAI,CAAC,KAAY,CAAC;YAExC,IAAI,CAAC,UAAU,EAAE;gBACb,KAAK,GAAG,UAAU,GAAG,EAAS,CAAC;aAClC;iBACI;gBACD,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC;aACzB;YAED,UAAU,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;SACtC;aACI;YACD,KAAK,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;SAC9B;QAED,4CAA4C;QAC5C,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IACzB,CAAC;IAED,oBAAoB,CAAC,KAAa;QAE9B,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE;YACjB,MAAM,IAAI,KAAK,CAAC,qDAAqD,CAAC,CAAC;SAC1E;QAED,MAAM,UAAU,GAAQ,IAAI,CAAC,KAAY,CAAC;QAC1C,MAAM,YAAY,GAAG,UAAU,CAAC,MAAM,CAAC;QACvC,UAAU,CAAC,MAAM,GAAG,KAAK,CAAC;QAE1B,KAAK,IAAI,CAAC,GAAG,YAAY,EAAE,CAAC,GAAG,KAAK,EAAE,EAAE,CAAC,EAAE;YACvC,UAAU,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;SACtC;QAED,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;IACxB,CAAC;IAED,WAAW;QAEP,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE;YACrC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;SACtC;IACL,CAAC;IAED,UAAU,CAAC,OAAiB;QAExB,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;YACtB,MAAM,IAAI,KAAK,CAAC,iDAAiD,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;SAClF;QAEA,IAAI,CAAC,MAA0B,CAAC,OAAO,GAAG,OAAO,CAAC,KAAK,EAAE,CAAC;QAC3D,IAAI,CAAC,IAAI,CAAuB,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;IACzF,CAAC;IAED,aAAa;QAET,MAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;QACpC,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,IAAI,OAAO,EAAE;YACnC,MAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAY,CAAC,CAAC;YACxC,OAAO,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;SACnE;IACL,CAAC;IAED,OAAO;QAEH,OAAO,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC;IACnE,CAAC;IAED,QAAQ;QAEJ,OAAO,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;IACpE,CAAC;IAED,OAAO;QAEH,OAAO,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IAC7C,CAAC;IAED,OAAO;QAEH,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;IAC/B,CAAC;IAED,SAAS;QAEL,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC;QAC7D,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;QAClC,MAAM,WAAW,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC7D,MAAM,YAAY,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEhE,IAAI,WAAW,KAAK,YAAY,EAAE;YAC9B,OAAO,KAAK,CAAC;SAChB;QAED,IAAI,WAAW,IAAI,CAAC,EAAE;YAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,EAAE,EAAE,CAAC,EAAE;gBAClC,IAAI,KAAK,CAAC,CAAC,CAAC,KAAK,MAAM,CAAC,CAAC,CAAC,EAAE;oBACxB,OAAO,KAAK,CAAC;iBAChB;aACJ;YACD,OAAO,IAAI,CAAC;SACf;QAED,OAAO,KAAK,KAAK,MAAM,CAAC;IAC5B,CAAC;IAED,UAAU,CAAC,KAAc;QAErB,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC;QAE3B,IAAI,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,EAAE;YACf,OAAO,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;SAC3B;QAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC1C,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,gBAAgB,KAAK,KAAK,EAAE;gBACrC,OAAO,IAAI,CAAC;aACf;SACJ;QAED,OAAO,KAAK,CAAC;IACjB,CAAC;IAED,cAAc;QAEV,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC;QAE3B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC1C,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,gBAAgB,IAAI,CAAC,CAAC,EAAE;gBACnC,OAAO,IAAI,CAAC;aACf;SACJ;QAED,OAAO,KAAK,CAAC;IACjB,CAAC;IAED,WAAW,CAAC,KAAc;QAEtB,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC;QAE5B,IAAI,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,EAAE;YACf,OAAO,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;SAC3B;QAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC1C,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,WAAW,KAAK,KAAK,EAAE;gBAChC,OAAO,IAAI,CAAC;aACf;SACJ;QAED,OAAO,KAAK,CAAC;IACjB,CAAC;IAED,WAAW;QAEP,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;IAC/B,CAAC;IAED,YAAY;QAER,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;IAChC,CAAC;IAED,OAAO;QAEH,IAAI,IAAI,GAAQ,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YACxB,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,MAAM,EAAE,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC;SACzC,CAAC,CAAC,CAAC,IAAI,CAAC;QAET,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,EAAE;YAC3F,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;YAClB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;SAC3B;QAED,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1B,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;YAClB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;gBAClC,MAAM,QAAQ,GAAQ;oBAClB,EAAE,EAAE,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE;oBACvC,GAAG,EAAE,IAAI,CAAC,WAAW,CAAC,GAAG;iBAC5B,CAAC;gBACF,IAAI,IAAI,CAAC,WAAW,IAAI,CAAC,EAAE;oBACvB,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC;iBACxC;gBACD,IAAI,IAAI,CAAC,gBAAgB,IAAI,CAAC,EAAE;oBAC5B,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC;iBAC7C;gBACD,OAAO,QAAQ,CAAC;YACpB,CAAC,CAAC,CAAC;SACN;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,OAAO,CAAC,IAAS,EAAE,YAAmC;QAElD,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;YAC1B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;SAC3B;QAED,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;YAC1B,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;gBACtB,MAAM,MAAM,GAAG,YAAY,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBACrC,MAAM,QAAQ,GAAG,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBACtC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC1D,CAAC,CAAC,CAAC;SACN;IACL,CAAC;IAED;;OAEG;IACH,QAAQ;QAEJ,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAC3B,MAAM,QAAQ,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAChF,OAAO,GAAG,IAAI,CAAC,IAAI,KAAK,QAAQ,GAAG;IACvC,CAAC;IAED;;;OAGG;IACO,aAAa,CAAC,KAAU;QAE9B,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAE3B,IAAI,MAAM,CAAC,IAAI,EAAE;YACb,MAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAC5B,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;SACjC;QACD,IAAI,MAAM,CAAC,OAAO,EAAE;YAChB,MAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAC5B,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;SAC3D;QACD,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,EAAE;YACxB,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;YACzD,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;YACzD,OAAO,KAAK,CAAC;SAChB;QAED,OAAO,KAAK,CAAC;IACjB,CAAC;IAES,WAAW;QAEjB,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;QAClC,OAAO,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,KAAK,EAAS,CAAC,CAAC,CAAC,MAAM,CAAC;IAClE,CAAC;CACJ;AAxkBD,2BAwkBC;;;;;;;;;;;;;;ACpnBD;;;;;GAKG;;AAGH,4GAA4D;AAE5D,mGAAkF;AAkClF;;;;;;;GAOG;AACH,MAAqB,aAAc,SAAQ,mBAAS;IAKhD,YAAY,QAAmB;QAE3B,KAAK,EAAE,CAAC;QACR,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAE1B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;IACzB,CAAC;IAED,OAAO;QAEH,IAAI,CAAC,mBAAmB,EAAE,CAAC;IAC/B,CAAC;IAED,YAAY;QAER,OAAO,IAAI,KAAK,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC;IACtC,CAAC;IAED,aAAa;QAET,OAAO,IAAI,KAAK,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;IACvC,CAAC;IAED;;;;OAIG;IACH,6BAA6B,CAAI,SAAY,EAAE,KAAc;QAEzD,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE;YACtC,MAAM,EAAE,GAAG,KAAK,KAAK,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC;YACvD,IAAI,CAAC,0BAA0B,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;QAC7D,CAAC,CAAC,CAAC;QAEH,OAAO,IAAyC,CAAC;IACrD,CAAC;IAED,0BAA0B,CAAC,QAA2B,EAAE,GAAY,EAAE,KAAc;QAEhF,MAAM,QAAQ,GAAG,IAAI,kBAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC;QAC9D,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;IAC5C,CAAC;IAED;;;;OAIG;IACH,WAAW,CAAC,GAAW;QAEnB,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;QAC3B,IAAI,CAAC,QAAQ,EAAE;YACX,MAAM,IAAI,KAAK,CAAC,+BAA+B,GAAG,GAAG,CAAC,CAAC;SAC1D;QAED,OAAO,QAAQ,CAAC;IACpB,CAAC;IAED,OAAO,CAAC,iBAA0B,KAAK;QAEnC,MAAM,IAAI,GAAa,EAAE,CAAC;QAC1B,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;YAC/B,IAAI,cAAc,IAAI,QAAQ,CAAC,IAAI,KAAK,QAAQ,EAAE;gBAC9C,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC;aAC1B;QACL,CAAC,CAAC,CAAC;QACH,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,SAAS,CAAC,iBAA0B,KAAK;QAErC,MAAM,MAAM,GAAU,EAAE,CAAC;QACzB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;YAC3B,IAAI,cAAc,IAAI,QAAQ,CAAC,IAAI,KAAK,QAAQ,EAAE;gBAC9C,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC;aAC9B;QACL,CAAC,CAAC,CAAC;QACH,OAAO,MAAM,CAAC;IAClB,CAAC;IAED,WAAW,CAAC,iBAA0B,KAAK;QAEvC,MAAM,MAAM,GAAU,EAAE,CAAC;QACzB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;YAC3B,IAAI,cAAc,IAAI,QAAQ,CAAC,IAAI,KAAK,QAAQ,EAAE;gBAC9C,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;aACrC;QACL,CAAC,CAAC,CAAC;QACH,OAAO,MAAM,CAAC;IAClB,CAAC;IAED,SAAS,CAAC,MAAuB;QAE7B,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CACvB,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CACnD,CAAC;IACN,CAAC;IAED;;;OAGG;IACH,UAAU,CAAC,MAAuB;QAE9B,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CACvB,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CACtD,CAAC;IACN,CAAC;IAED,mBAAmB;QAEf,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC;IAC3D,CAAC;IAED,OAAO;QAEH,IAAI,IAAI,GAAQ,IAAI,CAAC;QAErB,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;YAC/B,MAAM,QAAQ,GAAG,QAAQ,CAAC,OAAO,EAAE,CAAC;YACpC,IAAI,QAAQ,EAAE;gBACV,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;gBAClB,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC;aACjC;QACL,CAAC,CAAC,CAAC;QAEH,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,OAAO,CAAC,IAAS;QAEb,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;YAC5B,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;YAC3B,IAAI,QAAQ,CAAC,MAAM,EAAE;gBACjB,MAAM,QAAQ,GAAG,IAAI,kBAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;gBACpE,QAAQ,CAAC,MAAM,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;aAC9B;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED,YAAY,CAAC,IAAS,EAAE,YAAmC;QAEvD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;YAC5B,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,YAAY,CAAC,CAAC;QAC/C,CAAC,CAAC,CAAC;IACP,CAAC;IAED,YAAY,CAAC,QAAkB,EAAE,GAAY,EAAE,KAAc;QAEzD,IAAI,QAAQ,CAAC,KAAK,EAAE;YAChB,QAAQ,CAAC,MAAM,EAAE,CAAC;SACrB;QAED,IAAI,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE;YAClB,MAAM,IAAI,KAAK,CAAC,QAAQ,GAAG,2BAA2B,CAAC,CAAC;SAC3D;QAEA,QAAgB,CAAC,MAAM,GAAG,IAAI,CAAC;QAC/B,QAAgB,CAAC,IAAI,GAAG,GAAG,CAAC;QAE7B,IAAI,KAAK,KAAK,SAAS,EAAE;YACrB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAClC;aACI;YACD,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC;SAC9C;QAED,IAAI,GAAG,EAAE;YACL,IAAI,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC;SACxB;QAED,IAAI,CAAC,IAAI,CAA8B;YACnC,IAAI,EAAE,UAAU,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,QAAQ;SACvD,CAAC,CAAC;IACP,CAAC;IAED;;;OAGG;IACH,eAAe,CAAC,QAAkB;QAE9B,IAAI,QAAQ,CAAC,KAAK,KAAK,IAAI,EAAE;YAEzB,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,QAAQ,EAAE;gBACjC,MAAM,IAAI,KAAK,CAAC,gCAAgC,QAAQ,CAAC,GAAG,EAAE,CAAC,CAAC;aACnE;YAED,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;YAE5D,IAAI,QAAQ,CAAC,GAAG,EAAE;gBACd,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;aAC7B;YAEA,QAAgB,CAAC,MAAM,GAAG,IAAI,CAAC;YAC/B,QAAgB,CAAC,IAAI,GAAG,EAAE,CAAC;YAE5B,IAAI,CAAC,IAAI,CAA8B;gBACnC,IAAI,EAAE,UAAU,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ;aACvD,CAAC,CAAC;SACN;IACL,CAAC;CACJ;AAjND,gCAiNC;;;;;;;;;;;;;;ACrQD;;;;;GAKG;;AAGH,gGAAgG;AAMhG,MAAqB,YAAY;IAW7B,YAAY,MAAgB,EAAE,WAAqB,EAAE,WAAoB,EAAE,gBAAyB;QAEhG,IAAI,MAAM,CAAC,YAAY,KAAK,CAAC,IAAI,WAAW,IAAI,CAAC,EAAE;YAC/C,MAAM,IAAI,KAAK,CAAC,kDAAkD,CAAC,CAAC;SACvE;QACD,IAAI,WAAW,CAAC,YAAY,KAAK,CAAC,IAAI,gBAAgB,IAAI,CAAC,EAAE;YACzD,MAAM,IAAI,KAAK,CAAC,uDAAuD,CAAC,CAAC;SAC5E;QAED,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAE/B,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;QAEzC,MAAM,QAAQ,GAAG,WAAW,KAAK,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC;QAC9D,MAAM,QAAQ,GAAG,gBAAgB,KAAK,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC;QACxE,MAAM,OAAO,GAAG,MAAM,CAAC,YAAY,GAAG,CAAC,IAAI,QAAQ,GAAG,CAAC,IAAI,QAAQ,GAAG,CAAC,CAAC;QAExE,IAAI,CAAC,SAAS,GAAG,+BAAqB,CAAC,MAAM,CAAC,IAAI,EAAE,WAAW,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAC/E,MAAM,aAAa,GAAG,gCAAsB,CAAC,QAAQ,EAAE,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;QACjF,IAAI,CAAC,MAAM,GAAG,8BAAoB,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,WAAW,CAAC,OAAO,EAAE,EAAE,aAAa,CAAC,CAAC;IAC/F,CAAC;IAED,IAAI;QAEA,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;IACtG,CAAC;CACJ;AAvCD,+BAuCC;;;;;;;;;;;;;;ACrDD;;;;;GAKG;;AAEH,4GAA2C;AAC3C,2HAAqD;AACrD,wHAAmD;AAEnD,sGAA2E;AAC3E,uFAAuD;AACvD,0FAA4B;AAM5B,MAAqB,MAAO,SAAQ,mBAAS;IASzC,YAAY,QAAwB;QAEhC,KAAK,CAAC,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC,CAAC;QANzB,UAAK,GAAG,IAAI,wBAAc,CAAO,cAAI,CAAC,CAAC;QACvC,eAAU,GAAG,IAAI,wBAAc,CAAY,mBAAS,CAAC,CAAC;QAO3D,IAAI,CAAC,QAAQ,GAAG,QAAQ,IAAI,IAAI,uBAAa,EAAE,CAAC;QAChD,IAAI,CAAC,KAAK,GAAG,IAAI,eAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IACvC,CAAC;IAED,YAAY,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAC1G,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IAC1D,CAAC;IAED,aAAa,CAAkC,gBAAsC;QACjF,OAAO,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IACtD,CAAC;IAED,aAAa,CAAC,gBAAkC;QAC5C,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IACjD,CAAC;IAED,gBAAgB,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAC9G,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IAChE,CAAC;IAED,iBAAiB,CAAkC,gBAAsC;QACrF,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IAC5D,CAAC;IAED,iBAAiB,CAAC,gBAAkC;QAChD,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IACvD,CAAC;IAED,OAAO,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACjF,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IAChD,CAAC;IAED,QAAQ,CAAwB,WAA4B;QACxD,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IAC5C,CAAC;IAED,QAAQ,CAAC,WAAwB;QAC7B,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IACvC,CAAC;IAED,WAAW,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACrF,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IACtD,CAAC;IAED,YAAY,CAAwB,WAA4B;QAC5D,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IAClD,CAAC;IAED,YAAY,CAAC,WAAwB;QACjC,OAAO,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IAC7C,CAAC;IAED,cAAc,CAAwB,IAAY,EAAE,WAA4B;QAE5E,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;QAE/C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC1C,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,IAAI,EAAE;gBACxB,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC;aACnB;SACJ;QAED,OAAO,SAAS,CAAC;IACrB,CAAC;IAED;;OAEG;IACH,OAAO;QAEH,OAAO,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;IAChC,CAAC;IAED;;;OAGG;IACH,OAAO,CAAC,IAAI;QAER,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAED,QAAQ,CAAC,UAAmB,KAAK;QAE7B,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;QACpC,MAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;QAE9C,MAAM,IAAI,GAAG,YAAY,KAAK,CAAC,MAAM,WAAW,aAAa,cAAc,CAAC;QAE5E,IAAI,OAAO,EAAE;YACT,OAAO,IAAI,GAAG,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC1E;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,QAAQ,CAAC,IAAU;QAEf,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACzB,CAAC;IAED,WAAW,CAAC,IAAU;QAElB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IAC5B,CAAC;IAED,aAAa,CAAC,SAAoB;QAE9B,IAAI,SAAS,CAAC,iBAAiB,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;YAC/D,MAAM,IAAI,KAAK,CAAC,gCAAgC,SAAS,CAAC,SAAS,sBAAsB,CAAC,CAAC;SAC9F;QAED,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;IACnC,CAAC;IAED,gBAAgB,CAAC,SAAoB;QAEjC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IACtC,CAAC;CACJ;AApID,yBAoIC;;;;;;;;;;;;;;ACvJD;;;;;GAKG;;AAGH,4GAA2C;AAMlC,oBANF,mBAAS,CAME;AAJlB,uGAAgD;AAI5B,gBAJA,iBAAK,CAIA;AAGzB,MAAqB,WAAwC,SAAQ,mBAAS;IAO1E,aAAa,CAAC,SAAoB;QAE9B,OAAO,EAAE,CAAC;IACd,CAAC;;AARe,gBAAI,GAAW,aAAa,CAAC;AAC7B,6BAAiB,GAAY,IAAI,CAAC;AAHtD,8BAWC;;;;;;;;;;;;;;AC5BD;;;;;GAKG;;AAEH,uGAA2E;AAC3E,2FAA6B;AAK7B,gFAAgF;AAEhF,MAAqB,MAAO,SAAQ,mBAAS;IAA7C;;QAIc,gBAAW,GAAU,IAAI,CAAC;QAC1B,eAAU,GAAe,IAAI,CAAC;IA+E5C,CAAC;IA7EG,IAAI,UAAU;QACV,OAAO,IAAI,CAAC,WAAW,CAAC;IAC5B,CAAC;IAED,IAAI,SAAS;QACT,OAAO,IAAI,CAAC,UAAU,CAAC;IAC3B,CAAC;IACD,IAAI,SAAS,CAAC,IAAgB;QAC1B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;IAC3B,CAAC;IAED,iBAAiB,CAAkC,gBAAsC,EAAE,UAAmB,KAAK;QAC/G,OAAO,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IACtE,CAAC;IAED,kBAAkB,CAAkC,gBAAsC;QACtF,OAAO,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IAClE,CAAC;IAED,iBAAiB,CAAC,gBAAkC;QAChD,OAAO,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IAC7D,CAAC;IAED,YAAY,CAAwB,WAA4B,EAAE,UAAmB,KAAK;QACtF,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;IAC5D,CAAC;IAED,aAAa,CAAwB,WAA4B;QAC7D,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IACxD,CAAC;IAED,YAAY,CAAC,WAAwB;QACjC,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IACnD,CAAC;IAED,MAAM;QAEF,IAAI,CAAC,WAAW,GAAG,IAAI,eAAK,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;IACpD,CAAC;IAED,MAAM,CAAC,OAAuB;QAE1B,oCAAoC;QACpC,OAAO,KAAK,CAAC;IACjB,CAAC;IAED,IAAI,CAAC,OAAuB;QAExB,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAC1C,CAAC;IAED,QAAQ,CAAC,OAAuB;QAE5B,OAAO,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;IAC9C,CAAC;IAED,OAAO;QAEH,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;QACzB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;QACxB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QAEvB,KAAK,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;IAED,OAAO,CAAC,IAAS;QAEb,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACpB,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACzC,CAAC;IAED,OAAO;QAEH,MAAM,IAAI,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC;QAC7B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;QACxC,OAAO,IAAI,CAAC;IAChB,CAAC;;AAjFe,WAAI,GAAW,QAAQ,CAAC;AAF5C,yBAoFC;;;;;;;;;;;;;;ACnGD;;;;;GAKG;;AAIH,uGAAkE;AAClE,wFAA2B;AAIlB,eAJF,cAAI,CAIE;AAEb,MAAM,kBAAkB,GAAG,CACvB,SAAqB,EAAE,eAAoC,EAAE,SAAkB,EAAY,EAAE;IAE7F,IAAI,SAAS,CAAC;IAEd,MAAM,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAC;IACpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;QAC7C,SAAS,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;QAExD,IAAI,SAAS,EAAE;YACX,OAAO,SAAS,CAAC;SACpB;KACJ;IAED,IAAI,SAAS,EAAE;QACX,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC7C,SAAS,GAAG,kBAAkB,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;YACnE,IAAI,SAAS,EAAE;gBACX,OAAO,SAAS,CAAC;aACpB;SACJ;KACJ;IAED,OAAO,IAAI,CAAC;AAChB,CAAC,CAAC;AAEF,MAAM,mBAAmB,GAAG,CACxB,SAAqB,EAAE,eAAoC,EAAE,SAAkB,EAAO,EAAE;IAExF,IAAI,UAAU,GAAG,EAAE,CAAC;IAEpB,MAAM,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAC;IACpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;QAC7C,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC,CAAC;KACpF;IAED,IAAI,SAAS,EAAE;QACX,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC7C,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC,CAAC;SAC3F;KACJ;IAED,OAAO,UAAU,CAAC;AACtB,CAAC,CAAC;AAgBF,MAAM,OAAO,GAAG;IACZ,OAAO,EAAE,iBAAK,CAAC,OAAO,CAAC,mBAAmB,CAAC;CAC9C,CAAC;AAEF;;;;;GAKG;AACH,MAAqB,UAAW,SAAQ,mBAAS;IAAjD;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QAEpB,YAAO,GAAe,IAAI,CAAC;QAC3B,cAAS,GAAiB,EAAE,CAAC;IAiN3C,CAAC;IA/MG;;;OAGG;IACH,IAAI,MAAM;QAEN,OAAO,IAAI,CAAC,OAAO,CAAC;IACxB,CAAC;IAED;;;OAGG;IACH,IAAI,QAAQ;QAER,OAAO,IAAI,CAAC,SAAS,IAAI,EAAE,CAAC;IAChC,CAAC;IAED,OAAO;QAEH,8BAA8B;QAC9B,IAAI,IAAI,CAAC,OAAO,EAAE;YACd,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;SAClC;QAED,sBAAsB;QACtB,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;QAE9D,KAAK,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;IAED;;;OAGG;IACH,OAAO,CAAsB,eAAoC;QAE7D,IAAI,IAAI,GAAe,IAAI,CAAC;QAC5B,OAAM,IAAI,CAAC,OAAO,EAAE;YAChB,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC;SACvB;QAED,OAAO,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;IACnE,CAAC;IAED;;;;;OAKG;IACH,SAAS,CAAsB,eAAoC,EAAE,SAAkB;QAEnF,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;QAE1B,IAAI,CAAC,MAAM,EAAE;YACT,OAAO,IAAI,CAAC;SACf;QAED,IAAI,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;QAC5D,IAAI,SAAS,EAAE;YACX,OAAO,SAAS,CAAC;SACpB;QAED,IAAI,SAAS,EAAE;YACX,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC;YAExB,8CAA8C;YAC9C,IAAI,CAAC,MAAM,EAAE;gBACT,MAAM,oBAAoB,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;gBAC/C,MAAM,GAAG,oBAAoB,CAAC,CAAC,CAAC,oBAAoB,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC;aACzE;YAED,OAAM,MAAM,EAAE;gBACV,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;gBACxD,IAAI,SAAS,EAAE;oBACX,OAAO,SAAS,CAAC;iBACpB;aACJ;SACJ;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED;;;;OAIG;IACH,QAAQ,CAAsB,eAAoC,EAAE,SAAkB;QAElF,OAAO,kBAAkB,CAAC,IAAI,EAAE,eAAe,EAAE,SAAS,CAAC,CAAC;IAChE,CAAC;IAED;;;;OAIG;IACH,WAAW,CAAsB,eAAoC,EAAE,SAAkB;QAErF,OAAO,mBAAmB,CAAC,IAAI,EAAE,eAAe,EAAE,SAAS,CAAC,CAAC;IACjE,CAAC;IAED;;;;OAIG;IACH,WAAW,CAAsB,eAAoC,EAAE,SAAkB;QAErF,OAAO,CAAC,CAAC,kBAAkB,CAAC,IAAI,EAAE,eAAe,EAAE,SAAS,CAAC,CAAC;IAClE,CAAC;IAED;;;;OAIG;IACH,QAAQ,CAAC,SAAqB;QAE1B,IAAI,SAAS,CAAC,OAAO,EAAE;YACnB,MAAM,IAAI,KAAK,CAAC,oDAAoD,CAAC,CAAC;SACzE;QACD,IAAI,SAAS,KAAK,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE;YAC/B,MAAM,IAAI,KAAK,CAAC,gDAAgD,CAAC,CAAC;SACrE;QAED,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC;QACzB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAE/B,MAAM,KAAK,GAAoB;YAC3B,IAAI,EAAE,WAAW,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS;SAC9E,CAAC;QAEF,OAAO,SAAS,EAAE;YACd,SAAS,CAAC,IAAI,CAAkB,KAAK,CAAC,CAAC;YACvC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAkB,KAAK,CAAC,CAAC;YAC5C,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC;SACjC;QAED,IAAI,CAAC,KAAK,CAAC,IAAI,CAAkB,KAAK,CAAC,CAAC;QACxC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAkB,KAAK,CAAC,CAAC;IAC7C,CAAC;IAED;;;;OAIG;IACH,WAAW,CAAC,SAAqB;QAE7B,IAAI,SAAS,CAAC,OAAO,KAAK,IAAI,EAAE;YAC5B,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC;SACpD;QAED,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QAChD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QAChC,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC;QAEzB,MAAM,KAAK,GAAoB;YAC3B,IAAI,EAAE,WAAW,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,SAAS;SAC9E,CAAC;QAEF,OAAO,SAAS,EAAE;YACd,SAAS,CAAC,IAAI,CAAkB,KAAK,CAAC,CAAC;YACvC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAkB,KAAK,CAAC,CAAC;YAC5C,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC;SACjC;QAED,IAAI,CAAC,KAAK,CAAC,IAAI,CAAkB,KAAK,CAAC,CAAC;QACxC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAkB,KAAK,CAAC,CAAC;IAC7C,CAAC;IAED,OAAO;QAEH,MAAM,IAAI,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC;QAE7B,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;YAC3B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;SACzD;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,iBAAiB,CAAC,IAAS;QAEvB,KAAK,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;QAE9B,MAAM,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,aAAa,EAAE,CAAC;QAEpD,IAAI,IAAI,CAAC,QAAQ,EAAE;YACf,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;gBAC5B,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAe,CAAC;gBAC1C,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACzB,CAAC,CAAC;SACL;IACL,CAAC;IAED;;;OAGG;IACH,QAAQ;QAEJ,OAAO,KAAK,CAAC,QAAQ,EAAE,GAAG,gBAAgB,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;IACrE,CAAC;CACJ;AAtND,6BAsNC;;;;;;;;;;;;;;AC3SD;;;;;GAKG;;AAEH,mGAAkE;AAElE,mHAAyC;AAEzC,uGAAqC;AAErC,gFAAgF;AAEhF,MAAM,YAAY,GAAG,EAAE,MAAM,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC;AAE9D,IAAY,SAAgC;AAA5C,WAAY,SAAS;IAAG,iDAAQ;IAAE,iDAAQ;AAAC,CAAC,EAAhC,SAAS,GAAT,iBAAS,KAAT,iBAAS,QAAuB;AAC5C,IAAY,kBAAmD;AAA/D,WAAY,kBAAkB;IAAG,iEAAO;IAAE,mEAAQ;IAAE,qEAAS;AAAC,CAAC,EAAnD,kBAAkB,GAAlB,0BAAkB,KAAlB,0BAAkB,QAAiC;AAE/D,MAAM,GAAG,GAAG;IACR,GAAG,EAAE,qBAAK,CAAC,OAAO,CAAC,aAAa,CAAC;IACjC,KAAK,EAAE,qBAAK,CAAC,KAAK,CAAC,eAAe,CAAC;IACnC,KAAK,EAAE,qBAAK,CAAC,KAAK,CAAC,eAAe,CAAC;IACnC,IAAI,EAAE,qBAAK,CAAC,KAAK,CAAC,cAAc,CAAC;IACjC,GAAG,EAAE,qBAAK,CAAC,MAAM,CAAC,WAAW,CAAC;IAC9B,GAAG,EAAE,qBAAK,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC;IACjC,KAAK,EAAE,qBAAK,CAAC,IAAI,CAAC,qBAAqB,EAAE,qBAAY,CAAC;IACtD,IAAI,EAAE,qBAAK,CAAC,IAAI,CAAC,oBAAoB,EAAE,kBAAkB,CAAC;IAC1D,QAAQ,EAAE,qBAAK,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC,CAAC;IAC1C,IAAI,EAAE,qBAAK,CAAC,IAAI,CAAC,WAAW,EAAE,SAAS,CAAC;IACxC,MAAM,EAAE,qBAAK,CAAC,MAAM,CAAC,aAAa,EAAE,YAAY,CAAC;IACjD,WAAW,EAAE,qBAAK,CAAC,OAAO,CAAC,kBAAkB,CAAC;CACjD,CAAC;AAEF,MAAM,IAAI,GAAG;IACT,KAAK,EAAE,qBAAK,CAAC,MAAM,CAAC,OAAO,CAAC;IAC5B,UAAU,EAAE,qBAAK,CAAC,OAAO,CAAC,YAAY,CAAC;IACvC,MAAM,EAAE,qBAAK,CAAC,KAAK,CAAC,QAAQ,CAAC;CAChC,CAAC;AAEF,MAAqB,WAAY,SAAQ,mBAAS;IAAlD;;QAII,QAAG,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;QAC1B,SAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAEnB,aAAQ,GAAW,CAAC,CAAC;QACrB,UAAK,GAAG,CAAC,CAAC;QACV,mBAAc,GAA0B,IAAI,CAAC;QAC7C,eAAU,GAAG,KAAK,CAAC;QACnB,eAAU,GAAG,KAAK,CAAC;QACnB,gBAAW,GAAG,KAAK,CAAC;IA+FlC,CAAC;IA7FG,MAAM,CAAC,KAAoB;QAEvB,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC;QAE3B,IAAI,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE;YACnB,IAAI,CAAC,cAAc,GAAG,0BAAiB,CAAC,GAAG,CAAC,KAAK,CAAC,iBAAiB,EAAE,CAAC,CAAC;SAC1E;QACD,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE;YAClB,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC,IAAI,CAAC,KAAK,KAAK,kBAAkB,CAAC,QAAQ,CAAC;YACjE,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC,IAAI,CAAC,KAAK,KAAK,kBAAkB,CAAC,SAAS,CAAC;SACtE;QACD,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE;YAClB,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC,IAAI,CAAC,KAAK,KAAK,SAAS,CAAC,QAAQ,CAAC;SAC3D;QAED,IAAI,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE;YACnB,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;YAClB,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;YACvB,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;SAC/B;aACI,IAAI,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE;YACxB,IAAI,GAAG,CAAC,GAAG,CAAC,KAAK,EAAE;gBACf,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;aAC3B;iBACI,IAAI,GAAG,CAAC,WAAW,CAAC,KAAK,IAAI,CAAC,IAAI,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,GAAG,CAAC,WAAW,CAAC,KAAK,EAAE;gBAClF,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;aAC1B;SACJ;aACI,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE;YACvB,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;YAClB,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACxB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACrE,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;SAC/B;QAED,IAAI,GAAG,CAAC,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,GAAG,CAAC,KAAK,EAAE;YAClC,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;YACf,IAAI,GAAG,CAAC,WAAW,CAAC,KAAK,GAAG,CAAC,IAAI,IAAI,CAAC,UAAU,CAAC,KAAK,IAAI,GAAG,CAAC,WAAW,CAAC,KAAK,EAAE;gBAC7E,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;aAC/B;SACJ;QAED,OAAO,KAAK,CAAC;IACjB,CAAC;IAED,IAAI,CAAC,KAAoB;QAErB,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC;QAE3B,IAAI,GAAG,CAAC,GAAG,CAAC,KAAK,EAAE;YACf,MAAM,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC;YACpC,IAAI,QAAQ,KAAK,CAAC,EAAE;gBAChB,OAAO,KAAK,CAAC;aAChB;YAED,yBAAyB;YACzB,IAAI,CAAC,CAAC;YACN,IAAI,IAAI,CAAC,UAAU,EAAE;gBACjB,CAAC,GAAG,KAAK,CAAC,cAAc,GAAG,QAAQ,CAAC;aACvC;iBACI;gBACD,CAAC,GAAG,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC,YAAY,GAAG,QAAQ,CAAC;aACrE;YAED,eAAe;YACf,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;YAEjC,cAAc;YACd,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE;gBAChB,MAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC;gBAC7C,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;gBACrC,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;gBAClB,IAAI,GAAG,CAAC,WAAW,CAAC,KAAK,GAAG,CAAC,IAAI,UAAU,IAAI,GAAG,CAAC,WAAW,CAAC,KAAK,EAAE;oBAClE,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;oBACxB,CAAC,GAAG,CAAC,CAAC;iBACT;aACJ;YACD,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;YAEf,SAAS;YACT,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC;YACzB,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAEtB,0BAA0B;YAC1B,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACjF,MAAM,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,GAAG,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YAEnF,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YACvB,OAAO,IAAI,CAAC;SACf;QAED,OAAO,KAAK,CAAC;IACjB,CAAC;;AAxGe,gBAAI,GAAW,aAAa,CAAC;AAFjD,8BA2GC;;;;;;;;;;;;;;ACpJD;;;;;GAKG;;AAEH,uGAAsE;AAiBtE,MAAqB,MAAO,SAAQ,mBAAS;IAYzC,YAAY,EAAU;QAElB,KAAK,CAAC,EAAE,CAAC,CAAC;QACV,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QAEvB,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEzD,IAAI,CAAC,OAAO,GAAG;YACX,IAAI,EAAE,IAAI,IAAI,EAAE;YAChB,cAAc,EAAE,CAAC;YACjB,YAAY,EAAE,CAAC;YACf,WAAW,EAAE,CAAC;SACjB,CAAC;QAEF,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,CAAC;QAC1C,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;QAC5C,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC;QACtB,IAAI,CAAC,WAAW,GAAG,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,CAAC;IAChE,CAAC;IAED,KAAK;QAED,IAAI,IAAI,CAAC,YAAY,KAAK,CAAC,EAAE;YAEzB,IAAI,IAAI,CAAC,eAAe,GAAG,CAAC,EAAE;gBAC1B,IAAI,CAAC,eAAe,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC;gBACpE,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC;aAC5B;YAED,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,qBAAqB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;SAC3E;IACL,CAAC;IAED,IAAI;QAEA,IAAI,IAAI,CAAC,YAAY,KAAK,CAAC,EAAE;YACzB,IAAI,IAAI,CAAC,eAAe,KAAK,CAAC,EAAE;gBAC5B,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,CAAC;aAC7C;YACD,MAAM,CAAC,oBAAoB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAC/C,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC;SACzB;IACL,CAAC;IAED,UAAU;IACV,IAAI;IACJ,oCAAoC;IACpC,iCAAiC;IACjC,kCAAkC;IAClC,gCAAgC;IAChC,+BAA+B;IAC/B,EAAE;IACF,iDAAiD;IACjD,mDAAmD;IACnD,IAAI;IAEJ,KAAK,CAAC,YAAoB;QAEtB,MAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAE7B,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;QACnC,MAAM,OAAO,GAAG,YAAY,GAAG,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC;QAC5D,OAAO,CAAC,YAAY,GAAG,OAAO,GAAG,OAAO,CAAC,cAAc,CAAC;QACxD,OAAO,CAAC,cAAc,GAAG,OAAO,CAAC;QACjC,OAAO,CAAC,WAAW,EAAE,CAAC;QAEtB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QACrC,IAAI,CAAC,IAAI,CAAc,IAAI,CAAC,WAAW,CAAC,CAAC;QACzC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAC7C,CAAC;IAES,gBAAgB;QAEtB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;QACvB,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,qBAAqB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;IAC5E,CAAC;;AArFe,WAAI,GAAW,QAAQ,CAAC;AACxB,wBAAiB,GAAY,IAAI,CAAC;AAHtD,yBAwFC;;;;;;;;;;;;;;AChHD;;;;;GAKG;;AAIH,2HAAqD;AAErD,mHAAyC;AAEzC,uGAA4E;AAC5E,wFAAwD;AAGxD,wGAA8B;AAC9B,uHAAqD;AAcrD,MAAM,IAAI,GAAG;IACT,YAAY,EAAE,qBAAK,CAAC,OAAO,CAAC,iBAAiB,CAAC;IAC9C,iBAAiB,EAAE,qBAAK,CAAC,OAAO,CAAC,sBAAsB,CAAC;CAC3D,CAAC;AAEF,MAAqB,UAAW,SAAQ,qBAAuB;IA4B3D,YAAY,EAAU;QAElB,KAAK,CAAC,EAAE,CAAC,CAAC;QA1Bd,SAAI,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAE7B,gBAAW,GAAG,KAAK,CAAC;QACpB,oBAAe,GAAG,IAAI,CAAC;QAEd,kBAAa,GAAG,IAAI,wBAAc,CAAC,cAAI,CAAC,CAAC;QACzC,uBAAkB,GAAG,IAAI,wBAAc,CAAC,mBAAS,CAAC,CAAC;QAgBpD,iBAAY,GAAU,IAAI,CAAC;QAK/B,IAAI,CAAC,SAAS,CAAC,aAAa,EAAE,kBAAkB,EAAE,cAAc,EAAE,QAAQ,CAAC,CAAC;QAE5E,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,cAAI,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QACrE,IAAI,CAAC,kBAAkB,CAAC,EAAE,CAAC,mBAAS,EAAE,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;IACxF,CAAC;IAvBD,eAAe,CAAwB,WAA4B;QAC/D,OAAO,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;IACrD,CAAC;IACD,gBAAgB,CAAwB,WAA4B;QAChE,OAAO,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;IACpD,CAAC;IAED,oBAAoB,CAAkC,gBAAsC;QACxF,OAAO,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;IAC/D,CAAC;IACD,qBAAqB,CAAkC,gBAAsC;QACzF,OAAO,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;IAC9D,CAAC;IAaD,IAAI,WAAW;QACX,OAAO,IAAI,CAAC,YAAY,CAAC;IAC7B,CAAC;IACD,IAAI,WAAW,CAAC,KAAY;QACxB,IAAI,KAAK,KAAK,IAAI,CAAC,WAAW,EAAE;YAC5B,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,MAAM,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC;YACnC,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;YAC1B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC1B,IAAI,CAAC,IAAI,CAAoB,EAAE,IAAI,EAAE,cAAc,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC;SACjF;IACL,CAAC;IAED,cAAc;QAEV,OAAO,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;IACzD,CAAC;IAED,mBAAmB;QAEf,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,EAAE;YACrD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,CAAC;SACrD;IACL,CAAC;IAED,aAAa;QAET,OAAO,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,gBAAM,CAAC,CAAC;IAC/C,CAAC;IAED,kBAAkB;QAEd,MAAM,cAAc,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,gBAAM,EAAE,IAAI,CAAC,CAAC;QACjE,IAAI,cAAc,EAAE;YAChB,IAAI,CAAC,WAAW,GAAG,cAAc,CAAC,UAAU,CAAC;SAChD;IACL,CAAC;IAED,MAAM;QAEF,KAAK,CAAC,MAAM,EAAE,CAAC;QAEf,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;QAEtC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,cAAI,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QACpD,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,CAAC,mBAAS,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;IACvE,CAAC;IAED,OAAO;QAEH,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,cAAI,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QACrD,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,mBAAS,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;QAEpE,KAAK,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;IAED,aAAa,CAAC,SAAoB;QAE9B,OAAO;YACH,UAAU,EAAE,SAAS,CAAC,QAAQ,CAAC;gBAC3B,IAAI,EAAE,aAAa,EAAE,EAAE,EAAE,IAAI,CAAC,UAAU,EAAE,MAAM,EAAE,IAAI;aACzD,CAAC;YACF,eAAe,EAAE,SAAS,CAAC,QAAQ,CAAC;gBAChC,IAAI,EAAE,kBAAkB,EAAE,EAAE,EAAE,IAAI,CAAC,eAAe,EAAE,MAAM,EAAE,IAAI;aACnE,CAAC;YACF,cAAc,EAAE,SAAS,CAAC,QAAQ,CAAC;gBAC/B,IAAI,EAAE,iBAAiB,EAAE,EAAE,EAAE,IAAI,CAAC,cAAc,EAAE,MAAM,EAAE,IAAI;aACjE,CAAC;SACL,CAAC;IACN,CAAC;IAED,6BAA6B,CAAC,IAAU;QAEpC,MAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;QAC9C,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC/C,IAAI,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,EAAE;gBACjD,OAAO,IAAI,CAAC;aACf;SACJ;QAED,OAAO,KAAK,CAAC;IACjB,CAAC;IAED,UAAU,CAAC,IAAW,EAAE,SAAkB,KAAK;QAE3C,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC;QAE9B,MAAM,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC;QACzC,MAAM,WAAW,GAAG,IAAI,CAAC,WAAW,IAAI,MAAM,CAAC;QAE/C,IAAI,IAAI,IAAI,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;YACtC,IAAI,WAAW,EAAE;gBACb,aAAa,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;aAC9B;SACJ;aACI;YACD,IAAI,IAAI,CAAC,eAAe,EAAE;gBACtB,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,CAAC;aACnC;YACD,IAAI,CAAC,WAAW,EAAE;gBACd,aAAa,CAAC,KAAK,EAAE,CAAC;aACzB;YACD,IAAI,IAAI,EAAE;gBACN,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;aAC3B;SACJ;QAED,IAAI,CAAC,WAAW,EAAE,CAAC;IACvB,CAAC;IAED,eAAe,CAAC,SAAqB,EAAE,SAAkB,KAAK;QAE1D,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC,KAAK,CAAC;QAEnC,MAAM,kBAAkB,GAAG,IAAI,CAAC,kBAAkB,CAAC;QACnD,MAAM,WAAW,GAAG,IAAI,CAAC,WAAW,IAAI,MAAM,CAAC;QAE/C,IAAI,SAAS,IAAI,kBAAkB,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;YACrD,IAAI,WAAW,EAAE;gBACb,kBAAkB,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;aACxC;SACJ;aACI;YACD,IAAI,IAAI,CAAC,eAAe,EAAE;gBACtB,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;aAC9B;YACD,IAAI,CAAC,WAAW,EAAE;gBACd,kBAAkB,CAAC,KAAK,EAAE,CAAC;aAC9B;YACD,IAAI,SAAS,EAAE;gBACX,kBAAkB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;aACrC;SACJ;QAED,IAAI,CAAC,WAAW,EAAE,CAAC;IACvB,CAAC;IAED,cAAc;QAEV,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;QAC3B,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,CAAC;QAEhC,IAAI,CAAC,WAAW,EAAE,CAAC;IACvB,CAAC;IAES,YAAY,CAAC,IAAU,EAAE,QAAiB;IAEpD,CAAC;IAES,iBAAiB,CAAC,SAAoB,EAAE,QAAiB;IAEnE,CAAC;IAES,aAAa,CAAC,KAAY;IAEpC,CAAC;IAES,YAAY,CAAC,KAAiB;QAEpC,IAAI,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE;YAC3D,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SAC3C;IACL,CAAC;IAES,iBAAiB,CAAC,KAAsB;QAE9C,IAAI,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE;YAChE,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;SAChD;IACL,CAAC;IAES,WAAW;QAEjB,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;QACvB,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QACtD,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC;IACpE,CAAC;;AAnNe,eAAI,GAAW,YAAY,CAAC;AAFhD,6BAsNC;;;;;;;;;;;;;;AC3PD;;;;;GAKG;;AAEH,uHAAwC;AAUpC,sBAVG,qBAAW,CAUH;AATf,wGAA8B;AAU1B,iBAVG,gBAAM,CAUH;AATV,oHAAsC;AAUlC,qBAVG,oBAAU,CAUH;AATd,uHAAwC;AAUpC,sBAVG,qBAAW,CAUH;AATf,wGAA8B;AAU1B,iBAVG,gBAAM,CAUH;AATV,oHAAsC;AAUlC,qBAVG,oBAAU,CAUH;AAGD,sBAAc,GAAG;IAC1B,gBAAM;IACN,oBAAU;IACV,qBAAW;IACX,gBAAM;IACN,oBAAU;CACb,CAAC;;;;;;;;;;;;;;AC/BF;;;;;GAKG;;AAIH,MAAM,SAAS,GAAG;IACd,UAAS,MAAM;QACX,OAAO,MAAM,CAAC;IAClB,CAAC;IACD,UAAS,MAAM,EAAE,MAAM;QACnB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC3C,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;SACzB;QACD,OAAO,MAAM,CAAC;IAClB,CAAC;CACJ,CAAC;AAEF,MAAM,UAAU,GAAG;IACf,UAAS,MAAM;QACX,OAAO,CAAC,CAAC,MAAM,CAAC;IACpB,CAAC;IACD,UAAS,MAAM,EAAE,MAAM;QACnB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC3C,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;SAC3B;QACD,OAAO,MAAM,CAAC;IAClB,CAAC;CACJ,CAAC;AAEF,MAAM,SAAS,GAAG;IACd,UAAS,MAAM;QACX,OAAO,MAAM,CAAC,MAAM,CAAC,CAAC;IAC1B,CAAC;IACD,UAAS,MAAM,EAAE,MAAM;QACnB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC3C,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;SACjC;QACD,OAAO,MAAM,CAAC;IAClB,CAAC;CACJ,CAAC;AAEF,MAAM,WAAW,GAAG;IAChB,UAAS,MAAM;QACX,OAAO,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IACnC,CAAC;IACD,UAAS,MAAM,EAAE,MAAM;QACnB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC3C,MAAM,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;SAC1C;QACD,OAAO,MAAM,CAAC;IAClB,CAAC;CACJ,CAAC;AAEF,MAAM,gBAAgB,GAAG;IACrB,UAAS,MAAM;QACX,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1B,CAAC;IACD,UAAS,MAAM,EAAE,MAAM;QACnB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC3C,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;SACjC;QACD,OAAO,MAAM,CAAC;IAClB,CAAC;CACJ,CAAC;AAEF,MAAM,aAAa,GAAG;IAClB,UAAS,MAAM,EAAE,MAAM;QACnB,MAAM,IAAI,KAAK,CAAC,iCAAiC,OAAO,MAAM,OAAO,OAAO,MAAM,EAAE,CAAC,CAAC;IAC1F,CAAC;IACD,UAAS,MAAM,EAAE,MAAM,EAAE,QAAQ;QAC7B,MAAM,IAAI,KAAK,CAAC,iCAAiC,OAAO,MAAM,CAAC,CAAC,CAAC,OAAO,OAAO,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;IAChG,CAAC;CACJ,CAAC;AAEF,MAAM,oBAAoB,GAAG;IACzB,QAAQ,EAAE;QACN,QAAQ,EAAE,SAAS;QACnB,SAAS,EAAE,UAAU;QACrB,QAAQ,EAAE,SAAS;QACnB,QAAQ,EAAE,aAAa;KAC1B;IACD,SAAS,EAAE;QACP,QAAQ,EAAE,gBAAgB;QAC1B,SAAS,EAAE,SAAS;QACpB,QAAQ,EAAE,SAAS;QACnB,QAAQ,EAAE,aAAa;KAC1B;IACD,QAAQ,EAAE;QACN,QAAQ,EAAE,WAAW;QACrB,SAAS,EAAE,UAAU;QACrB,QAAQ,EAAE,SAAS;QACnB,QAAQ,EAAE,aAAa;KAC1B;IACD,QAAQ,EAAE;QACN,QAAQ,EAAE,aAAa;QACvB,SAAS,EAAE,UAAU;QACrB,QAAQ,EAAE,SAAS;QACnB,QAAQ,EAAE,SAAS;KACtB;CACJ,CAAC;AAEF,MAAM,gBAAgB,GAAG;IACrB,QAAQ,EAAE;QACN,QAAQ,EAAE,IAAI;QACd,SAAS,EAAE,IAAI;QACf,QAAQ,EAAE,IAAI;QACd,QAAQ,EAAE,KAAK;KAClB;IACD,SAAS,EAAE;QACP,QAAQ,EAAE,IAAI;QACd,SAAS,EAAE,IAAI;QACf,QAAQ,EAAE,IAAI;QACd,QAAQ,EAAE,KAAK;KAClB;IACD,QAAQ,EAAE;QACN,QAAQ,EAAE,IAAI;QACd,SAAS,EAAE,IAAI;QACf,QAAQ,EAAE,IAAI;QACd,QAAQ,EAAE,KAAK;KAClB;IACD,QAAQ,EAAE;QACN,QAAQ,EAAE,KAAK;QACf,SAAS,EAAE,IAAI;QACf,QAAQ,EAAE,IAAI;QACd,QAAQ,EAAE,IAAI;KACjB;CACJ,CAAC;AAEF,MAAM,cAAc,GAAG;IACnB;QACI,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,OAAO,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC,gBAAgB;QACtD,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,cAAc;YAC7C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,cAAc;YAC7C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,cAAc;YAC7C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,cAAc;YAC7C,OAAO,MAAM,CAAC;QAClB,CAAC;KACJ;IACD;QACI,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,OAAO,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,cAAc;QAC/C,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;KACJ;IACD;QACI,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,OAAO,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,cAAc;QAC/C,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;KACJ;IACD;QACI,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,OAAO,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,cAAc;QAC/C,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;KACJ;IACD;QACI,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,OAAO,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,cAAc;QAC/C,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;QACD,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;YAC9B,MAAM,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY;YAC9C,OAAO,MAAM,CAAC;QAClB,CAAC;KACJ;CACJ,CAAC;AAEF,SAAS,qBAAqB,CAAC,UAAqB,EAAE,eAA0B,EAAE,OAAgB;IAE9F,MAAM,KAAK,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9B,OAAO,oBAAoB,CAAC,UAAU,CAAC,CAAC,eAAe,CAAC,CAAC,KAAK,CAAqC,CAAC;AACxG,CAAC;AA8DG,sDAAqB;AA5DzB,SAAS,UAAU,CAAC,UAAU,EAAE,eAAe;IAE3C,OAAO,gBAAgB,CAAC,UAAU,CAAC,CAAC,eAAe,CAAC,CAAC;AACzD,CAAC;AA0DG,gCAAU;AAxDd,SAAS,sBAAsB,CAAC,WAAmB,EAAE,gBAAwB,EAAE,SAAS;IAEpF,IAAI,WAAW,KAAK,CAAC,CAAC,IAAI,gBAAgB,KAAK,CAAC,CAAC,EAAE;QAC/C,OAAO,SAAS,CAAC;KACpB;IACD,IAAI,WAAW,IAAI,CAAC,IAAI,gBAAgB,IAAI,CAAC,EAAE;QAC3C,OAAO,cAAc,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC,gBAAgB,GAAG,CAAC,CAAC,CAAC;KAChE;IAED,OAAO,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;QACrC,MAAM,CAAC,gBAAgB,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC;QAC1D,OAAO,MAAM,CAAC;IAClB,CAAC;AACL,CAAC;AA4CG,wDAAsB;AA1C1B,SAAS,oBAAoB,CAAC,aAAsB,EAAE,kBAA2B,EAAE,MAAM;IAErF,IAAI,aAAa,KAAK,KAAK,EAAE;QACzB,IAAI,kBAAkB,KAAK,KAAK,EAAE;YAC9B,kBAAkB;YAClB,OAAO,MAAM,CAAC;SACjB;aACI;YACD,iBAAiB;YACjB,OAAO,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;gBACrC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;oBAC3C,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;iBACzC;gBACD,OAAO,MAAM,CAAC;YAClB,CAAC;SACJ;KACJ;SACI;QACD,IAAI,kBAAkB,KAAK,KAAK,EAAE;YAC9B,iBAAiB;YACjB,OAAO,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;gBACrC,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;oBACnB,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;iBACtC;gBACD,OAAO,MAAM,CAAC;YAClB,CAAC;SACJ;aACI;YACD,gBAAgB;YAChB,OAAO,UAAS,MAAM,EAAE,MAAM,EAAE,SAAS;gBACrC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;oBAC9D,MAAM,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;iBAChD;gBACD,OAAO,MAAM,CAAC;YAClB,CAAC;SACJ;KACJ;AACL,CAAC;AAMG,oDAAoB;;;;;;;;;;;;;;ACrTxB;;;;;GAKG;;AAEH,gGAAsF;AAkCzE,cAAM,GAAG;IAClB,IAAI,EAAE,CAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAE;IAC5B,IAAI,EAAE,CAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAE;CAC/B,CAAC;AAEF,MAAM,UAAU,GAAG,UAAY,KAAqB;IAChD,IAAI,KAAK,KAAK,SAAS,IAAI,CAAC,OAAO,KAAK,KAAK,QAAQ,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE;QAC7E,OAAO,KAAK,CAAC;KAChB;IAED,OAAO,EAAE,MAAM,EAAE,KAAK,EAAoB,CAAC;AAC/C,CAAC,CAAC;AAEW,gBAAQ,GAAG,UAAY,MAA0B,EAAE,IAAY,EAAE,KAAqB;IAC/F,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC;IAC1B,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,EAA0B,CAAC;AACvG,CAAC,CAAC;AAEW,oBAAY,GAAG,UAAY,WAAc,EAAE,IAAY,EAAE,KAA6B;IAC/F,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC;IAC1B,MAAM,MAAM,GAAG,EAAE,IAAI,EAAE,WAAW,EAAE,OAAO,EAAE,mBAAW,CAAC,WAAW,CAAC,EAAE,MAAM,EAAE,CAAqB,EAAE,CAAC;IACvG,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,EAAkC,CAAC;AAC/G,CAAC,CAAC;AAEW,sBAAc,GAAG,UAAS,OAAiB,EAAE,IAAY,EAAE,KAA0B;IAC9F,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC;IAC1B,MAAM,MAAM,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC;IACtC,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,EAA+B,CAAC;AAC5G,CAAC,CAAC;AAEW,sBAAc,GAAG,UAAY,IAAe,EAAE,IAAY,EAAE,KAAqB;IAC1F,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC;IAC1B,MAAM,MAAM,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC;IAClD,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,EAA0B,CAAC;AACvG,CAAC,CAAC;AAEW,eAAO,GAAgC;IAChD,MAAM,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE;IACrB,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,EAAE;IAC1D,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE;IAClE,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;IAC3B,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE;IAC9B,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE;IACjC,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE;IACjC,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE;IAChD,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE;IACrE,MAAM,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;IAC1B,MAAM,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE;IAC7B,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,EAAE;IAC/D,OAAO,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,EAAE;IAClE,QAAQ,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE,cAAM,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE;IAClG,SAAS,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE,cAAM,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE;IACtG,OAAO,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE;IAC1B,MAAM,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;IACtB,MAAM,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,MAAM,EAAE;IAC5C,KAAK,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE;CACpC,CAAC;AAEW,aAAK,GAAG;IACjB,QAAQ,EAAE,CAAI,IAAY,EAAE,KAAsB,EAAE,EAAE,CAAC,gBAAQ,CAAI,SAAS,EAAE,IAAI,EAAE,KAAK,CAAC;IAC1F,MAAM,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,MAAM,EAAE,IAAI,EAAE,KAAK,CAAC;IACpG,OAAO,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IACtG,OAAO,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IACtG,OAAO,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IACtG,OAAO,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IACtG,OAAO,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IACtG,OAAO,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IACtG,OAAO,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IACtG,OAAO,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IACtG,OAAO,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IACtG,OAAO,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IACtG,MAAM,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,MAAM,EAAE,IAAI,EAAE,KAAK,CAAC;IACpG,MAAM,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,MAAM,EAAE,IAAI,EAAE,KAAK,CAAC;IACpG,QAAQ,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,QAAQ,EAAE,IAAI,EAAE,KAAK,CAAC;IACxG,SAAS,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,SAAS,EAAE,IAAI,EAAE,KAAK,CAAC;IAC1G,OAAO,EAAE,CAAC,IAAY,EAAE,KAA4B,EAAE,EAAE,CAAC,gBAAQ,CAAU,eAAO,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IACxG,MAAM,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,MAAM,EAAE,IAAI,EAAE,KAAK,CAAC;IACpG,IAAI,EAAE,CAAI,IAAY,EAAE,WAAc,EAAE,KAA8B,EAAE,EAAE,CAAC,oBAAY,CAAC,WAAW,EAAE,IAAI,EAAE,KAAK,CAAC;IACjH,MAAM,EAAE,CAAC,IAAY,EAAE,OAAiB,EAAE,KAA2B,EAAE,EAAE,CAAC,sBAAc,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC;IAC9G,MAAM,EAAE,CAAI,IAAY,EAAE,IAAe,EAAE,KAAsB,EAAE,EAAE,CAAC,sBAAc,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC;IACvG,KAAK,EAAE,CAAC,IAAY,EAAE,KAA2B,EAAE,EAAE,CAAC,gBAAQ,CAAS,eAAO,CAAC,KAAK,EAAE,IAAI,EAAE,KAAK,CAAC;CACrG,CAAC;;;;;;;;;;;;;;AC1HF;;;;;GAKG;;AAMH,gIAAqE;AAErE,yGAAwE;AAMxE,IAAY,eAAgE;AAA5E,WAAY,eAAe;IAAG,yDAAM;IAAE,2EAAe;IAAE,uEAAa;IAAE,qDAAI;AAAC,CAAC,EAAhE,eAAe,GAAf,uBAAe,KAAf,uBAAe,QAAiD;AAO5E,MAAqB,cAAe,SAAQ,oBAAU;IAMlD,YAAY,MAAc,EAAE,MAAyB,EAAE,OAAoB;QAEvE,KAAK,CAAC,MAAM,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;QAN3B,YAAO,GAAoB,eAAe,CAAC,IAAI,CAAC;QAChD,qBAAgB,GAAG,GAAG,CAAC;QACvB,mBAAc,GAAG,GAAG,CAAC;QAKzB,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAExB,IAAI,CAAC,MAAM,GAAG,eAAe,CAAC,MAAM,CAAC;IACzC,CAAC;IAED,IAAI,MAAM,CAAC,MAAuB;QAE9B,IAAI,MAAM,KAAK,IAAI,CAAC,OAAO,EAAE;YACzB,OAAO;SACV;QAED,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,MAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QAEjC,QAAQ,IAAI,CAAC,OAAO,EAAE;YAClB,KAAK,eAAe,CAAC,MAAM;gBACvB,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;gBACzB,MAAM;YAEV,KAAK,eAAe,CAAC,eAAe,CAAC;YACrC,KAAK,eAAe,CAAC,aAAa;gBAC9B,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;gBACzB,MAAM;YAEV,KAAK,eAAe,CAAC,IAAI;gBACrB,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;gBACzB,MAAM;SACb;QAED,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAE5B,IAAI,SAAS,CAAC,CAAC,CAAC,EAAE;YACd,SAAS,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC,6BAAW,CAAC,YAAY,EAAE,6BAAW,CAAC,GAAG,CAAC,CAAC;YACzE,SAAS,CAAC,CAAC,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC,kBAAkB,GAAG,KAAK,CAAC;SACnE;QAED,IAAI,SAAS,CAAC,CAAC,CAAC,EAAE;YACd,SAAS,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC,6BAAW,CAAC,YAAY,EAAE,6BAAW,CAAC,IAAI,CAAC,CAAC;YAC1E,SAAS,CAAC,CAAC,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC,kBAAkB,GAAG,KAAK,CAAC;SACnE;QAED,IAAI,SAAS,CAAC,CAAC,CAAC,EAAE;YACd,SAAS,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC,6BAAW,CAAC,YAAY,EAAE,6BAAW,CAAC,KAAK,CAAC,CAAC;YAC3E,SAAS,CAAC,CAAC,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC,kBAAkB,GAAG,KAAK,CAAC;SACnE;QAED,IAAI,CAAC,IAAI,CAAgB,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,CAAC;IACzD,CAAC;IAED,IAAI,MAAM;QACN,OAAO,IAAI,CAAC,OAAO,CAAC;IACxB,CAAC;IAED,IAAI,eAAe,CAAC,KAAa;QAC7B,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;QAC9B,IAAI,CAAC,oBAAoB,EAAE,CAAC;IAChC,CAAC;IAED,IAAI,eAAe;QACf,OAAO,IAAI,CAAC,gBAAgB,CAAC;IACjC,CAAC;IAED,IAAI,aAAa,CAAC,KAAa;QAC3B,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAC5B,IAAI,CAAC,oBAAoB,EAAE,CAAC;IAChC,CAAC;IAED,IAAI,aAAa;QACb,OAAO,IAAI,CAAC,cAAc,CAAC;IAC/B,CAAC;IAES,oBAAoB;QAE1B,MAAM,CAAC,GAAG,IAAI,CAAC,gBAAgB,CAAC;QAChC,MAAM,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC;QAE9B,QAAQ,IAAI,CAAC,OAAO,EAAE;YAClB,KAAK,eAAe,CAAC,MAAM;gBACvB,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;gBACtC,MAAM;YAEV,KAAK,eAAe,CAAC,eAAe;gBAChC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;gBACtC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,GAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBACxC,MAAM;YAEV,KAAK,eAAe,CAAC,aAAa;gBAC9B,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;gBACtC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAC,CAAC,CAAC,CAAC;gBACxC,MAAM;YAEV,KAAK,eAAe,CAAC,IAAI;gBACrB,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;gBACtC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,GAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBACxC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAC,CAAC,CAAC,CAAC;gBACxC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,CAAC,CAAC,CAAC;gBAC1C,MAAM;SACb;IACL,CAAC;CACJ;AA5GD,iCA4GC;;;;;;;;;;;;;;ACtID;;;;;GAKG;;AAEH,wDAA+B;AAE/B,4GAA2C;AAW3C,8GAA4C;AAC5C,2GAE4B;AAMnB,mBARF,kBAAQ,CAQE;AAJjB,4HAA+C;AAiB/C,MAAqB,UAAW,SAAQ,mBAAS;IAgB7C,YAAY,MAAc,EAAE,MAAyB,EAAE,OAAoB;QAEvE,KAAK,EAAE,CAAC;QAZH,cAAS,GAAe,EAAE,CAAC;QAE1B,sBAAiB,GAAc,IAAI,CAAC;QACpC,mBAAc,GAAa,IAAI,CAAC;QAChC,mBAAc,GAAmB,IAAI,CAAC;QACtC,oBAAe,GAAc,IAAI,CAAC;QAElC,iBAAY,GAAG,KAAK,CAAC;QAO3B,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QAEvB,IAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,aAAa,CAAC;YACpC,MAAM;YACN,SAAS,EAAE,IAAI;SAClB,CAAC,CAAC;QAEH,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,KAAK,CAAC;QAChC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;QAEvC,IAAI,CAAC,MAAM,GAAG,IAAI,mBAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC/C,CAAC;IAED,OAAO;QAEH,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;QACxB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC,CAAC;IAC3D,CAAC;IAED,IAAI,WAAW;QAEX,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;IAC7B,CAAC;IAED,IAAI,YAAY;QAEZ,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;IAC9B,CAAC;IAED,MAAM;QAEF,MAAM,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC;QAC/B,MAAM,MAAM,GAAG,IAAI,CAAC,YAAY,CAAC;QAEjC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,aAAa,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;QAC1E,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;QAE5C,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,mBAAS,EAAE,IAAI,CAAC,CAAC;QACnE,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;IAC5C,CAAC;IAED,MAAM;QAEF,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,mBAAS,EAAE,IAAI,CAAC,CAAC;QACnE,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QACxC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAClC,CAAC;IAED,WAAW,CAAC,KAAa,EAAE,MAAc,EAAE,MAAc,EAAE,OAAe;QAEtE,OAAO,CAAC,GAAG,CAAC,yEAAyE,EACjF,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;QAEpC,MAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;QACtC,MAAM,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;QAExC,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QAClC,IAAI,CAAC,MAAM,EAAE,CAAC;QACd,MAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;QACvD,IAAI,CAAC,aAAa,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;QAE9C,OAAO,OAAO,CAAC;IACnB,CAAC;IAED,MAAM;QAEF,MAAM,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,oBAAoB,CAAC;QACnE,IAAI,CAAC,cAAc,EAAE;YACjB,OAAO;SACV;QAED,MAAM,KAAK,GAAG,cAAc,CAAC,KAAK,CAAC;QACnC,MAAM,MAAM,GAAG,cAAc,CAAC,YAAY,CAAC;QAE3C,IAAI,CAAC,KAAK,IAAI,CAAC,MAAM,EAAE;YACnB,OAAO;SACV;QAED,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAE/B,IAAI,IAAI,CAAC,YAAY,EAAE;YACnB,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;YAC1B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;SACzE;QAED,QAAQ,CAAC,KAAK,EAAE,CAAC;QACjB,QAAQ,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC;QAE1B,MAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QAEjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;YAC9C,MAAM,QAAQ,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;YAE9B,QAAQ,CAAC,YAAY,CAAC,GAAG,QAAQ,CAAC;YAClC,MAAM,aAAa,GAAG,QAAQ,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;YACpD,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YACtC,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC;SACzC;IACL,CAAC;IAES,aAAa,CAAC,KAAa,EAAE,MAAc;QAEjD,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC;QAC1B,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC;QAE5B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,aAAa,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;QAC1E,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;IAChD,CAAC;IAED,MAAM;QAEF,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;IAC7B,CAAC;IAED,gBAAgB,CAAC,KAAa;QAE1B,MAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QAEjC,KAAK,IAAI,CAAC,GAAG,KAAK,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;YAC3C,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC;SAC1B;QACD,KAAK,IAAI,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,KAAK,EAAE,EAAE,CAAC,EAAE;YAC3C,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,kBAAQ,EAAE,CAAC;YAC9B,SAAS,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;SACnE;QAED,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC;IAC7B,CAAC;IAED,gBAAgB;QAEZ,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;IACjC,CAAC;IAED,SAAS,CAAC,KAAoB;QAE1B,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAC3B,IAAI,CAAC,MAAM,EAAE;YACT,OAAO,KAAK,CAAC;SAChB;QAED,IAAI,MAAM,GAAG,KAAK,CAAC;QACnB,IAAI,SAAS,GAAG,KAAK,CAAC;QAEtB,IAAI,KAAK,CAAC,IAAI,KAAK,eAAe,EAAE;YAChC,SAAS,GAAG,IAAI,CAAC;SACpB;aACI,IAAI,KAAK,CAAC,SAAS,IAAI,KAAK,CAAC,IAAI,KAAK,cAAc,EAAE;YACvD,SAAS,GAAG,IAAI,CAAC;YACjB,MAAM,GAAG,IAAI,CAAC;SACjB;QAED,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;QAE5D,IAAI,SAAS,EAAE;YACX,IAAI,SAAS,CAAC,SAAS,EAAE;gBACrB,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;aAC9C;iBACI;gBACD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aAC/B;YAED,IAAI,CAAC,SAAS,CAAC,eAAe,EAAE;gBAC5B,SAAS,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;aAC3C;YAED,OAAO,IAAI,CAAC;SACf;QAED,OAAO,KAAK,CAAC;IACjB,CAAC;IAED,SAAS,CAAC,KAAoB;QAE1B,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAC3B,IAAI,CAAC,MAAM,EAAE;YACT,OAAO,KAAK,CAAC;SAChB;QAED,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QAErD,IAAI,SAAS,EAAE;YACX,IAAI,SAAS,CAAC,SAAS,EAAE;gBACrB,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;aAC9C;iBACI;gBACD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aAC/B;YAED,IAAI,CAAC,SAAS,CAAC,eAAe,EAAE;gBAC5B,SAAS,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;aAC3C;YAED,OAAO,IAAI,CAAC;SACf;QAED,OAAO,KAAK,CAAC;IACjB,CAAC;IAIS,UAAU,CAAC,KAAK,EAAE,SAAS,EAAE,MAAM;QAEzC,IAAI,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC;QACnC,IAAI,QAAQ,GAAG,IAAI,CAAC,cAAc,CAAC;QACnC,IAAI,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC;QAErC,kEAAkE;QAClE,IAAI,SAAS,EAAE;YACX,QAAQ,GAAG,IAAI,CAAC;YAChB,MAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;YACjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;gBAC9C,MAAM,EAAE,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;gBACxB,IAAI,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,MAAM,CAAC,EAAE;oBAC9C,QAAQ,GAAG,EAAE,CAAC;oBACd,MAAM;iBACT;aACJ;SACJ;QAED,8DAA8D;QAC9D,IAAI,CAAC,QAAQ,EAAE;YACX,OAAO,IAAI,CAAC;SACf;QAED,kFAAkF;QAClF,MAAM,SAAS,GAAG,KAAmB,CAAC;QACtC,SAAS,CAAC,IAAI,GAAG,IAAI,CAAC;QACtB,SAAS,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC9B,SAAS,CAAC,OAAO,GAAG,QAAQ,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACtD,SAAS,CAAC,OAAO,GAAG,QAAQ,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACtD,SAAS,CAAC,eAAe,GAAG,KAAK,CAAC;QAElC,kBAAkB;QAClB,IAAI,MAAM,EAAE;YACR,MAAM,cAAc,GAAG,IAAI,CAAC,iBAAiB,CAAC,oBAAoB,CAAC;YACnE,MAAM,KAAK,GAAG,cAAc,IAAI,cAAc,CAAC,KAAK,CAAC;YACrD,MAAM,MAAM,GAAG,cAAc,IAAG,cAAc,CAAC,YAAY,CAAC;YAE5D,QAAQ,GAAG,IAAI,CAAC;YAChB,SAAS,GAAG,IAAI,CAAC;YAEjB,IAAI,KAAK,IAAI,MAAM,EAAE;gBACjB,IAAI,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;gBAC5D,IAAI,QAAQ,KAAK,SAAS,EAAE;oBACxB,OAAO,CAAC,GAAG,CAAC,yBAAyB,CAAC,CAAC;iBAC1C;qBACI;oBACD,OAAM,QAAQ,IAAI,CAAC,SAAS,EAAE;wBAC1B,SAAS,GAAG,QAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;wBAC3C,IAAI,CAAC,SAAS,EAAE;4BACZ,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC;yBAC9B;qBACJ;oBACD,IAAI,SAAS,EAAE;wBACX,OAAO,CAAC,GAAG,CAAC,4BAA4B,EAAE,SAAS,CAAC,SAAS,CAAC,CAAC;qBAClE;yBACI;wBACD,OAAO,CAAC,IAAI,CAAC,uCAAuC,CAAC,CAAC;qBACzD;iBACJ;aACJ;SACJ;QAED,SAAS,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC9B,SAAS,CAAC,SAAS,GAAG,SAAS,CAAC;QAEhC,IAAI,CAAC,cAAc,GAAG,QAAQ,CAAC;QAC/B,IAAI,CAAC,cAAc,GAAG,QAAQ,CAAC;QAC/B,IAAI,CAAC,eAAe,GAAG,SAAS,CAAC;QAEjC,OAAO,SAAS,CAAC;IACrB,CAAC;CACJ;AAvSD,6BAuSC;;;;;;;;;;;;;;ACjVD;;;;;GAKG;;AAEH,wDAA+B;AAE/B,0HAAgD;AAChD,iHAAoC;AAEpC,gFAAgF;AAEhF,MAAM,OAAO,GAAG;IACZ,KAAK,EAAE,qBAAK,CAAC,QAAQ,CAAC,OAAO,CAAC;CACjC,CAAC;AAEF,MAAqB,cAAe,SAAQ,mBAAS;IAArD;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAA4B,OAAO,CAAC,CAAC;IAgB7D,CAAC;IAbG,MAAM;QAEF,IAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,iBAAiB,EAAE,CAAC;IAClD,CAAC;IAED,MAAM;QAEF,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAmC,CAAC;QAC1D,MAAM,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAE3B,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QACtE,OAAO,IAAI,CAAC;IAChB,CAAC;CACJ;AAlBD,iCAkBC;;;;;;;;;;;;;;ACpCD;;;;;GAKG;;AAEH,wDAA+B;AAE/B,0HAAgD;AAEhD,iHAAoC;AAEpC,gFAAgF;AAEhF,MAAM,OAAO,GAAG;IACZ,IAAI,EAAE,qBAAK,CAAC,OAAO,CAAC,MAAM,EAAE,CAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAE,CAAC;IAC3C,QAAQ,EAAE,qBAAK,CAAC,OAAO,CAAC,UAAU,EAAE,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;CAClD,CAAC;AAEF,MAAqB,IAAK,SAAQ,mBAAS;IAA3C;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAA4B,OAAO,CAAC,CAAC;IAyB7D,CAAC;IAtBG,MAAM;QAEF,KAAK,CAAC,MAAM,EAAE,CAAC;QACf,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;IAC7C,CAAC;IAED,MAAM;QAEF,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QACpC,IAAI,IAAI,CAAC,OAAO,IAAI,QAAQ,CAAC,OAAO,EAAE;YAClC,IAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,iBAAiB,CACvC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAC3C,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAC1D,CAAC;SACL;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAES,SAAS,CAAC,KAAoB;IAExC,CAAC;CACJ;AA3BD,uBA2BC;;;;;;;;;;;;;;AC/CD;;;;;GAKG;;AAEH,0HAAgD;AAEhD,gIAAyE;AAMhE,sBANiB,6BAAW,CAMjB;AALpB,iHAAoC;AACpC,wGAA8B;AAM9B,MAAM,OAAO,GAAG;IACZ,QAAQ,EAAE,qBAAK,CAAC,KAAK,CAAC,iBAAiB,CAAC;IACxC,QAAQ,EAAE,qBAAK,CAAC,OAAO,CAAC,oBAAoB,CAAC;IAC7C,QAAQ,EAAE,qBAAK,CAAC,OAAO,CAAC,oBAAoB,CAAC;IAC7C,UAAU,EAAE,qBAAK,CAAC,IAAI,CAAC,iBAAiB,EAAE,6BAAW,EAAE,6BAAW,CAAC,WAAW,CAAC;IAC/E,GAAG,EAAE,qBAAK,CAAC,MAAM,CAAC,iBAAiB,EAAE,EAAE,CAAC;IACxC,IAAI,EAAE,qBAAK,CAAC,MAAM,CAAC,iBAAiB,EAAE,EAAE,CAAC;IACzC,IAAI,EAAE,qBAAK,CAAC,MAAM,CAAC,iBAAiB,EAAE,CAAC,CAAC;IACxC,IAAI,EAAE,qBAAK,CAAC,MAAM,CAAC,eAAe,EAAE,IAAI,CAAC;IACzC,GAAG,EAAE,qBAAK,CAAC,MAAM,CAAC,cAAc,EAAE,KAAK,CAAC;CAC3C,CAAC;AAEF,MAAqB,OAAQ,SAAQ,mBAAS;IAA9C;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAA4B,OAAO,CAAC,CAAC;IAgE7D,CAAC;IA7DG,IAAI,MAAM;QACN,OAAO,IAAI,CAAC,QAA2B,CAAC;IAC5C,CAAC;IAED,IAAc,KAAK;QACf,OAAO,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAM,CAAC;IAC5C,CAAC;IAED,MAAM;QAEF,KAAK,CAAC,MAAM,EAAE,CAAC;QACf,IAAI,CAAC,QAAQ,GAAG,IAAI,yBAAe,EAAE,CAAC;QAEtC,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,IAAI,KAAK,IAAI,CAAC,KAAK,CAAC,qBAAqB,EAAE;YACvC,KAAK,CAAC,qBAAqB,GAAG,IAAI,CAAC;SACtC;IACL,CAAC;IAED,MAAM;QAEF,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,UAAU,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAE1F,IAAI,QAAQ,CAAC,OAAO,EAAE;YAClB,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;YACzB,IAAI,KAAK,EAAE;gBACP,KAAK,CAAC,qBAAqB,GAAG,IAAI,CAAC;aACtC;SACJ;QAED,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAE3B,IAAI,QAAQ,CAAC,OAAO,IAAI,QAAQ,CAAC,OAAO,EAAE;YACtC,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YAC1C,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YAC1C,MAAM,CAAC,YAAY,EAAE,CAAC;SACzB;QAED,IAAI,UAAU,CAAC,OAAO,EAAE;YACpB,MAAM,CAAC,aAAa,CAAC,UAAU,CAAC,iBAAiB,EAAE,CAAC,CAAC;SACxD;QAED,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC;QACvB,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC,KAAK,CAAC;QAEvB,MAAM,CAAC,sBAAsB,EAAE,CAAC;QAChC,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,OAAO;QAEH,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,IAAI,KAAK,IAAI,KAAK,CAAC,qBAAqB,KAAK,IAAI,EAAE;YAC/C,KAAK,CAAC,qBAAqB,GAAG,IAAI,CAAC;SACtC;QAED,KAAK,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;CACJ;AAlED,0BAkEC;;;;;;;;;;;;;;AC/FD;;;;;GAKG;;AAEH,wDAA+B;AAE/B,0HAAgD;AAEhD,wGAA8B;AAE9B,gFAAgF;AAEhF,MAAM,OAAO,GAAG;IACZ,QAAQ,EAAE,qBAAK,CAAC,OAAO,CAAC,gBAAgB,EAAE,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;IACtD,MAAM,EAAE,qBAAK,CAAC,OAAO,CAAC,cAAc,CAAC;CACxC,CAAC;AAEF,MAAqB,iBAAkB,SAAQ,gBAAM;IAArD;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAAyB,OAAO,CAAC,CAAC;IA0B1D,CAAC;IAxBG,IAAI,KAAK;QAEL,OAAO,IAAI,CAAC,QAAkC,CAAC;IACnD,CAAC;IAED,MAAM;QAEF,KAAK,CAAC,MAAM,EAAE,CAAC;QACf,IAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,gBAAgB,EAAE,CAAC;IACjD,CAAC;IAED,MAAM;QAEF,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAExD,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACnC,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC;QAClC,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QACzC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAE9C,KAAK,CAAC,YAAY,EAAE,CAAC;QACrB,OAAO,IAAI,CAAC;IAChB,CAAC;CACJ;AA5BD,oCA4BC;;;;;;;;;;;;;;AChDD;;;;;GAKG;;AAEH,8GAA4C;AAE5C,gFAAgF;AAEhF,MAAqB,SAAU,SAAQ,mBAAS;IAK5C,YAAY,EAAU;QAElB,KAAK,CAAC,EAAE,CAAC,CAAC;QALN,cAAS,GAAyB,IAAI,CAAC;QAM3C,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;IAC9B,CAAC;IAED,IAAI,QAAQ;QACR,OAAO,IAAI,CAAC,SAAS,CAAC;IAC1B,CAAC;IAED,IAAI,QAAQ,CAAC,KAA2B;QACpC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QACvB,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;IACjC,CAAC;CACJ;AAnBD,4BAmBC;;;;;;;;;;;;;;AC9BD;;;;;GAKG;;AAEH,wDAA+B;AAE/B,6FAAiC;AACjC,0HAAgD;AAChD,iHAAoC;AAEpC,+FAAuD;AAEvD,gFAAgF;AAEhF,MAAM,MAAM,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;AACnC,MAAM,MAAM,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;AAEnC,MAAM,OAAO,GAAG;IACZ,QAAQ,EAAE,qBAAK,CAAC,OAAO,CAAC,oBAAoB,CAAC;IAC7C,QAAQ,EAAE,qBAAK,CAAC,OAAO,CAAC,oBAAoB,CAAC;IAC7C,KAAK,EAAE,qBAAK,CAAC,MAAM,CAAC,iBAAiB,CAAC;IACtC,IAAI,EAAE,qBAAK,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,CAAC;IACnC,QAAQ,EAAE,qBAAK,CAAC,MAAM,CAAC,qBAAqB,EAAE,CAAC,CAAC;IAChD,SAAS,EAAE,qBAAK,CAAC,QAAQ,CAAC,iBAAiB,EAAE,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;IACzD,OAAO,EAAE,qBAAK,CAAC,MAAM,CAAC,oBAAoB,EAAE,EAAE,CAAC;IAC/C,QAAQ,EAAE,qBAAK,CAAC,QAAQ,CAAC,gBAAgB,EAAE,CAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAE,CAAC;CAChE,CAAC;AAEF,MAAqB,KAAM,SAAQ,mBAAS;IAA5C;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAA4B,OAAO,CAAC,CAAC;IAsC7D,CAAC;IAnCG,MAAM;QAEF,IAAI,IAAI,GAAG,IAAI,CAAC,QAAqB,CAAC;QAEtC,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,SAAS,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAClE,IAAI,IAAI,CAAC,OAAO,IAAI,QAAQ,CAAC,OAAO,IAAI,SAAS,CAAC,OAAO,IAAI,OAAO,CAAC,OAAO,IAAI,QAAQ,CAAC,OAAO,EAAE;YAE9F,MAAM,KAAK,GAAe;gBACtB,IAAI,EAAE,IAAI,CAAC,KAAK;gBAChB,aAAa,EAAE,QAAQ,CAAC,KAAK;gBAC7B,SAAS,EAAE,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC;gBACvD,YAAY,EAAE,OAAO,CAAC,KAAK;gBAC3B,QAAQ,EAAE,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC;aACxD,CAAC;YAEF,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,GAAG,IAAI,cAAS,CAAC,KAAK,CAAC,CAAC;YACrD,IAAI,IAAI,EAAE;gBACN,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBACjC,OAAO,CAAC,sBAAsB,GAAG,IAAI,CAAC;aACzC;YAED,IAAI,GAAG,OAAO,CAAC;SAClB;QAED,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAC/C,IAAI,QAAQ,CAAC,OAAO,IAAI,QAAQ,CAAC,OAAO,IAAI,KAAK,CAAC,OAAO,EAAE;YACvD,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACxC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,cAAc,CAAC,cAAI,CAAC,OAAO,CAAC,CAAC;YAC9D,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;YAC5C,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAClC,IAAI,CAAC,YAAY,EAAE,CAAC;SACvB;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;CACJ;AAxCD,wBAwCC;;;;;;;;;;;;;;ACvED;;;;;GAKG;;AAEH,0HAAgD;AAChD,iHAAoC;AAEpC,gFAAgF;AAEhF,MAAM,OAAO,GAAG;IACZ,KAAK,EAAE,qBAAK,CAAC,QAAQ,CAAC,aAAa,CAAC;IACpC,SAAS,EAAE,qBAAK,CAAC,MAAM,CAAC,iBAAiB,EAAE,CAAC,CAAC;CAChD,CAAC;AAEF,MAAqB,MAAO,SAAQ,mBAAS;IAA7C;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAA4B,OAAO,CAAC,CAAC;IAO7D,CAAC;IAJG,IAAI,KAAK;QAEL,OAAO,IAAI,CAAC,QAAuB,CAAC;IACxC,CAAC;CACJ;AATD,yBASC;;;;;;;;;;;;;;AC1BD;;;;;GAKG;;AAIH,8GAAuD;AAGvD,wGAA8B;AAC9B,2GAAgC;AAEhC,gFAAgF;AAEhF,MAAM,GAAG,GAAG;IACR,KAAK,EAAE,iBAAK,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,CAAC;IAChC,MAAM,EAAE,iBAAK,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE,CAAC;CACrC,CAAC;AAEF,MAAqB,KAAM,SAAQ,mBAAS;IAA5C;;QAEc,WAAM,GAAa,EAAE,CAAC;QACtB,YAAO,GAAc,EAAE,CAAC;QAExB,kBAAa,GAAW,IAAI,CAAC;QAC7B,mBAAc,GAAY,IAAI,CAAC;QAEzC,QAAG,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;IAiH9B,CAAC;IA/GG,IAAI,cAAc;QACd,OAAO,IAAI,CAAC,aAAa,CAAC;IAC9B,CAAC;IAED,IAAI,eAAe;QACf,OAAO,IAAI,CAAC,cAAc,CAAC;IAC/B,CAAC;IAED,IAAI,KAAK;QACL,OAAO,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC;IAChE,CAAC;IAED,IAAI,MAAM;QACN,OAAO,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC;IACnE,CAAC;IAED,MAAM;QAEF,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,UAAU,CAAC,gBAAM,CAAC,CAAC;QACxD,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,CAAC,gBAAM,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QAE/D,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,UAAU,CAAC,iBAAO,CAAC,CAAC;QAC1D,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,CAAC,iBAAO,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;QAEjE,IAAI,CAAC,aAAa,EAAE,CAAC;IACzB,CAAC;IAED,MAAM;QAEF,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;QAErB,IAAI,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE;YACnB,MAAM,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,iBAAiB,EAAE,CAAC;YAC5C,IAAI,CAAC,aAAa,GAAG,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;SAC/D;QACD,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,EAAE;YACpB,MAAM,KAAK,GAAG,GAAG,CAAC,MAAM,CAAC,iBAAiB,EAAE,CAAC;YAC7C,IAAI,CAAC,cAAc,GAAG,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;SACjE;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,OAAO;QAEH,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,gBAAM,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QAChE,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,iBAAO,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;IACtE,CAAC;IAES,gBAAgB,CAAC,KAA8B;QAErD,MAAM,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC;QAE/B,IAAI,KAAK,CAAC,GAAG,EAAE;YACX,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YAC/B,IAAI,CAAC,aAAa,EAAE,CAAC;SACxB;aACI;YACD,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YAChD,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAE7B,IAAI,CAAC,aAAa,EAAE,CAAC;YAErB,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,IAAI,KAAK,IAAI,OAAO,CAAC,KAAK,EAAE;gBACjD,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;aACpD;SACJ;QAED,OAAO,CAAC,GAAG,EAAE,CAAC;IAClB,CAAC;IAES,iBAAiB,CAAC,KAA+B;QAEvD,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC;QAEjC,IAAI,KAAK,CAAC,GAAG,EAAE;YACX,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YAChC,IAAI,CAAC,aAAa,EAAE,CAAC;SACxB;aACI;YACD,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YACjD,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAE9B,IAAI,CAAC,aAAa,EAAE,CAAC;YAErB,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,IAAI,KAAK,IAAI,QAAQ,CAAC,KAAK,EAAE;gBACnD,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,QAAQ,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;aACtD;SACJ;QAED,QAAQ,CAAC,GAAG,EAAE,CAAC;IACnB,CAAC;IAES,aAAa;QAEnB,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAEnC,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;YACxB,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;SAC7E;aACI;YACD,KAAK,CAAC,UAAU,CAAC,CAAE,KAAK,CAAE,CAAC,CAAC;SAC/B;QAED,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;YACzB,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC;SAClF;aACI;YACD,MAAM,CAAC,UAAU,CAAC,CAAE,KAAK,CAAE,CAAC,CAAC;SAChC;IACL,CAAC;CACJ;AAzHD,wBAyHC;;;;;;;;;;;;;;AC/ID;;;;;GAKG;;AAEH,8GAA4C;AAE5C,gFAAgF;AAEhF,MAAqB,SAAU,SAAQ,mBAAS;IAK5C,YAAY,EAAU;QAElB,KAAK,CAAC,EAAE,CAAC,CAAC;QALN,cAAS,GAAmB,IAAI,CAAC;QAMrC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;IAC9B,CAAC;IAED,IAAI,QAAQ;QACR,OAAO,IAAI,CAAC,SAAS,CAAC;IAC1B,CAAC;IAED,IAAI,QAAQ,CAAC,KAAqB;QAC9B,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QACvB,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;IACjC,CAAC;CACJ;AAnBD,4BAmBC;;;;;;;;;;;;;;AC9BD;;;;;GAKG;;AAEH,wDAA+B;AAI/B,iHAAoC;AACpC,iHAAoC;AACpC,iHAAoC;AAEpC,gFAAgF;AAEhF,MAAqB,KAAM,SAAQ,mBAAS;IAMxC,IAAI,IAAI;QACJ,OAAO,IAAI,CAAC,QAAsB,CAAC;IACvC,CAAC;IAED,MAAM;QAEF,KAAK,CAAC,MAAM,EAAE,CAAC;QAEf,IAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC;QACjC,IAAI,CAAC,QAAQ,CAAC,OAAO,GAAG,KAAK,CAAC;QAE9B,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,cAAc,CAAC,mBAAS,EAAE,SAAS,CAAC,EAAE;YAC9D,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAC;YACxC,SAAS,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QACxD,CAAC,EAAE,SAAS,CAAC,EAAE;YACX,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YAC1B,SAAS,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,cAAc,CAAC,mBAAS,EAAE,SAAS,CAAC,EAAE;YAC9D,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAC;YACxC,SAAS,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QACxD,CAAC,EAAE,SAAS,CAAC,EAAE;YACX,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YAC1B,SAAS,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QACzD,CAAC,CAAC,CAAC;IACP,CAAC;IAED,QAAQ;QAEJ,MAAM,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC;QAC/B,MAAM,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,QAA0B,CAAC;QACjD,OAAO,GAAG,IAAI,CAAC,SAAS,iBAAiB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,iBAAiB,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,GAAG;IAC7G,CAAC;IAES,cAAc,CAAC,QAA8B;QAEnD,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC9B,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,QAAQ,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC3D,CAAC;IAES,cAAc,CAAC,QAAwB;QAE7C,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC9B,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,CAAC;IAC3D,CAAC;CACJ;AApDD,wBAoDC;;;;;;;;;;;;;;ACrED;;;;;GAKG;;AAOH,8GAAuD;AAIvD,oHAAsC;AAEtC,gFAAgF;AAEhF,MAAM,QAAQ,GAAmB;IAC7B,IAAI,EAAE,IAAI;IACV,QAAQ,EAAE,IAAI;IACd,QAAQ,EAAE,IAAI;IACd,KAAK,EAAE,IAAI;IACX,MAAM,EAAE,IAAI;IACZ,QAAQ,EAAE,IAAI;IACd,QAAQ,EAAE,IAAI;IACd,KAAK,EAAE,IAAI;CACd,CAAC;AAEF,MAAM,aAAa,GAAG,UAAS,MAAsB;IAEjD,IAAK,MAAc,CAAC,QAAQ,EAAE;QAC1B,MAAM,CAAC,cAAc,GAAG,UAAS,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,QAAqB;YAC9D,IAAI,QAAQ,CAAC,aAAa,EAAE;gBACxB,wDAAwD;gBACxD,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;aAChC;QACL,CAAC;KACJ;AACL,CAAC,CAAC;AAEF,MAAM,eAAe,GAAG,UAAS,MAAsB;IAEnD,IAAK,MAAc,CAAC,QAAQ,EAAE;QAC1B,MAAM,CAAC,cAAc,GAAG,IAAI,CAAC;KAChC;AACL,CAAC,CAAC;AAyBF,MAAM,OAAO,GAAG;IACZ,OAAO,EAAE,iBAAK,CAAC,OAAO,CAAC,gBAAgB,EAAE,IAAI,CAAC;IAC9C,QAAQ,EAAE,iBAAK,CAAC,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAAC;CACnD,CAAC;AAEF,MAAM,QAAQ,GAAG;IACb,WAAW,EAAE,iBAAK,CAAC,KAAK,CAAC,qBAAqB,CAAC;IAC/C,SAAS,EAAE,iBAAK,CAAC,KAAK,CAAC,mBAAmB,CAAC;IAC3C,aAAa,EAAE,iBAAK,CAAC,KAAK,CAAC,uBAAuB,CAAC;CACtD,CAAC;AAEF;;;;GAIG;AACH,MAAqB,SAAU,SAAQ,mBAAS;IAY5C,YAAY,EAAU;QAElB,KAAK,CAAC,EAAE,CAAC,CAAC;QATd,QAAG,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QAC9B,SAAI,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;QAGzB,cAAS,GAAmB,IAAI,CAAC;QAMrC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;IAC5B,CAAC;IAED,yFAAyF;IACzF,IAAI,oBAAoB;QACpB,OAAQ,IAAI,CAAC,WAAmB,CAAC,oBAAoB,CAAC;IAC1D,CAAC;IACD,2CAA2C;IAC3C,IAAI,eAAe;QACf,OAAO,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;IAC/D,CAAC;IACD,2DAA2D;IAC3D,IAAI,QAAQ;QACR,OAAO,IAAI,CAAC,SAAS,CAAC;IAC1B,CAAC;IAED;;;;OAIG;IACH,IAAI,QAAQ,CAAC,MAAsB;QAE/B,MAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC;QACrC,MAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;QAE7C,IAAI,aAAa,EAAE;YACf,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC;YACpC,aAAa,CAAC,cAAc,GAAG,IAAI,CAAC;YACpC,aAAa,CAAC,aAAa,GAAG,IAAI,CAAC;YAEnC,IAAI,CAAC,0BAA0B,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;YAErD,IAAI,eAAe,EAAE;gBACjB,eAAe,CAAC,QAAQ,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;aAClD;SACJ;QAED,IAAI,CAAC,IAAI,CAAuB,EAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE,aAAa,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;QAC1F,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC;QAExB,IAAI,MAAM,EAAE;YACR,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC;YACpC,MAAM,CAAC,gBAAgB,GAAG,KAAK,CAAC;YAChC,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC;YAExC,MAAM,CAAC,cAAc,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACxD,IAAI,IAAI,CAAC,WAAW,EAAE;gBAClB,MAAM,CAAC,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACzD;YAED,IAAI,CAAC,wBAAwB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;YAE5C,IAAI,eAAe,EAAE;gBACjB,eAAe,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;aACxC;SACJ;IACL,CAAC;IAED,MAAM;QAEF,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,oBAAoB,EAAE,SAAS,CAAC,EAAE;YACvD,IAAI,IAAI,CAAC,SAAS,EAAE;gBAChB,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aAC1C;QACL,CAAC,EAAE,SAAS,CAAC,EAAE;YACX,IAAI,IAAI,CAAC,SAAS,EAAE;gBAChB,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aAC7C;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED,MAAM,CAAC,OAAO;QAEV,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;QAErB,IAAI,GAAG,CAAC,OAAO,CAAC,OAAO,IAAI,IAAI,CAAC,SAAS,EAAE;YACvC,IAAI,CAAC,SAAS,CAAC,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC;SAC9C;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,OAAO;QAEH,IAAI,IAAI,CAAC,SAAS,EAAE;YAChB,MAAM,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC;YAEvC,IAAI,SAAS,EAAE;gBACX,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;aAC7C;SACJ;QAED,KAAK,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;IAED;;;;OAIG;IACH,YAAY,CAAC,OAAuB;IAEpC,CAAC;IAED;;;;OAIG;IACH,WAAW,CAAC,OAAuB;IAEnC,CAAC;IAED;;;;OAIG;IACH,WAAW,CAAC,MAAsB;QAE9B,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QAC3B,IAAI,CAAC,wBAAwB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;IAChD,CAAC;IAED;;;;OAIG;IACH,cAAc,CAAC,MAAsB;QAEjC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QAC9B,IAAI,CAAC,0BAA0B,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;IAClD,CAAC;IAED;;;;;OAKG;IACH,wBAAwB,CAAC,MAAsB,EAAE,YAAqB,KAAK;QAEvE,IAAI,SAAS,IAAI,MAAM,KAAK,IAAI,CAAC,SAAS,EAAE;YACxC,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;SACrF;aACI,IAAI,SAAS,EAAE;YAChB,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC;SACpD;aACI,IAAI,MAAM,KAAK,IAAI,CAAC,SAAS,EAAE;YAChC,aAAa,CAAC,MAAM,CAAC,CAAC;SACzB;IACL,CAAC;IAED;;;;;OAKG;IACH,0BAA0B,CAAC,MAAsB,EAAE,YAAqB,KAAK;QAEzE,IAAI,SAAS,IAAI,MAAM,KAAK,IAAI,CAAC,SAAS,EAAE;YACxC,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;SACvF;aACI,IAAI,SAAS,EAAE;YAChB,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC;SACtD;aACI,IAAI,MAAM,KAAK,IAAI,CAAC,SAAS,EAAE;YAChC,eAAe,CAAC,MAAM,CAAC,CAAC;SAC3B;IACL,CAAC;IAED;;OAEG;IACH,QAAQ;QAEJ,OAAO,KAAK,CAAC,QAAQ,EAAE,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,YAAY,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;IACjG,CAAC;IAED;;;OAGG;IACK,eAAe,CACnB,QAA6B,EAC7B,KAAkB,EAClB,MAAoB,EACpB,QAAwB,EACxB,QAAa,EACb,KAAU;QAEV,2EAA2E;QAC3E,IAAI,QAAQ,CAAC,aAAa,IAAI,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAK,EAAE;YACnD,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;SACvC;QAED,IAAI,IAAI,CAAC,YAAY,EAAE;YACnB,QAAQ,CAAC,IAAI,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC;YACnC,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC,YAAY,CAAC,CAAC;YAC3C,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;YAC7B,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;YACvB,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAC;YACzB,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;YAC7B,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;YAC7B,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;YAEvB,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;SAC/B;IACL,CAAC;IAED;;;OAGG;IACK,cAAc,CAClB,QAA6B,EAC7B,KAAkB,EAClB,MAAoB,EACpB,QAAwB,EACxB,QAAwB,EACxB,KAAU;QAEV,QAAQ,CAAC,IAAI,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACnC,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC,YAAY,CAAC,CAAC;QAC3C,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC7B,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;QACvB,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAC;QACzB,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC7B,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC7B,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;QAEvB,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;IAC/B,CAAC;;AAxPD,oFAAoF;AAC1D,8BAAoB,GAAwB,oBAAU,CAAC;AAHrF,4BA2PC;AAED,SAAS,CAAC,SAAS,CAAC,YAAY,GAAG,IAAI,CAAC;AACxC,SAAS,CAAC,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC;;;;;;;;;;;;;;ACvVvC;;;;;GAKG;;AAEH,0HAAgD;AAChD,8GAA4C;AAE5C,mIAAoD;AACpD,wGAAsD;AAKtD,gFAAgF;AAEhF,MAAM,OAAO,GAAG;IACZ,OAAO,EAAE,qBAAK,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,CAAC;IACvC,KAAK,EAAE,qBAAK,CAAC,OAAO,CAAC,OAAO,EAAE,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;IAC1C,MAAM,EAAE,qBAAK,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAE,CAAC;IAC7C,QAAQ,EAAE,qBAAK,CAAC,OAAO,CAAC,WAAW,EAAE,CAAE,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,CAAE,CAAC;IACvD,SAAS,EAAE,qBAAK,CAAC,OAAO,CAAC,YAAY,EAAE,CAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAE,CAAC;IACzD,QAAQ,EAAE,qBAAK,CAAC,OAAO,CAAC,WAAW,EAAE,CAAE,EAAE,EAAE,GAAG,EAAE,GAAG,CAAE,CAAC;IACtD,SAAS,EAAE,qBAAK,CAAC,OAAO,CAAC,YAAY,EAAE,CAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAE,CAAC;CAC5D,CAAC;AAEF,MAAM,QAAQ,GAAG;IACb,KAAK,EAAE,qBAAK,CAAC,OAAO,CAAC,OAAO,CAAC;IAC7B,MAAM,EAAE,qBAAK,CAAC,OAAO,CAAC,QAAQ,CAAC;IAC/B,IAAI,EAAE,qBAAK,CAAC,MAAM,CAAC,MAAM,CAAC;CAC7B,CAAC;AAEF,MAAqB,iBAAkB,SAAQ,mBAAS;IAAxD;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QAC9B,SAAI,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;QAEzB,WAAM,GAAG,IAAI,0BAAU,EAAE,CAAC;IAiHtC,CAAC;IA9GG,MAAM;QAEF,KAAK,CAAC,MAAM,EAAE,CAAC;QAEf,IAAI,CAAC,MAAM,CAAC,UAAU,GAAG,IAAI,CAAC;QAE9B,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,cAAc,EAAE,YAAY,EAAE,cAAc,CAAC,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QACrF,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QAE9C,IAAI,CAAC,cAAc,CAAC,gBAAM,EAAE,SAAS,CAAC,EAAE;YACpC,SAAS,CAAC,EAAE,CAAqB,eAAe,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QACjF,CAAC,EAAE,SAAS,CAAC,EAAE;YACX,SAAS,CAAC,GAAG,CAAqB,eAAe,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QAClF,CAAC,CAAC,CAAC;IAEP,CAAC;IAED,OAAO;QAEH,KAAK,CAAC,OAAO,EAAE,CAAC;QAEhB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,cAAc,EAAE,YAAY,EAAE,cAAc,CAAC,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QACtF,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;IACnD,CAAC;IAED,MAAM;QAEF,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;QAC1B,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;QAErB,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,QAAQ,EAAE,SAAS,EAAE,GAAG,GAAG,CAAC;QACzD,IAAI,QAAQ,CAAC,OAAO,IAAI,SAAS,CAAC,OAAO,IAAI,QAAQ,CAAC,OAAO,IAAI,SAAS,CAAC,OAAO,EAAE;YAChF,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACzC,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YAC3C,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACzC,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;SAC9C;QAED,IAAI,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE;YACnB,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;SAC1C;QACD,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,EAAE;YACpB,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;SAC5C;QAED,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,IAAI;QAEA,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;QAC1B,MAAM,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAC7B,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC;QAE1C,IAAI,OAAO,CAAC,KAAK,EAAE;YACf,KAAK,CAAC,MAAM,EAAE,CAAC;YAEf,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YACjC,KAAK,CAAC,GAAG,EAAE,CAAC;YACZ,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YACnC,MAAM,CAAC,GAAG,EAAE,CAAC;YACb,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAG1B,MAAM,eAAe,GAAG,IAAI,CAAC,sBAAsB,CAAC;YAEpD,IAAI,eAAe,EAAE;gBACjB,MAAM,MAAM,GAAG,eAAe,CAAC,eAAe,CAAC;gBAC/C,IAAI,MAAM,EAAE;oBACR,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;iBACzC;qBACI;oBACD,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;iBAClD;gBAED,IAAI,eAAe,CAAC,MAAM,CAAC,oBAAoB,EAAE;oBAC7C,eAAe,CAAC,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;iBAClD;gBAED,OAAO,IAAI,CAAC;aACf;SACJ;QAED,OAAO,KAAK,CAAC;IACjB,CAAC;IAES,SAAS,CAAC,KAAoB;QAEpC,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC,sBAAsB,EAAE;YACvD,MAAM,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;YAChC,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC;YAC7D,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YAC7B,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC;SAChC;IACL,CAAC;IAES,SAAS,CAAC,KAAoB;QAEpC,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC,sBAAsB,EAAE;YACvD,MAAM,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;YAChC,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC;YAC7D,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;YAC7B,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC;SAChC;IACL,CAAC;IAES,cAAc,CAAC,KAAyB;QAE9C,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC,IAAI,CAAC;IAC7C,CAAC;CACJ;AAtHD,oCAsHC;;;;;;;;;;;;;;ACxJD;;;;;GAKG;;AAEH,wDAA+B;AAE/B,0HAAgD;AAChD,iHAAoC;AAEpC,gFAAgF;AAEhF,MAAM,OAAO,GAAG;IACZ,KAAK,EAAE,qBAAK,CAAC,QAAQ,CAAC,OAAO,CAAC;CACjC,CAAC;AAEF,MAAqB,cAAe,SAAQ,mBAAS;IAArD;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;IAgBlC,CAAC;IAbG,MAAM;QAEF,IAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,iBAAiB,EAAE,CAAC;IAClD,CAAC;IAED,MAAM;QAEF,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAmC,CAAC;QAC1D,MAAM,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAE3B,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QACtE,OAAO,IAAI,CAAC;IAChB,CAAC;CACJ;AAlBD,iCAkBC;;;;;;;;;;;;;;ACpCD;;;;;GAKG;;AAEH,8GAAuD;AACvD,mIAA0D;AAG1D,uIAAyD;AAEzD,wGAAwC;AAIxC,iHAAoC;AACpC,oHAAsC;AACtC,wGAA0D;AAE1D,gFAAgF;AAEhF,MAAM,OAAO,GAAG;IACZ,eAAe,EAAE,iBAAK,CAAC,OAAO,CAAC,kBAAkB,EAAE,IAAI,CAAC;CAC3D,CAAC;AAEF,MAAqB,cAAe,SAAQ,oBAAU;IAAtD;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QAEpB,WAAM,GAAG,CAAC,CAAC;QACX,WAAM,GAAG,CAAC,CAAC;QAEb,cAAS,GAAG,IAAI,GAAG,EAAsB,CAAC;QAC1C,kBAAa,GAA6B,IAAI,CAAC;IAoH3D,CAAC;IAjHG,MAAM;QAEF,KAAK,CAAC,MAAM,EAAE,CAAC;QAEf,IAAI,CAAC,MAAM,CAAC,EAAE,CAAgB,cAAc,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QACxE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAgB,YAAY,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;IACxE,CAAC;IAED,OAAO;QAEH,IAAI,CAAC,MAAM,CAAC,GAAG,CAAgB,cAAc,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QACzE,IAAI,CAAC,MAAM,CAAC,GAAG,CAAgB,YAAY,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;QAErE,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,CAAC;QAE7B,KAAK,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;IAED,MAAM;QAEF,OAAO,IAAI,CAAC;IAChB,CAAC;IAES,YAAY,CAAC,IAAU,EAAE,QAAiB;QAEhD,KAAK,CAAC,YAAY,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QAEnC,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,oBAAU,CAAC,CAAC;QAClD,IAAI,SAAS,EAAE;YACX,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;SAC3C;IACL,CAAC;IAES,iBAAiB,CAAC,SAAoB,EAAE,QAAiB;QAE/D,KAAK,CAAC,iBAAiB,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;QAE7C,IAAI,SAAS,YAAY,mBAAS,IAAI,SAAS,YAAY,oBAAU,EAAE;YACnE,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;SAC3C;IACL,CAAC;IAES,aAAa,CAAC,KAAY;QAEhC,IAAI,IAAI,CAAC,aAAa,EAAE;YACpB,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,CAAC;SAChC;QAED,IAAI,KAAK,EAAE;YACP,IAAI,CAAC,aAAa,GAAG,IAAI,0BAAgB,CAAC,KAAK,CAAC,UAAU,EAAE,gBAAM,EAAE,SAAS,CAAC,EAAE;gBAC5E,SAAS,CAAC,EAAE,CAAyB,cAAc,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,CAAC;YACxF,CAAC,EAAE,SAAS,CAAC,EAAE;gBACX,SAAS,CAAC,GAAG,CAAyB,cAAc,EAAE,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,CAAC;YACzF,CAAC,CAAC,CAAC;SACN;IACL,CAAC;IAES,aAAa,CAAC,KAAoB;QAExC,IAAI,KAAK,CAAC,SAAS,EAAE;YACjB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC;YAC5B,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC;SAC/B;IACL,CAAC;IAES,WAAW,CAAC,KAAoB;QAEtC,IAAI,KAAK,CAAC,SAAS,EAAE;YACjB,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,CAAC;YAC/F,IAAI,QAAQ,GAAG,CAAC,EAAE;gBACd,IAAI,KAAK,CAAC,SAAS,EAAE;oBACjB,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,SAAS,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;iBACxD;qBACI,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE;oBACrB,IAAI,CAAC,cAAc,EAAE,CAAC;iBACzB;aACJ;SACJ;IACL,CAAC;IAES,kBAAkB,CAAC,KAA6B;QAEtD,MAAM,QAAQ,GAAG,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC;QACxC,MAAM,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC;QAEpC,IAAI,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,KAAK,EAAE;YAChC,KAAK,IAAI,KAAK,IAAI,IAAI,CAAC,SAAS,EAAE;gBAC9B,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAQ,EAAE,MAAM,CAAC,CAAC;aAC5C;SACJ;IACL,CAAC;IAES,aAAa,CAAC,SAAiC,EAAE,QAAiB;QAExE,IAAI,CAAC,SAAS,EAAE;YACZ,OAAO;SACV;QAED,IAAI,QAAQ,EAAE;YACV,MAAM,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAC;YACpC,IAAI,QAAQ,EAAE;gBACV,MAAM,OAAO,GAAG,IAAI,iBAAO,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;gBAChD,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;aAC1C;SACJ;aACI;YACD,MAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;YAC9C,IAAI,OAAO,EAAE;gBACT,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;gBACjC,OAAO,CAAC,OAAO,EAAE,CAAC;aACrB;SACJ;IACL,CAAC;CACJ;AA5HD,iCA4HC;;;;;;;;;;;;;;ACvJD;;;;;GAKG;;AAEH,wDAA+B;AAE/B,0HAAgD;AAEhD,wGAA8B;AAE9B,gFAAgF;AAEhF,MAAM,OAAO,GAAG;IACZ,QAAQ,EAAE,qBAAK,CAAC,MAAM,CAAC,gBAAgB,CAAC;IACxC,KAAK,EAAE,qBAAK,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,CAAC;CACxC,CAAC;AAEF,MAAqB,WAAY,SAAQ,gBAAM;IAA/C;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAAyB,OAAO,CAAC,CAAC;IA2B1D,CAAC;IAxBG,IAAI,KAAK;QAEL,OAAO,IAAI,CAAC,QAA4B,CAAC;IAC7C,CAAC;IAED,MAAM;QAEF,KAAK,CAAC,MAAM,EAAE,CAAC;QACf,IAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,UAAU,EAAE,CAAC;IAC3C,CAAC;IAED,MAAM;QAEF,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAEvD,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACnC,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC;QAClC,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC;QAChC,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;QAE1B,KAAK,CAAC,YAAY,EAAE,CAAC;QACrB,OAAO,IAAI,CAAC;IAChB,CAAC;CACJ;AA7BD,8BA6BC;;;;;;;;;;;;;;ACjDD;;;;;GAKG;;AAGH,2HAAiD;AAEjD,oHAAsC;AAEtC,gFAAgF;AAEhF,MAAqB,YAAa,SAAQ,gBAAM;IAE5C,IAAI,SAAS,CAAC,IAAgB;QAE1B,IAAI,IAAI,CAAC,EAAE,CAAC,oBAAU,CAAC,EAAE;YACrB,MAAM,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,oBAAU,CAAC,CAAC;YAC/C,MAAM,QAAQ,GAAG,IAAI,CAAC,SAAuB,CAAC;YAC9C,MAAM,IAAI,GAAG,IAAkB,CAAC;YAEhC,IAAI,MAAM,IAAI,QAAQ,EAAE;gBACpB,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;aAC7C;YAED,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC;YAEvB,IAAI,MAAM,IAAI,IAAI,EAAE;gBAChB,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aACtC;SACJ;IACL,CAAC;CACJ;AApBD,+BAoBC;;;;;;;;;;;;;;AClCD;;;;;GAKG;;AAEH,8GAA6D;AAC7D,2HAAiD;AAajD,MAAqB,SAAU,SAAQ,mBAAS;IAS5C,YAAY,EAAU;QAElB,KAAK,CAAC,EAAE,CAAC,CAAC;QAPL,UAAK,GAAiB,EAAE,CAAC;QAE1B,0BAAqB,GAAW,IAAI,CAAC;QAMzC,IAAI,CAAC,SAAS,CAAC,cAAc,EAAE,eAAe,CAAC,CAAC;IACpD,CAAC;IAED,IAAI,oBAAoB;QACpB,OAAO,IAAI,CAAC,qBAAqB,CAAC;IACtC,CAAC;IACD,IAAI,oBAAoB,CAAC,SAAiB;QACtC,IAAI,SAAS,KAAK,IAAI,CAAC,qBAAqB,EAAE;YAC1C,MAAM,aAAa,GAAG,IAAI,CAAC,qBAAqB,CAAC;YACjD,MAAM,cAAc,GAAG,IAAI,CAAC,qBAAqB,CAAC;YAElD,IAAI,aAAa,EAAE;gBACf,aAAa,CAAC,GAAG,CAAqB,eAAe,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;aACrF;YAED,IAAI,SAAS,EAAE;gBACX,SAAS,CAAC,EAAE,CAAqB,eAAe,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;aAChF;YAED,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;YACvC,MAAM,UAAU,GAAG,IAAI,CAAC,qBAAqB,CAAC;YAE9C,MAAM,UAAU,GAAsB,EAAE,IAAI,EAAE,cAAc,EAAE,QAAQ,EAAE,aAAa,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC;YACzG,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAEtB,MAAM,WAAW,GAAuB,EAAE,IAAI,EAAE,eAAe,EAAE,QAAQ,EAAE,cAAc,EAAE,IAAI,EAAE,UAAU,EAAE,CAAC;YAC9G,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;SAC1B;IACL,CAAC;IAED,IAAI,gBAAgB;QAChB,OAAO,IAAI,CAAC,qBAAqB,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC;IAChF,CAAC;IACD,IAAI,WAAW;QACX,OAAO,IAAI,CAAC,qBAAqB,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC;IAChF,CAAC;IAED,IAAI,qBAAqB;QACrB,OAAO,IAAI,CAAC,qBAAqB,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,qBAAqB,CAAC,CAAC,CAAC,IAAI,CAAC;IAChG,CAAC;IACD,IAAI,YAAY;QACZ,MAAM,SAAS,GAAG,IAAI,CAAC,qBAAqB,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,qBAAqB,CAAC,CAAC,CAAC,IAAI,CAAC;QACvG,OAAO,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC;IAC/C,CAAC;IAED,MAAM;QAEF,IAAI,CAAC,cAAc,CAAC,gBAAM,EAAE,SAAS,CAAC,EAAE;YACpC,SAAS,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC;QAC7C,CAAC,EAAE,SAAS,CAAC,EAAE;YACX,SAAS,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QAC/C,CAAC,CAAC,CAAC;IACP,CAAC;IAED,UAAU,CAAC,IAAgB;QAEvB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACtB,8EAA8E;IAClF,CAAC;IAED,UAAU,CAAC,IAAgB;QAEvB,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;SACjD;QACD,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QAC5B,8EAA8E;IAClF,CAAC;IAES,OAAO;QAEb,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACtB,IAAI,CAAC,MAAM,EAAE,CAAC;QAClB,CAAC,CAAC,CAAC;IACP,CAAC;IAES,cAAc,CAAC,KAAyB;QAE9C,IAAI,CAAC,IAAI,CAAqB,KAAK,CAAC,CAAC;IACzC,CAAC;;AA1Fe,2BAAiB,GAAY,IAAI,CAAC;AAFtD,4BA6FC;;;;;;;;;;;;;;AClHD;;;;;GAKG;;AAEH,wDAA+B;AAI/B,0HAAgD;AAGhD,iHAA2D;AAC3D,oHAAsC;AAOtC,MAAM,QAAQ,GAAwB;IAClC,IAAI,EAAE,IAAI;IACV,QAAQ,EAAE,IAAI;IACd,QAAQ,EAAE,IAAI;IACd,KAAK,EAAE,IAAI;IACX,MAAM,EAAE,IAAI;CACf,CAAC;AAEF,MAAM,kBAAkB,GAA4B;IAChD,IAAI,EAAE,eAAe;IACrB,SAAS,EAAE,IAAI;IACf,OAAO,EAAE,QAAQ;CACpB,CAAC;AAEF,MAAM,iBAAiB,GAA2B;IAC9C,IAAI,EAAE,cAAc;IACpB,SAAS,EAAE,IAAI;IACf,OAAO,EAAE,QAAQ;CACpB,CAAC;AA0BF,MAAM,OAAO,GAAG;IACZ,QAAQ,EAAE,qBAAK,CAAC,KAAK,CAAC,gBAAgB,CAAC;CAC1C,CAAC;AAEF,MAAqB,MAAO,SAAQ,oBAAU;IAQ1C,YAAY,EAAU;QAElB,KAAK,CAAC,EAAE,CAAC,CAAC;QANN,2BAAsB,GAAY,IAAI,CAAC;QAE/C,QAAG,GAAG,IAAI,CAAC,SAAS,CAA6B,OAAO,EAAE,CAAC,CAAC,CAAC;QAKzD,IAAI,CAAC,SAAS,CAAC,eAAe,EAAE,cAAc,EAAE,eAAe,CAAC,CAAC;IACrE,CAAC;IAED,IAAI,KAAK;QACL,OAAO,IAAI,CAAC,QAAuB,CAAC;IACxC,CAAC;IAED,IAAI,qBAAqB;QACrB,OAAO,IAAI,CAAC,sBAAsB,CAAC;IACvC,CAAC;IACD,IAAI,qBAAqB,CAAC,SAAkB;QACxC,IAAI,SAAS,KAAK,IAAI,CAAC,sBAAsB,EAAE;YAC3C,MAAM,QAAQ,GAAG,IAAI,CAAC,sBAAsB,CAAC;YAC7C,IAAI,CAAC,sBAAsB,GAAG,SAAS,CAAC;YAExC,MAAM,KAAK,GAAuB,EAAE,IAAI,EAAE,eAAe,EAAE,QAAQ,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC;YACvF,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAEjB,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;YAC/B,IAAI,QAAQ,EAAE;gBACV,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aAC7B;SACJ;IACL,CAAC;IAED,IAAI,YAAY;QACZ,OAAO,IAAI,CAAC,sBAAsB,CAAC,CAAC,CAAC,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC;IACnF,CAAC;IAED,IAAc,QAAQ;QAClB,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,mBAAS,CAAC,CAAC;IACvD,CAAC;IAED,MAAM;QAEF,KAAK,CAAC,MAAM,EAAE,CAAC;QAEf,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC/B,IAAI,QAAQ,IAAI,CAAC,QAAQ,CAAC,oBAAoB,EAAE;YAC5C,QAAQ,CAAC,oBAAoB,GAAG,IAAI,CAAC;SACxC;IACL,CAAC;IAED,MAAM,CAAC,OAAO;QAEV,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAEtC,IAAI,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,OAAO,EAAE;YAC3B,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;YAC/B,IAAI,QAAQ,EAAE;gBACV,QAAQ,CAAC,oBAAoB,GAAG,IAAI,CAAC;aACxC;SACJ;QAED,OAAO,OAAO,CAAC;IACnB,CAAC;IAED,OAAO;QAEH,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC/B,IAAI,QAAQ,IAAI,QAAQ,CAAC,oBAAoB,KAAK,IAAI,EAAE;YACpD,QAAQ,CAAC,oBAAoB,GAAG,IAAI,CAAC;SACxC;QAED,KAAK,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;IAED,YAAY,CAAC,OAA4B;IAEzC,CAAC;IAED,WAAW,CAAC,OAA4B;IAExC,CAAC;IAES,cAAc;QAEpB,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;QAChC,KAAK,CAAC,cAAc,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACvD,KAAK,CAAC,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACrD,OAAO,KAAK,CAAC;IACjB,CAAC;IAEO,eAAe,CAAC,QAA6B,EAAE,KAAkB,EAAE,MAAoB;QAE3F,QAAQ,CAAC,IAAI,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACnC,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC,YAAY,CAAC,CAAC;QAC3C,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC7B,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;QACvB,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAC;QAEzB,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;QAEjD,kBAAkB,CAAC,SAAS,GAAG,IAAI,CAAC;QACpC,IAAI,CAAC,IAAI,CAA0B,kBAAkB,CAAC,CAAC;IAC3D,CAAC;IAEO,cAAc,CAAC,QAA6B,EAAE,KAAkB,EAAE,MAAoB;QAE1F,QAAQ,CAAC,IAAI,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACnC,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC,YAAY,CAAC,CAAC;QAC3C,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC7B,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC;QACvB,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAC;QAEzB,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QAE/C,iBAAiB,CAAC,SAAS,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,IAAI,CAAyB,iBAAiB,CAAC,CAAC;IACzD,CAAC;;AAtHe,uBAAgB,GAAG,IAAI,CAAC;AAF5C,yBAyHC;AAED,MAAM,CAAC,SAAS,CAAC,YAAY,GAAG,IAAI,CAAC;AACrC,MAAM,CAAC,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC;;;;;;;;;;;;;;AClMpC;;;;;GAKG;;AAEH,wDAA+B;AAE/B,0HAAgD;AAEhD,wGAA8B;AAE9B,gFAAgF;AAEhF,MAAM,OAAO,GAAG;IACZ,QAAQ,EAAE,qBAAK,CAAC,MAAM,CAAC,gBAAgB,CAAC;IACxC,KAAK,EAAE,qBAAK,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,CAAC;IACrC,KAAK,EAAE,qBAAK,CAAC,MAAM,CAAC,aAAa,EAAE,EAAE,CAAC;IACtC,QAAQ,EAAE,qBAAK,CAAC,MAAM,CAAC,gBAAgB,EAAE,GAAG,CAAC;CAChD,CAAC;AAEF,MAAqB,UAAW,SAAQ,gBAAM;IAA9C;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAAyB,OAAO,CAAC,CAAC;IA6B1D,CAAC;IA1BG,IAAI,KAAK;QAEL,OAAO,IAAI,CAAC,QAA2B,CAAC;IAC5C,CAAC;IAED,MAAM;QAEF,KAAK,CAAC,MAAM,EAAE,CAAC;QACf,IAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,SAAS,EAAE,CAAC;IAC1C,CAAC;IAED,MAAM;QAEF,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAExE,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACnC,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC;QAClC,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC;QAChC,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;QAC1B,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;QAC1B,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC;QAEhC,KAAK,CAAC,YAAY,EAAE,CAAC;QACrB,OAAO,IAAI,CAAC;IAChB,CAAC;CACJ;AA/BD,6BA+BC;;;;;;;;;;;;;;ACrDD;;;;;GAKG;;AAEH,wDAA+B;AAE/B,0HAA+C;AAE/C,iHAAoC;AAEpC,gFAAgF;AAEhF,MAAM,OAAO,GAAG;IACZ,MAAM,EAAE,qBAAK,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE,CAAC;IAClC,IAAI,EAAE,qBAAK,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,CAAC;IAC7B,KAAK,EAAE,qBAAK,CAAC,MAAM,CAAC,OAAO,EAAE,GAAG,CAAC;IACjC,QAAQ,EAAE,qBAAK,CAAC,OAAO,CAAC,UAAU,EAAE,CAAE,EAAE,EAAE,EAAE,CAAE,CAAC;CAClD,CAAC;AAEF,MAAqB,MAAO,SAAQ,mBAAS;IAA7C;;QAEI,QAAG,GAAG,IAAI,CAAC,SAAS,CAA4B,OAAO,CAAC,CAAC;IAc7D,CAAC;IAZG,MAAM;QAEF,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAEnD,IAAI,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,mBAAmB,CACzC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,EACxB,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EACpC,KAAK,CAAC,KAAK,CACd,CAAC;QAEF,OAAO,IAAI,CAAC;IAChB,CAAC;CACJ;AAhBD,yBAgBC;;;;;;;;;;;;;;ACtCD;;;;;GAKG;;AAEH,wDAA+B;AAE/B,6FAAiC;AAEjC,0HAAgD;AAChD,uIAAyD;AAGzD,gFAAgF;AAEhF,MAAM,MAAM,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;AACnC,MAAM,MAAM,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;AACnC,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,UAAU,EAAE,CAAC;AACrC,MAAM,MAAM,GAAG,IAAI,KAAK,CAAC,KAAK,EAAE,CAAC;AAGjC,IAAY,cAA+C;AAA3D,WAAY,cAAc;IAAG,iDAAG;IAAE,iDAAG;IAAE,iDAAG;IAAE,iDAAG;IAAE,iDAAG;IAAE,iDAAG;AAAC,CAAC,EAA/C,cAAc,GAAd,sBAAc,KAAd,sBAAc,QAAiC;AAO3D,MAAM,OAAO,GAAG;IACZ,QAAQ,EAAE,qBAAK,CAAC,OAAO,CAAC,oBAAoB,CAAC;IAC7C,QAAQ,EAAE,qBAAK,CAAC,OAAO,CAAC,oBAAoB,CAAC;IAC7C,KAAK,EAAE,qBAAK,CAAC,IAAI,CAAC,iBAAiB,EAAE,cAAc,CAAC;IACpD,KAAK,EAAE,qBAAK,CAAC,OAAO,CAAC,iBAAiB,EAAE,CAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAE,CAAC;CACvD,CAAC;AAEF,MAAM,QAAQ,GAAG;IACb,MAAM,EAAE,qBAAK,CAAC,OAAO,CAAC,kBAAkB,CAAC;CAC5C,CAAC;AAEF;;;;GAIG;AACH,MAAqB,UAAW,SAAQ,oBAAU;IAO9C,YAAY,EAAU;QAElB,KAAK,CAAC,EAAE,CAAC,CAAC;QAPd,QAAG,GAAG,IAAI,CAAC,SAAS,CAA6B,OAAO,CAAC,CAAC;QAC1D,SAAI,GAAG,IAAI,CAAC,UAAU,CAA8B,QAAQ,CAAC,CAAC;QAQ1D,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;QACvC,IAAI,CAAC,SAAS,CAAC,gBAAgB,GAAG,KAAK,CAAC;IAC5C,CAAC;IAED,IAAI,SAAS;QACT,OAAO,IAAI,CAAC;IAChB,CAAC;IAED;;OAEG;IACH,IAAI,QAAQ;QAER,OAAO,IAAI,CAAC,SAAS,CAAC;IAC1B,CAAC;IAED;;OAEG;IACH,IAAI,QAAQ;QAER,OAAO,IAAI,CAAC,SAAyB,IAAI,EAAE,CAAC;IAChD,CAAC;IAED;;OAEG;IACH,IAAI,MAAM;QAEN,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;IACjC,CAAC;IAED,MAAM,CAAC,OAAO;QAEV,MAAM,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC;QAChC,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QACtD,MAAM,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC;QAE7B,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAC5C,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,cAAc,CAAC,cAAI,CAAC,OAAO,CAAC,CAAC;QAC9D,MAAM,SAAS,GAAG,KAAK,CAAC,aAAa,EAAE,CAAC;QACxC,QAAQ,CAAC,QAAQ,CAAC,cAAc,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;QACpD,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACtC,QAAQ,CAAC,YAAY,EAAE,CAAC;QAEvB,QAAQ,CAAC,MAAc,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAC/C,MAAM,CAAC,GAAG,EAAE,CAAC;QAEb,OAAO,IAAI,CAAC;IAChB,CAAC;IAED,OAAO;QAEH,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACjB,OAAO;SACV;QAED,0DAA0D;QAC1D,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE;YACvB,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SAChD;QACD,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;QAE/E,KAAK,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;IAED,aAAa,CAAC,MAAqB;QAE/B,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC;QAEtD,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;QACxC,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAE/B,MAAM,SAAS,GAAG,KAAK,CAAC,aAAa,EAAE,CAAC;QACxC,MAAM,CAAC,iBAAiB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;QAC3C,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QACzB,MAAM,CAAC,cAAc,CAAC,cAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAE5D,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAE5B,QAAQ,CAAC,GAAG,EAAE,CAAC;QACf,QAAQ,CAAC,GAAG,EAAE,CAAC;QACf,KAAK,CAAC,GAAG,EAAE,CAAC;IAChB,CAAC;IAGD;;;OAGG;IACH,QAAQ,CAAC,SAAqB;QAE1B,KAAK,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QAC1B,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;IAC5C,CAAC;IAED;;;OAGG;IACH,WAAW,CAAC,SAAqB;QAE7B,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QAC3C,KAAK,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;IACjC,CAAC;IAED,MAAM;IACN,kGAAkG;IAClG,gCAAgC;IAChC,mBAAmB;IACnB,MAAM;IACN,sCAAsC;IACtC,IAAI;IACJ,kCAAkC;IAClC,IAAI;IACJ,EAAE;IACF,MAAM;IACN,oGAAoG;IACpG,gCAAgC;IAChC,mBAAmB;IACnB,MAAM;IACN,yCAAyC;IACzC,IAAI;IACJ,qCAAqC;IACrC,IAAI;IAEM,cAAc;QAEpB,OAAO,IAAI,KAAK,CAAC,QAAQ,EAAE,CAAC;IAChC,CAAC;CACJ;AA7ID,6BA6IC;;;;;;;;;;;;;;AC3LD;;;;;GAKG;;AAEH,gIAA8C;AAyB1C,yBAzBG,wBAAc,CAyBH;AAxBlB,kGAA0B;AAyBtB,eAzBG,cAAI,CAyBH;AAxBR,2GAAgC;AAyB5B,kBAzBG,iBAAO,CAyBH;AAxBX,yIAAoD;AAyBhD,4BAzBG,2BAAiB,CAyBH;AAxBrB,iHAAoC;AAyBhC,oBAzBG,mBAAS,CAyBH;AAxBb,qGAA4B;AAyBxB,gBAzBG,eAAK,CAyBH;AAxBT,wGAA8B;AAyB1B,iBAzBG,gBAAM,CAyBH;AAxBV,qGAA4B;AAyBxB,gBAzBG,eAAK,CAyBH;AAxBT,iHAAoC;AAyBhC,oBAzBG,mBAAS,CAyBH;AAxBb,qGAA4B;AAyBxB,gBAzBG,eAAK,CAyBH;AAxBT,iHAAoC;AAyBhC,oBAzBG,mBAAS,CAyBH;AAxBb,yIAAoD;AAyBhD,4BAzBG,2BAAiB,CAyBH;AAxBrB,gIAA8C;AAyB1C,yBAzBG,wBAAc,CAyBH;AAxBlB,gIAA8C;AAyB1C,yBAzBG,wBAAc,CAyBH;AAxBlB,uHAAwC;AAyBpC,sBAzBG,qBAAW,CAyBH;AAxBf,iHAAoC;AAyBhC,oBAzBG,mBAAS,CAyBH;AAxBb,0HAA0C;AAyBtC,uBAzBG,sBAAY,CAyBH;AAxBhB,wGAA8B;AAyB1B,iBAzBG,gBAAM,CAyBH;AAxBV,oHAAsC;AAyBlC,qBAzBG,oBAAU,CAyBH;AAxBd,wGAA8B;AAyB1B,iBAzBG,gBAAM,CAyBH;AAxBV,oHAAsC;AAyBlC,qBAzBG,oBAAU,CAyBH;AAGD,sBAAc,GAAG;IAC1B,wBAAc;IACd,cAAI;IACJ,iBAAO;IACP,wBAAc;IACd,2BAAiB;IACjB,eAAK;IACL,eAAK;IACL,eAAK;IACL,2BAAiB;IACjB,wBAAc;IACd,qBAAW;IACX,mBAAS;IACT,sBAAY;IACZ,gBAAM;IACN,oBAAU;IACV,gBAAM;IACN,oBAAU;CACb,CAAC;;;;;;;;;;;;;;ACzEF;;;;;GAKG;;AAEH,wDAA+B;AAC/B,gGAAoD;AAEpD,gFAAgF;AAEhF,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;AAClC,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,OAAO,EAAE,CAAC;AAUlC;;GAEG;AACH,MAAqB,OAAQ,SAAQ,KAAK,CAAC,YAAY;IAOnD,YAAY,MAAsB,EAAE,KAAqB;QAErD,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,OAAO,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;QAEvD,MAAM,GAAG,GAAG,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC;QAC7B,GAAG,CAAC,SAAS,EAAE,CAAC;QAEhB,iCAAuB,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;QAErC,MAAM,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;QAC5B,MAAM,GAAG,GAAG,CAAE,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,CAAE,CAAC;QAChD,MAAM,GAAG,GAAG,CAAE,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,CAAE,CAAC;QAChD,MAAM,IAAI,GAAG,CAAE,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,CAAE,CAAC;QACpG,IAAI,QAAQ,CAAC;QAEb,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE;YAC7D,QAAQ,GAAG;gBACP,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;gBAExD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;gBAExD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;gBAExD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;gBAExD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;gBAExD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC;gBAExD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;gBACxD,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,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,WAAW,QAAQ;AACnB,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA,uCAAuC,WAAW,EAAE;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,qBAAqB;AACjC,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAAO,2EAA2E;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA,cAAc,EAAE;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,cAAc;AAC1B,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,uBAAuB,sCAAsC;AACxE,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,kBAAkB,mBAAO,CAAC,mEAAkB;AAC5C;AACA;AACA;AACA,mBAAmB,mBAAO,CAAC,mGAAkC;AAC7D;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA,eAAe,8BAA8B;AAC7C;AACA;AACA;;;AAGA;AACA;AACA;AACA,mBAAmB;AACnB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;;;;;;;;;;;AC/ea;;;AAGb;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;;;;;;;;;;;;;ACzBa;;AAEb,sBAAsB,mBAAO,CAAC,4EAAiB;;AAE/C;;;AAGA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,QAAQ,4CAA4C;AAC/D,WAAW,SAAS;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,mBAAmB,mBAAmB,EAAE;AACxC;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA,uCAAuC,gBAAgB;AACvD;AACA;;;AAGA;AACA,SAAS,iCAAiC;AAC1C;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AA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A;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;;;;;;;;;;;ACpJa;;AAEb,cAAc,mBAAO,CAAC,gEAAW;AACjC,WAAW,mBAAO,CAAC,0DAAQ;AAC3B,mBAAmB,mBAAO,CAAC,4EAAiB;AAC5C,sBAAsB,mBAAO,CAAC,0FAA4B;;AAE1D,wBAAwB,mBAAO,CAAC,uEAAmB;;AAEnD;AACA;AACA;;AAEA;AACA,YAAY,mBAAO,CAAC,oEAAiB;;AAErC;AACA;;AAEA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kBAAkB;;AAElB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,cAAc,EAAE;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe;AACf,eAAe;AACf;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA,eAAe,6BAA6B;AAC5C;AACA;AACA;AACA;AACA;;;AAGA;AACA,sFAAsF;AACtF;;;AAGA;AACA,qDAAqD;AACrD;;;AAGA;AACA,iFAAiF;AACjF;;;AAGA;AACA,2DAA2D;AAC3D;;;AAGA;AACA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;AACA;;;;;;;;;;;;;AC1Xa;;AAEb,UAAU,mBAAO,CAAC,6DAAQ;AAC1B,YAAY,mBAAO,CAAC,oEAAiB;AACrC,WAAW,mBAAO,CAAC,0DAAQ;AAC3B,mBAAmB,mBAAO,CAAC,sEAAc;AACzC,eAAe,mBAAO,CAAC,8EAAsB;;AAE7C;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,SAAS;AACrB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,gBAAgB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,iBAAiB;AACjB,mBAAmB;AACnB;AACA;;AAEA,oBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;;;;;;;;;;;;AC7Qa;;AAEb,kBAAkB,mBAAO,CAAC,2DAAU;AACpC,aAAa,mBAAO,CAAC,0DAAQ;;AAE7B;AACA;AACA,KAAK;AACL,gBAAgB,kCAAkC;AAClD,gBAAgB,kCAAkC,2BAA2B;AAC7E,KAAK;AACL,gEAAgE;AAChE,KAAK;AACL,6EAA6E;AAC7E,KAAK;AACL;AACA,gBAAgB,8DAA8D,IAAI;AAClF,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;;;;;;;;;;;;ACjEa;;AAEb,WAAW,mBAAO,CAAC,0DAAQ;;AAE3B;;AAEA;AACA;AACA;;;;;;;;;;;;;ACRa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA;;;;;;;;;;;;;ACnBa;;;AAGb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,mBAAO,CAAC,oEAAiB;AAClC,cAAc,mBAAO,CAAC,sEAAc;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,iBAAiB,oBAAoB;AACrC;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA,0BAA0B,IAAI;AAC9B,2CAA2C,KAAK;AAChD,+CAA+C,KAAK;AACpD;AACA;AACA;AACA;AACA;;;AAGA;AACA,oCAAoC,oBAAoB,2BAA2B;AACnF,0CAA0C,oBAAoB;AAC9D,wCAAwC;AACxC,0CAA0C,aAAa;AACvD,oDAAoD,6CAA6C;AACjG,qCAAqC;AACrC;AACA,qEAAqE;;AAErE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;;;;;;;;;;;;;AC1Qa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe,+BAA+B;AAC9C;AACA;AACA;AACA;AACA,aAAa,mBAAmB;AAChC;;AAEA,aAAa,mBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;AChDa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE;AACvE;AACA,sCAAsC,6DAA6D,uHAAuH;AAC1N;AACA;AACA;AACA,aAAa;AACb;AACA,gBAAgB,8LAA8L;AAC9M;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,KAAK;AACL,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D,OAAO;AACP,qDAAqD,cAAc;AACnE;AACA,KAAK;AACL,yCAAyC,wCAAwC,wBAAwB,UAAU;AACnH;AACA,cAAc;AACd;AACA;AACA;AACA,ihBAAihB,sFAAsF;AACvmB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oRAAoR;AACpR,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gHAAgH;AAChH;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,cAAc,oLAAoL,gGAAgG;AAClS;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D,KAAK;AACL,mDAAmD,cAAc;AACjE;AACA,GAAG;AACH,uCAAuC,wCAAwC,wBAAwB,UAAU;AACjH;AACA,YAAY;AACZ;AACA,mBAAmB;AACnB;AACA;AACA;;;;;;;;;;;;;AC5Ja;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE;AACzE;AACA;AACA;AACA,WAAW;AACX;AACA,cAAc,yLAAyL,gCAAgC;AACvO;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D,KAAK;AACL,mDAAmD,cAAc;AACjE;AACA,GAAG;AACH,uCAAuC,wCAAwC,wBAAwB,UAAU;AACjH;AACA,WAAW;AACX;AACA,mBAAmB;AACnB;AACA;AACA;;;;;;;;;;;;;AC5Ea;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA,WAAW;AACX;AACA,cAAc,0LAA0L,gCAAgC;AACxO;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D,KAAK;AACL,mDAAmD,cAAc;AACjE;AACA,GAAG;AACH,uCAAuC,wCAAwC,wBAAwB,UAAU;AACjH;AACA,WAAW;AACX;AACA,mBAAmB;AACnB;AACA;AACA;;;;;;;;;;;;;ACjFa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sFAAsF;AACtF;AACA;AACA;AACA,WAAW;AACX;AACA,cAAc,8LAA8L,gCAAgC;AAC5O;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D,KAAK;AACL,mDAAmD,cAAc;AACjE;AACA,GAAG;AACH,uCAAuC,wCAAwC,wBAAwB,UAAU;AACjH;AACA,WAAW;AACX;AACA,mBAAmB;AACnB;AACA;AACA;;;;;;;;;;;;;AC5Ea;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC1Ca;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,0CAA0C,8BAA8B;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,yBAAyB;AACtG,4BAA4B;AAC5B;AACA;AACA;AACA,8DAA8D,iBAAiB;AAC/E;AACA,gBAAgB,mKAAmK;AACnL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,KAAK;AACL,iBAAiB;AACjB;AACA,aAAa,wCAAwC,wBAAwB,UAAU;AACvF;AACA;AACA;AACA,oDAAoD;AACpD,OAAO;AACP,2CAA2C,cAAc;AACzD;AACA;AACA,cAAc,OAAO,2BAA2B,wBAAwB,uDAAuD,qBAAqB,EAAE;AACtJ;AACA,gBAAgB;AAChB;AACA;AACA,GAAG;AACH;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;;;;;;;;;;;;;ACzEa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C,GAAG;AACH,6HAA6H;AAC7H;AACA;AACA;;;;;;;;;;;;;ACba;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA;AACA,6EAA6E;AAC7E;AACA,8EAA8E,yBAAyB;AACvG;AACA;AACA,WAAW;AACX;AACA,cAAc,kKAAkK,qCAAqC;AACrN;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D,KAAK;AACL,mDAAmD,cAAc;AACjE;AACA,GAAG;AACH,uCAAuC,wCAAwC,wBAAwB,UAAU;AACjH;AACA,YAAY;AACZ;AACA,mBAAmB;AACnB;AACA;AACA;;;;;;;;;;;;;ACvDa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,qBAAqB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,6BAA6B,yCAAyC,oBAAoB;AACxI;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,6DAA6D;AAC7D;AACA,6CAA6C,EAAE;AAC/C;AACA,kEAAkE;AAClE,GAAG;AACH,+CAA+C;AAC/C;AACA;AACA;AACA,WAAW;AACX;AACA,cAAc,sKAAsK;AACpL;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D,KAAK;AACL,mDAAmD,cAAc;AACjE;AACA,GAAG;AACH,uCAAuC,wCAAwC,wBAAwB,UAAU;AACjH;AACA,YAAY,OAAO;AACnB;AACA,uCAAuC,wBAAwB,uDAAuD,qBAAqB,EAAE;AAC7I;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;;;;;;;;;;;;;ACjFa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yFAAyF,8DAA8D;AACvJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA,uCAAuC,qBAAqB;AAC5D;AACA,wBAAwB;AACxB,wDAAwD,yBAAyB,EAAE,OAAO;AAC1F;AACA,0BAA0B;AAC1B,+FAA+F,wBAAwB;AACvH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,mEAAmE;AACnE;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C,KAAK;AACL;AACA;AACA,gDAAgD,MAAM,yDAAyD,EAAE,YAAY,0BAA0B,kEAAkE,cAAc,EAAE;AACzO,OAAO;AACP,4CAA4C,mDAAmD;AAC/F;AACA;AACA;AACA;AACA,+GAA+G;AAC/G;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,gBAAgB,oLAAoL,uCAAuC;AAC3O;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,KAAK;AACL,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D,OAAO;AACP,qDAAqD,cAAc;AACnE;AACA,KAAK;AACL,yCAAyC,wCAAwC,wBAAwB,UAAU;AACnH;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,qBAAqB,kBAAkB,gDAAgD,0HAA0H,mDAAmD,4DAA4D,EAAE;AAC5X;AACA,wEAAwE,2CAA2C;AACnH;AACA,oBAAoB;AACpB;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT,mDAAmD,4BAA4B,OAAO,wCAAwC,qBAAqB,kBAAkB,gDAAgD,0HAA0H,mDAAmD,4DAA4D,EAAE;AAChc;AACA,wEAAwE,2CAA2C;AACnH;AACA,oBAAoB,EAAE;AACtB;AACA;AACA,KAAK;AACL,+BAA+B;AAC/B;AACA,kBAAkB,oLAAoL,uCAAuC;AAC7O;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,OAAO;AACP,mBAAmB;AACnB;AACA,eAAe,wCAAwC,wBAAwB,UAAU;AACzF;AACA;AACA;AACA,sDAAsD;AACtD,SAAS;AACT,6CAA6C,cAAc;AAC3D;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP,0DAA0D,qDAAqD,oDAAoD,yBAAyB,wCAAwC,qBAAqB,kBAAkB,gDAAgD,0HAA0H,6DAA6D;AAClf;AACA,sEAAsE,2CAA2C;AACjH;AACA,kBAAkB,EAAE,OAAO,4BAA4B;AACvD;AACA;AACA,cAAc;AACd;AACA,qBAAqB;AACrB;AACA;AACA;AACA;;;;;;;;;;;;;ACnOa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,oBAAoB,yKAAyK,yOAAyO;AACta;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,SAAS;AACT,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE;AAClE,WAAW;AACX,yDAAyD,cAAc;AACvE;AACA,SAAS;AACT,6CAA6C,wCAAwC,wBAAwB,UAAU;AACvH;AACA,OAAO;AACP,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA,wBAAwB,yKAAyK,yOAAyO;AAC1a;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB,aAAa;AACb,yBAAyB;AACzB;AACA,qBAAqB,wCAAwC,wBAAwB,UAAU,EAAE;AACjG;AACA;AACA;AACA,gBAAgB;AAChB;AACA,4BAA4B;AAC5B,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,4CAA4C;AAC5C,4BAA4B;AAC5B;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA;AACA;AACA;;;;;;;;;;;;;ACvKa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,2EAA2E;AAC3E;AACA,+BAA+B;AAC/B;AACA,6EAA6E,yEAAyE,OAAO;AAC7J;AACA,mCAAmC,wBAAwB,wCAAwC,gFAAgF,yBAAyB,OAAO,EAAE;AACrN;AACA,eAAe;AACf;AACA,mCAAmC;AACnC;AACA;AACA,WAAW;AACX;AACA,cAAc,iKAAiK,sCAAsC;AACrN;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D,KAAK;AACL,mDAAmD,cAAc;AACjE;AACA,GAAG;AACH,uCAAuC,wCAAwC,wBAAwB,UAAU;AACjH;AACA,YAAY;AACZ;AACA,mBAAmB;AACnB;AACA;AACA;;;;;;;;;;;;;ACjEa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,0IAA0I,yFAAyF,2BAA2B;AACnU;AACA,iEAAiE;AACjE;AACA,4DAA4D,EAAE;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,4DAA4D;AAC5D,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,OAAO;AACP;AACA,8BAA8B;AAC9B;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE;AACpE,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,cAAc,mKAAmK;AACjL;AACA;AACA,KAAK;AACL;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D,KAAK;AACL,mDAAmD,cAAc;AACjE;AACA,GAAG;AACH,uCAAuC,wCAAwC,wBAAwB,UAAU;AACjH;AACA,YAAY;AACZ;AACA,mBAAmB;AACnB;AACA;AACA;;;;;;;;;;;;;ACrJa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,6BAA6B;AACvE;AACA;AACA;AACA;AACA;AACA,uCAAuC,wBAAwB,uDAAuD,qBAAqB,EAAE;AAC7I;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA,oDAAoD;AACpD,OAAO;AACP;AACA;AACA,gBAAgB;AAChB;AACA,uBAAuB;AACvB;AACA,KAAK;AACL,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA,oDAAoD;AACpD,OAAO;AACP;AACA;AACA,gBAAgB;AAChB;AACA,qCAAqC,iBAAiB;AACtD;AACA,gBAAgB,+JAA+J,sCAAsC;AACrN;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,KAAK;AACL,iBAAiB;AACjB;AACA,aAAa,wCAAwC,wBAAwB,UAAU;AACvF;AACA;AACA;AACA,oDAAoD;AACpD,OAAO;AACP,2CAA2C,cAAc;AACzD;AACA;AACA,cAAc;AACd;AACA,qBAAqB;AACrB;AACA;AACA,GAAG;AACH;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;;;;;;;;;;;;;ACvGa;;AAEb;AACA;AACA,UAAU,mBAAO,CAAC,sDAAO;AACzB,SAAS,mBAAO,CAAC,0DAAS;AAC1B,SAAS,mBAAO,CAAC,0DAAS;AAC1B,cAAc,mBAAO,CAAC,8DAAW;AACjC,SAAS,mBAAO,CAAC,0DAAS;AAC1B,YAAY,mBAAO,CAAC,gEAAY;AAChC,gBAAgB,mBAAO,CAAC,wEAAgB;AACxC,UAAU,mBAAO,CAAC,wDAAQ;AAC1B,UAAU,mBAAO,CAAC,4DAAU;AAC5B,QAAQ,mBAAO,CAAC,oDAAM;AACtB,SAAS,mBAAO,CAAC,0DAAS;AAC1B,WAAW,mBAAO,CAAC,4DAAU;AAC7B,WAAW,mBAAO,CAAC,4DAAU;AAC7B,YAAY,mBAAO,CAAC,sEAAe;AACnC,YAAY,mBAAO,CAAC,sEAAe;AACnC,aAAa,mBAAO,CAAC,wEAAgB;AACrC,aAAa,mBAAO,CAAC,wEAAgB;AACrC,iBAAiB,mBAAO,CAAC,gFAAoB;AAC7C,iBAAiB,mBAAO,CAAC,gFAAoB;AAC7C,cAAc,mBAAO,CAAC,oEAAc;AACpC,OAAO,mBAAO,CAAC,sDAAO;AACtB,SAAS,mBAAO,CAAC,0DAAS;AAC1B,WAAW,mBAAO,CAAC,8DAAW;AAC9B,cAAc,mBAAO,CAAC,oEAAc;AACpC,iBAAiB,mBAAO,CAAC,0EAAiB;AAC1C,YAAY,mBAAO,CAAC,gEAAY;AAChC,eAAe,mBAAO,CAAC,sEAAe;AACtC,YAAY,mBAAO,CAAC,gEAAY;AAChC;;;;;;;;;;;;;AChCa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,qBAAqB;AAC5D;AACA;AACA;AACA,qFAAqF;AACrF;AACA;AACA,wCAAwC;AACxC;AACA;AACA,eAAe;AACf;AACA,kBAAkB,4KAA4K,kCAAkC;AAChO;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,OAAO;AACP,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE;AAChE,SAAS;AACT,uDAAuD,cAAc;AACrE;AACA,OAAO;AACP,2CAA2C,wCAAwC,wBAAwB,UAAU;AACrH;AACA,gBAAgB;AAChB;AACA;AACA,4BAA4B;AAC5B,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,6CAA6C;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,mEAAmE;AACnE;AACA,oBAAoB;AACpB;AACA,gDAAgD;AAChD,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,yDAAyD,qDAAqD,yCAAyC,oBAAoB;AACtN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,+DAA+D;AAC/D;AACA;AACA,kDAAkD;AAClD;AACA,gBAAgB,EAAE;AAClB;AACA,4CAA4C;AAC5C,4BAA4B;AAC5B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,oDAAoD,yCAAyC,oBAAoB;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,6DAA6D;AAC7D;AACA;AACA,gDAAgD;AAChD;AACA,cAAc;AACd;AACA;AACA,sEAAsE;AACtE;AACA;AACA;AACA;;;;;;;;;;;;;AC5Ia;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,WAAW;AACX;AACA,cAAc,uKAAuK,qCAAqC;AAC1N;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D,KAAK;AACL,mDAAmD,cAAc;AACjE;AACA,GAAG;AACH,uCAAuC,wCAAwC,wBAAwB,UAAU;AACjH;AACA,WAAW;AACX;AACA,mBAAmB;AACnB;AACA;AACA;;;;;;;;;;;;;AC5Ea;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA,aAAa;AACb;AACA,gBAAgB,iKAAiK;AACjL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,KAAK;AACL,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D,OAAO;AACP,qDAAqD,cAAc;AACnE;AACA,KAAK;AACL,yCAAyC,wCAAwC,wBAAwB,UAAU;AACnH;AACA,cAAc,OAAO,2BAA2B,wBAAwB,uDAAuD,qBAAqB,EAAE;AACtJ;AACA,gBAAgB;AAChB;AACA,GAAG;AACH,4BAA4B;AAC5B;AACA,gBAAgB,iKAAiK;AACjL;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,KAAK;AACL,iBAAiB;AACjB;AACA,aAAa,wCAAwC,wBAAwB,UAAU;AACvF;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;;;;;;;;;;;;;ACnFa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oIAAoI;AACpI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,iDAAiD;AACjD;AACA;AACA,oEAAoE,0BAA0B,uEAAuE,EAAE,OAAO;AAC9K,4BAA4B;AAC5B;AACA,0CAA0C,gDAAgD,0CAA0C,EAAE;AACtI;AACA;AACA;AACA,0DAA0D,iBAAiB;AAC3E;AACA,cAAc,kKAAkK,4CAA4C;AAC5N;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH,eAAe;AACf;AACA,WAAW,wCAAwC,wBAAwB,UAAU;AACrF;AACA;AACA;AACA,kDAAkD;AAClD,KAAK;AACL,yCAAyC,cAAc;AACvD;AACA;AACA,WAAW,OAAO,2BAA2B,wBAAwB,uDAAuD,qBAAqB,EAAE;AACnJ;AACA,cAAc;AACd;AACA;AACA;;;;;;;;;;;;;ACxEa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA,WAAW;AACX;AACA,cAAc,oKAAoK;AAClL;AACA;AACA,KAAK;AACL;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,cAAc;AACd,GAAG;AACH,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D,KAAK;AACL,mDAAmD,cAAc;AACjE;AACA,GAAG;AACH,uCAAuC,wCAAwC,wBAAwB,UAAU;AACjH;AACA,WAAW;AACX;AACA,mBAAmB;AACnB;AACA;AACA;;;;;;;;;;;;;AC1Ea;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,gCAAgC;AACvE;AACA,uDAAuD;AACvD;AACA;AACA;AACA,qGAAqG,2BAA2B,iDAAiD,oBAAoB,gEAAgE;AACrQ,KAAK;AACL,4DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,kCAAkC;AACnD;AACA;AACA,sDAAsD;AACtD,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D,SAAS;AACT,gDAAgD;AAChD;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA,sBAAsB,iLAAiL,wDAAwD;AAC/P;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB,WAAW;AACX,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE;AACpE,aAAa;AACb,2DAA2D,cAAc;AACzE;AACA,WAAW;AACX,+CAA+C,wCAAwC,wBAAwB,UAAU;AACzH;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA,OAAO;AACP;AACA,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,mEAAmE;AACnE;AACA,+CAA+C,0BAA0B,gCAAgC,6CAA6C,6BAA6B,EAAE,wCAAwC,EAAE;AAC/N;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,mEAAmE;AACnE;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,cAAc;AACd;AACA,0CAA0C;AAC1C,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,mEAAmE;AACnE;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,yBAAyB,8BAA8B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA,0BAA0B,qKAAqK,kDAAkD;AACjP;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,eAAe;AACf,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE;AACxE,iBAAiB;AACjB,+DAA+D,cAAc;AAC7E;AACA,eAAe;AACf,mDAAmD,wCAAwC,wBAAwB,UAAU;AAC7H;AACA;AACA;AACA,wBAAwB,OAAO;AAC/B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,2BAA2B,6BAA6B,EAAE,OAAO;AACjE,eAAe;AACf;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA,8CAA8C;AAC9C,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G,2BAA2B,iDAAiD,oBAAoB,gEAAgE;AAC3Q,WAAW;AACX,kEAAkE;AAClE;AACA,kFAAkF;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,mEAAmE;AACnE;AACA;AACA,sDAAsD;AACtD;AACA,oBAAoB;AACpB;AACA,sDAAsD;AACtD;AACA,oBAAoB;AACpB;AACA,gDAAgD;AAChD,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE;AACtE;AACA;AACA;AACA;;;;;;;;;;;;;ACzUa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA,qGAAqG,2BAA2B,iDAAiD,oBAAoB,gEAAgE;AACrQ,KAAK;AACL,4DAA4D;AAC5D;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,6DAA6D;AAC7D;AACA;AACA,yCAAyC,+CAA+C,qBAAqB,kBAAkB,qDAAqD,EAAE,iBAAiB;AACvM;AACA,gBAAgB,0KAA0K,2CAA2C;AACrO;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,KAAK;AACL,iBAAiB;AACjB;AACA,aAAa,wCAAwC,wBAAwB,UAAU;AACvF;AACA;AACA;AACA,oDAAoD;AACpD,OAAO;AACP,2CAA2C,cAAc;AACzD;AACA;AACA;AACA,qBAAqB;AACrB;AACA,cAAc,EAAE;AAChB;AACA;AACA,sEAAsE;AACtE;AACA;AACA;AACA;;;;;;;;;;;;;ACjFa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,oBAAoB,iKAAiK,mDAAmD;AACxO;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,SAAS;AACT,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE;AAClE,WAAW;AACX,yDAAyD,cAAc;AACvE;AACA,SAAS;AACT,6CAA6C,wCAAwC,wBAAwB,UAAU;AACvH;AACA;AACA,+BAA+B;AAC/B;AACA,OAAO;AACP;AACA;AACA,8BAA8B;AAC9B;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA,oBAAoB,gCAAgC;AACpD;AACA,yCAAyC;AACzC;AACA,gBAAgB,YAAY,8CAA8C,0CAA0C,yCAAyC,yBAAyB;AACtL;AACA,0CAA0C;AAC1C;AACA,gBAAgB;AAChB;AACA,wCAAwC;AACxC;AACA,KAAK;AACL,+CAA+C,2DAA2D,0DAA0D,yBAAyB,EAAE;AAC/L;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC3Ha;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,iFAAiF;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,mFAAmF,yEAAyE,OAAO;AACnK;AACA,2CAA2C,0CAA0C,kBAAkB;AACvG;AACA;AACA;AACA,iBAAiB,8BAA8B,EAAE;AACjD;AACA,qBAAqB;AACrB;AACA,0CAA0C;AAC1C;AACA;AACA,iBAAiB;AACjB;AACA,oBAAoB,qKAAqK,kDAAkD;AAC3O;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,SAAS;AACT,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE;AAClE,WAAW;AACX,yDAAyD,cAAc;AACvE;AACA,SAAS;AACT,6CAA6C,wCAAwC,wBAAwB,UAAU;AACvH;AACA,kBAAkB,OAAO;AACzB,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,oBAAoB,qKAAqK,kDAAkD;AAC3O;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,SAAS;AACT,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE;AAClE,WAAW;AACX,yDAAyD,cAAc;AACvE;AACA,SAAS;AACT,6CAA6C,wCAAwC,wBAAwB,UAAU;AACvH;AACA,kBAAkB,OAAO;AACzB;AACA,KAAK;AACL;AACA;AACA,iFAAiF;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kFAAkF,gBAAgB;AAClG;AACA,sBAAsB,qKAAqK,kDAAkD;AAC7O;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB,WAAW;AACX,uBAAuB;AACvB;AACA,mBAAmB,wCAAwC,wBAAwB,UAAU,EAAE,6CAA6C;AAC5I;AACA,2CAA2C,0CAA0C,kBAAkB;AACvG;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA,oBAAoB,qKAAqK,kDAAkD;AAC3O;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,SAAS;AACT,qBAAqB;AACrB;AACA,iBAAiB,wCAAwC,wBAAwB,UAAU,EAAE,EAAE;AAC/F;AACA,qBAAqB;AACrB;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA,wBAAwB,qKAAqK,kDAAkD;AAC/O;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB,aAAa;AACb,yBAAyB;AACzB;AACA,qBAAqB,wCAAwC,wBAAwB,UAAU,EAAE;AACjG;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,wBAAwB;AACxB;AACA;AACA;;;;;;;;;;;;;AC7Qa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA2G;AAC3G;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,oCAAoC,uGAAuG,iFAAiF,OAAO;AACnO;AACA,0EAA0E,aAAa;AACvF;AACA;AACA;AACA,4BAA4B,IAAI,GAAG,YAAY,KAAK,GAAG,qDAAqD,0BAA0B,aAAa,EAAE,EAAE,EAAE;AACzJ,KAAK;AACL,mCAAmC,OAAO,OAAO,IAAI,GAAG,+BAA+B;AACvF;AACA,iFAAiF;AACjF;AACA,oEAAoE;AACpE;AACA,4DAA4D,0BAA0B,uBAAuB,OAAO,EAAE,uBAAuB,EAAE;AAC/I;AACA,cAAc;AACd;AACA,iBAAiB;AACjB;AACA,qCAAqC;AACrC;AACA;AACA,aAAa;AACb;AACA,gBAAgB,wKAAwK,aAAa;AACrM;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,gBAAgB;AAChB,KAAK;AACL,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D,OAAO;AACP,qDAAqD,cAAc;AACnE;AACA,KAAK;AACL,yCAAyC,wCAAwC,wBAAwB,UAAU;AACnH;AACA,cAAc;AACd;AACA,qBAAqB;AACrB;AACA,GAAG;AACH;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;;;;;;;;;;;;;ACrFa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gFAAgF,gBAAgB;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,8CAA8C;AAC9C;AACA;AACA;AACA,eAAe;AACf;AACA,kBAAkB,2LAA2L;AAC7M;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB,OAAO;AACP,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE;AAChE,SAAS;AACT,uDAAuD,cAAc;AACrE;AACA,OAAO;AACP,2CAA2C,wCAAwC,wBAAwB,UAAU;AACrH;AACA,KAAK;AACL;AACA;AACA,+BAA+B;AAC/B,SAAS;AACT,0CAA0C,aAAa;AACvD;AACA,OAAO;AACP,6CAA6C;AAC7C;AACA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC,4BAA4B;AAC5B,yDAAyD;AACzD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E;AAC1E;AACA;AACA;AACA,kEAAkE;AAClE;AACA,4HAA4H;AAC5H;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D,mCAAmC;AACnC;AACA;AACA,6FAA6F,2DAA2D,8CAA8C,GAAG;AACzM;AACA;AACA,gJAAgJ,8DAA8D;AAC9M,aAAa;AACb;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,aAAa;AACb,0IAA0I,2FAA2F;AACrO,aAAa;AACb,qIAAqI;AACrI,aAAa;AACb,2MAA2M;AAC3M;AACA;AACA;AACA,kFAAkF;AAClF;AACA;AACA,iBAAiB;AACjB;AACA,oBAAoB,kLAAkL;AACtM;AACA;AACA,WAAW;AACX;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,SAAS;AACT,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE;AAClE,WAAW;AACX,yDAAyD,cAAc;AACvE;AACA,SAAS;AACT,6CAA6C,wCAAwC,wBAAwB,UAAU;AACvH;AACA,kBAAkB,OAAO;AACzB;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA,2FAA2F,EAAE;AAC7F,OAAO;AACP;AACA;AACA,iBAAiB;AACjB;AACA,oBAAoB,kLAAkL;AACtM;AACA;AACA,WAAW;AACX;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,SAAS;AACT,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE;AAClE,WAAW;AACX,yDAAyD,cAAc;AACvE;AACA,SAAS;AACT,6CAA6C,wCAAwC,wBAAwB,UAAU;AACvH;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,OAAO;AACP;AACA;AACA,iBAAiB;AACjB,2BAA2B;AAC3B;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oFAAoF;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA,0BAA0B,kLAAkL;AAC5M;AACA;AACA,iBAAiB;AACjB;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,eAAe;AACf,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE;AACxE,iBAAiB;AACjB,+DAA+D,cAAc;AAC7E;AACA,eAAe;AACf,mDAAmD,wCAAwC,wBAAwB,UAAU;AAC7H;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,uBAAuB;AACvB,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C,uDAAuD;AACvD,KAAK;AACL,yCAAyC;AACzC,mCAAmC;AACnC;AACA,eAAe,iBAAiB;AAChC,GAAG;AACH,mEAAmE;AACnE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;;;;;;;;;;;;;AChda;;AAEb;AACA,qBAAqB,mBAAO,CAAC,kEAAgB;;AAE7C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB;AACnB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,eAAe;AAC3B;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;AAC/B;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtIa;;AAEb;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB,WAAW;AACjC;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,oBAAoB,WAAW;AAC/B;;AAEA,oBAAoB,WAAW;AAC/B;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;ACtDa;;AAEb;AACA;AACA,4CAA4C;AAC5C;;AAEA;AACA;AACA;AACA,4BAA4B;AAC5B,4BAA4B;AAC5B;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;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A;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,SAAS;AACxB,eAAe,iBAAiB;AAChC;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,qBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,wBAAwB;AACnD;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,2BAA2B,cAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,OAAO;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,aAAa;AACb,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,SAAS,4BAA4B;AACjD;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;ACxgBA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;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AEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,kBAAkB,iBAAiB;;AAEnC;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,cAAc;;AAEhC,2CAA2C;AAC3C,iDAAiD;AACjD,2CAA2C;AAC3C,uCAAuC;;AAEvC;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;A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","file":"js/voyager-mini.dev.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./mini/ui/MainView.ts\");\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { ITypedEvent } from \"@ff/core/Publisher\";\n\nexport type PointerEventType = \"pointer-down\" | \"pointer-up\" | \"pointer-hover\" | \"pointer-move\";\nexport type TriggerEventType = \"wheel\" | \"double-click\" | \"context-menu\";\nexport type PointerEventSource = \"mouse\" | \"pen\" | \"touch\";\n\nexport interface IPointerPosition\n{\n    id: number;\n    clientX: number;\n    clientY: number;\n}\n\nexport interface IBaseEvent\n{\n    centerX: number;\n    centerY: number;\n    localX: number;\n    localY: number;\n\n    shiftKey: boolean;\n    ctrlKey: boolean;\n    altKey: boolean;\n    metaKey: boolean;\n}\n\nexport interface IPointerEvent extends IBaseEvent, ITypedEvent<PointerEventType>\n{\n    originalEvent: PointerEvent;\n    source: PointerEventSource;\n\n    isPrimary: boolean;\n    activePositions: IPointerPosition[];\n    pointerCount: number;\n\n    movementX: number;\n    movementY: number;\n}\n\nexport interface ITriggerEvent extends IBaseEvent, ITypedEvent<TriggerEventType>\n{\n    originalEvent: Event;\n\n    wheel: number;\n}\n\nexport interface IManip\n{\n    onPointer: (event: IPointerEvent) => boolean;\n    onTrigger: (event: ITriggerEvent) => boolean;\n}\n\nexport default class ManipTarget\n{\n    next: IManip;\n\n    protected activePositions: IPointerPosition[];\n    protected activeType: string;\n\n    protected centerX: number;\n    protected centerY: number;\n\n    constructor()\n    {\n        this.onPointerDown = this.onPointerDown.bind(this);\n        this.onPointerMove = this.onPointerMove.bind(this);\n        this.onPointerUpOrCancel = this.onPointerUpOrCancel.bind(this);\n        this.onDoubleClick = this.onDoubleClick.bind(this);\n        this.onContextMenu = this.onContextMenu.bind(this);\n        this.onWheel = this.onWheel.bind(this);\n\n        this.next = null;\n        this.activePositions = [];\n        this.activeType = \"\";\n        this.centerX = 0;\n        this.centerY = 0;\n    }\n\n    onPointerDown(event: PointerEvent)\n    {\n        // only events of a single pointer type can be handled at a time\n        if (this.activeType && event.pointerType !== this.activeType) {\n            return;\n        }\n\n        this.activeType = event.pointerType;\n        this.activePositions.push({\n            id: event.pointerId,\n            clientX: event.clientX,\n            clientY: event.clientY\n        });\n\n        (event.currentTarget as HTMLElement).setPointerCapture(event.pointerId);\n\n        const manipEvent = this.createManipPointerEvent(event, \"pointer-down\");\n\n        if (this.sendPointerEvent(manipEvent)) {\n            event.stopPropagation();\n        }\n\n        event.preventDefault();\n    }\n\n    onPointerMove(event: PointerEvent)\n    {\n        const activePositions = this.activePositions;\n\n        for (let i = 0, n = activePositions.length; i < n; ++i) {\n            const position = activePositions[i];\n            if (event.pointerId === position.id) {\n                position.clientX = event.clientX;\n                position.clientY = event.clientY;\n            }\n        }\n\n        const eventType = activePositions.length ? \"pointer-move\" : \"pointer-hover\";\n        const manipEvent = this.createManipPointerEvent(event, eventType);\n\n        if (this.sendPointerEvent(manipEvent)) {\n            event.stopPropagation();\n        }\n\n        event.preventDefault();\n    }\n\n    onPointerUpOrCancel(event: PointerEvent)\n    {\n        const activePositions = this.activePositions;\n        let found = false;\n\n        for (let i = 0, n = activePositions.length; i < n; ++i) {\n            if (event.pointerId === activePositions[i].id) {\n                activePositions.splice(i, 1);\n                found = true;\n                break;\n            }\n        }\n\n        if (!found) {\n            //console.warn(\"orphan pointer up/cancel event #id\", event.pointerId);\n            return;\n        }\n\n        const manipEvent = this.createManipPointerEvent(event, \"pointer-up\");\n        if (activePositions.length === 0) {\n            this.activeType = \"\";\n        }\n\n        if (this.sendPointerEvent(manipEvent)) {\n            event.stopPropagation();\n        }\n\n        event.preventDefault();\n    }\n\n    onDoubleClick(event: MouseEvent)\n    {\n        const consumed = this.sendTriggerEvent(\n            this.createManipTriggerEvent(event, \"double-click\")\n        );\n\n        if (consumed) {\n            event.preventDefault();\n        }\n    }\n\n    onContextMenu(event: MouseEvent)\n    {\n        this.sendTriggerEvent(\n            this.createManipTriggerEvent(event, \"context-menu\")\n        );\n\n        // prevent default context menu regardless of whether event was consumed or not\n        event.preventDefault();\n    }\n\n    onWheel(event: WheelEvent)\n    {\n        const consumed = this.sendTriggerEvent(\n            this.createManipTriggerEvent(event, \"wheel\")\n        );\n\n        if (consumed) {\n            event.preventDefault();\n        }\n    }\n\n    protected createManipPointerEvent(event: PointerEvent, type: PointerEventType): IPointerEvent\n    {\n        // calculate center and movement\n        let centerX = 0;\n        let centerY = 0;\n        let localX = 0;\n        let localY = 0;\n        let movementX = 0;\n        let movementY = 0;\n\n        const positions = this.activePositions;\n        const count = positions.length;\n\n        if (count > 0) {\n            for (let i = 0; i < count; ++i) {\n                centerX += positions[i].clientX;\n                centerY += positions[i].clientY;\n            }\n\n            centerX /= count;\n            centerY /= count;\n\n            if (type === \"pointer-move\" || type === \"pointer-hover\") {\n                movementX = centerX - this.centerX;\n                movementY = centerY - this.centerY;\n            }\n\n            this.centerX = centerX;\n            this.centerY = centerY;\n        }\n        else {\n            centerX = this.centerX;\n            centerY = this.centerY;\n        }\n\n        const element = event.currentTarget;\n        if (element instanceof Element) {\n            const rect = element.getBoundingClientRect();\n            localX = event.clientX - rect.left;\n            localY = event.clientY - rect.top;\n        }\n\n        return {\n            originalEvent: event,\n            type: type,\n            source: event.pointerType as PointerEventSource,\n\n            isPrimary: event.isPrimary,\n            activePositions: positions,\n            pointerCount: count,\n\n            centerX,\n            centerY,\n            localX,\n            localY,\n            movementX,\n            movementY,\n\n            shiftKey: event.shiftKey,\n            ctrlKey: event.ctrlKey,\n            altKey: event.altKey,\n            metaKey: event.metaKey\n        };\n    }\n\n    protected createManipTriggerEvent(event: MouseEvent, type: TriggerEventType): ITriggerEvent\n    {\n        let wheel = 0;\n\n        if (type === \"wheel\") {\n            wheel = (event as WheelEvent).deltaY;\n        }\n\n        let localX = 0;\n        let localY = 0;\n\n        const element = event.currentTarget;\n        if (element instanceof Element) {\n            const rect = element.getBoundingClientRect();\n            localX = event.clientX - rect.left;\n            localY = event.clientY - rect.top;\n        }\n\n        return {\n            originalEvent: event,\n\n            type,\n            wheel,\n\n            centerX: event.clientX,\n            centerY: event.clientY,\n            localX,\n            localY,\n\n            shiftKey: event.shiftKey,\n            ctrlKey: event.ctrlKey,\n            altKey: event.altKey,\n            metaKey: event.metaKey\n        }\n    }\n\n    protected sendPointerEvent(event: IPointerEvent): boolean\n    {\n        return this.next && this.next.onPointer(event);\n    }\n\n    protected sendTriggerEvent(event: ITriggerEvent): boolean\n    {\n        return this.next && this.next.onTrigger(event);\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\n/**\n * Returns the value of the variable in the URL query string with the given name.\n * Source: https://stackoverflow.com/questions/901115\n * @param {string} name Name of the variable to look for.\n * @param {string} url URL to search. If omitted, the browser's current location is used.\n * @returns {any} undefined if not found, \"\" if empty, string value of variable otherwise\n */\nexport default function(name: string, url?: string)\n{\n    if (!url) {\n        url = window.location.href;\n    }\n\n    name = name.replace(/[\\[\\]]/g, '\\\\$&');\n\n    const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');\n    const results = regex.exec(url);\n\n    if (!results) {\n        return undefined;\n    }\n\n    if (!results[2]) {\n        return \"\";\n    }\n\n    return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { Dictionary, Class } from \"./types\";\nimport Publisher, { ITypedEvent } from \"./Publisher\";\n\n////////////////////////////////////////////////////////////////////////////////\n\n\nexport interface IClassEvent extends ITypedEvent<\"class\">\n{\n    add: boolean;\n    remove: boolean;\n    classType: Class;\n}\n\nexport default class ClassRegistry extends Publisher\n{\n    protected _dict: Dictionary<Class> = {};\n\n    constructor()\n    {\n        super();\n        this.addEvent(\"class\");\n    }\n\n    add(classType: Class | Class[])\n    {\n        if (Array.isArray(classType)) {\n            classType.forEach(type => this.add(type));\n            return;\n        }\n\n        const name = classType.name;\n        if (!name) {\n            throw new Error(\"missing class name\");\n        }\n\n        if (this._dict[name]) {\n            throw new Error(`class '${name}' already registered`);\n        }\n\n        this._dict[name] = classType;\n        this.emit<IClassEvent>({ type: \"class\", add: true, remove: false, classType });\n    }\n\n    remove(classType: Class | Class[])\n    {\n        if (Array.isArray(classType)) {\n            classType.forEach(type => this.remove(type));\n            return;\n        }\n\n        const name = classType.name;\n        if (!name) {\n            throw new Error(\"missing class name\");\n        }\n\n        if (!this._dict[name]) {\n            throw new Error(`class '${name}' not registered`);\n        }\n\n        delete this._dict[name];\n        this.emit<IClassEvent>({ type: \"class\", add: false, remove: true, classType });\n    }\n\n    getClass(className: string | object | Class): Class | undefined\n    {\n        if (typeof className === \"function\") {\n            className = className.name;\n        }\n        else if (typeof className === \"object\") {\n            className = className.constructor.name;\n        }\n\n        return this._dict[className];\n    }\n\n    createInstance(className: string | object | Class, ...args)\n    {\n        const clazz = this.getClass(className);\n        if (!clazz) {\n            throw new Error(`class '${className}' not registered`);\n        }\n\n        return new clazz(...args);\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { normalize } from \"./text\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport interface ICommand\n{\n    readonly name: string;\n\n    do: () => void;\n    undo?: () => void;\n    canDo: () => boolean;\n    canUndo: () => boolean;\n}\n\nexport interface ICommandProps<T extends Function>\n{\n    do: T,\n    undo?: (state: {}) => void,\n    canDo?: () => boolean,\n    target: object,\n    name?: string;\n}\n\nexport default class Command<T extends Function = Function> implements ICommand\n{\n    private _props: ICommandProps<T>;\n    private _args: any[];\n    private _state: any;\n\n    constructor(args: any[], props: ICommandProps<T>)\n    {\n        this._args = args;\n        this._props = props;\n        this._args = args;\n        this._state = null;\n    }\n\n    get name() {\n        return this._props.name || normalize(this._props.do.name);\n    }\n\n    do()\n    {\n        if (this._state) {\n            throw new Error(\"undo should be called before execute can be applied again\");\n        }\n\n        this._state = this._props.do.apply(this._props.target, this._args);\n    }\n\n    undo()\n    {\n        if (!this._props.undo) {\n            throw new Error(\"can't undo this command\");\n        }\n        if (!this._state) {\n            throw new Error(\"execute should be called before undo can be applied\");\n        }\n\n        this._props.undo.call(this._props.target, this._state);\n        this._state = null;\n    }\n\n    canDo()\n    {\n        return this._props.canDo ? this._props.canDo() : true;\n    }\n\n    canUndo()\n    {\n        return !!this._props.undo;\n    }\n}\n\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport Publisher from \"./Publisher\";\nimport Command, { ICommand, ICommandProps } from \"./Command\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport interface ICommandDispatcher\n{\n    dispatch: () => void;\n}\n\nexport default class Commander extends Publisher\n{\n    protected static readonly defaultCapacity = 30;\n\n    protected stack: ICommand[];\n    protected pointer: number;\n    protected capacity: number;\n\n    constructor(capacity?: number)\n    {\n        super();\n        this.addEvent(\"change\");\n\n        this.stack = [];\n        this.pointer = -1;\n        this.capacity = capacity !== undefined ? capacity : Commander.defaultCapacity;\n    }\n\n    register<T extends Function>(factory: (args: any[]) => Command<T>): T;\n    register<T extends Function>(props: ICommandProps<T>): T;\n    register<T extends Function>(propsOrFactory: any): T\n    {\n        let factory: (args: any[]) => Command<T>;\n\n        if (typeof propsOrFactory === \"function\") {\n            factory = propsOrFactory;\n        }\n        else {\n            factory = (args: any[]) => new Command(args, propsOrFactory);\n        }\n\n        const action: any = (...args: any[]) => {\n            const command = factory(args);\n            this.do(command);\n        };\n\n        return action as T;\n    }\n\n    setCapacity(capacity: number)\n    {\n        this.capacity = capacity;\n\n        while(this.stack.length > capacity) {\n            this.stack.shift();\n            this.pointer--;\n        }\n\n        if (this.pointer < 0) {\n            this.stack = [];\n            this.pointer = -1;\n        }\n    }\n\n    do(command: ICommand)\n    {\n        console.log(`Commander.do - '${command.name}'`);\n        \n        command.do();\n\n        if (command.canUndo()) {\n            this.stack.splice(this.pointer + 1);\n            this.stack.push(command);\n\n            if (this.stack.length > this.capacity) {\n                this.stack.shift();\n            }\n\n            this.pointer = this.stack.length - 1;\n\n            this.emit(\"change\");\n        }\n    }\n\n    undo()\n    {\n        if (this.pointer >= 0) {\n            const command = this.stack[this.pointer];\n            command.undo();\n            this.pointer--;\n\n            this.emit(\"change\");\n        }\n    }\n\n\n    redo()\n    {\n        if (this.pointer < this.stack.length - 1) {\n            this.pointer++;\n            const command = this.stack[this.pointer];\n            command.do();\n\n            this.emit(\"change\");\n        }\n    }\n\n    clear()\n    {\n        if (this.stack.length > 0) {\n            this.stack = [];\n            this.pointer = -1;\n\n            this.emit(\"change\");\n        }\n    }\n\n    canUndo(): boolean\n    {\n        return this.pointer >= 0;\n    }\n\n    canRedo(): boolean\n    {\n        return this.pointer < this.stack.length - 1;\n    }\n\n    getUndoText(): string\n    {\n        if (this.pointer >= 0) {\n            return \"Undo \" + this.stack[this.pointer].name;\n        }\n\n        return \"Can't Undo\";\n    }\n\n    getRedoText(): string\n    {\n        if (this.pointer < this.stack.length - 1) {\n            return \"Redo \" + this.stack[this.pointer + 1].name;\n        }\n\n        return \"Can't Redo\";\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { Dictionary, TypeOf } from \"./types\";\nimport Publisher, { ITypedEvent } from \"./Publisher\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _EMPTY_ARRAY = [];\n\nexport const getClassName = function(scope: ObjectOrClassOrName): string\n{\n    return typeof scope === \"function\" ? scope.name : (typeof scope === \"object\"\n        ? scope.constructor.name : scope);\n}\n\nexport type ClassOrName<T extends object = object> = TypeOf<T> | string;\nexport type ObjectOrClassOrName<T extends object = object> = TypeOf<T> | T | string;\n\nexport interface IObjectEvent<T extends object = object> extends ITypedEvent<string>\n{\n    add: boolean;\n    remove: boolean;\n    object: T;\n}\n\n/**\n * Registry of object instances, grouped by their classes and base classes.\n */\nexport default class ObjectRegistry<T extends object = object> extends Publisher\n{\n    protected _rootClassName: string;\n\n    protected _objLists: Dictionary<T[]>;\n    protected _objDict: Dictionary<T>;\n\n    constructor(rootClass?: TypeOf<T>)\n    {\n        super({ knownEvents: false });\n\n        if (rootClass && !rootClass.name) {\n            throw new Error(\"root class must be a named constructor function\");\n        }\n\n        this._rootClassName = rootClass ? rootClass.name : Object.name;\n\n        this._objLists = { [this._rootClassName]: [] };\n        this._objDict = {};\n    }\n\n    /**\n     * Adds an object to the registry. The object is registered under its actual class\n     * and all base classes in its prototype chain. An [[IObjectEvent]] is emitted\n     * for each class in the object's prototype chain.\n     * @param object\n     */\n    add(object: T)\n    {\n        const id = (object as any).id;\n        if (typeof id === \"string\") {\n\n            if (this._objDict[id] !== undefined) {\n                throw new Error(\"object already registered\");\n            }\n\n            // add component to id dictionary\n            this._objDict[id] = object;\n        }\n\n        let prototype: any = object;\n        let className;\n        const rootClassName = this._rootClassName;\n\n        const event = { type: \"\", add: true, remove: false, object };\n\n        // add all types in prototype chain\n        do {\n            prototype = Object.getPrototypeOf(prototype);\n            className = prototype.constructor.name;\n\n            if (className) {\n                (this._objLists[className] || (this._objLists[className] = [])).push(object);\n\n                event.type = className;\n                this.emit<IObjectEvent>(event);\n            }\n\n        } while (className !== rootClassName);\n    }\n\n    /**\n     * Removes an object from the registry.\n     * @param object\n     */\n    remove(object: T)\n    {\n        const id = (object as any).id;\n        if (typeof id === \"string\") {\n\n            if (this._objDict[id] !== object) {\n                throw new Error(\"object not registered\");\n            }\n\n            // remove component\n            delete this._objDict[id];\n        }\n\n        let prototype: any = object;\n        let className;\n        const rootClassName = this._rootClassName;\n        const event = { type: \"\", add: false, remove: true, object };\n\n        // remove all types in prototype chain\n        do {\n            prototype = Object.getPrototypeOf(prototype);\n            className = prototype.constructor.name;\n\n            if (className) {\n                const objects = this._objLists[className];\n                objects.splice(objects.indexOf(object), 1);\n\n                event.type = className;\n                this.emit<IObjectEvent>(event);\n            }\n\n        } while (className !== rootClassName);\n    }\n\n    /**\n     * Removes all objects from the registry.\n     */\n    clear()\n    {\n        const objects = this.cloneArray();\n        objects.forEach(object => this.remove(object));\n    }\n\n    /**\n     * Returns the total number of objects in the registry.\n     */\n    get length() {\n        return this._objLists[this._rootClassName].length;\n    }\n\n    /**\n     * Returns the number of objects (of a certain class or class name if given) in the registry.\n     * @param scope Optional class or class name whose instances should be counted.\n     */\n    count(scope?: ObjectOrClassOrName): number\n    {\n        const objects = this._objLists[this.getClassName(scope)];\n        return objects ? objects.length : 0;\n    }\n\n    /**\n     * Returns true if the registry contains objects (of a given class or class name) or the given instance.\n     * @param scope A class, class name, or an instance of a class.\n     */\n    has<U extends T>(scope: ObjectOrClassOrName<U>): boolean\n    {\n        if (typeof scope === \"function\") {\n            const objects = this._objLists[scope.name];\n            return !!objects && objects.length > 0;\n        }\n        if (typeof scope === \"string\") {\n            const objects = this._objLists[scope];\n            return !!objects && objects.length > 0;\n        }\n\n        const id = (scope as any).id;\n        if (typeof id === \"string\") {\n            return !!this._objDict[id];\n        }\n\n        const objects = this._objLists[scope.constructor.name];\n        return objects && objects.indexOf(scope) >= 0;\n    }\n\n    /**\n     * Returns true if the registry contains the given object.\n     * @param object\n     */\n    contains<U extends T>(object: U): boolean\n    {\n        const id = (object as any).id;\n        if (typeof id === \"string\") {\n            return !!this._objDict[id];\n        }\n\n        const objects = this._objLists[object.constructor.name];\n        return objects && objects.indexOf(object) >= 0;\n    }\n\n    /**\n     * Returns the first found instance of the given class or class name.\n     * @param scope Class or class name of the instance to return.\n     * @param nothrow If true, the method returns undefined if no instance was found.\n     * By default, an error is thrown uf no instance is registered with the given class/class name.\n     */\n    get<U extends T = T>(scope?: ObjectOrClassOrName<U>, nothrow: boolean = false): U | undefined\n    {\n        const className = this.getClassName(scope);\n        const objects = this._objLists[className];\n        const object = objects ? objects[0] as U : undefined;\n\n        if (!nothrow && !object) {\n            throw new Error(`no instances of class '${className}' in registry`);\n        }\n\n        return object;\n    }\n\n    /**\n     * Returns an array with all instances of the given class or class name.\n     * This is a live array, it should not be kept or modified. If you need\n     * a storable/editable array, use [[ObjectRegistry.cloneArray]] instead.\n     * @param scope Class or class name of the instances to return.\n     */\n    getArray<U extends T = T>(scope?: ObjectOrClassOrName<U>): Readonly<U[]>\n    {\n        return this._objLists[this.getClassName(scope)] || _EMPTY_ARRAY;\n    }\n\n    /**\n     * Returns a cloned array with all instances of the given class or class name.\n     * @param scope Class or class name of the instances to return.\n     */\n    cloneArray<U extends T = T>(scope?: ObjectOrClassOrName<U>): U[]\n    {\n        return this.getArray(scope).slice();\n    }\n\n    /**\n     * Returns an object by its id.\n     * @param id An object's id.\n     */\n    getById(id: string): T | undefined\n    {\n        return this._objDict[id];\n    }\n\n    /**\n     * Returns a dictionary with all objects in the registry accessible by their ids.\n     * The dictionary only contains objects with an 'id' property.\n     */\n    getDictionary(): Readonly<Dictionary<T>>\n    {\n        return this._objDict;\n    }\n\n    /**\n     * Adds a listener for an object add/remove event.\n     * @param scope Class, class instance, or class name to subscribe to.\n     * @param callback Callback function, invoked when the event is emitted.\n     * @param context Optional: this context for the callback invocation.\n     */\n    on<U extends T>(scope: ObjectOrClassOrName<U>, callback: (event: IObjectEvent<U>) => void, context?: object)\n    {\n        super.on(this.getClassName(scope), callback, context);\n    }\n\n    /**\n     * Adds a one-time listener for an object add/remove event.\n     * @param scope Class, class instance, or class name to subscribe to.\n     * @param callback Callback function, invoked when the event is emitted.\n     * @param context Optional: this context for the callback invocation.\n     */\n    once<U extends T>(scope: ObjectOrClassOrName<U>, callback: (event: IObjectEvent<U>) => void, context?: object)\n    {\n        super.once(this.getClassName(scope), callback, context);\n    }\n\n    /**\n     * Removes a listener for an object add/remove event.\n     * @param scope Class, class instance, or class name to subscribe to.\n     * @param callback Callback function, invoked when the event is emitted.\n     * @param context Optional: this context for the callback invocation.\n     */\n    off<U extends T>(scope: ObjectOrClassOrName<U>, callback: (event: IObjectEvent<U>) => void, context?: object)\n    {\n        super.off(this.getClassName(scope), callback, context);\n    }\n\n    /**\n     * Returns the class name for the given instance, class or class name.\n     * @param scope\n     */\n    getClassName(scope?: ObjectOrClassOrName): string\n    {\n        return typeof scope === \"function\" ? scope.name : (typeof scope === \"object\"\n            ? scope.constructor.name : (scope || this._rootClassName));\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nconst _pd = Symbol(\"Publisher private data\");\nconst _strict = Symbol(\"Publisher strict option\");\n\n/**\n * Base class for bubbling events\n */\nexport interface IPropagatingEvent<T extends string> extends ITypedEvent<T>\n{\n    stopPropagation: boolean;\n}\n\n/**\n * Base class for typed events. Typed events have a type property holding the name of the event.\n * @event\n */\nexport interface ITypedEvent<T extends string>\n{\n    /** The type name of the event. */\n    type: T;\n}\n\n/**\n * Provides subscription services for events.\n */\nexport default class Publisher\n{\n    constructor(options?: { knownEvents: boolean })\n    {\n        const knownEvents = options ? options.knownEvents : true;\n        this[_pd] = { [_strict]: knownEvents };\n    }\n\n    /**\n     * Subscribes to an event.\n     * @param type Type name of the event or an array of type names of events.\n     * @param callback Callback function, invoked when the event is emitted.\n     * @param context Optional: this context for the callback invocation.\n     */\n    on<T extends ITypedEvent<string>>(type: T[\"type\"] | T[\"type\"][], callback: (event: T) => void, context?: object);\n    on(type: string | string[] | object, callback: (event: any) => void, context?: object);\n    on(type, callback, context?)\n    {\n        if (Array.isArray(type)) {\n            type.forEach(type => {\n                this.on(type, callback, context);\n            });\n\n            return;\n        }\n\n        if (!callback) {\n            throw new Error(\"missing callback function\");\n        }\n\n        let subscribers = this[_pd][type];\n        if (!subscribers) {\n            if (this[_pd][_strict]) {\n                throw new Error(`can't subscribe; unknown event: '${type}'`);\n            }\n\n            subscribers = this[_pd][type] = [];\n        }\n\n        let subscriber = { callback, context };\n        subscribers.push(subscriber);\n    }\n\n    /**\n     * Subscribes to an event. You may find using the .on() method more handy and more flexible.\n     * @param type\n     * @param callback\n     * @param context\n     */\n    addEventListener(type: string, callback: (event: any) => void, context?: object)\n    {\n        this.on(type, callback, context);\n    }\n\n    /**\n     * One-time subscription to an event. As soon as the event is emitted, the subscription is cancelled.\n     * @param type Type name of the event or an array of type names of events.\n     * @param callback Callback function, invoked when the event is emitted.\n     * @param context Optional: this context for the callback invocation.\n     */\n    once<T extends ITypedEvent<string>>(type: T[\"type\"] | T[\"type\"][], callback: (event: T) => void, context?: object);\n    once(type: string | string[] | object, callback: (event: any) => void, context?: object)\n    once(type, callback, context?)\n    {\n        if (Array.isArray(type)) {\n            type.forEach(type => {\n                this.once(type, callback, context);\n            });\n\n            return;\n        }\n\n        const redirect: any = event => {\n            this.off(type, redirect, context);\n            callback.call(context, event);\n        };\n\n        redirect.cb = callback;\n\n        this.on(type, redirect, context);\n    }\n\n    /**\n     * Unsubscribes from an event.\n     * @param type Type name of the event, or an array of type names of events.\n     * @param callback Callback function, invoked when the event is emitted.\n     * @param context Optional: this context for the callback invocation.\n     */\n    off<T extends ITypedEvent<string>>(type: T[\"type\"] | T[\"type\"][], callback?: (event: T) => void, context?: object);\n    off(type: string | string[] | object, callback?: (event: any) => void, context?: object)\n    off(type, callback?, context?)\n    {\n        if (typeof type === \"object\") {\n\n            if (Array.isArray(type)) {\n                // if first parameter is an array, call function for all elements of the array\n                type.forEach((type) => {\n                    this.off(type, callback, context);\n                });\n            }\n            else {\n                // if first parameter is an object, unsubscribe all subscriptions where the context matches the object.\n                const events = this[_pd];\n                const types = Object.keys(events);\n\n                for (let i = 0, ni = types.length; i < ni; ++i) {\n                    const subscribers = events[type];\n                    const remainingSubscribers = [];\n                    for (let j = 0, nj = subscribers.length; j < nj; ++j) {\n                        const subscriber = subscribers[j];\n                        if (type && subscriber.context !== type) {\n                            remainingSubscribers.push(subscriber);\n                        }\n                    }\n                    events[type] = remainingSubscribers;\n                }\n            }\n\n            return;\n        }\n\n        const subscribers = this[_pd][type];\n        if (!subscribers) {\n            throw new Error(`can't unsubscribe; unknown event type: '${type}'`);\n        }\n\n        const remainingSubscribers = [];\n        for (let i = 0, n = subscribers.length; i < n; ++i) {\n            const subscriber = subscribers[i];\n            if ((callback && callback !== subscriber.callback && callback !== subscriber.callback.cb)\n                || (context && context !== subscriber.context)) {\n                remainingSubscribers.push(subscriber);\n            }\n        }\n        this[_pd][type] = remainingSubscribers;\n    }\n\n    /**\n     * Unsubscribes from an event. You may find using the .off() method more handy and more flexible.\n     * @param type Type name of the event.\n     * @param callback Callback function, invoked when the event is emitted.\n     * @param context Optional: this context for the callback invocation.\n     */\n    removeEventListener(type: string, callback?: (event: any) => void, context?: object)\n    {\n        this.off(type, callback, context);\n    }\n\n    /**\n     * Emits an event with the given message to all subscribers of the event type.\n     * @param type Type name of the event.\n     * @param message The object sent to the subscribers of the event type.\n     */\n    emit(type: string, message?: any);\n    /**\n     * Emits an event to all subscribers of the event's type.\n     * @param event The event object sent to the subscribers of the event's type.\n     */\n    emit<T extends ITypedEvent<T[\"type\"]>>(event: T);\n    emit(eventOrType, message?)\n    {\n        let type, payload;\n        if (typeof eventOrType === \"string\") {\n            type = eventOrType;\n            payload = message;\n        }\n        else {\n            type = eventOrType.type;\n            payload = eventOrType;\n        }\n\n        if (!type) {\n            throw new Error(`empty or invalid event type: '${type}'`);\n        }\n\n        const data = this[_pd];\n        const subscribers = data[type];\n\n        if (!subscribers) {\n            if (data[_strict]) {\n                throw new Error(`can't emit; unknown event type: '${type}'`);\n            }\n\n            return;\n        }\n\n        for (let i = 0, n = subscribers.length; i < n; ++i) {\n            const subscriber = subscribers[i];\n            if (subscriber.context) {\n                subscriber.callback.call(subscriber.context, payload);\n            }\n            else {\n                subscriber.callback(payload);\n            }\n        }\n    }\n\n    /**\n     * Registers a new event type.\n     * @param name Name of the event type.\n     */\n    addEvent(name: string)\n    {\n        if (!this[_pd][name]) {\n            this[_pd][name] = [];\n        }\n    }\n\n    /**\n     * Registers multiple new event types.\n     * @param names Names of the event types.\n     */\n    addEvents(...names: string[])\n    {\n        names.forEach(name => {\n            if (!this[_pd][name]) {\n                this[_pd][name] = [];\n            }\n        });\n    }\n\n    /**\n     * Tests whether an event type has been registered.\n     * @param name Name of the event type.\n     * @returns true if an event type with the given name has been added.\n     */\n    hasEvent(name: string): boolean\n    {\n        return !!this[_pd][name];\n    }\n\n    /**\n     * Lists all registered event types.\n     * @returns an array with the names of all added event types.\n     */\n    listEvents(): string[]\n    {\n        return Object.getOwnPropertyNames(this[_pd]);\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nconst PI = Math.PI;\nconst HALF_PI = PI * 0.5;\n\nexport enum EEasingCurve {\n    Linear,\n    EaseQuad,\n    EaseInQuad,\n    EaseOutQuad,\n    EaseCubic,\n    EaseInCubic,\n    EaseOutCubic,\n    EaseQuart,\n    EaseInQuart,\n    EaseOutQuart,\n    EaseQuint,\n    EaseInQuint,\n    EaseOutQuint,\n    EaseSine,\n    EaseInSine,\n    EaseOutSine,\n}\n\nexport function getEasingFunction(curve: EEasingCurve)\n{\n    return easingFunctions[EEasingCurve[curve]];\n}\n\nexport const easingFunctions = {\n    Linear: function (t) { return t },\n\n    EaseQuad: function (t) { return t < 0.5 ? 2*t*t : -1+(4-2*t)*t },\n    EaseInQuad: function (t) { return t*t },\n    EaseOutQuad: function (t) { return t*(2-t) },\n\n    EaseCubic: function (t) { return t < 0.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1 },\n    EaseInCubic: function (t) { return t*t*t },\n    EaseOutCubic: function (t) { return (--t)*t*t+1 },\n\n    EaseQuart: function (t) { return t < 0.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t },\n    EaseInQuart: function (t) { return t*t*t*t },\n    EaseOutQuart: function (t) { return 1-(--t)*t*t*t },\n\n    EaseQuint: function (t) { return t < 0.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t },\n    EaseInQuint: function (t) { return t*t*t*t*t },\n    EaseOutQuint: function (t) { return 1+(--t)*t*t*t*t },\n\n    EaseSine: function (t) { return -0.5 * (Math.cos(t * PI) - 1); },\n    EaseInSine: function (t) { return 1 - Math.cos(t * HALF_PI); },\n    EaseOutSine: function (t) { return Math.sin(t * HALF_PI); },\n};","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { Constructor } from \"./types\";\n\nexport default function isSubclass(derived: Constructor, base: Constructor)\n{\n    if (!derived || !base) {\n        return false;\n    }\n\n    let prototype = derived.prototype;\n    while (prototype) {\n        if (prototype === base.prototype) {\n            return true;\n        }\n\n        prototype = prototype.prototype;\n    }\n\n    return false;\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nconst math = {\n\n    PI: 3.1415926535897932384626433832795,\n    DOUBLE_PI: 6.283185307179586476925286766559,\n    HALF_PI: 1.5707963267948966192313216916398,\n    QUARTER_PI: 0.78539816339744830961566084581988,\n    DEG2RAD: 0.01745329251994329576923690768489,\n    RAD2DEG: 57.295779513082320876798154814105,\n\n    limit: (v, min, max) => v < min ? min : (v > max ? max : v),\n\n    limitInt: function(v, min, max) {\n        v = Math.trunc(v);\n        return v < min ? min : (v > max ? max : v);\n    },\n\n    normalize: (v, min, max) => (v - min) / (max - min),\n\n    normalizeLimit: (v, min, max) => {\n        v = (v - min) / (max - min);\n        return v < 0.0 ? 0.0 : (v > 1.0 ? 1.0 : v);\n    },\n\n    denormalize: (t, min, max) => (min + t) * (max - min),\n\n    scale: (v, minIn, maxIn, minOut, maxOut) =>\n        minOut + (v - minIn) / (maxIn - minIn) * (maxOut - minOut),\n\n    scaleLimit: (v, minIn, maxIn, minOut, maxOut) => {\n        v = v < minIn ? minIn : (v > maxIn ? maxIn : v);\n        return minOut + (v - minIn) / (maxIn - minIn) * (maxOut - minOut);\n    },\n\n    deg2rad: function(degrees) {\n        return degrees * 0.01745329251994329576923690768489;\n    },\n\n    rad2deg: function(radians) {\n        return radians * 57.295779513082320876798154814105;\n    },\n\n    deltaRadians: function(radA, radB) {\n        radA %= math.DOUBLE_PI;\n        radA = radA < 0 ? radA + math.DOUBLE_PI : radA;\n        radB %= math.DOUBLE_PI;\n        radB = radB < 0 ? radB + math.DOUBLE_PI : radB;\n\n        if (radB - radA > math.PI) {\n            radA += math.DOUBLE_PI;\n        }\n\n        return radB - radA;\n    },\n\n    deltaDegrees: function(degA, degB) {\n        degA %= math.DOUBLE_PI;\n        degA = degA < 0 ? degA + math.DOUBLE_PI : degA;\n        degB %= math.DOUBLE_PI;\n        degB = degB < 0 ? degB + math.DOUBLE_PI : degB;\n\n        if (degB - degA > math.PI) {\n            degA += math.DOUBLE_PI;\n        }\n\n        return degB - degA;\n    },\n\n    curves: {\n        linear: t => t,\n\n        easeIn: t => Math.sin(t * math.HALF_PI),\n        easeOut: t => Math.cos(t * math.HALF_PI - math.PI) + 1.0,\n        ease: t => Math.cos(t * math.PI - math.PI) * 0.5 + 0.5,\n\n        easeInQuad: t => t * t,\n        easeOutQuad: t => t * (2 - t),\n        easeQuad: t => t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t,\n\n        easeInCubic: t => t * t * t,\n        easeOutCubic: t => (--t) * t * t + 1,\n        easeCubic: t => t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\n\n        easeInQuart: t => t * t * t * t,\n        easeOutQuart: t => 1 - (--t) * t * t * t,\n        easeQuart: t => t < 0.5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t\n    }\n};\n\nexport default math;","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nexport function camelize(text: string)\n{\n    return text.replace(/(?:^\\w|[A-Z]|\\b\\w)/g, (letter, index) =>\n        index == 0 ? letter.toLowerCase() : letter.toUpperCase()\n    ).replace(/\\s+/g, '');\n}\n\nexport function normalize(text: string)\n{\n    return text.replace(/([A-Z])/g, ' $1')\n        .replace(/^./, str => str.toUpperCase());\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\n////////////////////////////////////////////////////////////////////////////////\n// HELPER TYPES\n\nexport type Index = number;\n\nexport type Identifier = string;\n\nexport type Constructor<T = any> = {\n    new (...args: any[]): T;\n}\n\nexport interface Class extends Function {\n    new (...args: any[]): object;\n}\n\nexport interface ClassOf<T> extends Function {\n    new (...args: any[]): T;\n}\n\nexport interface Type extends Function {\n    new (...args: any[]): object;\n}\n\nexport interface TypeOf<T> extends Function {\n    new (...args: any[]): T;\n}\n\nexport type PropOf<T> = T extends {} ? T[keyof T] : never;\n\nexport type ReturnType<T extends Function> =\n    T extends (...args: any[]) => infer returnType ? returnType : never\n\n\nexport type PrimitiveType = number | boolean | string;\n\nexport type Identifiable<T extends object = object> = T & { id: Identifier };\n\nexport type Dictionary<T> = { [id: string]: T };\n\nexport type Transformable<U, A, TA, B, TB>\n    = U extends A ? TA\n    : U extends B ? TB\n    : TA | TB;\n\ntype Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>\n\nexport type Subtract<T, U> = Pick<T, Exclude<keyof T, keyof U>>\n\nexport type PartialOptional<T, U> = Pick<T, Exclude<keyof T, keyof U>> & Partial<U>\n\nexport type Record<K extends keyof any, T> = { [P in K]: T; };\n\nexport type Enum<E> = Record<keyof E, number | string> & { [k: number]: string };\n\n////////////////////////////////////////////////////////////////////////////////\n// ENUM HELPER FUNCTIONS\n\nexport const enumToArray = function(e: any) {\n    return Object.keys(e).filter(key => isNaN(Number(key)));\n};\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nlet _chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\n/**\n * Creates a base64 encoded globally unique identifier with a default length of 12 characters.\n * The identifier only uses letters and digits and can safely be used for file names.\n * Unique combinations: 62 ^ 12 > 2 ^ 64\n * @param length Number of base64 characters in the identifier.\n * @param dictionary Optional object with ids. Function ensures generated id is not equal to a key of dictionary.\n * @returns Globally unique identifier\n */\nexport default function uniqueId(length?: number, dictionary?: {})\n{\n    if (!length || typeof length !== \"number\") {\n        length = 12;\n    }\n\n    let id;\n\n    do {\n        id = \"\";\n        for (let i = 0; i < length; ++i) {\n            id += _chars[Math.random() * 62 | 0];\n        }\n    } while(dictionary && dictionary[id]);\n\n    return id;\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { Dictionary, ClassOf } from \"@ff/core/types\";\nimport Publisher, { IPropagatingEvent, ITypedEvent } from \"@ff/core/Publisher\";\nimport { IObjectEvent } from \"@ff/core/ObjectRegistry\";\n\nimport { types, IPropertyTemplate, PropertiesFromTemplates } from \"./Property\";\nimport PropertyGroup, { ILinkable } from \"./PropertyGroup\";\nimport ComponentTracker from \"./ComponentTracker\";\nimport ComponentReference from \"./ComponentReference\";\nimport Node, { NodeOrClass } from \"./Node\";\nimport System from \"./System\";\nimport CHierarchy from \"./components/CHierarchy\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { types, ITypedEvent };\n\n\nexport interface IUpdateContext\n{\n}\n\nexport interface IComponentEvent<T extends Component = Component> extends IObjectEvent<T>\n{\n}\n\n/**\n * Emitted by [[Component]] after the instance's state has changed.\n * @event\n */\nexport interface IComponentChangeEvent<T extends Component = Component> extends ITypedEvent<\"change\">\n{\n    component: T;\n    what: string;\n}\n\n/**\n * Emitted by [[Component]] if the component is about to be disposed.\n * @event\n */\nexport interface IComponentDisposeEvent<T extends Component = Component> extends ITypedEvent<\"dispose\">\n{\n    component: T;\n}\n\n/** A [[Component]] instance, [[Component]] constructor function or a component's type string. */\nexport type ComponentOrClass<T extends Component = Component> = T | ClassOf<T> | string;\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Base class for components in a node-component system.\n *\n * ### Events\n * - *\"change\"* - emits [[IComponentChangeEvent]] after the component's state has changed.\n * - *\"dispose\"* - emits [[IComponentDisposeEvent]] if the component is about to be disposed.\n *\n * ### See also\n * - [[ComponentTracker]]\n * - [[ComponentLink]]\n * - [[ComponentType]]\n * - [[ComponentOrType]]\n * - [[Node]]\n * - [[Graph]]\n * - [[System]]\n */\nexport default class Component extends Publisher implements ILinkable\n{\n    static readonly type: string = \"Component\";\n\n    static readonly text: string = \"\";\n    static readonly icon: string = \"\";\n\n    static readonly isNodeSingleton: boolean = true;\n    static readonly isGraphSingleton: boolean = false;\n    static readonly isSystemSingleton: boolean = false;\n\n    static getClassName<T extends Component>(scope?: ComponentOrClass<T>)\n    {\n        return typeof scope === \"function\" ? scope.name : (typeof scope === \"object\"\n            ? scope.constructor.name : (scope || Component.name));\n    }\n\n    /** The component's globally unique id. */\n    readonly id: string;\n\n    ins: PropertyGroup = new PropertyGroup(this);\n    outs: PropertyGroup = new PropertyGroup(this);\n\n    changed: boolean = true;\n    updated: boolean = false;\n\n    private _node: Node = null;\n    private _name: string = \"\";\n    private _trackers: ComponentTracker[] = [];\n    private _firstAttached = false;\n\n    /**\n     * Protected constructor. Use [[Node.createComponent]] to create component instances.\n     * @param id Unique id for the component. A unique id is usually created automatically,\n     * do not specify except while de-serializing the component.\n     *\n     * Note that during execution of the constructor, the component is not yet attached\n     * to a node/graph/system. Do not try to get access to other components,\n     * the parent node, graph, or the system here.\n     */\n    constructor(id: string)\n    {\n        super({ knownEvents: false });\n        this.id = id;\n    }\n\n    /**\n     * True if the component is a node singleton, i.e. can only be added once per node.\n     */\n    get isNodeSingleton() {\n        return (this.constructor as typeof Component).isNodeSingleton;\n    }\n\n    /**\n     * True if the component is a graph singleton, i.e. can only be added once per graph.\n     */\n    get isGraphSingleton() {\n        return (this.constructor as typeof Component).isGraphSingleton;\n    }\n\n    /**\n     * True if the component is a system singleton, i.e. can only be added once per system.\n     */\n    get isSystemSingleton() {\n        return (this.constructor as typeof Component).isSystemSingleton;\n    }\n\n    /**\n     * Returns the class name of this component.\n     * @returns {string}\n     */\n    get className() {\n        return this.constructor.name;\n    }\n    get displayClassName() {\n        const name = this.constructor.name;\n        return name === \"Component\" ? name : name.substr(1);\n    }\n\n    get text() {\n        return (this.constructor as typeof Component).text;\n    }\n\n    get icon() {\n        return (this.constructor as typeof Component).icon;\n    }\n\n    /**\n     * Returns the name of this component.\n     */\n    get name() {\n        return this._name;\n    }\n\n    get displayName() {\n        return this._name || this.text || this.displayClassName;\n    }\n\n    /**\n     * Sets the name of this component.\n     * This emits an [[IComponentChangeEvent]].\n     * @param value\n     */\n    set name(value: string)\n    {\n        this._name = value;\n        this.emit<IComponentChangeEvent>({ type: \"change\", component: this, what: \"name\" });\n    }\n\n    /**\n     * Returns the node this component belongs to.\n     */\n    get node() {\n        return this._node;\n    }\n\n    /**\n     * Returns the graph this component and its node belong to.\n     */\n    get graph() {\n        return this._node.graph;\n    }\n\n    /**\n     * Returns the system this component and its node belong to.\n     */\n    get system(): System {\n        return this._node.system;\n    }\n\n    /**\n     * Returns the set of sibling components of this component.\n     * Sibling components are components belonging to the same node.\n     */\n    get components() {\n        return this._node.components;\n    }\n\n    /**\n     * Returns the sibling hierarchy component if available.\n     */\n    get hierarchy() {\n        return this._node.components.get<CHierarchy>(\"CHierarchy\");\n    }\n\n    getComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this._node.components.get(componentOrClass, nothrow);\n    }\n\n    getComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this._node.components.getArray(componentOrClass);\n    }\n\n    hasComponent(componentOrClass: ComponentOrClass) {\n        return this._node.components.has(componentOrClass);\n    }\n\n    getGraphComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this._node.graph.components.get(componentOrClass, nothrow);\n    }\n\n    getGraphComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this._node.graph.components.getArray(componentOrClass);\n    }\n\n    hasGraphComponent(componentOrClass: ComponentOrClass) {\n        return this._node.graph.components.has(componentOrClass);\n    }\n\n    getMainComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this._node.system.graph.components.get(componentOrClass, nothrow);\n    }\n\n    getMainComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this._node.system.graph.components.getArray(componentOrClass);\n    }\n\n    hasMainComponent(componentOrClass: ComponentOrClass) {\n        return this._node.system.graph.components.has(componentOrClass);\n    }\n\n    getSystemComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this._node.system.components.get(componentOrClass, nothrow);\n    }\n\n    getSystemComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this._node.system.components.getArray(componentOrClass);\n    }\n\n    hasSystemComponent(componentOrClass: ComponentOrClass) {\n        return this._node.system.components.has(componentOrClass);\n    }\n\n    getComponentById(id: string): Component | null {\n        return this._node.system.components.getById(id);\n    }\n\n    getNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this._node.graph.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this._node.graph.nodes.getArray(nodeOrClass);\n    }\n\n    hasNode(nodeOrClass: NodeOrClass) {\n        return this._node.graph.nodes.has(nodeOrClass);\n    }\n\n    getMainNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this._node.system.graph.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getMainNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this._node.system.graph.nodes.getArray(nodeOrClass);\n    }\n\n    hasMainNode(nodeOrClass: NodeOrClass) {\n        return this._node.system.graph.nodes.has(nodeOrClass);\n    }\n\n    getSystemNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this._node.system.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getSystemNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this._node.system.nodes.getArray(nodeOrClass);\n    }\n\n    hasSystemNode(nodeOrClass: NodeOrClass) {\n        return this._node.system.nodes.has(nodeOrClass);\n    }\n\n    getNodeById(id: string): Node | null {\n        return this._node.system.nodes.getById(id);\n    }\n\n    /**\n     * Adds the component to the given node.\n     * @param node Node to attach the new component to.\n     */\n    attach(node: Node)\n    {\n        if (this._node) {\n            this.detach();\n        }\n\n        this._node = node;\n\n        if (!this._firstAttached) {\n            this._firstAttached = true;\n            this.create();\n        }\n\n        // note: adding the component informs subscribers, this must happen after create()\n        node._addComponent(this);\n    }\n\n    /**\n     * Called after the component has been constructed and attached to a node.\n     * Override to perform initialization tasks where you need access to other components.\n     */\n    create()\n    {\n    }\n\n    /**\n     * Called during each cycle if the component's input properties have changed.\n     * Override to update the status of the component based on the input properties.\n     * @param context Information about the current update cycle.\n     * @returns True if the state of the component has been changed during the update.\n     */\n    update(context: IUpdateContext): boolean\n    {\n        throw new Error(\"this should never be called\");\n    }\n\n    /**\n     * Called during each cycle, after the component has been updated.\n     * Override to let the component perform regular tasks.\n     * @param context Information about the current update cycle.\n     */\n    tick(context: IUpdateContext): boolean\n    {\n        throw new Error(\"this should never be called\");\n    }\n\n    /**\n     * Called after rendering is completed.\n     * Override to perform update operations which need to happen\n     * only after all rendering is done.\n     * @param context Information about the current update cycle.\n     */\n    finalize(context: IUpdateContext)\n    {\n        throw new Error(\"this should never be called\");\n    }\n\n    /**\n     * Removes the component from its node.\n     */\n    detach()\n    {\n        if (this._node) {\n            this._node._removeComponent(this);\n            this._node = null;\n        }\n    }\n\n    /**\n     * Removes the component from its node and deletes it.\n     * Override to perform cleanup tasks (remove event listeners, etc.).\n     * Must call super implementation if overridden!\n     */\n    dispose()\n    {\n        // remove all links and trackers\n        this.ins.dispose();\n        this.outs.dispose();\n\n        this._trackers.forEach(tracker => tracker.dispose());\n\n        // remove component from node\n        this.detach();\n\n        // emit dispose event\n        this.emit<IComponentDisposeEvent>({ type: \"dispose\", component: this });\n    }\n\n    requestSort()\n    {\n        this.graph.requestSort();\n    }\n\n    /**\n     * Returns true if this component has or inherits from the given type.\n     * @param scope\n     */\n    is(scope: ComponentOrClass): boolean\n    {\n        const className = Component.getClassName(scope);\n\n        let prototype = this;\n\n        do {\n            prototype = Object.getPrototypeOf(prototype);\n\n            if (prototype.constructor.name === className) {\n                return true;\n            }\n\n        } while (prototype.constructor.name !== Component.name);\n\n        return false;\n    }\n\n    /**\n     * Removes links from all input and output properties.\n     */\n    unlinkAllProperties()\n    {\n        this.ins.unlinkAllProperties();\n        this.outs.unlinkAllProperties();\n    }\n\n    /**\n     * Sets the changed flags of this component and of all input properties to false;\n     */\n    resetChanged()\n    {\n        this.changed = false;\n        const ins = this.ins.properties;\n        for (let i = 0, n = ins.length; i < n; ++i) {\n            ins[i].changed = false;\n        }\n    }\n\n    /**\n     * Tracks the given component type. If a component of this type is added\n     * to or removed from the node, it will be added or removed from the tracker.\n     * @param {ComponentOrClass} componentOrClass\n     * @param {(component: T) => void} didAdd\n     * @param {(component: T) => void} willRemove\n     */\n    trackComponent<T extends Component>(componentOrClass: ComponentOrClass<T>,\n        didAdd?: (component: T) => void, willRemove?: (component: T) => void): ComponentTracker<T>\n    {\n        const tracker = new ComponentTracker(this._node.components, componentOrClass, didAdd, willRemove);\n        this._trackers.push(tracker);\n        return tracker;\n    }\n\n    /**\n     * Returns a weak reference to a component.\n     * The reference is set to null after the linked component is removed.\n     * @param componentOrClass The type of component this reference accepts, or the component to link.\n     */\n    referenceComponent<T extends Component>(componentOrClass: ComponentOrClass<T>): ComponentReference<T>\n    {\n        return new ComponentReference<T>(this.system, componentOrClass);\n    }\n\n    /**\n     * Propagates and emits an event as follows, until event.stopPropagation is set to true.\n     * 1. this component\n     * 2. sibling components of this\n     * 3. parent hierarchy component if available\n     * 4. siblings of parent hierarchy component\n     * 5. repeat 3/4 until at root\n     * 6. emits event on system\n     * @param event\n     */\n    propagateUp(event: IPropagatingEvent<string>)\n    {\n        let target = this as Component;\n\n        while (target) {\n            target.emit(event);\n\n            if (event.stopPropagation) {\n                return;\n            }\n\n            const components = target.components.getArray();\n            for (let i = 0, n = components.length; i < n; ++i) {\n                const component = components[i];\n                if (component !== target) {\n                    component.emit(event);\n\n                    if (event.stopPropagation) {\n                        return;\n                    }\n                }\n            }\n\n            const hierarchy = target.components.get<CHierarchy>(\"CHierarchy\");\n            target = hierarchy ? hierarchy.parent : null;\n\n            // TODO: Should event propagate to parent graph?\n            // if (!target) {\n            //     target = hierarchy.graph.parent;\n            // }\n        }\n\n        if (!event.stopPropagation) {\n            this.system.emit(event);\n        }\n    }\n\n    /**\n     * Propagates and emits an event as follows, until event.stopPropagation is set to true.\n     * 1. all children of the sibling hierarchy of this\n     * 2. for each child, repeat 1 until reaching leaf components with no children\n     * @param event\n     */\n    propagateDown(event: IPropagatingEvent<string>)\n    {\n        const hierarchy = this.components.get<CHierarchy>(\"CHierarchy\");\n        const children = hierarchy ? hierarchy.children : null;\n\n        for (let i = 0, n = children.length; i < n; ++i) {\n            const components = children[i].components.getArray();\n            for (let j = 0, m = components.length; j < m; ++i) {\n                components[j].emit(event);\n                if (event.stopPropagation) {\n                    return;\n                }\n            }\n            for (let j = 0, m = components.length; j < m; ++i) {\n                components[j].propagateDown(event);\n                if (event.stopPropagation) {\n                    return;\n                }\n            }\n        }\n    }\n\n    /**\n     * Returns a text representation of the component.\n     * @returns {string}\n     */\n    toString()\n    {\n        return `${this.className}${this.name ? \" (\" + this.name + \")\" : \"\"}`;\n    }\n\n    deflate()\n    {\n        let json: any = {};\n\n        const jsonIns = this.ins.deflate();\n        if (jsonIns) {\n            json.ins = jsonIns;\n        }\n        const jsonOuts = this.outs.deflate();\n        if (jsonOuts) {\n            json.outs = jsonOuts;\n        }\n\n        return json;\n    }\n\n    inflate(json: any)\n    {\n        if (json.ins) {\n            this.ins.inflate(json.ins);\n        }\n        if (json.outs) {\n            this.outs.inflate(json.outs);\n        }\n    }\n\n    inflateReferences(json: any)\n    {\n        const dict = this.system.components.getDictionary();\n\n        if (json.ins) {\n            this.ins.inflateLinks(json.ins, dict);\n        }\n        if (json.outs) {\n            this.outs.inflateLinks(json.outs, dict);\n        }\n    }\n\n     /**\n     * Adds input properties to the component, specified by the provided property templates.\n     * @param templates A plain object with property templates.\n     * @param index Optional index at which to insert the new properties.\n     */\n    protected addInputs<T extends Component = Component, U extends Dictionary<IPropertyTemplate> = {}>\n    (templates: U, index?: number) : PropertyGroup & T[\"ins\"] & PropertiesFromTemplates<U>\n    {\n        return this.ins.createPropertiesFromTemplates(templates, index) as any;\n    }\n\n    /**\n     * Adds output properties to the component, specified by the provided property templates.\n     * @param templates A plain object with property templates.\n     * @param index Optional index at which to insert the new properties.\n     */\n    protected addOutputs<T extends Component = Component, U extends Dictionary<IPropertyTemplate> = {}>\n    (templates: U, index?: number) : PropertyGroup & T[\"outs\"] & PropertiesFromTemplates<U>\n    {\n        return this.outs.createPropertiesFromTemplates(templates, index) as any;\n    }\n}\n\nComponent.prototype.update = null;\nComponent.prototype.tick = null;\nComponent.prototype.finalize = null;\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport Component, { ComponentOrClass } from \"./Component\";\nimport System from \"./System\";\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Maintains a weak reference to a component.\n * The reference is set to null after the linked component is removed.\n */\nexport default class ComponentReference<T extends Component = Component>\n{\n    private _id: string;\n    private readonly _className: string;\n    private readonly _system: System;\n\n    constructor(system: System, scope?: ComponentOrClass<T>) {\n        this._className = scope ? Component.getClassName(scope) : null;\n        this._id = scope instanceof Component ? scope.id : undefined;\n        this._system = system;\n    }\n\n    get component(): T | null {\n        return this._id ? this._system.components.getById(this._id) as T || null : null;\n    }\n    set component(component: T) {\n        if (component && this._className && !(component instanceof this._system.registry.getClass(this._className))) {\n            throw new Error(`can't assign component of class '${(component as Component).constructor.name || \"unknown\"}' to link of class '${this._className}'`);\n        }\n        this._id = component ? component.id : undefined;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport ObjectRegistry, { IObjectEvent, getClassName } from \"@ff/core/ObjectRegistry\";\n\nimport Component, { ComponentOrClass } from \"./Component\";\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Tracks components of a specific type in the same node.\n * Maintains a reference to the component if found and executes\n * callbacks if the component of the tracked type is added or removed.\n */\nexport default class ComponentTracker<T extends Component = Component>\n{\n    /** The type of component to track. */\n    readonly className: string;\n    /** Access to the component of the tracked type after it has been added. */\n    component: T;\n    /** Called after a component of the tracked type has been added to the node. */\n    didAdd: (component: T) => void;\n    /** Called before a component of the tracked type is removed from the node. */\n    willRemove: (component: T) => void;\n\n    private _registry: ObjectRegistry<Component>;\n\n    constructor(registry: ObjectRegistry<Component>, scope: ComponentOrClass<T>,\n                didAdd?: (component: T) => void, willRemove?: (component: T) => void) {\n\n        this.className = getClassName(scope);\n        this.didAdd = didAdd;\n        this.willRemove = willRemove;\n\n        this._registry = registry;\n\n        registry.on(this.className, this.onComponent, this);\n        this.component = registry.get(scope, true);\n\n        if (this.component && didAdd) {\n            didAdd(this.component);\n        }\n    }\n\n    dispose()\n    {\n        this._registry.off(this.className, this.onComponent, this);\n        this.component = null;\n        this.didAdd = null;\n        this.willRemove = null;\n\n    }\n\n    protected onComponent(event: IObjectEvent<T>)\n    {\n        if (event.add) {\n            this.component = event.object;\n            this.didAdd && this.didAdd(event.object);\n        }\n        else if (event.remove) {\n            this.willRemove && this.willRemove(event.object);\n            this.component = null;\n        }\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport uniqueId from \"@ff/core/uniqueId\";\nimport Publisher from \"@ff/core/Publisher\";\n\nimport LinkableSorter from \"./LinkableSorter\";\nimport Component, { ComponentOrClass, IUpdateContext } from \"./Component\";\nimport Node, { NodeOrClass } from \"./Node\";\nimport System from \"./System\";\n\nimport CHierarchy from \"./components/CHierarchy\";\nimport CGraph from \"./components/CGraph\";\nimport ObjectRegistry from \"@ff/core/ObjectRegistry\";\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Graph in a graph/node/component system. A graph contains a collection of nodes.\n * Graphs can be nested, i.e. a graph can be a subgraph of another graph, the parent graph.\n *\n * ### See also\n * - [[Component]]\n * - [[Node]]\n * - [[System]]\n */\nexport default class Graph extends Publisher\n{\n    /** The system this graph belongs to. */\n    readonly system: System;\n    /** For subgraphs: the parent component. For the root graph (system graph), this is null. */\n    readonly parent: CGraph;\n\n    /** Collection of all nodes in this graph. */\n    readonly nodes = new ObjectRegistry<Node>(Node);\n    /** Collection of all components in this graph. */\n    readonly components = new ObjectRegistry<Component>(Component);\n\n    private _root: CHierarchy;\n    private _sorter = new LinkableSorter();\n    private _sortRequested = true;\n    private _sortedList: Component[] = null;\n    private _finalizeList: Component[] = [];\n\n    /**\n     * Creates a new graph instance.\n     * @param system System this graph belongs to.\n     * @param parent Optional parent component of this graph.\n     */\n    constructor(system: System, parent: CGraph | null)\n    {\n        super({ knownEvents: false });\n        this.system = system;\n        this.parent = parent;\n    }\n\n    // TODO: This should use a tracker for the root component\n\n    /** Sets the root hierarchy component of this graph. */\n    set root(root: CHierarchy) {\n        this._root = root;\n\n        if (this.parent) {\n            this.parent.innerRoot = root;\n        }\n    }\n\n    /** Returns the root hierarchy component of this graph. */\n    get root() {\n        return this._root;\n    }\n\n    getComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this.components.get(componentOrClass, nothrow);\n    }\n\n    getComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this.components.getArray(componentOrClass);\n    }\n\n    hasComponent(componentOrClass: ComponentOrClass) {\n        return this.components.has(componentOrClass);\n    }\n\n    getMainComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this.system.graph.components.get(componentOrClass, nothrow);\n    }\n\n    getMainComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this.system.graph.components.getArray(componentOrClass);\n    }\n\n    hasMainComponent(componentOrClass: ComponentOrClass) {\n        return this.system.graph.components.has(componentOrClass);\n    }\n\n    getSystemComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this.system.components.get(componentOrClass, nothrow);\n    }\n\n    getSystemComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this.system.components.getArray(componentOrClass);\n    }\n\n    hasSystemComponent(componentOrClass: ComponentOrClass) {\n        return this.system.components.has(componentOrClass);\n    }\n\n    getComponentById(id: string): Component | null {\n        return this.system.components.getById(id);\n    }\n\n    getNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this.nodes.getArray(nodeOrClass);\n    }\n\n    hasNode(nodeOrClass: NodeOrClass) {\n        return this.nodes.has(nodeOrClass);\n    }\n\n    getMainNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this.system.graph.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getMainNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this.system.graph.nodes.getArray(nodeOrClass);\n    }\n\n    hasMainNode(nodeOrClass: NodeOrClass) {\n        return this.system.graph.nodes.has(nodeOrClass);\n    }\n\n    getSystemNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this.system.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getSystemNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this.system.nodes.getArray(nodeOrClass);\n    }\n\n    hasSystemNode(nodeOrClass: NodeOrClass) {\n        return this.system.nodes.has(nodeOrClass);\n    }\n\n    getNodeById(id: string): Node | null {\n        return this.system.nodes.getById(id);\n    }\n\n    /**\n     * Called at the begin of each frame cycle. Calls update() on all components\n     * in the graph whose changed flag is set, then calls tick() on all components.\n     * Returns true if at least one component changed its state.\n     * @param context Context-specific information such as time, etc.\n     * @returns true if at least one component was updated.\n     */\n    tick(context: IUpdateContext): boolean\n    {\n        if (this._sortRequested) {\n            this._sortRequested = false;\n            this.sort();\n        }\n\n        // call update on components in topological sort order\n        const components = this._sortedList;\n        let updated = false;\n\n        for (let i = 0, n = components.length; i < n; ++i) {\n            const component = components[i];\n            component.updated = false;\n\n            if (component.changed) {\n                if (component.update && component.update(context)) {\n                    updated = component.updated = true;\n                }\n\n                component.resetChanged();\n            }\n\n            if (component.tick && component.tick(context)) {\n                updated = true;\n            }\n        }\n\n        return updated;\n    }\n\n    /**\n     * Calls finalize on all components in the graph.\n     * The finalize call happens at the end of a frame cycle.\n     * @param context Context-specific information such as time, etc.\n     */\n    finalize(context: IUpdateContext)\n    {\n        const components = this._finalizeList;\n        for (let i = 0, n = components.length; i < n; ++i) {\n            components[i].finalize(context);\n        }\n    }\n\n    clear()\n    {\n        const nodes = this.nodes.cloneArray();\n        for (let i = 0, n = nodes.length; i < n; ++i) {\n            nodes[i].dispose();\n        }\n    }\n\n    /**\n     * Requests a topological sort of the list of components based on how they are interlinked.\n     * The sort is executed before the next update.\n     */\n    requestSort()\n    {\n        this._sortRequested = true;\n    }\n\n    sort()\n    {\n        this._sortedList = this._sorter.sort(this.components.getArray()) as Component[];\n\n        const name = this.parent ? this.parent.name || this.parent.className : \"System\";\n        console.log(\"Graph.sort - %s: sorted %s components\", name, this._sortedList.length);\n    }\n\n    /**\n     * Creates a new node of the given type. Adds it to the graph.\n     * @param nodeOrClass Type of the node to create.\n     * @param name Optional name for the node.\n     * @param id Optional unique identifier for the node (must omit unless serializing).\n     */\n    createCustomNode<T extends Node>(nodeOrClass: NodeOrClass<T>, name?: string, id?: string): T\n    {\n        const classType = this.system.registry.getClass(nodeOrClass);\n        const node = new classType(id || uniqueId(12, this.system.nodes.getDictionary())) as T;\n\n        node.attach(this);\n\n        if (name) {\n            node.name = name;\n        }\n\n        if (!id) {\n            node.createComponents();\n        }\n\n        return node;\n    }\n\n    /**\n     * Creates a new, plain, empty node (of base type [[Node]]). Adds it to the graph.\n     * @param name Optional name for the node.\n     * @param id Optional unique identifier for the node (must omit unless serializing).\n     */\n    createNode(name?: string, id?: string): Node\n    {\n        const node = new Node(id || uniqueId(12, this.system.nodes.getDictionary()));\n\n        node.attach(this);\n\n        if (name) {\n            node.name = name;\n        }\n\n        return node;\n    }\n\n    findNodeByName<T extends Node = Node>(name: string, nodeOrClass?: NodeOrClass<T>): T | undefined\n    {\n        const nodes = this.nodes.getArray(nodeOrClass);\n\n        for (let i = 0, n = nodes.length; i < n; ++i) {\n            if (nodes[i].name === name) {\n                return nodes[i];\n            }\n        }\n\n        return undefined;\n    }\n\n    findRootNodes<T extends Node = Node>(nodeOrType?: NodeOrClass<T>): T[]\n    {\n        const nodes = this.nodes.getArray(nodeOrType);\n        const result = [];\n\n        for (let i = 0, n = nodes.length; i < n; ++i) {\n            const hierarchy = nodes[i].components.get<CHierarchy>(\"CHierarchy\", true);\n            if (!hierarchy || !hierarchy.parent) {\n                result.push(nodes[i]);\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * Returns a text representation of the graph.\n     * @param verbose\n     */\n    toString(verbose: boolean = false)\n    {\n        const nodes = this.nodes.getArray();\n        const numComponents = this.components.count();\n\n        const text = `Graph - ${nodes.length} nodes, ${numComponents} components.`;\n\n        if (verbose) {\n            return text + \"\\n\" + nodes.map(node => node.toString(true)).join(\"\\n\");\n        }\n\n        return text;\n    }\n\n    /**\n     * Serializes the graph, its nodes and components.\n     * Returns graph serialization data, which must be cloned or stringified immediately.\n     */\n    deflate()\n    {\n        const json: any = {};\n        const jsonNodes = [];\n\n        const nodes = this.nodes.getArray();\n        for (let i = 0, n = nodes.length; i < n; ++i) {\n            const node = nodes[i];\n\n            const jsonNode = this.deflateNode(node);\n\n            jsonNode.type = node.className;\n            jsonNode.id = node.id;\n\n            if (node.name) {\n                jsonNode.name = node.name;\n            }\n\n            jsonNodes.push(jsonNode);\n        }\n\n        if (jsonNodes.length > 0) {\n            json.nodes = jsonNodes;\n        }\n\n        return json;\n    }\n\n    /**\n     * Deserializes the graph, its nodes and components.\n     * @param json serialized graph data.\n     */\n    inflate(json)\n    {\n        if (json.nodes) {\n            json.nodes.forEach(jsonNode => {\n                const node = this.createCustomNode(jsonNode.type, jsonNode.name, jsonNode.id);\n                node.inflate(jsonNode);\n            });\n        }\n    }\n\n    /**\n     * Deserializes references between graphs, nodes, and components\n     * @param json serialized graph data.\n     */\n    inflateReferences(json)\n    {\n        if (json.nodes) {\n            json.nodes.forEach(jsonNode => {\n                const node = this.nodes.getById(jsonNode.id);\n                node.inflateReferences(jsonNode);\n            });\n        }\n    }\n\n    /**\n     * Override to control how nodes are serialized.\n     * Return serialization data or null if the node should be excluded from serialization.\n     * @param node The node to be serialized.\n     */\n    protected deflateNode(node: Node)\n    {\n        return node.deflate();\n    }\n\n    /**\n     * Adds a node to the graph and the system. Called by [[Node.attach]], do not call directly.\n     * @param node\n     * @private\n     */\n    _addNode(node: Node)\n    {\n        this.system._addNode(node);\n        this.nodes.add(node);\n    }\n\n    /**\n     * Removes a node from the graph and the system. Called by [[Node.detach]], do not call directly.\n     * @param node\n     * @private\n     */\n    _removeNode(node: Node)\n    {\n        this.nodes.remove(node);\n        this.system._removeNode(node);\n    }\n\n    /**\n     * Adds a component to the graph and the system. Called by [[Component.attach]], do not call directly.\n     * @param component\n     * @private\n     */\n    _addComponent(component: Component)\n    {\n        if (component.isGraphSingleton && this.components.has(component)) {\n            throw new Error(`only one component of class '${component.className}' allowed per graph`);\n        }\n\n        this.system._addComponent(component);\n        this.components.add(component);\n\n        if (component.finalize) {\n            this._finalizeList.push(component);\n        }\n\n        this._sortRequested = true;\n    }\n\n    /**\n     * Removes a component from the graph and the system. Called by [[Component.detach]], do not call directly.\n     * @param component\n     * @private\n     */\n    _removeComponent(component: Component)\n    {\n        this.components.remove(component);\n        this.system._removeComponent(component);\n\n        if (component.finalize) {\n            this._finalizeList.splice(this._finalizeList.indexOf(component), 1);\n        }\n\n        this._sortRequested = true;\n    }\n}\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { Dictionary } from \"@ff/core/types\";\nimport { ILinkable } from \"./PropertyGroup\";\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Sorts an array of [[ILinkable]] such that if a is linked to b, a comes before b.\n */\nexport default class LinkableSorter\n{\n    protected visited: Dictionary<boolean>;\n    protected visiting: Dictionary<boolean>;\n    protected sorted: ILinkable[];\n\n    constructor()\n    {\n        this.visited = {};\n        this.visiting = {};\n        this.sorted = [];\n    }\n\n    sort(linkables: ILinkable[]): ILinkable[]\n    {\n        for (let i = 0, n = linkables.length; i < n; ++i) {\n            this.visit(linkables[i]);\n        }\n\n        const sorted = this.sorted;\n\n        this.visited = {};\n        this.visiting = {};\n        this.sorted = [];\n\n        return sorted;\n    }\n\n    protected visit(linkable: ILinkable)\n    {\n        const visited = this.visited;\n        const visiting = this.visiting;\n\n        if (visited[linkable.id] || visiting[linkable.id]) {\n            return;\n        }\n\n        visiting[linkable.id] = true;\n\n        // for each output property, follow all outgoing links\n        const outProps = linkable.outs.properties;\n        for (let i0 = 0, n0 = outProps.length; i0 < n0; ++i0) {\n            const outLinks = outProps[i0].outLinks;\n            for (let i1 = 0, n1 = outLinks.length; i1 < n1; ++i1) {\n                const ins = outLinks[i1].destination.group;\n\n                // follow outgoing links at input properties\n                const inProps = ins.properties;\n                for (let i2 = 0, n2 = inProps.length; i2 < n2; ++i2) {\n                    const links = inProps[i2].outLinks;\n                    for (let i3 = 0, n3 = links.length; i3 < n3; ++i3) {\n                        const linkedIns = links[i3].destination.group;\n                        this.visit(linkedIns.linkable);\n                    }\n                }\n\n                this.visit(ins.linkable);\n            }\n        }\n\n        visiting[linkable.id] = undefined;\n        visited[linkable.id] = true;\n\n        this.sorted.unshift(linkable);\n    }\n}\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport uniqueId from \"@ff/core/uniqueId\";\nimport { Dictionary, ClassOf } from \"@ff/core/types\";\nimport Publisher, { ITypedEvent } from \"@ff/core/Publisher\";\nimport ObjectRegistry, { IObjectEvent } from \"@ff/core/ObjectRegistry\";\n\nimport { ILinkable } from \"./PropertyGroup\";\nimport Component, { ComponentOrClass, IComponentEvent } from \"./Component\";\nimport Graph from \"./Graph\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { IComponentEvent }\n\nexport interface INodeEvent<T extends Node = Node> extends IObjectEvent<T>\n{\n}\n\n/**\n * Emitted by [[Node]] after the instance's state has changed.\n * @event\n */\nexport interface INodeChangeEvent<T extends Node = Node> extends ITypedEvent<\"change\">\n{\n    node: T;\n    what: string;\n}\n\n/**\n * Emitted by [[Node]] if the component is about to be disposed.\n * @event\n */\nexport interface INodeDisposeEvent<T extends Node = Node> extends ITypedEvent<\"dispose\">\n{\n    node: T;\n}\n\n/** A [[Node]] instance, [[Node]] constructor function or a node's type string. */\nexport type NodeOrClass<T extends Node = Node> = T | ClassOf<T> | string;\n\n/**\n * Node in an graph/node/component system.\n *\n * ### Events\n * - *\"change\"* - emits [[INodeChangeEvent]] after the node's state has changed.\n * - *\"dispose\"* - emits [[INodeDisposeEvent]] if the node is about to be disposed.\n *\n * ### See also\n * - [[Component]]\n * - [[Graph]]\n * - [[System]]\n */\nexport default class Node extends Publisher\n{\n    static readonly type: string = \"Node\";\n\n    static readonly text: string = \"\";\n    static readonly icon: string = \"\";\n\n    static getClassName<T extends Node>(scope?: NodeOrClass<T>)\n    {\n        return typeof scope === \"function\" ? scope.name : (typeof scope === \"object\"\n            ? scope.constructor.name : (scope || Node.name));\n    }\n\n    /** The node's globally unique id. */\n    readonly id: string;\n\n    /** Collection of all components in this node. */\n    readonly components = new ObjectRegistry<Component>(Component);\n\n    private _graph: Graph = null;\n    private _name: string = \"\";\n\n    /**\n     * Protected constructor. Please use [[Graph.createNode]] / [[Graph.createCustomNode]] to create node instances.\n     * @param id Unique id for the node. A unique id is usually created automatically,\n     * do not specify except while de-serializing the component.\n     *\n     * Note that during execution of the constructor, the node is not yet attached to a graph/system.\n     * Do not try to get access to other nodes, components, the parent graph, or the system here.\n     */\n    constructor(id: string)\n    {\n        super({ knownEvents: false });\n        this.id = id;\n    }\n\n    /**\n     * Returns the class name of this node.\n     */\n    get className() {\n        return this.constructor.name;\n    }\n    get displayClassName() {\n        const name = this.constructor.name;\n        return name === \"Node\" ? name : name.substr(1);\n    }\n\n    get text() {\n        return (this.constructor as typeof Component).text;\n    }\n\n    get icon() {\n        return (this.constructor as typeof Component).icon;\n    }\n\n    /**\n     * Returns the name of this node.\n     */\n    get name() {\n        return this._name;\n    }\n\n    get displayName() {\n        return this._name || this.text || this.displayClassName;\n    }\n\n    /**\n     * Sets the name of this node.\n     * This emits an [[INodeChangeEvent]]\n     * @param value\n     */\n    set name(value: string) {\n        this._name = value;\n        this.emit<INodeChangeEvent>({ type: \"change\", what: \"name\", node: this });\n    }\n\n    /**\n     * Returns the graph this node is part of.\n     */\n    get graph() {\n        return this._graph;\n    }\n\n    /**\n     * Returns the system this node and its graph belong to.\n     */\n    get system() {\n        return this._graph.system;\n    }\n\n    getComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this.components.get(componentOrClass, nothrow);\n    }\n\n    getComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this.components.getArray(componentOrClass);\n    }\n\n    hasComponent(componentOrClass: ComponentOrClass) {\n        return this.components.has(componentOrClass);\n    }\n\n    getGraphComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this.graph.components.get(componentOrClass, nothrow);\n    }\n\n    getGraphComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this.graph.components.getArray(componentOrClass);\n    }\n\n    hasGraphComponent(componentOrClass: ComponentOrClass) {\n        return this.graph.components.has(componentOrClass);\n    }\n\n    getMainComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this._graph.system.graph.components.get(componentOrClass, nothrow);\n    }\n\n    getMainComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this._graph.system.graph.components.getArray(componentOrClass);\n    }\n\n    hasMainComponent(componentOrClass: ComponentOrClass) {\n        return this._graph.system.graph.components.has(componentOrClass);\n    }\n\n    getSystemComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this._graph.system.components.get(componentOrClass, nothrow);\n    }\n\n    getSystemComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this._graph.system.components.getArray(componentOrClass);\n    }\n\n    hasSystemComponent(componentOrClass: ComponentOrClass) {\n        return this._graph.system.components.has(componentOrClass);\n    }\n\n    getComponentById(id: string): Component | null {\n        return this._graph.system.components.getById(id);\n    }\n\n    getNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this._graph.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this._graph.nodes.getArray(nodeOrClass);\n    }\n\n    hasNode(nodeOrClass: NodeOrClass) {\n        return this._graph.nodes.has(nodeOrClass);\n    }\n\n    getMainNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this._graph.system.graph.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getMainNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this._graph.system.graph.nodes.getArray(nodeOrClass);\n    }\n\n    hasMainNode(nodeOrClass: NodeOrClass) {\n        return this._graph.system.graph.nodes.has(nodeOrClass);\n    }\n\n    getSystemNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this._graph.system.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getSystemNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this._graph.system.nodes.getArray(nodeOrClass);\n    }\n\n    hasSystemNode(nodeOrClass: NodeOrClass) {\n        return this._graph.system.nodes.has(nodeOrClass);\n    }\n\n    getNodeById(id: string): Node | null {\n        return this._graph.system.nodes.getById(id);\n    }\n\n    /**\n     * Adds this node to the given graph and the system.\n     * @param graph\n     */\n    attach(graph: Graph)\n    {\n        if (this._graph) {\n            this.detach();\n        }\n\n        this._graph = graph;\n        graph._addNode(this);\n    }\n\n    /**\n     * Removes this node from its graph and system.\n     */\n    detach()\n    {\n        if (this._graph) {\n            this._graph._removeNode(this);\n            this._graph = null;\n        }\n    }\n\n    /**\n     * Override to create an initial set of components for the node.\n     * Note that this function is not called if a node is restored from serialization data.\n     */\n    createComponents()\n    {\n    }\n\n    clear()\n    {\n        // dispose components\n        const componentList = this.components.getArray().slice();\n        componentList.forEach(component => component.dispose());\n    }\n\n    /**\n     * Must be called to delete/destroy the node. This unregisters the node\n     * and all its components from the system.\n     */\n    dispose()\n    {\n        // dispose components\n        const componentList = this.components.getArray().slice();\n        componentList.forEach(component => component.dispose());\n\n        // remove node from system and graph\n        this.detach();\n\n        // emit dispose event\n        this.emit<INodeDisposeEvent>({ type: \"dispose\", node: this });\n    }\n\n    /**\n     * Creates a new component of the given type. Adds it to this node.\n     * @param componentOrType Component constructor, type name, or instance.\n     * @param name Optional name for the component.\n     * @param id Optional unique identifier for the component (must omit unless serializing).\n     */\n    createComponent<T extends Component>(componentOrType: ComponentOrClass<T>, name?: string, id?: string): T\n    {\n        const classType = this.system.registry.getClass(componentOrType);\n        const component = new classType(id || uniqueId(12, this.system.components.getDictionary())) as T;\n\n        component.attach(this);\n\n        if (name) {\n            component.name = name;\n        }\n\n        return component;\n    }\n\n    /**\n     * Tests whether the node is of or descends from the given type.\n     * @param scope Node constructor, type name, or instance.\n     */\n    is(scope: NodeOrClass): boolean\n    {\n        const className = Node.getClassName(scope);\n\n        let prototype = this;\n\n        do {\n            prototype = Object.getPrototypeOf(prototype);\n\n            if (prototype.constructor.name === className) {\n                return true;\n            }\n\n        } while(prototype.constructor.name !== Node.type);\n\n        return false;\n    }\n\n    /**\n     * Returns a text representation of the node.\n     * @param verbose\n     */\n    toString(verbose: boolean = false)\n    {\n        const components = this.components.getArray();\n        const text = `Node '${this.name}' - ${components.length} components`;\n\n        if (verbose) {\n            return text + \"\\n\" + components.map(component => \"  \" + component.toString()).join(\"\\n\");\n        }\n\n        return text;\n    }\n\n    /**\n     * Serializes the node and its components.\n     * Return node serialization data, or null if the node should be excluded from serialization.\n     */\n    deflate()\n    {\n        const json: any = {};\n        const jsonComponents = [];\n\n        const components = this.components.getArray();\n        for (let i = 0, n = components.length; i < n; ++i) {\n            const component = components[i];\n\n            const jsonComp = this.deflateComponent(component);\n\n            jsonComp.type = component.className;\n            jsonComp.id = component.id;\n\n            if (component.name) {\n                jsonComp.name = component.name;\n            }\n\n            jsonComponents.push(jsonComp);\n        }\n\n        if (jsonComponents.length > 0) {\n            json.components = jsonComponents;\n        }\n\n        return json;\n    }\n\n    /**\n     * Deserializes the node and its components.\n     * @param json serialized node data.\n     * @param linkableDict dictionary mapping component ids to components.\n     */\n    inflate(json, linkableDict: Dictionary<ILinkable>)\n    {\n        if (json.components) {\n            json.forEach(jsonComp => {\n                const component = this.createComponent(jsonComp.type, jsonComp.name, jsonComp.id);\n                component.inflate(jsonComp);\n            });\n        }\n    }\n\n    /**\n     * Deserializes the links of all components.\n     * @param json serialized component data.\n     */\n    inflateReferences(json)\n    {\n        if (json.components) {\n            json.components.forEach(jsonComp => {\n                const component = this.components.getById(jsonComp.id);\n                component.inflateReferences(jsonComp);\n            });\n        }\n    }\n\n    /**\n     * Override to control how components are serialized.\n     * Return serialization data or null if the component should be excluded from serialization.\n     * @param component The component to be serialized.\n     */\n    protected deflateComponent(component: Component)\n    {\n        return component.deflate();\n    }\n\n    /**\n     * Adds a component to the node, the node's graph and the system. Called by [[Component.attach]],\n     * do not call directly.\n     * @param component\n     * @private\n     */\n    _addComponent(component: Component)\n    {\n        if (component.isNodeSingleton && this.components.has(component)) {\n            throw new Error(`only one component of class '${component.className}' allowed per node`);\n        }\n\n        this.graph._addComponent(component);\n        this.components.add(component);\n    }\n\n    /**\n     * Removes a component from the node, the node's graph and the system. Called by [[Component.detach]],\n     * do not call directly.\n     * @param component\n     * @private\n     */\n    _removeComponent(component: Component)\n    {\n        this.components.remove(component);\n        this.graph._removeComponent(component);\n    }\n\n}\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport isSubclass from \"@ff/core/isSubclass\";\nimport { Dictionary } from \"@ff/core/types\";\nimport Publisher, { ITypedEvent } from \"@ff/core/Publisher\";\n\nimport { ValueType, canConvert } from \"./convert\";\nimport PropertyGroup, { ILinkable } from \"./PropertyGroup\";\nimport PropertyLink from \"./PropertyLink\";\nimport { schemas, types, IPropertySchema, IPropertyTemplate } from \"./propertyTypes\";\n\n/////////////////////////////////////////////////////////////////////////////////\n\nexport { schemas, types, IPropertySchema, IPropertyTemplate };\n\nexport type PropertyFromTemplate<T> = T extends IPropertyTemplate<infer U> ? Property<U> : never;\nexport type PropertiesFromTemplates<T> = { [P in keyof T]: PropertyFromTemplate<T[P]> };\n\nexport interface IPropertyChangeEvent extends ITypedEvent<\"change\">\n{\n    what: \"path\" | \"options\";\n    property: Property;\n}\n\nexport interface IPropertyLinkEvent extends ITypedEvent<\"link\">\n{\n    link: PropertyLink;\n    add: boolean;\n    remove: boolean;\n}\n\nexport interface IPropertyDisposeEvent extends ITypedEvent<\"dispose\">\n{\n    property: Property;\n}\n\n/**\n * Linkable property.\n */\nexport default class Property<T = any> extends Publisher\n{\n    value: T;\n    changed: boolean;\n\n    readonly type: ValueType;\n    readonly schema: Readonly<IPropertySchema<T>>;\n    readonly user: boolean;\n    readonly elementCount: number;\n\n    readonly inLinks: PropertyLink[];\n    readonly outLinks: PropertyLink[];\n\n    private _group: PropertyGroup;\n    private _key: string;\n    private _path: string;\n\n    /**\n     * Creates a new linkable property.\n     * @param path Name and group(s) the property is displayed under.\n     * @param schema Property schema definition.\n     * @param user Marks the property as user-defined if set to true.\n     */\n    constructor(path: string, schema: IPropertySchema<T>, user?: boolean)\n    {\n        super();\n        this.addEvents(\"value\", \"link\", \"change\", \"dispose\");\n\n        if (!schema || schema.preset === undefined) {\n            throw new Error(\"missing schema/preset\");\n        }\n\n        const preset = schema.preset;\n        const isArray = Array.isArray(preset);\n\n        this.type = typeof (isArray ? preset[0] : preset) as ValueType;\n        this.schema = schema;\n        this.user = user || false;\n        this.elementCount = isArray ? (preset as any).length : 1;\n\n        this.inLinks = [];\n        this.outLinks = [];\n\n        this._group = null;\n        this._key = \"\";\n        this._path = path;\n\n        this.value = null;\n        this.reset();\n        this.changed = !schema.event;\n    }\n\n    get group() {\n        return this._group;\n    }\n    get key() {\n        return this._key;\n    }\n\n    get path() {\n        return this._path;\n    }\n    set path(path: string) {\n        this._path = path;\n        this.emit<IPropertyChangeEvent>({ type: \"change\", what: \"path\", property: this });\n    }\n\n    /**\n     * Adds the property to the given group.\n     * @param group The property group this property should be added to.\n     * @param key An optional key under which the property is accessible in the property group.\n     * @param index An optional index position where the property should be inserted in the group.\n     */\n    attach(group: PropertyGroup, key?: string, index?: number)\n    {\n        group._addProperty(this, key, index);\n    }\n\n    /**\n     * Removes the property from the group it was previously added to.\n     * Does nothing if the property is not member of a group.\n     */\n    detach()\n    {\n        if (this._group) {\n            this._group._removeProperty(this);\n        }\n    }\n\n    /**\n     * Removes the property from its group, removes all links.\n     * Emits a [[IPropertyDisposeEvent]] event.\n     */\n    dispose()\n    {\n        this.unlink();\n        this.detach();\n\n        this.emit<IPropertyDisposeEvent>({ type: \"dispose\", property: this });\n    }\n\n    setValue(value: T, silent?: boolean)\n    {\n        this.value = value;\n\n        if (!silent) {\n            this.changed = true;\n\n            if (this.isInput()) {\n                this._group.linkable.changed = true;\n            }\n        }\n\n        this.emit(\"value\", value);\n\n        const outLinks = this.outLinks;\n        for (let i = 0, n = outLinks.length; i < n; ++i) {\n            outLinks[i].push();\n        }\n    }\n\n    copyValue(value: T, silent?: boolean)\n    {\n        if (Array.isArray(value)) {\n            value = value.slice() as any;\n        }\n\n        this.setValue(value, silent);\n    }\n\n    set(silent?: boolean)\n    {\n        if (!silent) {\n            this.changed = true;\n\n            if (this.isInput()) {\n                this._group.linkable.changed = true;\n            }\n        }\n\n        this.emit(\"value\", this.value);\n\n        const outLinks = this.outLinks;\n        for (let i = 0, n = outLinks.length; i < n; ++i) {\n            outLinks[i].push();\n        }\n    }\n\n    cloneValue(): T\n    {\n        const value = this.value;\n        return Array.isArray(value) ? value.slice() as any : value;\n    }\n\n    /**\n     * Returns the property value, validated against the property schema.\n     * @param result Optional array to write the validated values into.\n     */\n    getValidatedValue(result?: T)\n    {\n        const value = this.value as any;\n\n        if (this.isArray()) {\n            result = result || [] as any as T;\n            for (let i = 0, n = value.length; i < n; ++i) {\n                result[i] = this.validateValue(value[i]);\n            }\n            return result;\n        }\n\n        return this.validateValue(value);\n    }\n\n    linkTo(destination: Property, sourceIndex?: number, destinationIndex?: number)\n    {\n        destination.linkFrom(this, sourceIndex, destinationIndex);\n    }\n\n    linkFrom(source: Property, sourceIndex?: number, destinationIndex?: number)\n    {\n        if (!this.canLinkFrom(source, sourceIndex, destinationIndex)) {\n            throw new Error(\"can't link\");\n        }\n\n        const link = new PropertyLink(source, this, sourceIndex, destinationIndex);\n        source.addOutLink(link);\n        this.addInLink(link);\n    }\n\n    unlinkTo(destination: Property, sourceIndex?: number, destinationIndex?: number)\n    {\n        destination.unlinkFrom(this, sourceIndex, destinationIndex);\n    }\n\n    unlinkFrom(source: Property, sourceIndex?: number, destinationIndex?: number): boolean\n    {\n        const link = this.inLinks.find(link =>\n            link.source === source\n            && link.sourceIndex === sourceIndex\n            && link.destinationIndex === destinationIndex\n        );\n\n        if (!link) {\n            return false;\n        }\n\n        source.removeOutLink(link);\n        this.removeInLink(link);\n\n        return true;\n    }\n\n    unlink()\n    {\n        const inLinks = this.inLinks.slice();\n        inLinks.forEach(link => {\n            link.source.removeOutLink(link);\n            this.removeInLink(link)\n        });\n\n        const outLinks = this.outLinks.slice();\n        outLinks.forEach(link => {\n            this.removeOutLink(link);\n            link.destination.removeInLink(link);\n        });\n\n        if (this.inLinks.length !== 0 || this.outLinks.length !== 0) {\n            throw new Error(\"fatal: leftover links\");\n        }\n    }\n\n    addInLink(link: PropertyLink)\n    {\n        if(link.destination !== this) {\n            throw new Error(\"input link's destination must equal this\");\n        }\n\n        this.inLinks.push(link);\n        this.requestSort();\n\n        this.emit<IPropertyLinkEvent>({\n            type: \"link\", add: true, remove: false, link\n        });\n    }\n\n    addOutLink(link: PropertyLink)\n    {\n        if(link.source !== this) {\n            throw new Error(\"output link's source must equal this\");\n        }\n\n        this.outLinks.push(link);\n        this.requestSort();\n\n        // push value through added link\n        link.push();\n    }\n\n    removeInLink(link: PropertyLink)\n    {\n        const index = this.inLinks.indexOf(link);\n        if (index < 0) {\n            throw new Error(\"input link not found\");\n        }\n\n        this.inLinks.splice(index, 1);\n        this.requestSort();\n\n                // if last link is removed and if object, reset to default (usually null) values\n        if (this.inLinks.length === 0 && this.type === \"object\") {\n            this.reset();\n        }\n\n        this.emit<IPropertyLinkEvent>({\n            type: \"link\", add: false, remove: true, link\n        });\n    }\n\n    removeOutLink(link: PropertyLink)\n    {\n        const index = this.outLinks.indexOf(link);\n        if (index < 0) {\n            throw new Error(\"output link not found\");\n        }\n\n        this.outLinks.splice(index, 1);\n        this.requestSort();\n    }\n\n    canLinkTo(destination: Property, sourceIndex?: number, destinationIndex?: number): boolean\n    {\n        return destination.canLinkFrom(this, sourceIndex, destinationIndex);\n    }\n\n    canLinkFrom(source: Property, sourceIndex?: number, destinationIndex?: number): boolean\n    {\n        // can't link to an output property\n        if (this.isOutput()) {\n            return false;\n        }\n\n        const hasSrcIndex = sourceIndex >= 0;\n        const hasDstIndex = destinationIndex >= 0;\n\n        if (!source.isArray() && hasSrcIndex) {\n            throw new Error(\"non-array source property; can't link to element\");\n        }\n        if (!this.isArray() && hasDstIndex) {\n            throw new Error(\"non-array destination property; can't link to element\");\n        }\n\n        const srcIsArray = source.isArray() && !hasSrcIndex;\n        const dstIsArray = this.isArray() && !hasDstIndex;\n\n        if (srcIsArray !== dstIsArray) {\n            return false;\n        }\n        if (srcIsArray && source.elementCount !== this.elementCount) {\n            return false;\n        }\n\n        if (source.type === \"object\" && this.type === \"object\") {\n            if (!isSubclass(source.schema.objectType, this.schema.objectType)) {\n                return false;\n            }\n        }\n\n        return canConvert(source.type, this.type);\n    }\n\n    reset()\n    {\n        let value;\n\n        if (this.isMulti()) {\n            let multiArray: T[] = this.value as any;\n\n            if (!multiArray) {\n                value = multiArray = [] as any;\n            }\n            else {\n                multiArray.length = 1;\n            }\n\n            multiArray[0] = this.clonePreset();\n        }\n        else {\n            value = this.clonePreset();\n        }\n\n        // set changed flag and push to output links\n        this.setValue(value);\n    }\n\n    setMultiChannelCount(count: number)\n    {\n        if (!this.isMulti()) {\n            throw new Error(\"can't set multi channel count on non-multi property\");\n        }\n\n        const multiArray: T[] = this.value as any;\n        const currentCount = multiArray.length;\n        multiArray.length = count;\n\n        for (let i = currentCount; i < count; ++i) {\n            multiArray[i] = this.clonePreset();\n        }\n\n        this.changed = true;\n    }\n\n    requestSort()\n    {\n        if (this._group && this._group.linkable) {\n            this._group.linkable.requestSort();\n        }\n    }\n\n    setOptions(options: string[])\n    {\n        if (!this.schema.options) {\n            throw new Error(`property type mismatch, can't set options on '${this.path}'`);\n        }\n\n        (this.schema as IPropertySchema).options = options.slice();\n        this.emit<IPropertyChangeEvent>({ type: \"change\", what: \"options\", property: this });\n    }\n\n    getOptionText()\n    {\n        const options = this.schema.options;\n        if (this.type === \"number\" && options) {\n            const i = Math.trunc(this.value as any);\n            return options[i < 0 ? 0 : (i >= options.length ? 0 : i)] || \"\";\n        }\n    }\n\n    isInput(): boolean\n    {\n        return this._group && this._group === this._group.linkable.ins;\n    }\n\n    isOutput(): boolean\n    {\n        return this._group && this._group === this._group.linkable.outs;\n    }\n\n    isArray(): boolean\n    {\n        return Array.isArray(this.schema.preset);\n    }\n\n    isMulti(): boolean\n    {\n        return !!this.schema.multi;\n    }\n\n    isDefault()\n    {\n        const value = this.schema.multi ? this.value[0] : this.value;\n        const preset = this.schema.preset;\n        const valueLength = Array.isArray(value) ? value.length : -1;\n        const presetLength = Array.isArray(preset) ? preset.length : -1;\n\n        if (valueLength !== presetLength) {\n            return false;\n        }\n\n        if (valueLength >= 0) {\n            for (let i = 0; i < valueLength; ++i) {\n                if (value[i] !== preset[i]) {\n                    return false;\n                }\n            }\n            return true;\n        }\n\n        return value === preset;\n    }\n\n    hasInLinks(index?: number)\n    {\n        const links = this.inLinks;\n\n        if (!(index >= 0)) {\n            return links.length > 0;\n        }\n\n        for (let i = 0, n = links.length; i < n; ++i) {\n            if (links[i].destinationIndex === index) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    hasMainInLinks()\n    {\n        const links = this.inLinks;\n\n        for (let i = 0, n = links.length; i < n; ++i) {\n            if (!(links[i].destinationIndex >= 0)) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    hasOutLinks(index?: number)\n    {\n        const links = this.outLinks;\n\n        if (!(index >= 0)) {\n            return links.length > 0;\n        }\n\n        for (let i = 0, n = links.length; i < n; ++i) {\n            if (links[i].sourceIndex === index) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    inLinkCount()\n    {\n        return this.inLinks.length;\n    }\n\n    outLinkCount()\n    {\n        return this.outLinks.length;\n    }\n\n    deflate()\n    {\n        let json: any = this.user ? {\n            path: this.path,\n            schema: Object.assign({}, this.schema)\n        } : null;\n\n        if (!this.isOutput() && !this.hasMainInLinks() && !this.isDefault() && this.type !== \"object\") {\n            json = json || {};\n            json.value = this.value;\n        }\n\n        if (this.outLinks.length > 0) {\n            json = json || {};\n            json.links = this.outLinks.map(link => {\n                const jsonLink: any = {\n                    id: link.destination._group.linkable.id,\n                    key: link.destination.key\n                };\n                if (link.sourceIndex >= 0) {\n                    jsonLink.srcIndex = link.sourceIndex;\n                }\n                if (link.destinationIndex >= 0) {\n                    jsonLink.dstIndex = link.destinationIndex;\n                }\n                return jsonLink;\n            });\n        }\n\n        return json;\n    }\n\n    inflate(json: any, linkableDict: Dictionary<ILinkable>)\n    {\n        if (json.value !== undefined) {\n            this.value = json.value;\n        }\n\n        if (json.links !== undefined) {\n            json.links.forEach(link => {\n                const target = linkableDict[link.id];\n                const property = target.ins[link.key];\n                property.linkFrom(this, link.srcIndex, link.dstIndex);\n            });\n        }\n    }\n\n    /**\n     * Returns a text representation.\n     */\n    toString()\n    {\n        const schema = this.schema;\n        const typeName = schema.event ? \"event\" : (schema.options ? \"enum\" : this.type);\n        return `${this.path} [${typeName}]`\n    }\n\n    /**\n     * Validates the given value against the property schema.\n     * @param value\n     */\n    protected validateValue(value: any)\n    {\n        const schema = this.schema;\n\n        if (schema.enum) {\n            const i = Math.trunc(value);\n            return schema.enum[i] ? i : 0;\n        }\n        if (schema.options) {\n            const i = Math.trunc(value);\n            return i < 0 ? 0 : (i >= schema.options.length ? 0 : i);\n        }\n        if (this.type === \"number\") {\n            value = schema.min ? Math.max(schema.min, value) : value;\n            value = schema.max ? Math.min(schema.max, value) : value;\n            return value;\n        }\n\n        return value;\n    }\n\n    protected clonePreset(): T\n    {\n        const preset = this.schema.preset;\n        return Array.isArray(preset) ? preset.slice() as any : preset;\n    }\n}\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { Dictionary } from \"@ff/core/types\";\nimport Publisher, { ITypedEvent } from \"@ff/core/Publisher\";\n\nimport Property, { IPropertyTemplate, PropertiesFromTemplates } from \"./Property\";\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * To make use of linkable properties and property sets, classes must implement this interface.\n */\nexport interface ILinkable\n{\n    /** A unique identifier for this instance. */\n    id: string;\n    /** Will be set to true if an input property changes. */\n    changed: boolean;\n\n    /** Set of input properties. */\n    readonly ins: PropertyGroup;\n    /** Set of output properties. */\n    readonly outs: PropertyGroup;\n\n    /** Called after property links have been added or removed. */\n    requestSort: () => void;\n}\n\n/**\n * Emitted by [[Properties]] after changes in the properties configuration.\n * @event\n */\nexport interface IPropertyGroupPropertyEvent extends ITypedEvent<\"property\">\n{\n    add: boolean;\n    remove: boolean;\n    property: Property;\n}\n\n/**\n * A set of properties. Properties can be linked, such that one property updates another.\n * After adding properties to the set, they are available on the set using their key.\n * To make use of linkable properties, classes must implement the [[ILinkable]] interface.\n *\n * ### Events\n * - *\"change\"* - emits [[IPropertiesChangeEvent]] after properties have been added, removed, or renamed.\n */\nexport default class PropertyGroup extends Publisher\n{\n    linkable: ILinkable;\n    properties: Property[];\n\n    constructor(linkable: ILinkable)\n    {\n        super();\n        this.addEvent(\"property\");\n\n        this.linkable = linkable;\n        this.properties = [];\n    }\n\n    dispose()\n    {\n        this.unlinkAllProperties();\n    }\n\n    isInputGroup()\n    {\n        return this === this.linkable.ins;\n    }\n\n    isOutputGroup()\n    {\n        return this === this.linkable.outs;\n    }\n\n    /**\n     * Appends properties to the set.\n     * @param templates plain object with property templates.\n     * @param index Optional index at which to insert the properties.\n     */\n    createPropertiesFromTemplates<U>(templates: U, index?: number): this & PropertiesFromTemplates<U>\n    {\n        Object.keys(templates).forEach((key, i) => {\n            const ii = index === undefined ? undefined : index + i;\n            this.createPropertyFromTemplate(templates[key], key, ii);\n        });\n\n        return this as this & PropertiesFromTemplates<U>;\n    }\n\n    createPropertyFromTemplate(template: IPropertyTemplate, key?: string, index?: number)\n    {\n        const property = new Property(template.path, template.schema);\n        this._addProperty(property, key, index);\n    }\n\n    /**\n     * Returns a property by key.\n     * @param {string} key The key of the property to be returned.\n     * @returns {Property}\n     */\n    getProperty(key: string)\n    {\n        const property = this[key];\n        if (!property) {\n            throw new Error(`no property found with key '${key}'`);\n        }\n\n        return property;\n    }\n\n    getKeys(includeObjects: boolean = false)\n    {\n        const keys: string[] = [];\n        this.properties.forEach(property => {\n            if (includeObjects || property.type !== \"object\") {\n                keys.push(property.key)\n            }\n        });\n        return keys;\n    }\n\n    getValues(includeObjects: boolean = false)\n    {\n        const values: any[] = [];\n        this.properties.map(property => {\n            if (includeObjects || property.type !== \"object\") {\n                values.push(property.value)\n            }\n        });\n        return values;\n    }\n\n    cloneValues(includeObjects: boolean = false)\n    {\n        const values: any[] = [];\n        this.properties.map(property => {\n            if (includeObjects || property.type !== \"object\") {\n                values.push(property.cloneValue())\n            }\n        });\n        return values;\n    }\n\n    setValues(values: Dictionary<any>)\n    {\n        Object.keys(values).forEach(\n            key => this.getProperty(key).value = values[key]\n        );\n    }\n\n    /**\n     * Sets the values of multiple properties. Properties are identified by key.\n     * @param values Dictionary of property key/value pairs.\n     */\n    copyValues(values: Dictionary<any>)\n    {\n        Object.keys(values).forEach(\n            key => this.getProperty(key).copyValue(values[key])\n        );\n    }\n\n    unlinkAllProperties()\n    {\n        this.properties.forEach(property => property.unlink());\n    }\n\n    deflate()\n    {\n        let json: any = null;\n\n        this.properties.forEach(property => {\n            const jsonProp = property.deflate();\n            if (jsonProp) {\n                json = json || {};\n                json[property.key] = jsonProp;\n            }\n        });\n\n        return json;\n    }\n\n    inflate(json: any)\n    {\n        Object.keys(json).forEach(key => {\n            const jsonProp = json[key];\n            if (jsonProp.schema) {\n                const property = new Property(jsonProp.path, jsonProp.schema, true);\n                property.attach(this, key);\n            }\n        });\n    }\n\n    inflateLinks(json: any, linkableDict: Dictionary<ILinkable>)\n    {\n        Object.keys(json).forEach(key => {\n            this[key].inflate(json[key], linkableDict);\n        });\n    }\n\n    _addProperty(property: Property, key?: string, index?: number)\n    {\n        if (property.group) {\n            property.detach();\n        }\n\n        if (key && this[key]) {\n            throw new Error(`key '${key}' already exists in group`);\n        }\n\n        (property as any)._group = this;\n        (property as any)._key = key;\n\n        if (index === undefined) {\n            this.properties.push(property);\n        }\n        else {\n            this.properties.splice(index, 0, property);\n        }\n\n        if (key) {\n            this[key] = property;\n        }\n\n        this.emit<IPropertyGroupPropertyEvent>({\n            type: \"property\", add: true, remove: false, property\n        });\n    }\n\n    /**\n     * Removes the given property from the set.\n     * @param {Property} property The property to be removed.\n     */\n    _removeProperty(property: Property)\n    {\n        if (property.group === this) {\n\n            if (this[property.key] !== property) {\n                throw new Error(`property not found in group: ${property.key}`);\n            }\n\n            this.properties.slice(this.properties.indexOf(property), 1);\n\n            if (property.key) {\n                delete this[property.key];\n            }\n\n            (property as any)._group = null;\n            (property as any)._key = \"\";\n\n            this.emit<IPropertyGroupPropertyEvent>({\n                type: \"property\", add: false, remove: true, property\n            });\n        }\n    }\n}\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport Property from \"./Property\";\nimport { getConversionFunction, getElementCopyFunction, getMultiCopyFunction } from \"./convert\";\n\n////////////////////////////////////////////////////////////////////////////////\n\ntype ConversionFunction = (inVal: any, outVal: any) => any;\n\nexport default class PropertyLink\n{\n    source: Property;\n    destination: Property;\n\n    sourceIndex: number | undefined;\n    destinationIndex: number | undefined;\n\n    protected fnConvert: ConversionFunction;\n    protected fnCopy: (inVal: any, outVal: any, fnConvert: ConversionFunction) => any;\n\n    constructor(source: Property, destination: Property, sourceIndex?: number, destinationIndex?: number)\n    {\n        if (source.elementCount === 1 && sourceIndex >= 0) {\n            throw new Error(\"non-array source property; can't link to element\");\n        }\n        if (destination.elementCount === 1 && destinationIndex >= 0) {\n            throw new Error(\"non-array destination property; can't link to element\");\n        }\n\n        this.source = source;\n        this.destination = destination;\n\n        this.sourceIndex = sourceIndex;\n        this.destinationIndex = destinationIndex;\n\n        const srcIndex = sourceIndex === undefined ? -1 : sourceIndex;\n        const dstIndex = destinationIndex === undefined ? -1 : destinationIndex;\n        const isArray = source.elementCount > 1 && srcIndex < 0 && dstIndex < 0;\n\n        this.fnConvert = getConversionFunction(source.type, destination.type, isArray);\n        const fnElementCopy = getElementCopyFunction(srcIndex, dstIndex, this.fnConvert);\n        this.fnCopy = getMultiCopyFunction(source.isMulti(), destination.isMulti(), fnElementCopy);\n    }\n\n    push()\n    {\n        this.destination.setValue(this.fnCopy(this.source.value, this.destination.value, this.fnConvert));\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport Publisher from \"@ff/core/Publisher\";\nimport ObjectRegistry from \"@ff/core/ObjectRegistry\";\nimport ClassRegistry from \"@ff/core/ClassRegistry\";\n\nimport Component, { ComponentOrClass, IComponentEvent } from \"./Component\";\nimport Node, { INodeEvent, NodeOrClass } from \"./Node\";\nimport Graph from \"./Graph\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { IComponentEvent, INodeEvent };\n\nexport default class System extends Publisher\n{\n    readonly registry: ClassRegistry;\n    readonly graph: Graph;\n\n    readonly nodes = new ObjectRegistry<Node>(Node);\n    readonly components = new ObjectRegistry<Component>(Component);\n\n\n    constructor(registry?: ClassRegistry)\n    {\n        super({ knownEvents: false });\n\n        this.registry = registry || new ClassRegistry();\n        this.graph = new Graph(this, null);\n    }\n\n    getComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this.components.get(componentOrClass, nothrow);\n    }\n\n    getComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this.components.getArray(componentOrClass);\n    }\n\n    hasComponents(componentOrClass: ComponentOrClass) {\n        return this.components.has(componentOrClass);\n    }\n\n    getMainComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this.graph.components.get(componentOrClass, nothrow);\n    }\n\n    getMainComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this.graph.components.getArray(componentOrClass);\n    }\n\n    hasMainComponents(componentOrClass: ComponentOrClass) {\n        return this.graph.components.has(componentOrClass);\n    }\n\n    getNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this.nodes.getArray(nodeOrClass);\n    }\n\n    hasNodes(nodeOrClass: NodeOrClass) {\n        return this.nodes.has(nodeOrClass);\n    }\n\n    getMainNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this.graph.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getMainNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this.graph.nodes.getArray(nodeOrClass);\n    }\n\n    hasMainNodes(nodeOrClass: NodeOrClass) {\n        return this.graph.nodes.has(nodeOrClass);\n    }\n\n    findNodeByName<T extends Node = Node>(name: string, nodeOrClass?: NodeOrClass<T>): T | undefined\n    {\n        const nodes = this.nodes.getArray(nodeOrClass);\n\n        for (let i = 0, n = nodes.length; i < n; ++i) {\n            if (nodes[i].name === name) {\n                return nodes[i];\n            }\n        }\n\n        return undefined;\n    }\n\n    /**\n     * Serializes the content of the system, ready to be stringified.\n     */\n    deflate()\n    {\n        return this.graph.deflate();\n    }\n\n    /**\n     * Deserializes the given JSON object.\n     * @param json\n     */\n    inflate(json)\n    {\n        this.graph.inflate(json);\n    }\n\n    toString(verbose: boolean = false)\n    {\n        const nodes = this.nodes.getArray();\n        const numComponents = this.components.count();\n\n        const text = `System - ${nodes.length} nodes, ${numComponents} components.`;\n\n        if (verbose) {\n            return text + \"\\n\" + nodes.map(node => node.toString(true)).join(\"\\n\");\n        }\n\n        return text;\n    }\n\n    _addNode(node: Node)\n    {\n        this.nodes.add(node);\n    }\n\n    _removeNode(node: Node)\n    {\n        this.nodes.remove(node);\n    }\n\n    _addComponent(component: Component)\n    {\n        if (component.isSystemSingleton && this.components.has(component)) {\n            throw new Error(`only one component of class '${component.className}' allowed per system`);\n        }\n\n        this.components.add(component);\n    }\n\n    _removeComponent(component: Component)\n    {\n        this.components.remove(component);\n    }\n}\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { ReturnType } from \"@ff/core/types\";\nimport Commander from \"@ff/core/Commander\";\n\nimport Component, { types } from \"../Component\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { Commander, types  };\nexport type Actions<T extends CController<any>> = ReturnType<T[\"createActions\"]>;\n\nexport default class CController<T extends CController<any>> extends Component\n{\n    static readonly type: string = \"CController\";\n    static readonly isSystemSingleton: boolean = true;\n\n    readonly actions: Actions<CController<T>>;\n\n    createActions(commander: Commander)\n    {\n        return {};\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport Component, { ComponentOrClass, IUpdateContext } from \"../Component\";\nimport Graph from \"../Graph\";\n\nimport CHierarchy from \"./CHierarchy\";\nimport Node, { NodeOrClass } from \"../Node\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class CGraph extends Component\n{\n    static readonly type: string = \"CGraph\";\n\n    protected _innerGraph: Graph = null;\n    protected _innerRoot: CHierarchy = null;\n\n    get innerGraph() {\n        return this._innerGraph;\n    }\n\n    get innerRoot() {\n        return this._innerRoot;\n    }\n    set innerRoot(root: CHierarchy) {\n        this._innerRoot = root;\n    }\n\n    getInnerComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>, nothrow: boolean = false) {\n        return this._innerGraph.components.get(componentOrClass, nothrow);\n    }\n\n    getInnerComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this._innerGraph.components.getArray(componentOrClass);\n    }\n\n    hasInnerComponent(componentOrClass: ComponentOrClass) {\n        return this._innerGraph.components.has(componentOrClass);\n    }\n\n    getInnerNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>, nothrow: boolean = false) {\n        return this._innerGraph.nodes.get(nodeOrClass, nothrow);\n    }\n\n    getInnerNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this._innerGraph.nodes.getArray(nodeOrClass);\n    }\n\n    hasInnerNode(nodeOrClass: NodeOrClass) {\n        return this._innerGraph.nodes.has(nodeOrClass);\n    }\n\n    create()\n    {\n        this._innerGraph = new Graph(this.system, this);\n    }\n\n    update(context: IUpdateContext): boolean\n    {\n        // TODO: Evaluate interface ins/outs\n        return false;\n    }\n\n    tick(context: IUpdateContext): boolean\n    {\n        return this._innerGraph.tick(context);\n    }\n\n    finalize(context: IUpdateContext)\n    {\n        return this._innerGraph.finalize(context);\n    }\n\n    dispose()\n    {\n        this._innerGraph.clear();\n        this._innerGraph = null;\n        this._innerRoot = null;\n\n        super.dispose();\n    }\n\n    inflate(json: any)\n    {\n        super.inflate(json);\n        this._innerGraph.inflate(json.graph);\n    }\n\n    deflate()\n    {\n        const json = super.deflate();\n        json.graph = this._innerGraph.deflate();\n        return json;\n    }\n}\n\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { ITypedEvent } from \"@ff/core/Publisher\";\n\nimport Component, { ComponentOrClass, types } from \"../Component\";\nimport Node from \"../Node\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { Node };\n\nconst _getChildComponent = <T extends Component>(\n    hierarchy: CHierarchy, componentOrType: ComponentOrClass<T>, recursive: boolean): T | null => {\n\n    let component;\n\n    const children = hierarchy.children;\n    for (let i = 0, n = children.length; i < n; ++i) {\n        component = children[i].components.get(componentOrType);\n\n        if (component) {\n            return component;\n        }\n    }\n\n    if (recursive) {\n        for (let i = 0, n = children.length; i < n; ++i) {\n            component = _getChildComponent(children[i], componentOrType, true);\n            if (component) {\n                return component;\n            }\n        }\n    }\n\n    return null;\n};\n\nconst _getChildComponents = <T extends Component>(\n    hierarchy: CHierarchy, componentOrType: ComponentOrClass<T>, recursive: boolean): T[] => {\n\n    let components = [];\n\n    const children = hierarchy.children;\n    for (let i = 0, n = children.length; i < n; ++i) {\n        components = components.concat(children[i].components.getArray(componentOrType));\n    }\n\n    if (recursive) {\n        for (let i = 0, n = children.length; i < n; ++i) {\n            components = components.concat(_getChildComponents(children[i], componentOrType, true));\n        }\n    }\n\n    return components;\n};\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Emitted by [[Hierarchy]] component after it's parent has changed.\n * @event\n */\nexport interface IHierarchyEvent extends ITypedEvent<\"hierarchy\">\n{\n    parent: CHierarchy;\n    child: CHierarchy;\n    add: boolean;\n    remove: boolean;\n}\n\nconst _inputs = {\n    blocked: types.Boolean(\"Hierarchy.Blocked\"),\n};\n\n/**\n * Allows arranging components in a hierarchical structure.\n *\n * ### Events\n * - *\"change\"* - emits [[IHierarchyChangeEvent]] after the instance's state has changed.\n */\nexport default class CHierarchy extends Component\n{\n    ins = this.addInputs(_inputs);\n\n    protected _parent: CHierarchy = null;\n    protected _children: CHierarchy[] = [];\n\n    /**\n     * Returns the parent component of this.\n     * @returns {CHierarchy}\n     */\n    get parent(): CHierarchy\n    {\n        return this._parent;\n    }\n\n    /**\n     * Returns an array of child components of this.\n     * @returns {Readonly<CHierarchy[]>}\n     */\n    get children(): Readonly<CHierarchy[]>\n    {\n        return this._children || [];\n    }\n\n    dispose()\n    {\n        // detach this from its parent\n        if (this._parent) {\n            this._parent.removeChild(this);\n        }\n\n        // dispose of children\n        this._children.slice().forEach(child => child.node.dispose());\n\n        super.dispose();\n    }\n\n    /**\n     * Returns a component at the root of the hierarchy.\n     * @returns A component of the given type that is a sibling of the root hierarchy component.\n     */\n    getRoot<T extends Component>(componentOrType: ComponentOrClass<T>): T | null\n    {\n        let root: CHierarchy = this;\n        while(root._parent) {\n            root = root._parent;\n        }\n\n        return root ? root.node.components.get(componentOrType) : null;\n    }\n\n    /**\n     * Returns a component from the parent node of the node of this component.\n     * @param componentOrType\n     * @param recursive If true, extends search to entire chain of ancestors,\n     * including parent graphs.\n     */\n    getParent<T extends Component>(componentOrType: ComponentOrClass<T>, recursive: boolean): T | null\n    {\n        let parent = this._parent;\n\n        if (!parent) {\n            return null;\n        }\n\n        let component = parent.node.components.get(componentOrType);\n        if (component) {\n            return component;\n        }\n\n        if (recursive) {\n            parent = parent._parent;\n\n            // if at root, continue search at parent graph\n            if (!parent) {\n                const parentGraphComponent = this.graph.parent;\n                parent = parentGraphComponent ? parentGraphComponent.hierarchy : null;\n            }\n\n            while(parent) {\n                component = parent.node.components.get(componentOrType);\n                if (component) {\n                    return component;\n                }\n            }\n        }\n\n        return null;\n    }\n\n    /**\n     * Returns the child component of the given type.\n     * @param componentOrType\n     * @param recursive If true, extends search to entire subtree (breadth-first).\n     */\n    getChild<T extends Component>(componentOrType: ComponentOrClass<T>, recursive: boolean): T | null\n    {\n        return _getChildComponent(this, componentOrType, recursive);\n    }\n\n    /**\n     * Returns all child components of the given type.\n     * @param componentOrType\n     * @param recursive If true, extends search to entire subtree (breadth-first).\n     */\n    getChildren<T extends Component>(componentOrType: ComponentOrClass<T>, recursive: boolean): Readonly<T[]>\n    {\n        return _getChildComponents(this, componentOrType, recursive);\n    }\n\n    /**\n     * Returns true if there is a child component of the given type.\n     * @param componentOrType\n     * @param recursive If true, extends search to entire subtree (breadth-first).\n     */\n    hasChildren<T extends Component>(componentOrType: ComponentOrClass<T>, recursive: boolean): boolean\n    {\n        return !!_getChildComponent(this, componentOrType, recursive);\n    }\n\n    /**\n     * Adds another hierarchy component as a child to this component.\n     * Emits a hierarchy event at this component, its node and all their parents.\n     * @param {CHierarchy} component\n     */\n    addChild(component: CHierarchy)\n    {\n        if (component._parent) {\n            throw new Error(\"can't add as child: component already has a parent\");\n        }\n        if (component === this.graph.root) {\n            throw new Error(\"can't add as child: component is root of graph\");\n        }\n\n        component._parent = this;\n        this._children.push(component);\n\n        const event: IHierarchyEvent = {\n            type: \"hierarchy\", add: true, remove: false, parent: this, child: component\n        };\n\n        while (component) {\n            component.emit<IHierarchyEvent>(event);\n            component.node.emit<IHierarchyEvent>(event);\n            component = component._parent;\n        }\n\n        this.graph.emit<IHierarchyEvent>(event);\n        this.system.emit<IHierarchyEvent>(event);\n    }\n\n    /**\n     * Removes a child component from this hierarchy component.\n     * Emits a hierarchy event at this component, its node and all their parents.\n     * @param {CHierarchy} component\n     */\n    removeChild(component: CHierarchy)\n    {\n        if (component._parent !== this) {\n            throw new Error(\"component not a child of this\");\n        }\n\n        const index = this._children.indexOf(component);\n        this._children.splice(index, 1);\n        component._parent = null;\n\n        const event: IHierarchyEvent = {\n            type: \"hierarchy\", add: false, remove: true, parent: this, child: component\n        };\n\n        while (component) {\n            component.emit<IHierarchyEvent>(event);\n            component.node.emit<IHierarchyEvent>(event);\n            component = component._parent;\n        }\n\n        this.graph.emit<IHierarchyEvent>(event);\n        this.system.emit<IHierarchyEvent>(event);\n    }\n\n    deflate()\n    {\n        const json = super.deflate();\n\n        if (this._children.length > 0) {\n            json.children = this._children.map(child => child.id);\n        }\n\n        return json;\n    }\n\n    inflateReferences(json: any)\n    {\n        super.inflateReferences(json);\n\n        const dict = this.system.components.getDictionary();\n\n        if (json.children) {\n            json.children.forEach(childId => {\n                const child = dict[childId] as CHierarchy;\n                this.addChild(child);\n            })\n        }\n    }\n\n    /**\n     * Returns a text representation of this object.\n     * @returns {string}\n     */\n    toString()\n    {\n        return super.toString() + ` - children: ${this.children.length}`;\n    }\n}\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { EEasingCurve, getEasingFunction } from \"@ff/core/easing\";\n\nimport { types } from \"../propertyTypes\";\nimport { IPulseContext } from \"./CPulse\";\nimport Component from \"../Component\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst offsetSchema = { preset: 0, min: 0, max: 1, bar: true };\n\nexport enum ETimeBase { Relative, Absolute }\nexport enum EInterpolationMode { Forward, Backward, Alternate }\n\nconst ins = {\n    run: types.Boolean(\"Control.Run\"),\n    start: types.Event(\"Control.Start\"),\n    pause: types.Event(\"Control.Pause\"),\n    stop: types.Event(\"Control.Stop\"),\n    min: types.Number(\"Value.Min\"),\n    max: types.Number(\"Value.Max\", 1),\n    curve: types.Enum(\"Interpolation.Curve\", EEasingCurve),\n    mode: types.Enum(\"Interpolation.Mode\", EInterpolationMode),\n    duration: types.Number(\"Time.Duration\", 1),\n    base: types.Enum(\"Time.Base\", ETimeBase),\n    offset: types.Number(\"Time.Offset\", offsetSchema),\n    repetitions: types.Natural(\"Time.Repetitions\")\n};\n\nconst outs = {\n    value: types.Number(\"Value\"),\n    repetition: types.Natural(\"Repetition\"),\n    repeat: types.Event(\"Repeat\")\n};\n\nexport default class COscillator extends Component\n{\n    static readonly type: string = \"COscillator\";\n\n    ins = this.addInputs(ins);\n    outs = this.addOutputs(outs);\n\n    protected lastTime: number = 0;\n    protected lastT = 0;\n    protected easingFunction: (t: number) => number = null;\n    protected isAbsolute = false;\n    protected isBackward = false;\n    protected isAlternate = false;\n\n    update(pulse: IPulseContext)\n    {\n        const { ins, outs } = this;\n\n        if (ins.curve.changed) {\n            this.easingFunction = getEasingFunction(ins.curve.getValidatedValue());\n        }\n        if (ins.mode.changed) {\n            this.isBackward = ins.mode.value === EInterpolationMode.Backward;\n            this.isAlternate = ins.mode.value === EInterpolationMode.Alternate;\n        }\n        if (ins.base.changed) {\n            this.isAbsolute = ins.base.value === ETimeBase.Absolute;\n        }\n\n        if (ins.start.changed) {\n            this.lastTime = 0;\n            ins.run.setValue(true);\n            outs.repetition.setValue(0);\n        }\n        else if (ins.pause.changed) {\n            if (ins.run.value) {\n                ins.run.setValue(false);\n            }\n            else if (ins.repetitions.value <= 0 || outs.repetition.value < ins.repetitions.value) {\n                ins.run.setValue(true);\n            }\n        }\n        else if (ins.stop.changed) {\n            this.lastTime = 0;\n            ins.run.setValue(false);\n            outs.value.setValue(this.isBackward ? ins.max.value : ins.min.value);\n            outs.repetition.setValue(0);\n        }\n\n        if (ins.run.changed && ins.run.value) {\n            this.lastT = 0;\n            if (ins.repetitions.value > 0 && outs.repetition.value >= ins.repetitions.value) {\n                outs.repetition.setValue(0);\n            }\n        }\n\n        return false;\n    }\n\n    tick(pulse: IPulseContext)\n    {\n        const { ins, outs } = this;\n\n        if (ins.run.value) {\n            const duration = ins.duration.value;\n            if (duration === 0) {\n                return false;\n            }\n\n            // absolute/relative base\n            let t;\n            if (this.isAbsolute) {\n                t = pulse.secondsElapsed / duration;\n            }\n            else {\n                t = this.lastTime = this.lastTime + pulse.secondsDelta / duration;\n            }\n\n            // modulo cycle\n            t = t < 0 ? 1 - (-t % 1) : t % 1;\n\n            // repetitions\n            if (t < this.lastT) {\n                const repetition = outs.repetition.value + 1;\n                outs.repetition.setValue(repetition);\n                outs.repeat.set();\n                if (ins.repetitions.value > 0 && repetition >= ins.repetitions.value) {\n                    ins.run.setValue(false);\n                    t = 1;\n                }\n            }\n            this.lastT = t;\n\n            // offset\n            t = t + ins.offset.value;\n            t = t > 1 ? t % 1 : t;\n\n            // alternate, easing curve\n            t = this.isAlternate ? (t > 0.5 ? 1 - t : t) * 2 : (this.isBackward ? 1 - t : t);\n            const v = ins.min.value + this.easingFunction(t) * (ins.max.value - ins.min.value);\n\n            outs.value.setValue(v);\n            return true;\n        }\n\n        return false;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport Component, { IUpdateContext, ITypedEvent } from \"../Component\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport interface IPulseContext extends IUpdateContext\n{\n    time: Date;\n    secondsElapsed: number;\n    secondsDelta: number;\n    frameNumber: number;\n}\n\ninterface IPulseEvent extends ITypedEvent<\"pulse\">\n{\n    context: IPulseContext;\n}\n\nexport default class CPulse extends Component\n{\n    static readonly type: string = \"CPulse\";\n    static readonly isSystemSingleton: boolean = true;\n\n    readonly context: IPulseContext;\n\n    private _secondsStarted: number;\n    private _secondsStopped: number;\n    private _animHandler: number;\n    private _pulseEvent: IPulseEvent;\n\n    constructor(id: string)\n    {\n        super(id);\n        this.addEvent(\"pulse\");\n\n        this.onAnimationFrame = this.onAnimationFrame.bind(this);\n\n        this.context = {\n            time: new Date(),\n            secondsElapsed: 0,\n            secondsDelta: 0,\n            frameNumber: 0\n        };\n\n        this._secondsStarted = Date.now() * 0.001;\n        this._secondsStopped = this._secondsStarted;\n        this._animHandler = 0;\n        this._pulseEvent = { type: \"pulse\", context: this.context };\n    }\n\n    start()\n    {\n        if (this._animHandler === 0) {\n\n            if (this._secondsStopped > 0) {\n                this._secondsStarted += (Date.now() * 0.001 - this._secondsStopped);\n                this._secondsStopped = 0;\n            }\n\n            this._animHandler = window.requestAnimationFrame(this.onAnimationFrame);\n        }\n    }\n\n    stop()\n    {\n        if (this._animHandler !== 0) {\n            if (this._secondsStopped === 0) {\n                this._secondsStopped = Date.now() * 0.001;\n            }\n            window.cancelAnimationFrame(this._animHandler);\n            this._animHandler = 0;\n        }\n    }\n\n    // reset()\n    // {\n    //     const context = this.context;\n    //     context.time = new Date();\n    //     context.secondsElapsed = 0;\n    //     context.secondsDelta = 0;\n    //     context.frameNumber = 0;\n    //\n    //     this._secondsStarted = Date.now() * 0.001;\n    //     this._secondsStopped = this._secondsStarted;\n    // }\n\n    pulse(milliseconds: number)\n    {\n        const context = this.context;\n\n        context.time.setTime(milliseconds);\n        const elapsed = milliseconds * 0.001 - this._secondsStarted;\n        context.secondsDelta = elapsed - context.secondsElapsed;\n        context.secondsElapsed = elapsed;\n        context.frameNumber++;\n\n        this.system.graph.tick(this.context);\n        this.emit<IPulseEvent>(this._pulseEvent);\n        this.system.graph.finalize(this.context);\n    }\n\n    protected onAnimationFrame()\n    {\n        this.pulse(Date.now());\n        this._animHandler = window.requestAnimationFrame(this.onAnimationFrame);\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { ITypedEvent } from \"@ff/core/Publisher\";\nimport Commander from \"@ff/core/Commander\";\nimport ObjectRegistry from \"@ff/core/ObjectRegistry\";\n\nimport { types } from \"../propertyTypes\";\n\nimport Component, { ComponentOrClass, IComponentEvent } from \"../Component\";\nimport Node, { INodeEvent, NodeOrClass } from \"../Node\";\nimport Graph from \"../Graph\";\n\nimport CGraph from \"./CGraph\";\nimport CController, { Actions } from \"./CController\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { INodeEvent, IComponentEvent };\n\nexport interface IActiveGraphEvent extends ITypedEvent<\"active-graph\">\n{\n    previous: Graph;\n    next: Graph;\n}\n\nexport type SelectionActions = Actions<CSelection>;\n\nconst outs = {\n    selNodeCount: types.Integer(\"Selection.Nodes\"),\n    selComponentCount: types.Integer(\"Selection.Components\")\n};\n\nexport default class CSelection extends CController<CSelection>\n{\n    static readonly type: string = \"CSelection\";\n\n    outs = this.addOutputs(outs);\n\n    multiSelect = false;\n    exclusiveSelect = true;\n\n    readonly selectedNodes = new ObjectRegistry(Node);\n    readonly selectedComponents = new ObjectRegistry(Component);\n\n    getSelectedNode<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this.selectedNodes.get(nodeOrClass, true);\n    }\n    getSelectedNodes<T extends Node = Node>(nodeOrClass?: NodeOrClass<T>) {\n        return this.selectedNodes.getArray(nodeOrClass);\n    }\n\n    getSelectedComponent<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this.selectedComponents.get(componentOrClass, true);\n    }\n    getSelectedComponents<T extends Component = Component>(componentOrClass?: ComponentOrClass<T>) {\n        return this.selectedComponents.getArray(componentOrClass);\n    }\n\n    private _activeGraph: Graph = null;\n\n    constructor(id: string)\n    {\n        super(id);\n        this.addEvents(\"select-node\", \"select-component\", \"active-graph\", \"update\");\n\n        this.selectedNodes.on(Node, e => this.onSelectNode(e.object, e.add));\n        this.selectedComponents.on(Component, e => this.onSelectComponent(e.object, e.add));\n    }\n\n    get activeGraph() {\n        return this._activeGraph;\n    }\n    set activeGraph(graph: Graph) {\n        if (graph !== this.activeGraph) {\n            this.clearSelection();\n            const previous = this._activeGraph;\n            this._activeGraph = graph;\n            this.onActiveGraph(graph);\n            this.emit<IActiveGraphEvent>({ type: \"active-graph\", previous, next: graph });\n        }\n    }\n\n    hasParentGraph()\n    {\n        return this._activeGraph && this._activeGraph.parent;\n    }\n\n    activateParentGraph()\n    {\n        if (this._activeGraph && this._activeGraph.parent.graph) {\n            this.activeGraph = this._activeGraph.parent.graph;\n        }\n    }\n\n    hasChildGraph()\n    {\n        return this.selectedComponents.has(CGraph);\n    }\n\n    activateChildGraph()\n    {\n        const graphComponent = this.selectedComponents.get(CGraph, true);\n        if (graphComponent) {\n            this.activeGraph = graphComponent.innerGraph;\n        }\n    }\n\n    create()\n    {\n        super.create();\n\n        this._activeGraph = this.system.graph;\n\n        this.system.nodes.on(Node, this.onSystemNode, this);\n        this.system.components.on(Component, this.onSystemComponent, this);\n    }\n\n    dispose()\n    {\n        this.system.nodes.off(Node, this.onSystemNode, this);\n        this.system.components.off(Component, this.onSystemComponent, this);\n\n        super.dispose();\n    }\n\n    createActions(commander: Commander)\n    {\n        return {\n            selectNode: commander.register({\n                name: \"Select Node\", do: this.selectNode, target: this\n            }),\n            selectComponent: commander.register({\n                name: \"Select Component\", do: this.selectComponent, target: this\n            }),\n            clearSelection: commander.register({\n                name: \"Clear Selection\", do: this.clearSelection, target: this\n            })\n        };\n    }\n\n    nodeContainsSelectedComponent(node: Node)\n    {\n        const components = node.components.getArray();\n        for (let i = 0, n = components.length; i < n; ++i) {\n            if (this.selectedComponents.contains(components[i])) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    selectNode(node?: Node, toggle: boolean = false)\n    {\n        this.activeGraph = node.graph;\n\n        const selectedNodes = this.selectedNodes;\n        const multiSelect = this.multiSelect && toggle;\n\n        if (node && selectedNodes.contains(node)) {\n            if (multiSelect) {\n                selectedNodes.remove(node);\n            }\n        }\n        else {\n            if (this.exclusiveSelect) {\n                this.selectedComponents.clear();\n            }\n            if (!multiSelect) {\n                selectedNodes.clear();\n            }\n            if (node) {\n                selectedNodes.add(node);\n            }\n        }\n\n        this.updateStats();\n    }\n\n    selectComponent(component?: Component, toggle: boolean = false)\n    {\n        this.activeGraph = component.graph;\n\n        const selectedComponents = this.selectedComponents;\n        const multiSelect = this.multiSelect && toggle;\n\n        if (component && selectedComponents.contains(component)) {\n            if (multiSelect) {\n                selectedComponents.remove(component);\n            }\n        }\n        else {\n            if (this.exclusiveSelect) {\n                this.selectedNodes.clear();\n            }\n            if (!multiSelect) {\n                selectedComponents.clear();\n            }\n            if (component) {\n                selectedComponents.add(component);\n            }\n        }\n\n        this.updateStats();\n    }\n\n    clearSelection()\n    {\n        this.selectedNodes.clear();\n        this.selectedComponents.clear();\n\n        this.updateStats();\n    }\n\n    protected onSelectNode(node: Node, selected: boolean)\n    {\n    }\n\n    protected onSelectComponent(component: Component, selected: boolean)\n    {\n    }\n\n    protected onActiveGraph(graph: Graph)\n    {\n    }\n\n    protected onSystemNode(event: INodeEvent)\n    {\n        if (event.remove && this.selectedNodes.contains(event.object)) {\n            this.selectedNodes.remove(event.object);\n        }\n    }\n\n    protected onSystemComponent(event: IComponentEvent)\n    {\n        if (event.remove && this.selectedComponents.contains(event.object)) {\n            this.selectedComponents.remove(event.object);\n        }\n    }\n\n    protected updateStats()\n    {\n        const outs = this.outs;\n        outs.selNodeCount.setValue(this.selectedNodes.length);\n        outs.selComponentCount.setValue(this.selectedComponents.length);\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport CController from \"./CController\";\nimport CGraph from \"./CGraph\";\nimport CHierarchy from \"./CHierarchy\";\nimport COscillator from \"./COscillator\";\nimport CPulse from \"./CPulse\";\nimport CSelection from \"./CSelection\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport {\n    CController,\n    CGraph,\n    CHierarchy,\n    COscillator,\n    CPulse,\n    CSelection\n};\n\nexport const componentTypes = [\n    CGraph,\n    CHierarchy,\n    COscillator,\n    CPulse,\n    CSelection\n];\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nexport type ValueType = \"number\" | \"boolean\" | \"string\" | \"object\";\n\nconst _identity = [\n    function(srcVal) {\n        return srcVal;\n    },\n    function(srcVal, dstVal) {\n        for (let i = 0, n = dstVal.length; i < n; ++i) {\n            dstVal[i] = srcVal[i];\n        }\n        return dstVal;\n    }\n];\n\nconst _toBoolean = [\n    function(srcVal) {\n        return !!srcVal;\n    },\n    function(srcVal, dstVal) {\n        for (let i = 0, n = dstVal.length; i < n; ++i) {\n            dstVal[i] = !!srcVal[i];\n        }\n        return dstVal;\n    }\n];\n\nconst _toString = [\n    function(srcVal) {\n        return String(srcVal);\n    },\n    function(srcVal, dstVal) {\n        for (let i = 0, n = dstVal.length; i < n; ++i) {\n            dstVal[i] = String(srcVal[i]);\n        }\n        return dstVal;\n    }\n];\n\nconst _parseFloat = [\n    function(srcVal) {\n        return parseFloat(srcVal) || 0;\n    },\n    function(srcVal, dstVal) {\n        for (let i = 0, n = dstVal.length; i < n; ++i) {\n            dstVal[i] = parseFloat(srcVal[i]) || 0;\n        }\n        return dstVal;\n    }\n];\n\nconst _booleanToNumber = [\n    function(srcVal) {\n        return srcVal ? 1 : 0;\n    },\n    function(srcVal, dstVal) {\n        for (let i = 0, n = dstVal.length; i < n; ++i) {\n            dstVal[i] = srcVal[i] ? 1 : 0;\n        }\n        return dstVal;\n    }\n];\n\nconst _illegalThrow = [\n    function(srcVal, dstVal) {\n        throw new Error(`illegal value conversion from ${typeof srcVal} to ${typeof dstVal}`);\n    },\n    function(srcVal, dstVal, elements) {\n        throw new Error(`illegal array conversion from ${typeof srcVal[0]} to ${typeof dstVal[0]}`);\n    }\n];\n\nconst _conversionFunctions = {\n    \"number\": {\n        \"number\": _identity,\n        \"boolean\": _toBoolean,\n        \"string\": _toString,\n        \"object\": _illegalThrow\n    },\n    \"boolean\": {\n        \"number\": _booleanToNumber,\n        \"boolean\": _identity,\n        \"string\": _toString,\n        \"object\": _illegalThrow\n    },\n    \"string\": {\n        \"number\": _parseFloat,\n        \"boolean\": _toBoolean,\n        \"string\": _identity,\n        \"object\": _illegalThrow\n    },\n    \"object\": {\n        \"number\": _illegalThrow,\n        \"boolean\": _toBoolean,\n        \"string\": _toString,\n        \"object\": _identity\n    }\n};\n\nconst _conversionTable = {\n    \"number\": {\n        \"number\": true,\n        \"boolean\": true,\n        \"string\": true,\n        \"object\": false\n    },\n    \"boolean\": {\n        \"number\": true,\n        \"boolean\": true,\n        \"string\": true,\n        \"object\": false\n    },\n    \"string\": {\n        \"number\": true,\n        \"boolean\": true,\n        \"string\": true,\n        \"object\": false\n    },\n    \"object\": {\n        \"number\": false,\n        \"boolean\": true,\n        \"string\": true,\n        \"object\": true\n    }\n};\n\nconst _copyFunctions = [\n    [\n        function(srcVal, dstVal, fnConvert) {\n            return fnConvert(srcVal, dstVal); // value > value\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[0] = fnConvert(srcVal); // value > [0]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[1] = fnConvert(srcVal); // value > [1]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[2] = fnConvert(srcVal); // value > [2]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[3] = fnConvert(srcVal); // value > [3]\n            return dstVal;\n        }\n    ],\n    [\n        function(srcVal, dstVal, fnConvert) {\n            return fnConvert(srcVal[0]); // [0] > value\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[0] = fnConvert(srcVal[0]); // [0] > [0]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[1] = fnConvert(srcVal[0]); // [0] > [1]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[2] = fnConvert(srcVal[0]); // [0] > [2]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[3] = fnConvert(srcVal[0]); // [0] > [3]\n            return dstVal;\n        }\n    ],\n    [\n        function(srcVal, dstVal, fnConvert) {\n            return fnConvert(srcVal[1]); // [1] > value\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[0] = fnConvert(srcVal[1]); // [1] > [0]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[1] = fnConvert(srcVal[1]); // [1] > [1]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[2] = fnConvert(srcVal[1]); // [1] > [2]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[3] = fnConvert(srcVal[1]); // [1] > [3]\n            return dstVal;\n        }\n    ],\n    [\n        function(srcVal, dstVal, fnConvert) {\n            return fnConvert(srcVal[2]); // [2] > value\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[0] = fnConvert(srcVal[2]); // [2] > [0]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[1] = fnConvert(srcVal[2]); // [2] > [1]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[2] = fnConvert(srcVal[2]); // [2] > [2]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[3] = fnConvert(srcVal[2]); // [2] > [3]\n            return dstVal;\n        }\n    ],\n    [\n        function(srcVal, dstVal, fnConvert) {\n            return fnConvert(srcVal[3]); // [3] > value\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[0] = fnConvert(srcVal[3]); // [3] > [0]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[1] = fnConvert(srcVal[3]); // [3] > [1]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[2] = fnConvert(srcVal[3]); // [3] > [2]\n            return dstVal;\n        },\n        function(srcVal, dstVal, fnConvert) {\n            dstVal[3] = fnConvert(srcVal[3]); // [3] > [3]\n            return dstVal;\n        }\n    ]\n];\n\nfunction getConversionFunction(sourceType: ValueType, destinationType: ValueType, isArray: boolean)\n{\n    const index = isArray ? 1 : 0;\n    return _conversionFunctions[sourceType][destinationType][index] as (inVal: any, outVal: any) => any;\n}\n\nfunction canConvert(sourceType, destinationType)\n{\n    return _conversionTable[sourceType][destinationType];\n}\n\nfunction getElementCopyFunction(sourceIndex: number, destinationIndex: number, fnConvert)\n{\n    if (sourceIndex === -1 && destinationIndex === -1) {\n        return fnConvert;\n    }\n    if (sourceIndex <= 3 && destinationIndex <= 3) {\n        return _copyFunctions[sourceIndex + 1][destinationIndex + 1];\n    }\n\n    return function(srcVal, dstVal, fnConvert) {\n        dstVal[destinationIndex] = fnConvert(srcVal[sourceIndex]);\n        return dstVal;\n    }\n}\n\nfunction getMultiCopyFunction(sourceIsMulti: boolean, destinationIsMulti: boolean, fnCopy)\n{\n    if (sourceIsMulti === false) {\n        if (destinationIsMulti === false) {\n            // single > single\n            return fnCopy;\n        }\n        else {\n            // single > multi\n            return function(srcVal, dstVal, fnConvert) {\n                for (let i = 0, n = dstVal.length; i < n; ++i) {\n                    dstVal[i] = fnCopy(srcVal, dstVal[i]);\n                }\n                return dstVal;\n            }\n        }\n    }\n    else {\n        if (destinationIsMulti === false) {\n            // multi > single\n            return function(srcVal, dstVal, fnConvert) {\n                if (srcVal.length > 0) {\n                    dstVal = fnCopy(srcVal[0], dstVal);\n                }\n                return dstVal;\n            }\n        }\n        else {\n            // multi > multi\n            return function(srcVal, dstVal, fnConvert) {\n                for (let i = 0, m = srcVal.length, n = dstVal.length; i < n; ++i) {\n                    dstVal[i] = fnCopy(srcVal[i % m], dstVal[i]);\n                }\n                return dstVal;\n            }\n        }\n    }\n}\n\nexport {\n    getConversionFunction,\n    canConvert,\n    getElementCopyFunction,\n    getMultiCopyFunction\n};","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { TypeOf, PropOf, enumToArray, Dictionary, Constructor } from \"@ff/core/types\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport interface IPropertyTemplate<T = any>\n{\n    path: string;\n    schema: IPropertySchema<T>;\n}\n\nexport interface IPropertySchema<T = any>\n{\n    preset: T;\n    min?: number;\n    max?: number;\n    step?: number; // increment/decrement step\n    speed?: number; // steps per pixel\n    precision?: number;\n    bar?: boolean;\n    percent?: boolean;\n    options?: string[];\n    enum?: any;\n    labels?: string[];\n    objectType?: TypeOf<T>;\n    multi?: boolean;\n    event?: boolean;\n    semantic?: string;\n}\n\nexport type SchemaProps<T> = Partial<IPropertySchema<T>> | T;\n\ntype Vector<T = number> = T[];\ntype Matrix<T = number> = T[];\n\nexport const labels = {\n    xyzw: [ \"X\", \"Y\", \"Z\", \"W\" ],\n    rgba: [ \"R\", \"G\", \"B\", \"A\" ],\n};\n\nconst parseProps = function<T>(props: SchemaProps<T>) {\n    if (props === undefined || (typeof props === \"object\" && !Array.isArray(props))) {\n        return props;\n    }\n\n    return { preset: props } as SchemaProps<T>;\n};\n\nexport const makeType = function<T>(schema: IPropertySchema<T>, path: string, props: SchemaProps<T>) {\n    props = parseProps(props);\n    return { path, schema: props ? Object.assign({}, schema, props) : schema } as IPropertyTemplate<T>;\n};\n\nexport const makeEnumType = function<T>(enumeration: T, path: string, props: SchemaProps<PropOf<T>>) {\n    props = parseProps(props);\n    const schema = { enum: enumeration, options: enumToArray(enumeration), preset: 0 as any as PropOf<T> };\n    return { path, schema: props ? Object.assign({}, schema, props) : schema } as IPropertyTemplate<PropOf<T>>;\n};\n\nexport const makeOptionType = function(options: string[], path: string, props: SchemaProps<number>) {\n    props = parseProps(props);\n    const schema = { options, preset: 0 };\n    return { path, schema: props ? Object.assign({}, schema, props) : schema } as IPropertyTemplate<number>;\n};\n\nexport const makeObjectType = function<T>(type: TypeOf<T>, path: string, props: SchemaProps<T>) {\n    props = parseProps(props);\n    const schema = { preset: null, objectType: type };\n    return { path, schema: props ? Object.assign({}, schema, props) : schema } as IPropertyTemplate<T>;\n};\n\nexport const schemas: Dictionary<IPropertySchema> = {\n    Number: { preset: 0 },\n    Integer: { preset: 0, step: 1, speed: 0.34, precision: 0 },\n    Natural: { preset: 0, step: 1, speed: 0.34, precision: 0, min: 0 },\n    Vector2: { preset: [0, 0] },\n    Vector3: { preset: [0, 0, 0] },\n    Vector4: { preset: [0, 0, 0, 0] },\n    Matrix2: { preset: [1, 0, 0, 1] },\n    Matrix3: { preset: [1, 0, 0, 0, 1, 0, 0, 0, 1] },\n    Matrix4: { preset: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1] },\n    Scale2: { preset: [1, 1] },\n    Scale3: { preset: [1, 1, 1] },\n    IntVec2: { preset: [0, 0], step: 1, speed: 0.34, precision: 0 },\n    IntVec3: { preset: [0, 0, 0], step: 1, speed: 0.34, precision: 0 },\n    ColorRGB: { preset: [1, 1, 1], semantic: \"color\", labels: labels.rgba, min: 0, max: 1, bar: true },\n    ColorRGBA: { preset: [1, 1, 1, 1], semantic: \"color\", labels: labels.rgba, min: 0, max: 1, bar: true },\n    Boolean: { preset: false },\n    String: { preset: \"\" },\n    Object: { preset: null, objectType: Object },\n    Event: { preset: 0, event: true }\n};\n\nexport const types = {\n    Property: <T>(path: string, props?: SchemaProps<T>) => makeType<T>(undefined, path, props),\n    Number: (path: string, props?: SchemaProps<number>) => makeType<number>(schemas.Number, path, props),\n    Integer: (path: string, props?: SchemaProps<number>) => makeType<number>(schemas.Integer, path, props),\n    Natural: (path: string, props?: SchemaProps<number>) => makeType<number>(schemas.Natural, path, props),\n    Vector2: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.Vector2, path, props),\n    Vector3: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.Vector3, path, props),\n    Vector4: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.Vector4, path, props),\n    IntVec2: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.IntVec2, path, props),\n    IntVec3: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.IntVec3, path, props),\n    Matrix2: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.Matrix2, path, props),\n    Matrix3: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.Matrix3, path, props),\n    Matrix4: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.Matrix4, path, props),\n    Scale2: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.Scale2, path, props),\n    Scale3: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.Scale3, path, props),\n    ColorRGB: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.ColorRGB, path, props),\n    ColorRGBA: (path: string, props?: SchemaProps<Vector>) => makeType<Vector>(schemas.ColorRGBA, path, props),\n    Boolean: (path: string, props?: SchemaProps<boolean>) => makeType<boolean>(schemas.Boolean, path, props),\n    String: (path: string, props?: SchemaProps<string>) => makeType<string>(schemas.String, path, props),\n    Enum: <T>(path: string, enumeration: T, props?: SchemaProps<PropOf<T>>) => makeEnumType(enumeration, path, props),\n    Option: (path: string, options: string[], props?: SchemaProps<number>) => makeOptionType(options, path, props),\n    Object: <T>(path: string, type: TypeOf<T>, props?: SchemaProps<T>) => makeObjectType(type, path, props),\n    Event: (path: string, props?: SchemaProps<number>) => makeType<number>(schemas.Event, path, props)\n};","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { ITypedEvent } from \"@ff/core/Publisher\";\nimport System from \"@ff/graph/System\";\n\nimport Viewport from \"@ff/three/Viewport\";\nimport { EViewPreset, EProjection } from \"@ff/three/UniversalCamera\";\n\nimport RenderView, { IPointerEvent, ITriggerEvent } from \"./RenderView\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { IPointerEvent, ITriggerEvent };\n\nexport enum EQuadViewLayout { Single, HorizontalSplit, VerticalSplit, Quad }\n\nexport interface ILayoutChange extends ITypedEvent<\"layout\">\n{\n    layout: EQuadViewLayout;\n}\n\nexport default class RenderQuadView extends RenderView\n{\n    private _layout: EQuadViewLayout = EQuadViewLayout.Quad;\n    private _horizontalSplit = 0.5;\n    private _verticalSplit = 0.5;\n\n    constructor(system: System, canvas: HTMLCanvasElement, overlay: HTMLElement)\n    {\n        super(system, canvas, overlay);\n        this.addEvent(\"layout\");\n\n        this.layout = EQuadViewLayout.Single;\n    }\n\n    set layout(layout: EQuadViewLayout) {\n\n        if (layout === this._layout) {\n            return;\n        }\n\n        this._layout = layout;\n        const viewports = this.viewports;\n\n        switch (this._layout) {\n            case EQuadViewLayout.Single:\n                this.setViewportCount(1);\n                break;\n\n            case EQuadViewLayout.HorizontalSplit:\n            case EQuadViewLayout.VerticalSplit:\n                this.setViewportCount(2);\n                break;\n\n            case EQuadViewLayout.Quad:\n                this.setViewportCount(4);\n                break;\n        }\n\n        this.updateSplitPositions();\n\n        if (viewports[1]) {\n            viewports[1].setBuiltInCamera(EProjection.Orthographic, EViewPreset.Top);\n            viewports[1].enableCameraManip(true).orientationEnabled = false;\n        }\n\n        if (viewports[2]) {\n            viewports[2].setBuiltInCamera(EProjection.Orthographic, EViewPreset.Left);\n            viewports[2].enableCameraManip(true).orientationEnabled = false;\n        }\n\n        if (viewports[3]) {\n            viewports[3].setBuiltInCamera(EProjection.Orthographic, EViewPreset.Front);\n            viewports[3].enableCameraManip(true).orientationEnabled = false;\n        }\n\n        this.emit<ILayoutChange>({ type: \"layout\", layout });\n    }\n\n    get layout() {\n        return this._layout;\n    }\n\n    set horizontalSplit(value: number) {\n        this._horizontalSplit = value;\n        this.updateSplitPositions();\n    }\n\n    get horizontalSplit() {\n        return this._horizontalSplit;\n    }\n\n    set verticalSplit(value: number) {\n        this._verticalSplit = value;\n        this.updateSplitPositions();\n    }\n\n    get verticalSplit() {\n        return this._verticalSplit;\n    }\n\n    protected updateSplitPositions()\n    {\n        const h = this._horizontalSplit;\n        const v = this._verticalSplit;\n\n        switch (this._layout) {\n            case EQuadViewLayout.Single:\n                this.viewports[0].setSize(0, 0, 1, 1);\n                break;\n\n            case EQuadViewLayout.HorizontalSplit:\n                this.viewports[0].setSize(0, 0, h, 1);\n                this.viewports[1].setSize(h, 0, 1-h, 1);\n                break;\n\n            case EQuadViewLayout.VerticalSplit:\n                this.viewports[0].setSize(0, 0, 1, v);\n                this.viewports[1].setSize(0, v, 1, 1-v);\n                break;\n\n            case EQuadViewLayout.Quad:\n                this.viewports[0].setSize(0, 0, h, v);\n                this.viewports[1].setSize(h, 0, 1-h, v);\n                this.viewports[2].setSize(0, v, h, 1-v);\n                this.viewports[3].setSize(h, v, 1-h, 1-v);\n                break;\n        }\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport Publisher from \"@ff/core/Publisher\";\nimport Component from \"@ff/graph/Component\";\nimport System from \"@ff/graph/System\";\n\n\nimport {\n    IManip,\n    IPointerEvent as IManipPointerEvent,\n    ITriggerEvent as IManipTriggerEvent\n} from \"@ff/browser/ManipTarget\";\n\nimport GPUPicker from \"@ff/three/GPUPicker\";\nimport Viewport, {\n    IBaseEvent as IViewportBaseEvent\n} from \"@ff/three/Viewport\";\n\nimport CRenderer from \"./components/CRenderer\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { Viewport };\n\ninterface IBaseEvent extends IViewportBaseEvent\n{\n    view: RenderView;\n    object3D: THREE.Object3D;\n    component: Component;\n    stopPropagation: boolean;\n}\n\nexport interface IPointerEvent extends IManipPointerEvent, IBaseEvent { }\nexport interface ITriggerEvent extends IManipTriggerEvent, IBaseEvent { }\n\nexport default class RenderView extends Publisher implements IManip\n{\n    readonly system: System;\n    readonly renderer: THREE.WebGLRenderer;\n    readonly canvas: HTMLCanvasElement;\n    readonly overlay: HTMLElement;\n    readonly viewports: Viewport[] = [];\n\n    protected rendererComponent: CRenderer = null;\n    protected activeViewport: Viewport = null;\n    protected activeObject3D: THREE.Object3D = null;\n    protected activeComponent: Component = null;\n\n    protected shouldResize = false;\n    protected picker: GPUPicker;\n\n    constructor(system: System, canvas: HTMLCanvasElement, overlay: HTMLElement)\n    {\n        super();\n\n        this.system = system;\n        this.canvas = canvas;\n        this.overlay = overlay;\n\n        this.renderer = new THREE.WebGLRenderer({\n            canvas,\n            antialias: true\n        });\n\n        this.renderer.autoClear = false;\n        this.renderer.setClearColor(\"#0090c0\");\n\n        this.picker = new GPUPicker(this.renderer);\n    }\n\n    dispose()\n    {\n        this.renderer.dispose();\n        this.viewports.forEach(viewport => viewport.dispose());\n    }\n\n    get canvasWidth()\n    {\n        return this.canvas.width;\n    }\n\n    get canvasHeight()\n    {\n        return this.canvas.height;\n    }\n\n    attach()\n    {\n        const width = this.canvasWidth;\n        const height = this.canvasHeight;\n\n        this.viewports.forEach(viewport => viewport.setCanvasSize(width, height));\n        this.renderer.setSize(width, height, false);\n\n        this.rendererComponent = this.system.getComponent(CRenderer, true);\n        this.rendererComponent.attachView(this);\n    }\n\n    detach()\n    {\n        this.rendererComponent = this.system.getComponent(CRenderer, true);\n        this.rendererComponent.detachView(this);\n        this.rendererComponent = null;\n    }\n\n    renderImage(width: number, height: number, format: string, quality: number)\n    {\n        console.log(\"RenderView.renderImage - width: %s, height: %s, format: %s, quality: %s\",\n            width, height, format, quality);\n\n        const canvasWidth = this.canvas.width;\n        const canvasHeight = this.canvas.height;\n\n        this.setRenderSize(width, height);\n        this.render();\n        const dataURL = this.canvas.toDataURL(format, quality);\n        this.setRenderSize(canvasWidth, canvasHeight);\n\n        return dataURL;\n    }\n\n    render()\n    {\n        const sceneComponent = this.rendererComponent.activeSceneComponent;\n        if (!sceneComponent) {\n            return;\n        }\n\n        const scene = sceneComponent.scene;\n        const camera = sceneComponent.activeCamera;\n\n        if (!scene || !camera) {\n            return;\n        }\n\n        const renderer = this.renderer;\n\n        if (this.shouldResize) {\n            this.shouldResize = false;\n            this.setRenderSize(this.canvas.clientWidth, this.canvas.clientHeight);\n        }\n\n        renderer.clear();\n        renderer[\"__view\"] = this;\n\n        const viewports = this.viewports;\n\n        for (let i = 0, n = viewports.length; i < n; ++i) {\n            const viewport = viewports[i];\n\n            renderer[\"__viewport\"] = viewport;\n            const currentCamera = viewport.updateCamera(camera);\n            viewport.applyViewport(this.renderer);\n            renderer.render(scene, currentCamera);\n        }\n    }\n\n    protected setRenderSize(width: number, height: number)\n    {\n        this.canvas.width = width;\n        this.canvas.height = height;\n\n        this.viewports.forEach(viewport => viewport.setCanvasSize(width, height));\n        this.renderer.setSize(width, height, false);\n    }\n\n    resize()\n    {\n        this.shouldResize = true;\n    }\n\n    setViewportCount(count: number)\n    {\n        const viewports = this.viewports;\n\n        for (let i = count; i < viewports.length; ++i) {\n            viewports[i].dispose();\n        }\n        for (let i = viewports.length; i < count; ++i) {\n            viewports[i] = new Viewport();\n            viewports[i].setCanvasSize(this.canvasWidth, this.canvasHeight);\n        }\n\n        viewports.length = count;\n    }\n\n    getViewportCount()\n    {\n        return this.viewports.length;\n    }\n\n    onPointer(event: IPointerEvent)\n    {\n        const system = this.system;\n        if (!system) {\n            return false;\n        }\n\n        let doPick = false;\n        let doHitTest = false;\n\n        if (event.type === \"pointer-hover\") {\n            doHitTest = true;\n        }\n        else if (event.isPrimary && event.type === \"pointer-down\") {\n            doHitTest = true;\n            doPick = true;\n        }\n\n        const viewEvent = this.routeEvent(event, doHitTest, doPick);\n\n        if (viewEvent) {\n            if (viewEvent.component) {\n                viewEvent.component.propagateUp(viewEvent);\n            }\n            else {\n                this.system.emit(viewEvent);\n            }\n\n            if (!viewEvent.stopPropagation) {\n                viewEvent.viewport.onPointer(viewEvent);\n            }\n\n            return true;\n        }\n\n        return false;\n    }\n\n    onTrigger(event: ITriggerEvent)\n    {\n        const system = this.system;\n        if (!system) {\n            return false;\n        }\n\n        const viewEvent = this.routeEvent(event, true, true);\n\n        if (viewEvent) {\n            if (viewEvent.component) {\n                viewEvent.component.propagateUp(viewEvent);\n            }\n            else {\n                this.system.emit(viewEvent);\n            }\n\n            if (!viewEvent.stopPropagation) {\n                viewEvent.viewport.onTrigger(viewEvent);\n            }\n\n            return true;\n        }\n\n        return false;\n    }\n\n    protected routeEvent(event: IPointerEvent, doHitTest: boolean, doPick: boolean): IPointerEvent;\n    protected routeEvent(event: ITriggerEvent, doHitTest: boolean, doPick: boolean): ITriggerEvent;\n    protected routeEvent(event, doHitTest, doPick)\n    {\n        let viewport = this.activeViewport;\n        let object3D = this.activeObject3D;\n        let component = this.activeComponent;\n\n        // if no active viewport, perform a hit test against all viewports\n        if (doHitTest) {\n            viewport = null;\n            const viewports = this.viewports;\n            for (let i = 0, n = viewports.length; i < n; ++i) {\n                const vp = viewports[i];\n                if (vp.isPointInside(event.localX, event.localY)) {\n                    viewport = vp;\n                    break;\n                }\n            }\n        }\n\n        // without an active viewport, return null to cancel the event\n        if (!viewport) {\n            return null;\n        }\n\n        // if we have an active viewport now, augment event with viewport/view information\n        const viewEvent = event as IBaseEvent;\n        viewEvent.view = this;\n        viewEvent.viewport = viewport;\n        viewEvent.deviceX = viewport.getDeviceX(event.localX);\n        viewEvent.deviceY = viewport.getDeviceY(event.localY);\n        viewEvent.stopPropagation = false;\n\n        // perform 3D pick\n        if (doPick) {\n            const sceneComponent = this.rendererComponent.activeSceneComponent;\n            const scene = sceneComponent && sceneComponent.scene;\n            const camera = sceneComponent &&sceneComponent.activeCamera;\n\n            object3D = null;\n            component = null;\n\n            if (scene && camera) {\n                let object3D = this.picker.pickObject(scene, camera, event);\n                if (object3D === undefined) {\n                    console.log(\"Pick Index - Background\");\n                }\n                else {\n                    while(object3D && !component) {\n                        component = object3D.userData[\"component\"];\n                        if (!component) {\n                            object3D = object3D.parent;\n                        }\n                    }\n                    if (component) {\n                        console.log(\"Pick Index - Component: %s\", component.className);\n                    }\n                    else {\n                        console.warn(\"Pick Index - Object without component\");\n                    }\n                }\n            }\n        }\n\n        viewEvent.object3D = object3D;\n        viewEvent.component = component;\n\n        this.activeViewport = viewport;\n        this.activeObject3D = object3D;\n        this.activeComponent = component;\n\n        return viewEvent;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport { types } from \"@ff/graph/propertyTypes\";\nimport CMaterial from \"./CMaterial\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _inputs = {\n    color: types.ColorRGB(\"Color\")\n};\n\nexport default class CBasicMaterial extends CMaterial\n{\n    ins = this.addInputs<CMaterial, typeof _inputs>(_inputs);\n\n\n    create()\n    {\n        this.material = new THREE.MeshBasicMaterial();\n    }\n\n    update()\n    {\n        const material = this.material as THREE.MeshBasicMaterial;\n        const { color } = this.ins;\n\n        material.color.setRGB(color.value[0], color.value[1], color.value[2]);\n        return true;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport { types } from \"@ff/graph/propertyTypes\";\nimport { IPointerEvent } from \"../RenderView\";\nimport CGeometry from \"./CGeometry\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _inputs = {\n    size: types.Vector3(\"Size\", [ 10, 10, 10 ]),\n    segments: types.Vector3(\"Segments\", [ 1, 1, 1])\n};\n\nexport default class CBox extends CGeometry\n{\n    ins = this.addInputs<CGeometry, typeof _inputs>(_inputs);\n\n\n    create()\n    {\n        super.create();\n        this.on(\"pointer\", this.onPointer, this);\n    }\n\n    update()\n    {\n        const { size, segments } = this.ins;\n        if (size.changed || segments.changed) {\n            this.geometry = new THREE.BoxBufferGeometry(\n                size.value[0], size.value[1], size.value[2],\n                segments.value[0], segments.value[1], segments.value[2]\n            );\n        }\n\n        return true;\n    }\n\n    protected onPointer(event: IPointerEvent)\n    {\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { types } from \"@ff/graph/propertyTypes\";\n\nimport UniversalCamera, { EProjection } from \"@ff/three/UniversalCamera\";\nimport CObject3D from \"./CObject3D\";\nimport CScene from \"./CScene\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { EProjection };\n\nconst _inputs = {\n    activate: types.Event(\"Camera.Activate\"),\n    position: types.Vector3(\"Transform.Position\"),\n    rotation: types.Vector3(\"Transform.Rotation\"),\n    projection: types.Enum(\"Projection.Type\", EProjection, EProjection.Perspective),\n    fov: types.Number(\"Projection.FovY\", 52),\n    size: types.Number(\"Projection.Size\", 20),\n    zoom: types.Number(\"Projection.Zoom\", 1),\n    near: types.Number(\"Frustum.ZNear\", 0.01),\n    far: types.Number(\"Frustum.ZFar\", 10000)\n};\n\nexport default class CCamera extends CObject3D\n{\n    ins = this.addInputs<CObject3D, typeof _inputs>(_inputs);\n\n\n    get camera() {\n        return this.object3D as UniversalCamera;\n    }\n\n    protected get scene() {\n        return this.graph.components.get(CScene)\n    }\n\n    create()\n    {\n        super.create();\n        this.object3D = new UniversalCamera();\n\n        const scene = this.scene;\n        if (scene && !scene.activeCameraComponent) {\n            scene.activeCameraComponent = this;\n        }\n    }\n\n    update()\n    {\n        const { activate, position, rotation, projection, fov, size, zoom, near, far } = this.ins;\n\n        if (activate.changed) {\n            const scene = this.scene;\n            if (scene) {\n                scene.activeCameraComponent = this;\n            }\n        }\n\n        const camera = this.camera;\n\n        if (position.changed || rotation.changed) {\n            camera.position.fromArray(position.value);\n            camera.rotation.fromArray(rotation.value);\n            camera.updateMatrix();\n        }\n\n        if (projection.changed) {\n            camera.setProjection(projection.getValidatedValue());\n        }\n\n        camera.fov = fov.value;\n        camera.size = size.value;\n        camera.zoom = zoom.value;\n        camera.near = near.value;\n        camera.far = far.value;\n\n        camera.updateProjectionMatrix();\n        return true;\n    }\n\n    dispose()\n    {\n        const scene = this.scene;\n        if (scene && scene.activeCameraComponent === this) {\n            scene.activeCameraComponent = null;\n        }\n\n        super.dispose();\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport { types } from \"@ff/graph/propertyTypes\";\n\nimport CLight from \"./CLight\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _inputs = {\n    position: types.Vector3(\"Light.Position\", [ 0, 1, 0 ]),\n    target: types.Vector3(\"Light.Target\")\n};\n\nexport default class CDirectionalLight extends CLight\n{\n    ins = this.addInputs<CLight, typeof _inputs>(_inputs);\n\n    get light(): THREE.DirectionalLight\n    {\n        return this.object3D as THREE.DirectionalLight;\n    }\n\n    create()\n    {\n        super.create();\n        this.object3D = new THREE.DirectionalLight();\n    }\n\n    update()\n    {\n        const light = this.light;\n        const { color, intensity, position, target } = this.ins;\n\n        light.color.fromArray(color.value);\n        light.intensity = intensity.value;\n        light.position.fromArray(position.value);\n        light.target.position.fromArray(target.value);\n\n        light.updateMatrix();\n        return true;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport Component from \"@ff/graph/Component\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class CGeometry extends Component\n{\n    private _geometry: THREE.BufferGeometry = null;\n\n    \n    constructor(id: string)\n    {\n        super(id);\n        this.addEvent(\"geometry\");\n    }\n\n    get geometry() {\n        return this._geometry;\n    }\n\n    set geometry(value: THREE.BufferGeometry) {\n        this._geometry = value;\n        this.emit(\"geometry\", value);\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport math from \"@ff/core/math\";\nimport { types } from \"@ff/graph/propertyTypes\";\nimport CObject3D from \"./CObject3D\";\n\nimport ThreeGrid, { IGridProps } from \"@ff/three/Grid\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _vec3a = new THREE.Vector3();\nconst _vec3b = new THREE.Vector3();\n\nconst _inputs = {\n    position: types.Vector3(\"Transform.Position\"),\n    rotation: types.Vector3(\"Transform.Rotation\"),\n    scale: types.Scale3(\"Transform.Scale\"),\n    size: types.Number(\"Grid.Size\", 20),\n    mainDivs: types.Number(\"Grid.Main.Divisions\", 2),\n    mainColor: types.ColorRGB(\"Grid.Main.Color\", [ 1, 1, 1 ]),\n    subDivs: types.Number(\"Grid.Sub.Divisions\", 10),\n    subColor: types.ColorRGB(\"Grid.Sub.Color\", [ 0.5, 0.5, 0.5 ])\n};\n\nexport default class CGrid extends CObject3D\n{\n    ins = this.addInputs<CObject3D, typeof _inputs>(_inputs);\n\n\n    update(): boolean\n    {\n        let grid = this.object3D as ThreeGrid;\n\n        const { size, mainDivs, mainColor, subDivs, subColor } = this.ins;\n        if (size.changed || mainDivs.changed || mainColor.changed || subDivs.changed || subColor.changed) {\n\n            const props: IGridProps = {\n                size: size.value,\n                mainDivisions: mainDivs.value,\n                mainColor: new THREE.Color().fromArray(mainColor.value),\n                subDivisions: subDivs.value,\n                subColor: new THREE.Color().fromArray(subColor.value)\n            };\n\n            const newGrid = this.object3D = new ThreeGrid(props);\n            if (grid) {\n                newGrid.matrix.copy(grid.matrix);\n                newGrid.matrixWorldNeedsUpdate = true;\n            }\n\n            grid = newGrid;\n        }\n\n        const { position, rotation, scale } = this.ins;\n        if (position.changed || rotation.changed || scale.changed) {\n            grid.position.fromArray(position.value);\n            _vec3a.fromArray(rotation.value).multiplyScalar(math.DEG2RAD);\n            grid.rotation.setFromVector3(_vec3a, \"XYZ\");\n            grid.scale.fromArray(scale.value);\n            grid.updateMatrix();\n        }\n\n        return true;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { types } from \"@ff/graph/propertyTypes\";\nimport CObject3D from \"./CObject3D\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _inputs = {\n    color: types.ColorRGB(\"Light.Color\"),\n    intensity: types.Number(\"Light.Intensity\", 1)\n};\n\nexport default class CLight extends CObject3D\n{\n    ins = this.addInputs<CObject3D, typeof _inputs>(_inputs);\n\n\n    get light(): THREE.Light\n    {\n        return this.object3D as THREE.Light;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport Component, { types } from \"@ff/graph/Component\";\nimport { IComponentEvent } from \"@ff/graph/System\"\n\nimport CScene from \"./CScene\";\nimport CCamera from \"./CCamera\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst ins = {\n    scene: types.Option(\"Scene\", []),\n    camera: types.Option(\"Camera\", [])\n};\n\nexport default class CMain extends Component\n{\n    protected scenes: CScene[] = [];\n    protected cameras: CCamera[] = [];\n\n    protected selectedScene: CScene = null;\n    protected selectedCamera: CCamera = null;\n\n    ins = this.addInputs(ins);\n\n    get sceneComponent(): CScene | null {\n        return this.selectedScene;\n    }\n\n    get cameraComponent(): CCamera | null {\n        return this.selectedCamera;\n    }\n\n    get scene(): THREE.Scene | null {\n        return this.selectedScene ? this.selectedScene.scene : null;\n    }\n\n    get camera(): THREE.Camera | null {\n        return this.selectedCamera ? this.selectedCamera.camera : null;\n    }\n\n    create()\n    {\n        this.scenes = this.system.components.cloneArray(CScene);\n        this.system.components.on(CScene, this.onSceneComponent, this);\n\n        this.cameras = this.system.components.cloneArray(CCamera);\n        this.system.components.on(CCamera, this.onCameraComponent, this);\n\n        this.updateOptions();\n    }\n\n    update()\n    {\n        const ins = this.ins;\n\n        if (ins.scene.changed) {\n            const index = ins.scene.getValidatedValue();\n            this.selectedScene = index >= 0 ? this.scenes[index] : null;\n        }\n        if (ins.camera.changed) {\n            const index = ins.camera.getValidatedValue();\n            this.selectedCamera = index >= 0 ? this.cameras[index] : null;\n        }\n\n        return true;\n    }\n\n    dispose()\n    {\n        this.system.components.off(CScene, this.onSceneComponent, this);\n        this.system.components.off(CCamera, this.onCameraComponent, this);\n    }\n\n    protected onSceneComponent(event: IComponentEvent<CScene>)\n    {\n        const inScene = this.ins.scene;\n\n        if (event.add) {\n            this.scenes.push(event.object);\n            this.updateOptions();\n        }\n        else {\n            const index = this.scenes.indexOf(event.object);\n            this.scenes.splice(index, 1);\n\n            this.updateOptions();\n\n            if (!inScene.hasInLinks() && index <= inScene.value) {\n                inScene.setValue(Math.max(0, inScene.value - 1));\n            }\n        }\n\n        inScene.set();\n    }\n\n    protected onCameraComponent(event: IComponentEvent<CCamera>)\n    {\n        const inCamera = this.ins.camera;\n\n        if (event.add) {\n            this.cameras.push(event.object);\n            this.updateOptions();\n        }\n        else {\n            const index = this.cameras.indexOf(event.object);\n            this.cameras.splice(index, 1);\n\n            this.updateOptions();\n\n            if (!inCamera.hasInLinks() && index <= inCamera.value) {\n                inCamera.setValue(Math.max(0, inCamera.value - 1));\n            }\n        }\n\n        inCamera.set();\n    }\n\n    protected updateOptions()\n    {\n        const { scene, camera } = this.ins;\n\n        if (this.scenes.length > 0) {\n            scene.setOptions(this.scenes.map(scene => scene.name || scene.className));\n        }\n        else {\n            scene.setOptions([ \"N/A\" ]);\n        }\n\n        if (this.cameras.length > 0) {\n            camera.setOptions(this.cameras.map(camera => camera.name || camera.className));\n        }\n        else {\n            camera.setOptions([ \"N/A\" ]);\n        }\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport Component from \"@ff/graph/Component\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class CMaterial extends Component\n{\n    private _material: THREE.Material = null;\n\n\n    constructor(id: string)\n    {\n        super(id);\n        this.addEvent(\"material\");\n    }\n\n    get material() {\n        return this._material;\n    }\n\n    set material(value: THREE.Material) {\n        this._material = value;\n        this.emit(\"material\", value);\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport ComponentTracker from \"@ff/graph/ComponentTracker\";\n\nimport CGeometry from \"./CGeometry\";\nimport CMaterial from \"./CMaterial\";\nimport CObject3D from \"./CObject3D\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class CMesh extends CObject3D\n{\n    protected geometryTracker: ComponentTracker<CGeometry>;\n    protected materialTracker: ComponentTracker<CMaterial>;\n\n\n    get mesh() {\n        return this.object3D as THREE.Mesh;\n    }\n\n    create()\n    {\n        super.create();\n\n        this.object3D = new THREE.Mesh();\n        this.object3D.visible = false;\n\n        this.geometryTracker = this.trackComponent(CGeometry, component => {\n            this.mesh.geometry = component.geometry;\n            component.on(\"geometry\", this.updateGeometry, this);\n        }, component => {\n            this.mesh.geometry = null;\n            component.off(\"geometry\", this.updateGeometry, this);\n        });\n\n        this.materialTracker = this.trackComponent(CMaterial, component => {\n            this.mesh.material = component.material;\n            component.on(\"material\", this.updateMaterial, this);\n        }, component => {\n            this.mesh.material = null;\n            component.off(\"material\", this.updateMaterial, this);\n        });\n    }\n\n    toString()\n    {\n        const geo = this.mesh.geometry;\n        const mat = this.mesh.material as THREE.Material;\n        return `${this.className} - Geometry: '${geo ? geo.type : \"N/A\"}', Material: '${mat ? mat.type : \"N/A\"}'`\n    }\n\n    protected updateGeometry(geometry: THREE.BufferGeometry)\n    {\n        this.mesh.geometry = geometry;\n        this.mesh.visible = !!(geometry && this.mesh.material);\n    }\n\n    protected updateMaterial(material: THREE.Material)\n    {\n        this.mesh.material = material;\n        this.mesh.visible = !!(this.mesh.geometry && material);\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport { ClassOf } from \"@ff/core/types\";\nimport { ITypedEvent } from \"@ff/core/Publisher\";\n\nimport Component, { types } from \"@ff/graph/Component\";\nimport IndexShader from \"@ff/three/shaders/IndexShader\";\n\nimport RenderView, { Viewport } from \"../RenderView\";\nimport CTransform from \"./CTransform\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _context: IRenderContext = {\n    view: null,\n    viewport: null,\n    renderer: null,\n    scene: null,\n    camera: null,\n    geometry: null,\n    material: null,\n    group: null\n};\n\nconst _hookObject3D = function(object: THREE.Object3D)\n{\n    if ((object as any).material) {\n        object.onBeforeRender = function(r, s, c, g, material: IndexShader) {\n            if (material.isIndexShader) {\n                //console.log(\"setIndex #%s for %s\", object.id, object);\n                material.setIndex(object.id);\n            }\n        }\n    }\n};\n\nconst _unhookObject3D = function(object: THREE.Object3D)\n{\n    if ((object as any).material) {\n        object.onBeforeRender = null;\n    }\n};\n\nexport interface ICObject3D extends Component\n{\n    object3D: THREE.Object3D;\n}\n\nexport interface IObject3DObjectEvent extends ITypedEvent<\"object\">\n{\n    current: THREE.Object3D;\n    next: THREE.Object3D;\n}\n\nexport interface IRenderContext\n{\n    view: RenderView;\n    viewport: Viewport;\n    renderer: THREE.WebGLRenderer;\n    scene: THREE.Scene;\n    camera: THREE.Camera;\n    geometry: THREE.Geometry;\n    material: THREE.Material;\n    group: any;\n}\n\nconst _inputs = {\n    visible: types.Boolean(\"Object.Visible\", true),\n    pickable: types.Boolean(\"Object.Pickable\", true),\n};\n\nconst _outputs = {\n    pointerDown: types.Event(\"Picking.PointerDown\"),\n    pointerUp: types.Event(\"Picking.PointerUp\"),\n    pointerActive: types.Event(\"Picking.PointerActive\")\n};\n\n/**\n * Base component for Three.js renderable objects.\n * If component is added to a node together with a [[Transform]] component,\n * it is automatically added as a child to the transform.\n */\nexport default class CObject3D extends Component implements ICObject3D\n{\n    /** The component type whose object3D is the parent of this component's object3D. */\n    protected static readonly parentComponentClass: ClassOf<ICObject3D> = CTransform;\n\n    ins = this.addInputs(_inputs);\n    outs = this.addOutputs(_outputs);\n\n\n    private _object3D: THREE.Object3D = null;\n\n\n    constructor(id: string)\n    {\n        super(id);\n        this.addEvent(\"object\");\n    }\n\n    /** The class of a component in the same node this component uses as parent transform. */\n    get parentComponentClass(): ClassOf<ICObject3D> {\n        return (this.constructor as any).parentComponentClass;\n    }\n    /** The transform parent of this object. */\n    get parentComponent(): ICObject3D {\n        return this.node.components.get(this.parentComponentClass);\n    }\n    /** The underlying [[THREE.Object3D]] of this component. */\n    get object3D(): THREE.Object3D | null {\n        return this._object3D;\n    }\n\n    /**\n     * Assigns a [[THREE.Object3D]] to this component. The object automatically becomes a child\n     * of the parent component's object.\n     * @param object\n     */\n    set object3D(object: THREE.Object3D)\n    {\n        const currentObject = this._object3D;\n        const parentComponent = this.parentComponent;\n\n        if (currentObject) {\n            object.userData[\"component\"] = null;\n            currentObject.onBeforeRender = null;\n            currentObject.onAfterRender = null;\n\n            this.unregisterPickableObject3D(currentObject, true);\n\n            if (parentComponent) {\n                parentComponent.object3D.remove(currentObject);\n            }\n        }\n\n        this.emit<IObject3DObjectEvent>({ type: \"object\", current: currentObject, next: object });\n        this._object3D = object;\n\n        if (object) {\n            object.userData[\"component\"] = this;\n            object.matrixAutoUpdate = false;\n            object.visible = this.ins.visible.value;\n\n            object.onBeforeRender = this._onBeforeRender.bind(this);\n            if (this.afterRender) {\n                object.onAfterRender = this._onAfterRender.bind(this);\n            }\n\n            this.registerPickableObject3D(object, true);\n\n            if (parentComponent) {\n                parentComponent.object3D.add(object);\n            }\n        }\n    }\n\n    create()\n    {\n        this.trackComponent(this.parentComponentClass, component => {\n            if (this._object3D) {\n                component.object3D.add(this._object3D);\n            }\n        }, component => {\n            if (this._object3D) {\n                component.object3D.remove(this._object3D);\n            }\n        });\n    }\n\n    update(context): boolean\n    {\n        const ins = this.ins;\n\n        if (ins.visible.changed && this._object3D) {\n            this._object3D.visible = ins.visible.value;\n        }\n\n        return true;\n    }\n\n    dispose()\n    {\n        if (this._object3D) {\n            const component = this.parentComponent;\n\n            if (component) {\n                component.object3D.remove(this._object3D);\n            }\n        }\n\n        super.dispose();\n    }\n\n    /**\n     * This is called right before the component's 3D object is rendered.\n     * Override to make adjustments specific to the renderer, view or viewport.\n     * @param context\n     */\n    beforeRender(context: IRenderContext)\n    {\n    }\n\n    /**\n     * This is called right after the component's 3D object has been rendered.\n     * Override to make adjustments specific to the renderer, view or viewport.\n     * @param context\n     */\n    afterRender(context: IRenderContext)\n    {\n    }\n\n    /**\n     * Adds a [[THREE.Object3D]] as a child to this component's object.\n     * Registers the object with the picking service to make it pickable.\n     * @param object\n     */\n    addObject3D(object: THREE.Object3D)\n    {\n        this._object3D.add(object);\n        this.registerPickableObject3D(object, true);\n    }\n\n    /**\n     * Removes a [[THREE.Object3D]] child from this component's object.\n     * Also unregisters the object from the picking service.\n     * @param object\n     */\n    removeObject3D(object: THREE.Object3D)\n    {\n        this._object3D.remove(object);\n        this.unregisterPickableObject3D(object, true);\n    }\n\n    /**\n     * This should be called after an external change to this component's Object3D subtree.\n     * It registers newly added mesh objects with the picking service.\n     * @param object\n     * @param recursive\n     */\n    registerPickableObject3D(object: THREE.Object3D, recursive: boolean = false)\n    {\n        if (recursive && object === this._object3D) {\n            object.children.forEach(child => child.traverse(object => _hookObject3D(object)));\n        }\n        else if (recursive) {\n            object.traverse(object => _hookObject3D(object));\n        }\n        else if (object !== this._object3D) {\n            _hookObject3D(object);\n        }\n    }\n\n    /**\n     * This should be called before an external change to this component's Object3D subtree.\n     * It unregisters the mesh objects in the subtree from the picking service.\n     * @param object\n     * @param recursive\n     */\n    unregisterPickableObject3D(object: THREE.Object3D, recursive: boolean = false)\n    {\n        if (recursive && object === this._object3D) {\n            object.children.forEach(child => child.traverse(object => _unhookObject3D(object)));\n        }\n        else if (recursive) {\n            object.traverse(object => _unhookObject3D(object));\n        }\n        else if (object !== this._object3D) {\n            _unhookObject3D(object);\n        }\n    }\n\n    /**\n     * Returns a text representation.\n     */\n    toString()\n    {\n        return super.toString() + (this._object3D ? ` - type: ${this._object3D.type}` : \" - (null)\");\n    }\n\n    /**\n     * Three.js event handler called before the object is rendered.\n     * @private\n     */\n    private _onBeforeRender(\n        renderer: THREE.WebGLRenderer,\n        scene: THREE.Scene,\n        camera: THREE.Camera,\n        geometry: THREE.Geometry,\n        material: any,\n        group: any)\n    {\n        // index rendering for picking: set shader index uniform to the object's id\n        if (material.isIndexShader && this.ins.pickable.value) {\n            material.setIndex(this.object3D.id);\n        }\n\n        if (this.beforeRender) {\n            _context.view = renderer[\"__view\"];\n            _context.viewport = renderer[\"__viewport\"];\n            _context.renderer = renderer;\n            _context.scene = scene;\n            _context.camera = camera;\n            _context.geometry = geometry;\n            _context.material = material;\n            _context.group = group;\n\n            this.beforeRender(_context);\n        }\n    }\n\n    /**\n     * Three.js event handler called after the object has been rendered.\n     * @private\n     */\n    private _onAfterRender(\n        renderer: THREE.WebGLRenderer,\n        scene: THREE.Scene,\n        camera: THREE.Camera,\n        geometry: THREE.Geometry,\n        material: THREE.Material,\n        group: any)\n    {\n        _context.view = renderer[\"__view\"];\n        _context.viewport = renderer[\"__viewport\"];\n        _context.renderer = renderer;\n        _context.scene = scene;\n        _context.camera = camera;\n        _context.geometry = geometry;\n        _context.material = material;\n        _context.group = group;\n\n        this.afterRender(_context);\n    }\n}\n\nCObject3D.prototype.beforeRender = null;\nCObject3D.prototype.afterRender = null;","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { types } from \"@ff/graph/propertyTypes\";\nimport Component from \"@ff/graph/Component\";\n\nimport OrbitManip from \"@ff/three/OrbitManipulator\";\nimport CScene, { IActiveCameraEvent } from \"./CScene\";\nimport CCamera from \"./CCamera\";\n\nimport { IPointerEvent, ITriggerEvent } from \"../RenderView\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _inputs = {\n    enabled: types.Boolean(\"Enabled\", true),\n    orbit: types.Vector3(\"Orbit\", [ 0, 0, 0 ]),\n    offset: types.Vector3(\"Offset\", [ 0, 0, 50 ]),\n    minOrbit: types.Vector3(\"Min.Orbit\", [ -90, NaN, NaN ]),\n    minOffset: types.Vector3(\"Min.Offset\", [ NaN, NaN, 0.1 ]),\n    maxOrbit: types.Vector3(\"Max.Orbit\", [ 90, NaN, NaN ]),\n    maxOffset: types.Vector3(\"Max.Offset\", [ NaN, NaN, 100 ])\n};\n\nconst _outputs = {\n    orbit: types.Vector3(\"Orbit\"),\n    offset: types.Vector3(\"Offset\"),\n    size: types.Number(\"Size\")\n};\n\nexport default class COrbitManipulator extends Component\n{\n    ins = this.addInputs(_inputs);\n    outs = this.addOutputs(_outputs);\n\n    private _manip = new OrbitManip();\n    private _activeCameraComponent: CCamera;\n\n    create()\n    {\n        super.create();\n\n        this._manip.cameraMode = true;\n\n        this.system.on([\"pointer-down\", \"pointer-up\", \"pointer-move\"], this.onPointer, this);\n        this.system.on(\"wheel\", this.onTrigger, this);\n\n        this.trackComponent(CScene, component => {\n            component.on<IActiveCameraEvent>(\"active-camera\", this.onActiveCamera, this);\n        }, component => {\n            component.off<IActiveCameraEvent>(\"active-camera\", this.onActiveCamera, this);\n        });\n\n    }\n\n    dispose()\n    {\n        super.dispose();\n\n        this.system.off([\"pointer-down\", \"pointer-up\", \"pointer-move\"], this.onPointer, this);\n        this.system.off(\"wheel\", this.onTrigger, this);\n    }\n\n    update()\n    {\n        const manip = this._manip;\n        const ins = this.ins;\n\n        const { minOrbit, minOffset, maxOrbit, maxOffset } = ins;\n        if (minOrbit.changed || minOffset.changed || maxOrbit.changed || maxOffset.changed) {\n            manip.minOrbit.fromArray(minOrbit.value);\n            manip.minOffset.fromArray(minOffset.value);\n            manip.maxOrbit.fromArray(maxOrbit.value);\n            manip.maxOffset.fromArray(maxOffset.value);\n        }\n\n        if (ins.orbit.changed) {\n            manip.orbit.fromArray(ins.orbit.value);\n        }\n        if (ins.offset.changed) {\n            manip.offset.fromArray(ins.offset.value);\n        }\n\n        return true;\n    }\n\n    tick()\n    {\n        const manip = this._manip;\n        const { enabled } = this.ins;\n        const { orbit, offset, size } = this.outs;\n\n        if (enabled.value) {\n            manip.update();\n\n            manip.orbit.toArray(orbit.value);\n            orbit.set();\n            manip.offset.toArray(offset.value);\n            offset.set();\n            size.setValue(manip.size);\n\n\n            const cameraComponent = this._activeCameraComponent;\n\n            if (cameraComponent) {\n                const parent = cameraComponent.parentComponent;\n                if (parent) {\n                    this._manip.toObject(parent.object3D);\n                }\n                else {\n                    this._manip.toObject(cameraComponent.object3D);\n                }\n\n                if (cameraComponent.camera.isOrthographicCamera) {\n                    cameraComponent.camera.size = this._manip.size;\n                }\n\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    protected onPointer(event: IPointerEvent)\n    {\n        if (this.ins.enabled.value && this._activeCameraComponent) {\n            const viewport = event.viewport;\n            this._manip.setViewportSize(viewport.width, viewport.height);\n            this._manip.onPointer(event);\n            event.stopPropagation = true;\n        }\n    }\n\n    protected onTrigger(event: ITriggerEvent)\n    {\n        if (this.ins.enabled.value && this._activeCameraComponent) {\n            const viewport = event.viewport;\n            this._manip.setViewportSize(viewport.width, viewport.height);\n            this._manip.onTrigger(event);\n            event.stopPropagation = true;\n        }\n    }\n\n    protected onActiveCamera(event: IActiveCameraEvent)\n    {\n        this._activeCameraComponent = event.next;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport { types } from \"@ff/graph/propertyTypes\";\nimport CMaterial from \"./CMaterial\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _inputs = {\n    color: types.ColorRGB(\"Color\")\n};\n\nexport default class CPhongMaterial extends CMaterial\n{\n    ins = this.addInputs(_inputs);\n\n\n    create()\n    {\n        this.material = new THREE.MeshPhongMaterial();\n    }\n\n    update()\n    {\n        const material = this.material as THREE.MeshBasicMaterial;\n        const { color } = this.ins;\n\n        material.color.setRGB(color.value[0], color.value[1], color.value[2]);\n        return true;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport Component, { types } from \"@ff/graph/Component\";\nimport ComponentTracker from \"@ff/graph/ComponentTracker\";\nimport Node from \"@ff/graph/Node\";\nimport Graph from \"@ff/graph/Graph\";\nimport CSelection from \"@ff/graph/components/CSelection\";\n\nimport Bracket from \"@ff/three/Bracket\";\n\nimport { IPointerEvent } from \"../RenderView\";\n\nimport CObject3D from \"./CObject3D\";\nimport CTransform from \"./CTransform\";\nimport CScene, { ISceneAfterRenderEvent } from \"./CScene\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _inputs = {\n    bracketsVisible: types.Boolean(\"Brackets.Visible\", true)\n};\n\nexport default class CPickSelection extends CSelection\n{\n    ins = this.addInputs(_inputs);\n\n    protected startX = 0;\n    protected startY = 0;\n\n    private _brackets = new Map<Component, Bracket>();\n    private _sceneTracker: ComponentTracker<CScene> = null;\n\n\n    create()\n    {\n        super.create();\n\n        this.system.on<IPointerEvent>(\"pointer-down\", this.onPointerDown, this);\n        this.system.on<IPointerEvent>(\"pointer-up\", this.onPointerUp, this);\n    }\n\n    dispose()\n    {\n        this.system.off<IPointerEvent>(\"pointer-down\", this.onPointerDown, this);\n        this.system.off<IPointerEvent>(\"pointer-up\", this.onPointerUp, this);\n\n        this._sceneTracker.dispose();\n\n        super.dispose();\n    }\n\n    update()\n    {\n        return true;\n    }\n\n    protected onSelectNode(node: Node, selected: boolean)\n    {\n        super.onSelectNode(node, selected);\n\n        const transform = node.components.get(CTransform);\n        if (transform) {\n            this.updateBracket(transform, selected);\n        }\n    }\n\n    protected onSelectComponent(component: Component, selected: boolean)\n    {\n        super.onSelectComponent(component, selected);\n\n        if (component instanceof CObject3D || component instanceof CTransform) {\n            this.updateBracket(component, selected);\n        }\n    }\n\n    protected onActiveGraph(graph: Graph)\n    {\n        if (this._sceneTracker) {\n            this._sceneTracker.dispose();\n        }\n\n        if (graph) {\n            this._sceneTracker = new ComponentTracker(graph.components, CScene, component => {\n                component.on<ISceneAfterRenderEvent>(\"after-render\", this.onSceneAfterRender, this);\n            }, component => {\n                component.off<ISceneAfterRenderEvent>(\"after-render\", this.onSceneAfterRender, this);\n            });\n        }\n    }\n\n    protected onPointerDown(event: IPointerEvent)\n    {\n        if (event.isPrimary) {\n            this.startX = event.centerX;\n            this.startY = event.centerY;\n        }\n    }\n\n    protected onPointerUp(event: IPointerEvent)\n    {\n        if (event.isPrimary) {\n            const distance = Math.abs(this.startX - event.centerX) + Math.abs(this.startY - event.centerY);\n            if (distance < 2) {\n                if (event.component) {\n                    this.selectComponent(event.component, event.ctrlKey);\n                }\n                else if (!event.ctrlKey) {\n                    this.clearSelection();\n                }\n            }\n        }\n    }\n\n    protected onSceneAfterRender(event: ISceneAfterRenderEvent)\n    {\n        const renderer = event.context.renderer;\n        const camera = event.context.camera;\n\n        if (this.ins.bracketsVisible.value) {\n            for (let entry of this._brackets) {\n                renderer.render(entry[1] as any, camera);\n            }\n        }\n    }\n\n    protected updateBracket(component: CTransform | CObject3D, selected: boolean)\n    {\n        if (!component) {\n            return;\n        }\n\n        if (selected) {\n            const object3D = component.object3D;\n            if (object3D) {\n                const bracket = new Bracket(component.object3D);\n                this._brackets.set(component, bracket);\n            }\n        }\n        else {\n            const bracket = this._brackets.get(component);\n            if (bracket) {\n                this._brackets.delete(component);\n                bracket.dispose();\n            }\n        }\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport { types } from \"@ff/graph/propertyTypes\";\n\nimport CLight from \"./CLight\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _inputs = {\n    distance: types.Number(\"Light.Distance\"),\n    decay: types.Number(\"Light.Decay\", 1)\n};\n\nexport default class CPointLight extends CLight\n{\n    ins = this.addInputs<CLight, typeof _inputs>(_inputs);\n\n\n    get light(): THREE.PointLight\n    {\n        return this.object3D as THREE.PointLight;\n    }\n\n    create()\n    {\n        super.create();\n        this.object3D = new THREE.PointLight();\n    }\n\n    update()\n    {\n        const light = this.light;\n        const { color, intensity, distance, decay } = this.ins;\n\n        light.color.fromArray(color.value);\n        light.intensity = intensity.value;\n        light.distance = distance.value;\n        light.decay = decay.value;\n\n        light.updateMatrix();\n        return true;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport CHierarchy from \"@ff/graph/components/CHierarchy\";\nimport CGraph from \"@ff/graph/components/CGraph\";\n\nimport CTransform from \"./CTransform\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class CRenderGraph extends CGraph\n{\n    set innerRoot(root: CHierarchy)\n    {\n        if (root.is(CTransform)) {\n            const parent = this.components.get(CTransform);\n            const previous = this.innerRoot as CTransform;\n            const next = root as CTransform;\n\n            if (parent && previous) {\n                parent.object3D.remove(previous.object3D);\n            }\n\n            super.innerRoot = next;\n\n            if (parent && next) {\n                parent.object3D.add(next.object3D);\n            }\n        }\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport Component, { ITypedEvent } from \"@ff/graph/Component\";\nimport CPulse from \"@ff/graph/components/CPulse\";\n\nimport RenderView from \"../RenderView\";\nimport CScene, { IActiveCameraEvent } from \"./CScene\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport interface IActiveSceneEvent extends ITypedEvent<\"active-scene\">\n{\n    previous: CScene;\n    next: CScene;\n}\n\nexport default class CRenderer extends Component\n{\n    static readonly isSystemSingleton: boolean = true;\n\n    readonly views: RenderView[] = [];\n\n    private _activeSceneComponent: CScene = null;\n\n\n    constructor(id: string)\n    {\n        super(id);\n        this.addEvents(\"active-scene\", \"active-camera\");\n    }\n\n    get activeSceneComponent() {\n        return this._activeSceneComponent;\n    }\n    set activeSceneComponent(component: CScene) {\n        if (component !== this._activeSceneComponent) {\n            const previousScene = this._activeSceneComponent;\n            const previousCamera = this.activeCameraComponent;\n\n            if (previousScene) {\n                previousScene.off<IActiveCameraEvent>(\"active-camera\", this.onActiveCamera, this);\n            }\n\n            if (component) {\n                component.on<IActiveCameraEvent>(\"active-camera\", this.onActiveCamera, this);\n            }\n\n            this._activeSceneComponent = component;\n            const nextCamera = this.activeCameraComponent;\n\n            const sceneEvent: IActiveSceneEvent = { type: \"active-scene\", previous: previousScene, next: component };\n            this.emit(sceneEvent);\n\n            const cameraEvent: IActiveCameraEvent = { type: \"active-camera\", previous: previousCamera, next: nextCamera };\n            this.emit(cameraEvent);\n        }\n    }\n\n    get activeSceneGraph() {\n        return this._activeSceneComponent ? this._activeSceneComponent.graph : null;\n    }\n    get activeScene() {\n        return this._activeSceneComponent ? this._activeSceneComponent.scene : null;\n    }\n\n    get activeCameraComponent() {\n        return this._activeSceneComponent ? this._activeSceneComponent.activeCameraComponent : null;\n    }\n    get activeCamera() {\n        const component = this._activeSceneComponent ? this._activeSceneComponent.activeCameraComponent : null;\n        return component ? component.camera : null;\n    }\n\n    create()\n    {\n        this.trackComponent(CPulse, component => {\n            component.on(\"pulse\", this.onPulse, this)\n        }, component => {\n            component.off(\"pulse\", this.onPulse, this);\n        });\n    }\n\n    attachView(view: RenderView)\n    {\n        this.views.push(view);\n        //console.log(\"RenderSystem.attachView - total views: %s\", this.views.length);\n    }\n\n    detachView(view: RenderView)\n    {\n        const index = this.views.indexOf(view);\n        if (index < 0) {\n            throw new Error(\"render view not registered\");\n        }\n        this.views.splice(index, 1);\n        //console.log(\"RenderSystem.detachView - total views: %s\", this.views.length);\n    }\n\n    protected onPulse()\n    {\n        this.views.forEach(view => {\n            view.render();\n        });\n    }\n\n    protected onActiveCamera(event: IActiveCameraEvent)\n    {\n        this.emit<IActiveCameraEvent>(event);\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport { ITypedEvent } from \"@ff/core/Publisher\";\n\nimport { types } from \"@ff/graph/propertyTypes\";\n\nimport RenderView, { Viewport } from \"../RenderView\";\nimport CRenderer, { IActiveSceneEvent } from \"./CRenderer\";\nimport CTransform from \"./CTransform\";\nimport CCamera from \"./CCamera\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { IActiveSceneEvent };\n\nconst _context: IRenderSceneContext = {\n    view: null,\n    viewport: null,\n    renderer: null,\n    scene: null,\n    camera: null\n};\n\nconst _beforeRenderEvent: ISceneBeforeRenderEvent = {\n    type: \"before-render\",\n    component: null,\n    context: _context\n};\n\nconst _afterRenderEvent: ISceneAfterRenderEvent = {\n    type: \"after-render\",\n    component: null,\n    context: _context\n};\n\nexport interface IRenderSceneContext\n{\n    view: RenderView;\n    viewport: Viewport;\n    renderer: THREE.WebGLRenderer;\n    scene: THREE.Scene;\n    camera: THREE.Camera;\n}\n\ninterface ISceneRenderEvent<T extends string> extends ITypedEvent<T>\n{\n    component: CScene;\n    context: IRenderSceneContext;\n}\n\nexport interface ISceneBeforeRenderEvent extends ISceneRenderEvent<\"before-render\"> { }\nexport interface ISceneAfterRenderEvent extends ISceneRenderEvent<\"after-render\"> { }\n\nexport interface IActiveCameraEvent extends ITypedEvent<\"active-camera\">\n{\n    previous: CCamera;\n    next: CCamera;\n}\n\nconst _inputs = {\n    activate: types.Event(\"Scene.Activate\")\n};\n\nexport default class CScene extends CTransform\n{\n    static readonly isGraphSingleton = true;\n\n    private _activeCameraComponent: CCamera = null;\n\n    ins = this.addInputs<CTransform, typeof _inputs>(_inputs, 0);\n\n    constructor(id: string)\n    {\n        super(id);\n        this.addEvents(\"before-render\", \"after-render\", \"active-camera\");\n    }\n\n    get scene(): THREE.Scene {\n        return this.object3D as THREE.Scene;\n    }\n\n    get activeCameraComponent() {\n        return this._activeCameraComponent;\n    }\n    set activeCameraComponent(component: CCamera) {\n        if (component !== this._activeCameraComponent) {\n            const previous = this._activeCameraComponent;\n            this._activeCameraComponent = component;\n\n            const event: IActiveCameraEvent = { type: \"active-camera\", previous, next: component };\n            this.emit(event);\n\n            const renderer = this.renderer;\n            if (renderer) {\n                this.renderer.emit(event);\n            }\n        }\n    }\n\n    get activeCamera() {\n        return this._activeCameraComponent ? this._activeCameraComponent.camera : null;\n    }\n\n    protected get renderer(): CRenderer {\n        return this.system.graph.components.get(CRenderer);\n    }\n\n    create()\n    {\n        super.create();\n\n        const renderer = this.renderer;\n        if (renderer && !renderer.activeSceneComponent) {\n            renderer.activeSceneComponent = this;\n        }\n    }\n\n    update(context)\n    {\n        const updated = super.update(context);\n\n        if (this.ins.activate.changed) {\n            const renderer = this.renderer;\n            if (renderer) {\n                renderer.activeSceneComponent = this;\n            }\n        }\n\n        return updated;\n    }\n\n    dispose()\n    {\n        const renderer = this.renderer;\n        if (renderer && renderer.activeSceneComponent === this) {\n            renderer.activeSceneComponent = null;\n        }\n\n        super.dispose();\n    }\n\n    beforeRender(context: IRenderSceneContext)\n    {\n    }\n\n    afterRender(context: IRenderSceneContext)\n    {\n    }\n\n    protected createObject3D()\n    {\n        const scene = new THREE.Scene();\n        scene.onBeforeRender = this._onBeforeRender.bind(this);\n        scene.onAfterRender = this._onAfterRender.bind(this);\n        return scene;\n    }\n\n    private _onBeforeRender(renderer: THREE.WebGLRenderer, scene: THREE.Scene, camera: THREE.Camera)\n    {\n        _context.view = renderer[\"__view\"];\n        _context.viewport = renderer[\"__viewport\"];\n        _context.renderer = renderer;\n        _context.scene = scene;\n        _context.camera = camera;\n\n        this.beforeRender && this.beforeRender(_context);\n\n        _beforeRenderEvent.component = this;\n        this.emit<ISceneBeforeRenderEvent>(_beforeRenderEvent);\n    }\n\n    private _onAfterRender(renderer: THREE.WebGLRenderer, scene: THREE.Scene, camera: THREE.Camera)\n    {\n        _context.view = renderer[\"__view\"];\n        _context.viewport = renderer[\"__viewport\"];\n        _context.renderer = renderer;\n        _context.scene = scene;\n        _context.camera = camera;\n\n        this.afterRender && this.afterRender(_context);\n\n        _afterRenderEvent.component = this;\n        this.emit<ISceneAfterRenderEvent>(_afterRenderEvent);\n    }\n}\n\nCScene.prototype.beforeRender = null;\nCScene.prototype.afterRender = null;","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport { types } from \"@ff/graph/propertyTypes\";\n\nimport CLight from \"./CLight\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _inputs = {\n    distance: types.Number(\"Light.Distance\"),\n    decay: types.Number(\"Light.Decay\", 1),\n    angle: types.Number(\"Light.Angle\", 45),\n    penumbra: types.Number(\"Light.Penumbra\", 0.5)\n};\n\nexport default class CSpotLight extends CLight\n{\n    ins = this.addInputs<CLight, typeof _inputs>(_inputs);\n\n\n    get light(): THREE.SpotLight\n    {\n        return this.object3D as THREE.SpotLight;\n    }\n\n    create()\n    {\n        super.create();\n        this.object3D = new THREE.SpotLight();\n    }\n\n    update()\n    {\n        const light = this.light;\n        const { color, intensity, distance, decay, angle, penumbra } = this.ins;\n\n        light.color.fromArray(color.value);\n        light.intensity = intensity.value;\n        light.distance = distance.value;\n        light.decay = decay.value;\n        light.angle = angle.value;\n        light.penumbra = penumbra.value;\n\n        light.updateMatrix();\n        return true;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport{ types } from \"@ff/graph/propertyTypes\";\n\nimport CGeometry from \"./CGeometry\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _inputs = {\n    radius: types.Number(\"Radius\", 10),\n    tube: types.Number(\"Tube\", 3),\n    angle: types.Number(\"Angle\", 360),\n    segments: types.Vector2(\"Segments\", [ 24, 12 ])\n};\n\nexport default class CTorus extends CGeometry\n{\n    ins = this.addInputs<CGeometry, typeof _inputs>(_inputs);\n\n    update()\n    {\n        const { radius, tube, angle, segments } = this.ins;\n\n        this.geometry = new THREE.TorusBufferGeometry(\n            radius.value, tube.value,\n            segments.value[0], segments.value[1],\n            angle.value\n        );\n\n        return true;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport math from \"@ff/core/math\";\n\nimport { types } from \"@ff/graph/propertyTypes\";\nimport CHierarchy from \"@ff/graph/components/CHierarchy\";\nimport Component from \"@ff/graph/Component\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _vec3a = new THREE.Vector3();\nconst _vec3b = new THREE.Vector3();\nconst _quat = new THREE.Quaternion();\nconst _euler = new THREE.Euler();\n\n\nexport enum ERotationOrder { XYZ, YZX, ZXY, XZY, YXZ, ZYX }\n\nexport interface ICObject3D extends Component\n{\n    object3D: THREE.Object3D;\n}\n\nconst _inputs = {\n    position: types.Vector3(\"Transform.Position\"),\n    rotation: types.Vector3(\"Transform.Rotation\"),\n    order: types.Enum(\"Transform.Order\", ERotationOrder),\n    scale: types.Vector3(\"Transform.Scale\", [ 1, 1, 1 ])\n};\n\nconst _outputs = {\n    matrix: types.Matrix4(\"Transform.Matrix\")\n};\n\n/**\n * Allows arranging components in a hierarchical structure. Each [[TransformComponent]]\n * contains a transformation which affects its children as well as other components which\n * are part of the same entity.\n */\nexport default class CTransform extends CHierarchy implements ICObject3D\n{\n    ins = this.addInputs<CHierarchy, typeof _inputs>(_inputs);\n    outs = this.addOutputs<CHierarchy, typeof _outputs>(_outputs);\n\n    private _object3D: THREE.Object3D;\n\n    constructor(id: string)\n    {\n        super(id);\n\n        this._object3D = this.createObject3D();\n        this._object3D.matrixAutoUpdate = false;\n    }\n\n    get transform(): CTransform {\n        return this;\n    }\n\n    /**\n     * Returns the three.js renderable object wrapped in this component.\n     */\n    get object3D(): THREE.Object3D\n    {\n        return this._object3D;\n    }\n\n    /**\n     * Returns an array of child components of this.\n     */\n    get children(): Readonly<CTransform[]>\n    {\n        return this._children as CTransform[] || [];\n    }\n\n    /**\n     * Returns a reference to the local transformation matrix.\n     */\n    get matrix(): Readonly<THREE.Matrix4>\n    {\n        return this._object3D.matrix;\n    }\n\n    update(context)\n    {\n        const object3D = this._object3D;\n        const { position, rotation, order, scale } = this.ins;\n        const { matrix } = this.outs;\n\n        object3D.position.fromArray(position.value);\n        _vec3a.fromArray(rotation.value).multiplyScalar(math.DEG2RAD);\n        const orderName = order.getOptionText();\n        object3D.rotation.setFromVector3(_vec3a, orderName);\n        object3D.scale.fromArray(scale.value);\n        object3D.updateMatrix();\n\n        (object3D.matrix as any).toArray(matrix.value);\n        matrix.set();\n\n        return true;\n    }\n\n    dispose()\n    {\n        if (!this._object3D) {\n            return;\n        }\n\n        // detach the three.js object from its parent and children\n        if (this._object3D.parent) {\n            this._object3D.parent.remove(this._object3D);\n        }\n        this._object3D.children.slice().forEach(child => this._object3D.remove(child));\n\n        super.dispose();\n    }\n\n    setFromMatrix(matrix: THREE.Matrix4)\n    {\n        const { position, rotation, order, scale } = this.ins;\n\n        matrix.decompose(_vec3a, _quat, _vec3b);\n        _vec3a.toArray(position.value);\n\n        const orderName = order.getOptionText();\n        _euler.setFromQuaternion(_quat, orderName);\n        _euler.toVector3(_vec3a);\n        _vec3a.multiplyScalar(math.RAD2DEG).toArray(rotation.value);\n\n        _vec3b.toArray(scale.value);\n\n        position.set();\n        rotation.set();\n        scale.set();\n    }\n\n\n    /**\n     * Adds the given transform component as a children to this.\n     * @param component\n     */\n    addChild(component: CTransform)\n    {\n        super.addChild(component);\n        this._object3D.add(component._object3D);\n    }\n\n    /**\n     * Removes the given transform component from the list of children of this.\n     * @param component\n     */\n    removeChild(component: CTransform)\n    {\n        this._object3D.remove(component._object3D);\n        super.removeChild(component);\n    }\n\n    // /**\n    //  * Called by [[CObject3D]] to attach its three.js renderable object to the transform component.\n    //  * Do not call this directly.\n    //  * @param object\n    //  */\n    // addObject3D(object: THREE.Object3D)\n    // {\n    //     this._object3D.add(object);\n    // }\n    //\n    // /**\n    //  * Called by [[CObject3D]] to detach its three.js renderable object from the transform component.\n    //  * Do not call this directly.\n    //  * @param object\n    //  */\n    // removeObject3D(object: THREE.Object3D)\n    // {\n    //     this._object3D.remove(object);\n    // }\n\n    protected createObject3D()\n    {\n        return new THREE.Object3D();\n    }\n}\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport CBasicMaterial from \"./CBasicMaterial\";\nimport CBox from \"./CBox\";\nimport CCamera from \"./CCamera\";\nimport CDirectionalLight from \"./CDirectionalLight\";\nimport CGeometry from \"./CGeometry\";\nimport CGrid from \"./CGrid\";\nimport CLight from \"./CLight\";\nimport CMain from \"./CMain\";\nimport CMaterial from \"./CMaterial\";\nimport CMesh from \"./CMesh\";\nimport CObject3D from \"./CObject3D\";\nimport COrbitManipulator from \"./COrbitManipulator\";\nimport CPhongMaterial from \"./CPhongMaterial\";\nimport CPickSelection from \"./CPickSelection\";\nimport CPointLight from \"./CPointLight\";\nimport CRenderer from \"./CRenderer\";\nimport CRenderGraph from \"./CRenderGraph\";\nimport CScene from \"./CScene\";\nimport CSpotLight from \"./CSpotLight\";\nimport CTorus from \"./CTorus\";\nimport CTransform from \"./CTransform\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport {\n    CBasicMaterial,\n    CBox,\n    CCamera,\n    CDirectionalLight,\n    CGeometry,\n    CGrid,\n    CLight,\n    CMain,\n    CMaterial,\n    CMesh,\n    CObject3D,\n    COrbitManipulator,\n    CPhongMaterial,\n    CPickSelection,\n    CPointLight,\n    CRenderer,\n    CRenderGraph,\n    CScene,\n    CSpotLight,\n    CTorus,\n    CTransform\n};\n\nexport const componentTypes = [\n    CBasicMaterial,\n    CBox,\n    CCamera,\n    CPickSelection,\n    CDirectionalLight,\n    CGrid,\n    CMain,\n    CMesh,\n    COrbitManipulator,\n    CPhongMaterial,\n    CPointLight,\n    CRenderer,\n    CRenderGraph,\n    CScene,\n    CSpotLight,\n    CTorus,\n    CTransform\n];\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\nimport { computeLocalBoundingBox } from \"./helpers\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _vec3 = new THREE.Vector3();\nconst _mat4 = new THREE.Matrix4();\n\nexport interface IBracketProps\n{\n    /** Color of the bracket lines. Default is white. */\n    color?: THREE.Color;\n    /** Length of the bracket lines relative to the size of the object. Default is 0.25. */\n    length?: number;\n}\n\n/**\n * Wireframe selection bracket.\n */\nexport default class Bracket extends THREE.LineSegments\n{\n    static readonly defaultProps = {\n        color: new THREE.Color(\"#ffd633\"),\n        length: 0.25\n    };\n\n    constructor(target: THREE.Object3D, props?: IBracketProps)\n    {\n        props = Object.assign({}, Bracket.defaultProps, props);\n\n        const box = new THREE.Box3();\n        box.makeEmpty();\n\n        computeLocalBoundingBox(target, box);\n\n        const length = props.length;\n        const min = [ box.min.x, box.min.y, box.min.z ];\n        const max = [ box.max.x, box.max.y, box.max.z ];\n        const size = [ (max[0] - min[0]) * length, (max[1] - min[1]) * length, (max[2] - min[2]) * length ];\n        let vertices;\n\n        if (isFinite(size[0]) && isFinite(size[1]) && isFinite(size[2])) {\n            vertices = [\n                min[0], min[1], min[2], min[0] + size[0], min[1], min[2],\n                min[0], min[1], min[2], min[0], min[1] + size[1], min[2],\n                min[0], min[1], min[2], min[0], min[1], min[2] + size[2],\n\n                max[0], min[1], min[2], max[0] - size[0], min[1], min[2],\n                max[0], min[1], min[2], max[0], min[1] + size[1], min[2],\n                max[0], min[1], min[2], max[0], min[1], min[2] + size[2],\n\n                min[0], max[1], min[2], min[0] + size[0], max[1], min[2],\n                min[0], max[1], min[2], min[0], max[1] - size[1], min[2],\n                min[0], max[1], min[2], min[0], max[1], min[2] + size[2],\n\n                min[0], min[1], max[2], min[0] + size[0], min[1], max[2],\n                min[0], min[1], max[2], min[0], min[1] + size[1], max[2],\n                min[0], min[1], max[2], min[0], min[1], max[2] - size[2],\n\n                min[0], max[1], max[2], min[0] + size[0], max[1], max[2],\n                min[0], max[1], max[2], min[0], max[1] - size[1], max[2],\n                min[0], max[1], max[2], min[0], max[1], max[2] - size[2],\n\n                max[0], min[1], max[2], max[0] - size[0], min[1], max[2],\n                max[0], min[1], max[2], max[0], min[1] + size[1], max[2],\n                max[0], min[1], max[2], max[0], min[1], max[2] - size[2],\n\n                max[0], max[1], min[2], max[0] - size[0], max[1], min[2],\n                max[0], max[1], min[2], max[0], max[1] - size[1], min[2],\n                max[0], max[1], min[2], max[0], max[1], min[2] + size[2],\n\n                max[0], max[1], max[2], max[0] - size[0], max[1], max[2],\n                max[0], max[1], max[2], max[0], max[1] - size[1], max[2],\n                max[0], max[1], max[2], max[0], max[1], max[2] - size[2],\n            ];\n        }\n        else {\n            vertices = [\n                -1, 0, 0, 1, 0, 0,\n                0, -1, 0, 0, 1, 0,\n                0, 0, -1, 0, 0, 1,\n            ];\n        }\n\n        const geometry = new THREE.BufferGeometry();\n        geometry.addAttribute(\"position\", new THREE.Float32BufferAttribute(vertices, 3));\n\n        const material = new THREE.LineBasicMaterial({\n            color: props.color,\n            depthTest: false\n        });\n\n        super(geometry, material);\n\n        this.renderOrder = 1;\n\n        this.onBeforeRender = () => {\n            target.updateMatrixWorld(false);\n            this.matrixWorld.copy(target.matrixWorld);\n        }\n    }\n\n    dispose()\n    {\n        if (this.parent) {\n            this.parent.remove(this);\n        }\n\n        this.geometry.dispose();\n    }\n\n    protected static expandBoundingBox(object: THREE.Object3D, root: THREE.Object3D, box: THREE.Box3)\n    {\n        const geometry = (object as any).geometry;\n        if (geometry !== undefined) {\n\n            let parent = object;\n            _mat4.identity();\n            while(parent && parent !== root) {\n                _mat4.premultiply(parent.matrix);\n                parent = parent.parent;\n            }\n\n            if (geometry.isGeometry) {\n                const vertices = geometry.vertices;\n                for (let i = 0, n = vertices.length; i < n; ++i) {\n                    _vec3.copy(vertices[i]).applyMatrix4(_mat4);\n                    box.expandByPoint(_vec3);\n                }\n            }\n            else if (geometry.isBufferGeometry) {\n                const attribute = geometry.attributes.position;\n                if (attribute !== undefined) {\n                    for (let i = 0, n = attribute.count; i < n; ++i) {\n                        _vec3.fromBufferAttribute(attribute, i).applyMatrix4(_mat4);\n                        box.expandByPoint(_vec3);\n                    }\n                }\n            }\n        }\n\n        const children = object.children;\n        for (let i = 0, n = children.length; i < n; ++i) {\n            Bracket.expandBoundingBox(children[i], root, box);\n        }\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport IndexShader from \"./shaders/IndexShader\";\nimport PositionShader from \"./shaders/PositionShader\";\nimport NormalShader from \"./shaders/NormalShader\";\n\nimport { IBaseEvent } from \"./Viewport\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _vec3 = new THREE.Vector3();\n\nexport default class GPUPicker\n{\n    protected renderer: THREE.WebGLRenderer;\n\n    protected pickTextures: THREE.WebGLRenderTarget[];\n    protected pickBuffer: Uint8Array;\n\n    protected indexShader: IndexShader;\n    protected positionShader: PositionShader;\n    protected normalShader: NormalShader;\n\n    constructor(renderer: THREE.WebGLRenderer)\n    {\n        this.renderer = renderer;\n\n        this.pickTextures = [];\n        for (let i = 0; i < 3; ++i) {\n            this.pickTextures[i] = new THREE.WebGLRenderTarget(1, 1, { stencilBuffer: false });\n        }\n        this.pickBuffer = new Uint8Array(4);\n\n        this.indexShader = new IndexShader();\n        this.positionShader = new PositionShader();\n        this.normalShader = new NormalShader();\n    }\n\n    pickObject(scene: THREE.Scene, camera: THREE.Camera, event: IBaseEvent): THREE.Object3D\n    {\n        const index = this.pickIndex(scene, camera, event);\n        if (index > 0) {\n            return scene.getObjectById(index);\n        }\n\n        return undefined;\n    }\n\n    pickIndex(scene: THREE.Scene, camera: THREE.Camera, event: IBaseEvent): number\n    {\n        const viewport = event.viewport;\n        camera = viewport.updateCamera(camera);\n\n        const overrideMaterial = scene.overrideMaterial;\n        scene.overrideMaterial = this.indexShader;\n\n        const renderer = this.renderer;\n        const pickTexture = this.pickTextures[0];\n        const color = renderer.getClearColor().clone();\n        renderer.setClearColor(0);\n\n        viewport.applyPickViewport(pickTexture, event);\n        renderer.render(scene, camera, pickTexture, true);\n\n        renderer.setRenderTarget();\n        renderer.setClearColor(color);\n        scene.overrideMaterial = overrideMaterial;\n\n        const buffer = this.pickBuffer;\n        renderer.readRenderTargetPixels(pickTexture, 0, 0, 1, 1, buffer);\n\n        return buffer[0] + buffer[1] * 256 + buffer[2] * 65536;\n    }\n\n    pickPosition(scene: THREE.Scene, camera: THREE.Camera,\n        boundingBox: THREE.Box3, event: IBaseEvent): THREE.Vector3\n    {\n        const viewport = event.viewport;\n        camera = viewport.updateCamera(camera);\n\n        const overrideMaterial = scene.overrideMaterial;\n        const shader = scene.overrideMaterial = this.positionShader;\n\n        const renderer = this.renderer;\n        const pickTextures = this.pickTextures;\n        const color = renderer.getClearColor().clone();\n        renderer.setClearColor(0);\n\n        for (let i = 0; i < 3; ++i) {\n            shader.uniforms.index.value = i;\n            shader.uniforms.range.value[0] = boundingBox.min.getComponent(i);\n            shader.uniforms.range.value[1] = boundingBox.max.getComponent(i);\n            viewport.applyPickViewport(pickTextures[i], event);\n            renderer.render(scene, camera, pickTextures[i], true);\n        }\n\n        renderer.setRenderTarget();\n        renderer.setClearColor(color);\n        scene.overrideMaterial = overrideMaterial;\n\n        const buffer = this.pickBuffer;\n        const position = new THREE.Vector3();\n\n        for (let i = 0; i < 3; ++i) {\n            renderer.readRenderTargetPixels(pickTextures[i], 0, 0, 1, 1, buffer);\n            position[i] = buffer[0] / 255\n                + buffer[1] / 255 / 256\n                + buffer[2] / 255 / 65536\n                + buffer[3] / 255 / 16777216;\n        }\n\n        boundingBox.getSize(_vec3);\n        return position.multiply(_vec3).add(boundingBox.min);\n    }\n\n    pickNormal(scene: THREE.Scene, camera: THREE.Camera, event: IBaseEvent): THREE.Vector3\n    {\n        const viewport = event.viewport;\n        camera = viewport.updateCamera(camera);\n\n        const overrideMaterial = scene.overrideMaterial;\n        scene.overrideMaterial = this.normalShader;\n\n        const renderer = this.renderer;\n        const pickTexture = this.pickTextures[0];\n        const color = renderer.getClearColor().clone();\n        renderer.setClearColor(0);\n\n        viewport.applyPickViewport(pickTexture, event);\n        renderer.render(scene, camera, pickTexture, true);\n\n        renderer.setRenderTarget();\n        renderer.setClearColor(color);\n        scene.overrideMaterial = overrideMaterial;\n\n        const buffer = this.pickBuffer;\n        renderer.readRenderTargetPixels(pickTexture, 0, 0, 1, 1, buffer);\n        return new THREE.Vector3(\n            buffer[0] / 255 * 2 - 1,\n            buffer[1] / 255 * 2 - 1,\n            buffer[2] / 255 * 2 - 1\n        ).normalize();\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport interface IGridProps\n{\n    size: number;\n    mainDivisions: number;\n    subDivisions: number;\n    mainColor: THREE.Color | string | number;\n    subColor: THREE.Color | string | number;\n}\n\nexport default class Grid extends THREE.LineSegments\n{\n    constructor(props: IGridProps)\n    {\n        const geometry = Grid.generate(props);\n        const material = new THREE.LineBasicMaterial({\n            vertexColors: THREE.VertexColors\n        });\n\n        super(geometry, material);\n    }\n\n    update(props: IGridProps)\n    {\n        if (this.geometry) {\n            this.geometry.dispose();\n        }\n\n        this.geometry = Grid.generate(props);\n    }\n\n    protected static generate(props: IGridProps): THREE.BufferGeometry\n    {\n        const mainColor = new THREE.Color(props.mainColor as any);\n        const subColor = new THREE.Color(props.subColor as any);\n\n        const divisions = props.mainDivisions * props.subDivisions;\n        const step = props.size / divisions;\n        const halfSize = props.size * 0.5;\n\n        const vertices = [];\n        const colors = [];\n\n        for (let i = 0, j = 0, k = -halfSize; i <= divisions; ++i, k += step) {\n            vertices.push(-halfSize, 0, k, halfSize, 0, k);\n            vertices.push(k, 0, -halfSize, k, 0, halfSize);\n\n            const color = i % props.subDivisions === 0 ? mainColor : subColor;\n\n            color.toArray(colors, j); j += 3;\n            color.toArray(colors, j); j += 3;\n            color.toArray(colors, j); j += 3;\n            color.toArray(colors, j); j += 3;\n        }\n\n        const geometry = new THREE.BufferGeometry();\n        geometry.addAttribute(\"position\", new THREE.Float32BufferAttribute(vertices, 3));\n        geometry.addAttribute(\"color\", new THREE.Float32BufferAttribute(colors, 3));\n\n        return geometry;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport math from \"@ff/core/math\";\n\nimport threeMath from \"./math\";\n\nimport {\n    IManip,\n    IPointerEvent,\n    ITriggerEvent\n} from \"@ff/browser/ManipTarget\";\n\nimport { EProjection } from \"./UniversalCamera\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _vec3a = new THREE.Vector3();\nconst _vec3b = new THREE.Vector3();\n\nexport { EProjection };\nexport enum EViewPreset { Left, Right, Top, Bottom, Front, Back, None }\n\nenum EManipMode { Off, Pan, Orbit, Dolly, Zoom, PanDolly, Roll }\nenum EManipPhase { Off, Active, Release }\n\n\nexport default class OrbitManipulator implements IManip\n{\n    orbit = new THREE.Vector3(0, 0, 0);\n    offset = new THREE.Vector3(0, 0, 50);\n    size = 50;\n    zoom = 1;\n\n    minOrbit = new THREE.Vector3(-90, -Infinity, -Infinity);\n    maxOrbit = new THREE.Vector3(90, Infinity, Infinity);\n    minOffset = new THREE.Vector3(-Infinity, -Infinity, 0.1);\n    maxOffset = new THREE.Vector3(Infinity, Infinity, 1000);\n\n    orientationEnabled = true;\n    offsetEnabled = true;\n    cameraMode = true;\n    orthographicMode = false;\n\n    protected mode = EManipMode.Off;\n    protected phase = EManipPhase.Off;\n    protected prevPinchDist = 0;\n\n    protected deltaX = 0;\n    protected deltaY = 0;\n    protected deltaPinch = 0;\n    protected deltaWheel = 0;\n\n    protected viewportWidth = 100;\n    protected viewportHeight = 100;\n\n    constructor()\n    {\n    }\n\n    onPointer(event: IPointerEvent)\n    {\n        if (event.isPrimary) {\n            if (event.type === \"pointer-down\") {\n                this.phase = EManipPhase.Active;\n            }\n            else if (event.type === \"pointer-up\") {\n                this.phase = EManipPhase.Release;\n                return true;\n            }\n        }\n\n        if (event.type === \"pointer-down\") {\n            this.mode = this.getModeFromEvent(event);\n        }\n\n        this.deltaX += event.movementX;\n        this.deltaY += event.movementY;\n\n        // calculate pinch\n        if (event.pointerCount === 2) {\n            const positions = event.activePositions;\n            const dx = positions[1].clientX - positions[0].clientX;\n            const dy = positions[1].clientY - positions[0].clientY;\n            const pinchDist = Math.sqrt(dx * dx + dy * dy);\n\n            const prevPinchDist = this.prevPinchDist || pinchDist;\n            this.deltaPinch *= prevPinchDist > 0 ? (pinchDist / prevPinchDist) : 1;\n            this.prevPinchDist = pinchDist;\n        }\n        else {\n            this.deltaPinch = 1;\n            this.prevPinchDist = 0;\n        }\n\n        return true;\n    }\n\n    onTrigger(event: ITriggerEvent)\n    {\n        if (event.type === \"wheel\") {\n            this.deltaWheel += math.limit(event.wheel, -1, 1);\n            return true;\n        }\n\n        return false;\n    }\n\n    setViewportSize(width: number, height: number)\n    {\n        this.viewportWidth = width;\n        this.viewportHeight = height;\n    }\n\n    setFromCamera(camera: THREE.Camera, adaptLimits: boolean = false)\n    {\n        const orbit = this.orbit;\n        const offset = this.offset;\n        threeMath.decomposeOrbitMatrix(camera.matrix, orbit, offset);\n        this.orbit.multiplyScalar(threeMath.RAD2DEG);\n\n        const cam = camera as any;\n\n        if ((this.orthographicMode = cam.isOrthographicCamera)) {\n            this.size = cam.isUniversalCamera ? cam.size : cam.top - cam.bottom;\n        }\n        if (adaptLimits) {\n            this.minOffset.min(offset);\n            this.maxOffset.max(offset);\n        }\n    }\n\n    setFromObject(object: THREE.Object3D)\n    {\n        threeMath.decomposeOrbitMatrix(object.matrix, this.orbit, this.offset);\n        this.orbit.multiplyScalar(threeMath.RAD2DEG);\n\n        this.orthographicMode = false;\n    }\n\n    setFromMatrix(matrix: THREE.Matrix4, invert: boolean = false)\n    {\n        threeMath.decomposeOrbitMatrix(matrix, this.orbit, this.offset);\n        this.orbit.multiplyScalar(threeMath.RAD2DEG);\n\n        this.orthographicMode = false;\n    }\n\n    /**\n     * Updates the matrix of the given camera. If the camera's projection is orthographic,\n     * updates the camera's size parameter as well.\n     * @param camera\n     */\n    toCamera(camera: THREE.Camera)\n    {\n        _vec3a.copy(this.orbit).multiplyScalar(math.DEG2RAD);\n        _vec3b.copy(this.offset);\n\n        if (this.orthographicMode) {\n            _vec3b.z = this.maxOffset.z;\n        }\n\n        threeMath.composeOrbitMatrix(_vec3a, _vec3b, camera.matrix);\n        camera.matrixWorldNeedsUpdate = true;\n\n        const cam = camera as any;\n        if (cam.isOrthographicCamera) {\n            if (cam.isUniversalCamera) {\n                cam.size = this.offset.z;\n            }\n            else {\n                const aspect = camera.userData[\"aspect\"] || 1;\n                const halfSize = this.offset.z * 0.5;\n                cam.left = -halfSize * aspect;\n                cam.right = halfSize * aspect;\n                cam.bottom = -halfSize;\n                cam.top = halfSize;\n            }\n            cam.updateProjectionMatrix();\n        }\n    }\n\n    /**\n     * Sets the given object's matrix from the manipulator's current orbit and offset.\n     * @param object\n     */\n    toObject(object: THREE.Object3D)\n    {\n        _vec3a.copy(this.orbit).multiplyScalar(math.DEG2RAD);\n        _vec3b.copy(this.offset);\n\n        if (this.orthographicMode) {\n            _vec3b.z = this.maxOffset.z;\n        }\n\n        threeMath.composeOrbitMatrix(_vec3a, _vec3b, object.matrix);\n        object.matrixWorldNeedsUpdate = true;\n    }\n\n    /**\n     * Sets the given matrix from the manipulator's current orbit and offset.\n     * @param matrix\n     */\n    toMatrix(matrix: THREE.Matrix4)\n    {\n        _vec3a.copy(this.orbit).multiplyScalar(math.DEG2RAD);\n        _vec3b.copy(this.offset);\n\n        if (this.orthographicMode) {\n            _vec3b.z = this.maxOffset.z;\n        }\n\n        threeMath.composeOrbitMatrix(_vec3a, _vec3b, matrix);\n    }\n\n    /**\n     * Updates the manipulator.\n     * @returns true if the state has changed during the update.\n     */\n    update(): boolean\n    {\n        if (this.phase === EManipPhase.Off && this.deltaWheel === 0) {\n            return false;\n        }\n\n        if (this.deltaWheel !== 0) {\n            this.updatePose(0, 0, this.deltaWheel * 0.07 + 1, 0, 0, 0);\n            this.deltaWheel = 0;\n            return true;\n        }\n\n        if (this.phase === EManipPhase.Active) {\n            if (this.deltaX === 0 && this.deltaY === 0 && this.deltaPinch === 1) {\n                return false;\n            }\n\n            this.updateByMode();\n            this.deltaX = 0;\n            this.deltaY = 0;\n            this.deltaPinch = 1;\n            return true;\n        }\n        else if (this.phase === EManipPhase.Release) {\n            this.deltaX *= 0.85;\n            this.deltaY *= 0.85;\n            this.deltaPinch = 1;\n            this.updateByMode();\n\n            const delta = Math.abs(this.deltaX) + Math.abs(this.deltaY);\n            if (delta < 0.1) {\n                this.mode = EManipMode.Off;\n                this.phase = EManipPhase.Off;\n            }\n            return true;\n        }\n\n        return false;\n    }\n\n    protected updateByMode()\n    {\n        switch(this.mode) {\n            case EManipMode.Orbit:\n                this.updatePose(0, 0, 1, this.deltaY, this.deltaX, 0);\n                break;\n\n            case EManipMode.Pan:\n                this.updatePose(this.deltaX, this.deltaY, 1, 0, 0, 0);\n                break;\n\n            case EManipMode.Roll:\n                this.updatePose(0, 0, 1, 0, 0, this.deltaX);\n                break;\n\n            case EManipMode.Dolly:\n                this.updatePose(0, 0, this.deltaY * 0.0075 + 1, 0, 0, 0);\n                break;\n\n            case EManipMode.PanDolly:\n                const pinchScale = (this.deltaPinch - 1) * 0.5 + 1;\n                this.updatePose(this.deltaX, this.deltaY, 1 / pinchScale, 0, 0, 0);\n                break;\n        }\n    }\n\n    protected updatePose(dX, dY, dScale, dPitch, dHead, dRoll)\n    {\n        const {\n            orbit, minOrbit, maxOrbit,\n            offset, minOffset, maxOffset\n        } = this;\n\n        let inverse = this.cameraMode ? -1 : 1;\n\n        if (this.orientationEnabled) {\n            orbit.x += inverse * dPitch * 300 / this.viewportHeight;\n            orbit.y += inverse * dHead * 300 / this.viewportHeight;\n            orbit.z += inverse * dRoll * 300 / this.viewportHeight;\n\n            // check limits\n            orbit.x = math.limit(orbit.x, minOrbit.x, maxOrbit.x);\n            orbit.y = math.limit(orbit.y, minOrbit.y, maxOrbit.y);\n            orbit.z = math.limit(orbit.z, minOrbit.z, maxOrbit.z);\n        }\n\n        if (this.offsetEnabled) {\n            const factor = offset.z = dScale * offset.z;\n\n            offset.x += dX * factor * inverse * 2 / this.viewportHeight;\n            offset.y -= dY * factor * inverse * 2 / this.viewportHeight;\n\n            // check limits\n            offset.x = math.limit(offset.x, minOffset.x, maxOffset.x);\n            offset.y = math.limit(offset.y, minOffset.y, maxOffset.y);\n            offset.z = math.limit(offset.z, minOffset.z, maxOffset.z);\n        }\n    }\n\n    protected getModeFromEvent(event: IPointerEvent): EManipMode\n    {\n        if (event.source === \"mouse\") {\n            const button = event.originalEvent.button;\n\n            // left button\n            if (button === 0) {\n                if (event.ctrlKey) {\n                    return EManipMode.Pan;\n                }\n                if (event.altKey) {\n                    return EManipMode.Dolly;\n                }\n\n                return EManipMode.Orbit;\n            }\n\n            // right button\n            if (button === 2) {\n                if (event.altKey) {\n                    return EManipMode.Roll;\n                }\n                else {\n                    return EManipMode.Pan;\n                }\n            }\n\n            // middle button\n            if (button === 1) {\n                return EManipMode.Dolly;\n            }\n        }\n        else if (event.source === \"touch\") {\n            const count = event.pointerCount;\n\n            if (count === 1) {\n                return EManipMode.Orbit;\n            }\n\n            if (count === 2) {\n                return EManipMode.PanDolly;\n            }\n\n            return EManipMode.Pan;\n        }\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport math from \"@ff/core/math\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _halfPi = Math.PI * 0.5;\nconst _box = new THREE.Box3();\nconst _size = new THREE.Vector3();\nconst _center = new THREE.Vector3();\nconst _translation = new THREE.Vector3();\nconst _mat4a = new THREE.Matrix4();\nconst _mat4b = new THREE.Matrix4();\n\nconst _cameraOrientation = [\n    new THREE.Vector3(0, -_halfPi, 0), // left\n    new THREE.Vector3(0, _halfPi, 0),  // right\n    new THREE.Vector3(-_halfPi, 0, 0),  // top\n    new THREE.Vector3(_halfPi, 0, 0), // bottom\n    new THREE.Vector3(0, 0, 0),        // front\n    new THREE.Vector3(0, Math.PI, 0),  // back\n];\n\nexport enum EProjection { Perspective, Orthographic }\nexport enum EViewPreset { None = -1, Left = 0, Right, Top, Bottom, Front, Back }\n\nexport default class UniversalCamera extends THREE.Camera\n{\n    type: string;\n    isPerspectiveCamera: boolean;\n    isOrthographicCamera: boolean;\n    isUniversalCamera = true;\n\n    fov = 50;\n    size = 20;\n    aspect = 1;\n    distance = 20;\n    zoom = 1;\n    near = 0.1;\n    far = 2000;\n\n    // additional perspective parameters\n    focus = 10;\n    filmGauge = 35;\n    filmOffset = 0;\n\n    // view offset\n    view = null;\n\n    constructor(projection?: EProjection)\n    {\n        super();\n        this.setProjection(projection);\n    }\n\n    setProjection(type: EProjection)\n    {\n        if (type === EProjection.Orthographic) {\n            this.type = \"OrthographicCamera\";\n            this.isPerspectiveCamera = false;\n            this.isOrthographicCamera = true;\n        }\n        else {\n            this.type = \"PerspectiveCamera\";\n            this.isPerspectiveCamera = true;\n            this.isOrthographicCamera = false;\n        }\n\n        this.updateProjectionMatrix();\n    }\n\n    getProjection(): EProjection\n    {\n        return this.isOrthographicCamera ? EProjection.Orthographic : EProjection.Perspective;\n    }\n\n    setPreset(preset: EViewPreset)\n    {\n        if (preset !== EViewPreset.None) {\n            this.rotation.setFromVector3(_cameraOrientation[preset], \"XYZ\");\n            this.position.set(0, 0, this.distance).applyQuaternion(this.quaternion);\n        }\n        else {\n            this.rotation.set(0, 0, 0);\n            this.position.set(0, 0, 0);\n        }\n\n        this.updateMatrix();\n    }\n\n    setFocalLength(focalLength: number)\n    {\n        const vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\n        this.fov = THREE.Math.RAD2DEG * 2 * Math.atan(vExtentSlope);\n        this.updateProjectionMatrix();\n    }\n\n    getFocalLength()\n    {\n        const vExtentSlope = Math.tan(THREE.Math.DEG2RAD * 0.5 * this.fov);\n        return 0.5 * this.getFilmHeight() / vExtentSlope;\n    }\n\n    getEffectiveFOV()\n    {\n        return THREE.Math.RAD2DEG * 2 * Math.atan(\n            Math.tan(THREE.Math.DEG2RAD * 0.5 * this.fov) / this.zoom);\n    }\n\n    getFilmWidth()\n    {\n        return this.filmGauge * Math.min(this.aspect, 1);\n    }\n\n    getFilmHeight()\n    {\n        return this.filmGauge / Math.max(this.aspect, 1);\n    }\n\n    setViewOffset(viewportWidth: number, viewportHeight: number,\n                  windowX: number, windowY: number, windowWidth: number, windowHeight: number)\n    {\n        if (this.isPerspectiveCamera) {\n            THREE.PerspectiveCamera.prototype.setViewOffset.call(\n                this, viewportWidth, viewportHeight, windowX, windowY, windowWidth, windowHeight);\n        }\n        else {\n            THREE.OrthographicCamera.prototype.setViewOffset.call(\n                this, viewportWidth, viewportHeight, windowX, windowY, windowWidth, windowHeight);\n        }\n    }\n\n    clearViewOffset()\n    {\n        if (this.view !== null) {\n            this.view.enabled = false;\n        }\n\n        this.updateProjectionMatrix();\n    }\n\n    zoomToView()\n    {\n        // TODO: Implement\n    }\n\n    moveToView(boundingBox: THREE.Box3)\n    {\n        this.updateMatrixWorld(false);\n        _box.copy(boundingBox);\n        _mat4a.extractRotation(this.matrixWorldInverse);\n        _box.applyMatrix4(_mat4a);\n        _box.getSize(_size);\n        _box.getCenter(_center);\n\n        const objectSize = Math.max(_size.x / this.aspect, _size.y);\n        _translation.set(-_center.x, -_center.y, 0);\n\n        if (this.isPerspectiveCamera) {\n            _translation.z = _size.z / (2 * Math.tan(this.fov * math.DEG2RAD * 0.5));\n        }\n        else {\n            this.size = objectSize * 0.5;\n            _translation.z = _size.z * 2;\n            this.far = Math.max(this.far, _translation.z * 2);\n        }\n\n        _mat4a.extractRotation(this.matrixWorld);\n        _translation.applyMatrix4(_mat4a);\n\n        this.matrix.decompose(this.position, this.quaternion, this.scale);\n        this.position.copy(_translation);\n        this.updateMatrix();\n    }\n\n    updateProjectionMatrix()\n    {\n        const near = this.near;\n        const far = this.far;\n        const aspect = this.aspect;\n        const zoom = this.zoom;\n        const view = this.view;\n\n        if (this.isOrthographicCamera) {\n            const size = this.size;\n\n            const dy = size / (2 * zoom);\n            const dx = dy * aspect;\n\n            let left = -dx;\n            let right = dx;\n            let top = dy;\n            let bottom = -dy;\n\n            if (view && view.enabled) {\n                const zoomW = zoom / (view.width / view.fullWidth);\n                const zoomH = zoom / (view.height / view.fullHeight);\n                const scaleW = size * aspect / view.width;\n                const scaleH = size / view.height;\n\n                left += scaleW * (view.offsetX / zoomW);\n                right = left + scaleW * (view.width / zoomW);\n                top -= scaleH * (view.offsetY / zoomH);\n                bottom = top - scaleH * (view.height / zoomH);\n\n            }\n\n            this.projectionMatrix.makeOrthographic(left, right, top, bottom, near, far);\n        }\n        else {\n            let top = near * Math.tan(THREE.Math.DEG2RAD * 0.5 * this.fov) / zoom;\n            let height = 2 * top;\n            let width = aspect * height;\n            let left = -0.5 * width;\n\n            if (view && view.enabled) {\n                left += view.offsetX * width / view.fullWidth;\n                top -= view.offsetY * height / view.fullHeight;\n                width *= view.width / view.fullWidth;\n                height *= view.height / view.fullHeight;\n            }\n\n            var skew = this.filmOffset;\n            if (skew !== 0) {\n                left += near * skew / this.getFilmWidth();\n            }\n\n            this.projectionMatrix.makePerspective(left, left + width, top, top - height, near, far);\n        }\n\n        (this as any).projectionMatrixInverse.getInverse(this.projectionMatrix);\n    }\n\n    copy(source: this, recursive: boolean)\n    {\n        super.copy(source, recursive);\n\n        this.type = source.type;\n        this.isOrthographicCamera = source.isOrthographicCamera;\n        this.isPerspectiveCamera = source.isPerspectiveCamera;\n\n        this.fov = source.fov;\n        this.size = source.size;\n        this.aspect = source.aspect;\n        this.zoom = source.zoom;\n        this.near = source.near;\n        this.far = source.far;\n\n        this.focus = source.focus;\n        this.filmGauge = source.filmGauge;\n        this.filmOffset = source.filmOffset;\n\n        this.view = source.view ? Object.assign({}, source.view) : null;\n\n        return this;\n    }\n\n    clone(): this\n    {\n        return new (this.constructor as any)().copy(this);\n    }\n\n    toJSON(meta)\n    {\n        const data = super.toJSON(meta);\n\n        data.object.fov = this.fov;\n        data.object.size = this.size;\n        data.object.aspect = this.aspect;\n        data.object.zoom = this.zoom;\n        data.object.near = this.near;\n        data.object.far = this.far;\n\n        data.object.focus = this.focus;\n        data.object.filmGauge = this.filmGauge;\n        data.object.filmOffset = this.filmOffset;\n\n        if (this.view !== null) {\n            data.object.view = Object.assign({}, this.view);\n        }\n\n        return data;\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\nimport Publisher, { ITypedEvent } from \"@ff/core/Publisher\";\n\nimport {\n    IBaseEvent as IManipBaseEvent,\n    IPointerEvent as IManipPointerEvent,\n    ITriggerEvent as IManipTriggerEvent\n} from \"@ff/browser/ManipTarget\";\n\nimport UniversalCamera, {\n    EProjection,\n    EViewPreset\n} from \"./UniversalCamera\";\n\nimport OrbitManipulator from \"./OrbitManipulator\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport interface IBaseEvent extends IManipBaseEvent\n{\n    viewport: Viewport | null;\n    deviceX: number;\n    deviceY: number;\n}\n\nexport interface IPointerEvent extends IManipPointerEvent, IBaseEvent { }\nexport interface ITriggerEvent extends IManipTriggerEvent, IBaseEvent { }\n\nexport interface IViewportManip\n{\n    onPointer: (event: IPointerEvent) => boolean;\n    onTrigger: (event: ITriggerEvent) => boolean;\n}\n\nexport interface IViewportRect\n{\n    left: number;\n    top: number;\n    width: number;\n    height: number;\n}\n\nexport interface IViewportDisposeEvent extends ITypedEvent<\"dispose\">\n{\n    viewport: Viewport;\n}\n\nexport default class Viewport extends Publisher implements IViewportManip\n{\n    next: IViewportManip = null;\n\n    private _relRect: IViewportRect;\n    private _absRect: IViewportRect;\n\n    private _canvasWidth: number;\n    private _canvasHeight: number;\n\n    private _sceneCamera: THREE.Camera;\n    private _vpCamera: UniversalCamera;\n    private _manip: OrbitManipulator;\n\n    constructor(left?: number, top?: number, width?: number, height?: number)\n    {\n        super();\n        this.addEvent(\"dispose\");\n\n        this.next = null;\n\n        this._relRect = {\n            left: left || 0,\n            top: top || 0,\n            width: width || 1,\n            height: height || 1\n        };\n\n        this._absRect = {\n            left: 0,\n            top: 0,\n            width: 1,\n            height: 1\n        };\n\n        this._canvasWidth = 1;\n        this._canvasHeight = 1;\n\n        this._sceneCamera = null;\n        this._vpCamera = null;\n        this._manip = null;\n    }\n\n    get left() {\n        return this._absRect.left;\n    }\n\n    get top() {\n        return this._absRect.top;\n    }\n\n    get width() {\n        return this._absRect.width;\n    }\n\n    get height() {\n        return this._absRect.height;\n    }\n\n    get canvasWidth() {\n        return this._canvasWidth;\n    }\n\n    get canvasHeight() {\n        return this._canvasHeight;\n    }\n\n    get camera() {\n        return this._vpCamera || this._sceneCamera;\n    }\n\n    get sceneCamera() {\n        return this._sceneCamera;\n    }\n\n    get viewportCamera(): UniversalCamera {\n        return this._vpCamera;\n    }\n\n    get manip() {\n        return this._manip;\n    }\n\n    dispose()\n    {\n        console.log(\"Viewport.dispose - \" + this.toString());\n        this.emit<IViewportDisposeEvent>({ type: \"dispose\", viewport: this });\n    }\n\n    setSize(left?: number, top?: number, width?: number, height?: number)\n    {\n        const relRect = this._relRect;\n        relRect.left = left;\n        relRect.top = top;\n        relRect.width = width;\n        relRect.height = height;\n\n        this.updateViewport();\n    }\n\n    setCanvasSize(width: number, height: number)\n    {\n        this._canvasWidth = width;\n        this._canvasHeight = height;\n\n        this.updateViewport();\n\n        if (this._manip) {\n            this._manip.setViewportSize(width, height);\n        }\n    }\n\n    setBuiltInCamera(type: EProjection, preset?: EViewPreset)\n    {\n        if (!this._vpCamera) {\n            this._vpCamera = new UniversalCamera(type);\n            this._vpCamera.matrixAutoUpdate = false;\n        }\n        else {\n            this._vpCamera.setProjection(type);\n        }\n\n        if (preset !== undefined) {\n            this._vpCamera.setPreset(preset);\n        }\n    }\n\n    unsetBuiltInCamera()\n    {\n        this._vpCamera = null;\n    }\n\n    enableCameraManip(state: boolean): OrbitManipulator\n    {\n        if (!state && this._manip) {\n            this._manip = null;\n        }\n        else if (state && this._vpCamera) {\n            if (!this._manip) {\n                this._manip = new OrbitManipulator();\n                this._manip.setViewportSize(this.width, this.height);\n                this._manip.setFromCamera(this._vpCamera);\n            }\n        }\n\n        return this._manip;\n    }\n\n    moveCameraToView(box: THREE.Box3)\n    {\n        const camera = this.viewportCamera;\n        const manip = this._manip;\n\n        if (camera) {\n            camera.moveToView(box);\n            if (manip) {\n                manip.setFromCamera(camera, true);\n            }\n        }\n    }\n\n    isPointInside(x: number, y: number): boolean\n    {\n        const absRect = this._absRect;\n        return x >= absRect.left && x < absRect.left + absRect.width\n            && y >= absRect.top && y < absRect.top + absRect.height;\n    }\n\n    getDevicePoint(x: number, y: number, result?: THREE.Vector2): THREE.Vector2\n    {\n        const absRect = this._absRect;\n\n        const ndx = ((x - absRect.left) / absRect.width) * 2 - 1;\n        const ndy = 1 - ((y - absRect.top) / absRect.height) * 2;\n\n        return result ? result.set(ndx, ndy) : new THREE.Vector2(ndx, ndy);\n    }\n\n    getDeviceX(x: number): number\n    {\n        const absRect = this._absRect;\n        return ((x - absRect.left) / absRect.width) * 2 - 1;\n    }\n\n    getDeviceY(y: number): number\n    {\n        const absRect = this._absRect;\n        return 1 - ((y - absRect.top) / absRect.height) * 2;\n    }\n\n    updateCamera(sceneCamera?: THREE.Camera): THREE.Camera\n    {\n        let currentCamera: any = sceneCamera;\n\n        if (this._vpCamera) {\n            currentCamera = this._vpCamera;\n\n            if (this._manip) {\n                this._manip.update();\n                this._manip.toCamera(currentCamera);\n            }\n        }\n\n        if (!currentCamera) {\n            return;\n        }\n\n        const absRect = this._absRect;\n        const aspect = absRect.width / absRect.height;\n\n        if (aspect !== currentCamera.userData[\"aspect\"]) {\n            currentCamera.userData[\"aspect\"] = aspect;\n            if (currentCamera.isUniversalCamera || currentCamera.isPerspectiveCamera) {\n                currentCamera.aspect = aspect;\n                currentCamera.updateProjectionMatrix();\n            }\n            else if (currentCamera.isOrthographicCamera) {\n                const dy = (currentCamera.top - currentCamera.bottom) * 0.5;\n                currentCamera.left = -dy * aspect;\n                currentCamera.right = dy * aspect;\n                currentCamera.updateProjectionMatrix();\n            }\n        }\n\n        return currentCamera;\n    }\n\n    applyViewport(renderer: THREE.WebGLRenderer)\n    {\n        const absRect = this._absRect;\n        renderer.setViewport(absRect.left, absRect.top, absRect.width, absRect.height);\n        renderer[\"viewport\"] = this;\n    }\n\n    applyPickViewport(target: THREE.WebGLRenderTarget, event: IBaseEvent)\n    {\n        const absRect = this._absRect;\n        const left = event.localX - absRect.left;\n        const top = event.localY - absRect.top;\n        target.viewport.set(-left, -absRect.height + top, absRect.width, absRect.height);\n\n        //console.log(\"Viewport.applyPickViewport - offset: \", -left, -top);\n    }\n\n    toViewportEvent(event: IManipPointerEvent): IPointerEvent;\n    toViewportEvent(event: IManipTriggerEvent): ITriggerEvent;\n    toViewportEvent(event: IManipBaseEvent): IBaseEvent\n    {\n        const vpEvent = event as IBaseEvent;\n        vpEvent.viewport = this;\n        vpEvent.deviceX = this.getDeviceX(event.localX);\n        vpEvent.deviceY = this.getDeviceY(event.localY);\n        return vpEvent;\n    }\n\n    isInside(event: IBaseEvent): boolean\n    {\n        return this.isPointInside(event.localX, event.localY);\n    }\n\n    onPointer(event: IPointerEvent)\n    {\n        if (this._manip) {\n            return this._manip.onPointer(event);\n        }\n\n        return false;\n    }\n\n    onTrigger(event: ITriggerEvent)\n    {\n        if (this._manip) {\n            return this._manip.onTrigger(event);\n        }\n\n        return false;\n    }\n\n    toString()\n    {\n        return `Viewport (left: ${this.left}, top: ${this.top}, width: ${this.width}, height: ${this.height})`;\n    }\n\n    protected updateViewport()\n    {\n        const relRect = this._relRect;\n        const absRect = this._absRect;\n        const canvasWidth = this._canvasWidth;\n        const canvasHeight = this._canvasHeight;\n\n        absRect.left = Math.round(relRect.left * canvasWidth);\n        absRect.top = Math.round(relRect.top * canvasHeight);\n        absRect.width = Math.round(relRect.width * canvasWidth);\n        absRect.height = Math.round(relRect.height * canvasHeight);\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _vec3 = new THREE.Vector3();\nconst _mat4 = new THREE.Matrix4();\nconst _euler = new THREE.Euler();\nconst _quat = new THREE.Quaternion();\n\nexport type RotationOrder = \"XYZ\" | \"XZY\" | \"YXZ\" | \"YZX\" | \"ZXY\" | \"ZYX\";\n\nexport function degreesToQuaternion(rotation: number[], order: RotationOrder, quaternion?: THREE.Quaternion): THREE.Quaternion\n{\n    const result = quaternion || new THREE.Quaternion();\n\n    _vec3.fromArray(rotation).multiplyScalar(THREE.Math.DEG2RAD);\n    _euler.setFromVector3(_vec3, order);\n    result.setFromEuler(_euler, false);\n\n    return result;\n}\n\nexport function quaternionToDegrees(quaternion: THREE.Quaternion, order: string, rotation?: number[]): number[]\n{\n    const result = rotation || [ 0, 0, 0 ];\n\n    _euler.setFromQuaternion(quaternion, order, false);\n    _euler.toVector3(_vec3);\n    _vec3.multiplyScalar(THREE.Math.RAD2DEG).toArray(result);\n\n    return result;\n}\n\nexport function disposeObject(object: THREE.Object3D)\n{\n    const geometries = new Map<string, THREE.BufferGeometry>();\n    const materials = new Map<string, THREE.Material>();\n    const textures = new Map<string, THREE.Texture>();\n\n    object.traverse(object => {\n        const mesh = object as THREE.Mesh;\n        if (mesh.isMesh) {\n            const geometry = mesh.geometry as THREE.BufferGeometry;\n            if (geometry) {\n                geometries.set(geometry.uuid, geometry);\n            }\n            const material = mesh.material as THREE.Material;\n            if (material) {\n                materials.set(material.uuid, material);\n                for (let key in material) {\n                    const texture = material[key] as any; // THREE.Texture;\n                    if (texture && texture.isTexture) {\n                        textures.set(texture.uuid, texture);\n                    }\n                }\n\n            }\n        }\n    });\n\n    for (let entry of textures) {\n        entry[1].dispose();\n    }\n    for (let entry of materials) {\n        entry[1].dispose();\n    }\n    for (let entry of geometries) {\n        entry[1].dispose();\n    }\n}\n\n/**\n * Computes the bounding box of the given object, relative to the given root (same as object if\n * not specified explicitly). Accounts for the transforms of all children relative to the root.\n * Caller is responsible for emptying the given bounding box, and for updating the matrices of\n * all child objects.\n * @param object\n * @param box The box to be updated.\n * @param root\n */\nexport function computeLocalBoundingBox(object: THREE.Object3D, box: THREE.Box3, root?: THREE.Object3D)\n{\n    if (!root) {\n        root = object;\n    }\n\n    const geometry = (object as any).geometry;\n    if (geometry && object.visible) {\n\n        let current = object;\n        _mat4.identity();\n\n        while(current && current !== root) {\n            _mat4.premultiply(current.matrix);\n            current = current.parent;\n        }\n\n        if (geometry.isGeometry) {\n            const vertices = geometry.vertices;\n            for (let i = 0, n = vertices.length; i < n; ++i) {\n                _vec3.copy(vertices[i]).applyMatrix4(_mat4);\n                box.expandByPoint(_vec3);\n            }\n        }\n        else if (geometry.isBufferGeometry) {\n            const attribute = geometry.attributes.position;\n            if (attribute !== undefined) {\n                for (let i = 0, n = attribute.count; i < n; ++i) {\n                    _vec3.fromBufferAttribute(attribute, i).applyMatrix4(_mat4);\n                    box.expandByPoint(_vec3);\n                }\n            }\n        }\n    }\n\n    const children = object.children;\n    for (let i = 0, n = children.length; i < n; ++i) {\n        computeLocalBoundingBox(children[i], box, root);\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\nimport baseMath from \"@ff/core/math\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _vec4a = new THREE.Vector4();\nconst _vec4b = new THREE.Vector4();\nconst _vec3a = new THREE.Vector3();\nconst _vec3b = new THREE.Vector3();\nconst _mat4 = new THREE.Matrix4();\nconst _euler = new THREE.Euler();\nconst _quat = new THREE.Quaternion();\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport type Matrix4 = Float32Array | number[];\n\nconst math = {\n    PI: 3.1415926535897932384626433832795,\n    DOUBLE_PI: 6.283185307179586476925286766559,\n    HALF_PI: 1.5707963267948966192313216916398,\n    QUARTER_PI: 0.78539816339744830961566084581988,\n    DEG2RAD: 0.01745329251994329576923690768489,\n    RAD2DEG: 57.295779513082320876798154814105,\n\n    composeOrbitMatrix: function(orientation: THREE.Vector3, offset: THREE.Vector3, result?: THREE.Matrix4): THREE.Matrix4\n    {\n        const pitch = orientation.x;\n        const head = orientation.y;\n        const roll = orientation.z;\n\n        const ox = offset.x;\n        const oy = offset.y;\n        const oz = offset.z;\n\n        const sinX = Math.sin(pitch);\n        const cosX = Math.cos(pitch);\n        const sinY = Math.sin(head);\n        const cosY = Math.cos(head);\n        const sinZ = Math.sin(roll);\n        const cosZ = Math.cos(roll);\n\n        const m00 = cosY * cosZ;\n        const m01 = cosZ * sinY * sinX - sinZ * cosX;\n        const m02 = cosZ * sinY * cosX + sinZ * sinX;\n        const m10 = cosY * sinZ;\n        const m11 = sinX * sinY * sinZ + cosZ * cosX;\n        const m12 = sinZ * sinY * cosX - cosZ * sinX;\n        const m20 = -sinY;\n        const m21 = cosY * sinX;\n        const m22 = cosY * cosX;\n\n        result = result || new THREE.Matrix4();\n        const e = result.elements;\n\n        e[0] = m00;\n        e[1] = m10;\n        e[2] = m20;\n        e[3] = 0;\n        e[4] = m01;\n        e[5] = m11;\n        e[6] = m21;\n        e[7] = 0;\n        e[8] = m02;\n        e[9] = m12;\n        e[10] = m22;\n        e[11] = 0;\n\n        e[12] = ox * m00 + oy * m01 + oz * m02;\n        e[13] = ox * m10 + oy * m11 + oz * m12;\n        e[14] = ox * m20 + oy * m21 + oz * m22;\n        e[15] = 1;\n\n        return result;\n    },\n\n    decomposeOrbitMatrix: function(matrix: THREE.Matrix4, orientationOut: THREE.Vector3, offsetOut: THREE.Vector3)\n    {\n        _euler.setFromRotationMatrix(matrix, \"ZYX\");\n        _euler.toVector3(orientationOut);\n\n        _mat4.getInverse(matrix);\n        _vec4a.set(0, 0, 0, 1);\n        _vec4a.applyMatrix4(_mat4);\n\n        offsetOut.x = -_vec4a.x;\n        offsetOut.y = -_vec4a.y;\n        offsetOut.z = -_vec4a.z;\n    },\n\n    isMatrix4Identity: function(matrix: THREE.Matrix4)\n    {\n        const e = matrix.elements;\n        return e[0]  === 1 && e[1]  === 0 && e[2]  === 0 && e[3]  === 0\n            && e[4]  === 0 && e[5]  === 1 && e[6]  === 0 && e[7]  === 0\n            && e[8]  === 0 && e[9]  === 0 && e[10] === 1 && e[11] === 0\n            && e[12] === 0 && e[13] === 0 && e[14] === 0 && e[15] === 1;\n    },\n\n    decomposeTransformMatrix: function(matrix: number[], posOut: number[], rotOut: number[], scaleOut: number[])\n    {\n        _mat4.fromArray(matrix);\n        _mat4.decompose(_vec3a, _quat, _vec3b);\n        _euler.setFromQuaternion(_quat, \"XYZ\");\n        _vec3a.toArray(posOut);\n        _vec3b.toArray(scaleOut);\n        _euler.toVector3(_vec3a);\n        _vec4a.multiplyScalar(baseMath.RAD2DEG);\n        _vec3a.toArray(rotOut);\n    }\n};\n\nexport default math;\n","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class IndexShader extends THREE.ShaderMaterial\n{\n    static indexFromPixel(pixel: Uint8Array)\n    {\n        return pixel[0] + pixel[1] << 8 + pixel[2] << 16;\n    }\n\n    static zoneFromPixel(pixel: Uint8Array)\n    {\n        return pixel[3];\n    }\n\n    isIndexShader = true;\n    uniformsNeedUpdate = false;\n\n    lights = false;\n\n    setIndex(index: number)\n    {\n        const hb = index >> 16;\n        const mb = (index >> 8) - (hb << 8);\n        const lb = index - (hb << 16) - (mb << 8);\n\n        const value = this.uniforms.index.value;\n        value[0] = lb / 255;\n        value[1] = mb / 255;\n        value[2] = hb / 255;\n\n        this.uniformsNeedUpdate = true;\n    }\n\n    uniforms = {\n        index: { value: [ 0, 0, 0 ] }\n    };\n\n    vertexShader = [\n        \"void main() {\",\n        \"  #include <begin_vertex>\",\n        \"  #include <project_vertex>\",\n        \"}\",\n    ].join(\"\\n\");\n\n    fragmentShader = [\n        \"uniform vec3 index;\",\n\n        \"void main() {\",\n        \"  gl_FragColor = vec4(index, 1.0);\",\n        \"}\"\n    ].join(\"\\n\");\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class NormalShader extends THREE.ShaderMaterial\n{\n    isNormalShader = true;\n\n    uniforms = {\n        index: { value: 0 }\n    };\n\n    vertexShader = [\n        \"varying vec3 vLocalNormal;\",\n\n        \"void main() {\",\n        \"  #include <beginnormal_vertex>\",\n        \"  #include <begin_vertex>\",\n        \"  #include <project_vertex>\",\n        \"  vLocalNormal = vec3(normal);\",\n        \"}\",\n    ].join(\"\\n\");\n\n    fragmentShader = [\n        \"uniform vec3 index;\",\n        \"varying vec3 vLocalNormal;\",\n\n        \"void main() {\",\n        \"  vec3 normal = normalize(vLocalNormal);\",\n        \"  gl_FragColor = vec4(normal * 0.5 + 0.5, 1.0);\",\n        \"}\"\n    ].join(\"\\n\");\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport * as THREE from \"three\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class PositionShader extends THREE.ShaderMaterial\n{\n    isPositionShader = true;\n\n    uniforms = {\n        index: { value: 0 },\n        range: { value: [ -1, 1 ]}\n    };\n\n    vertexShader = [\n        \"varying vec3 vLocalPosition;\",\n\n        \"void main() {\",\n        \"  #include <begin_vertex>\",\n        \"  #include <project_vertex>\",\n        \"  vLocalPosition = vec3(position);\",\n        \"}\",\n    ].join(\"\\n\");\n\n    fragmentShader = [\n        \"uniform float index;\",\n        \"uniform float range;\",\n        \"varying vec3 vLocalPosition;\",\n\n        \"vec4 toVec4(float v) {\",\n        \"  float vn = (v - range.x) / (range.y - range.x);\",\n        \"  float b0 = floor(vn * 255.0) / 255.0; vn = (vn - b0) * 256.0;\",\n        \"  float b1 = floor(vn * 255.0) / 255.0; vn = (vn - b1) * 256.0;\",\n        \"  float b2 = floor(vn * 255.0) / 255.0; vn = (vn - b2) * 256.0;\",\n        \"  float b3 = floor(vn * 255.0) / 255.0;\",\n        \"  return vec4(clamp(b0, 0.0, 1.0), clamp(b1, 0.0, 1.0), clamp(b2, 0.0, 1.0), clamp(b3, 0.0, 1.0));\",\n        \"}\",\n\n        \"void main() {\",\n        \"  gl_FragColor = (index == 0.0 ? toVec4(vLocalPosition.x)\",\n        \"    : (index == 1.0 ? toVec4(vLocalPosition.y) : toVec4(vLocalPosition.z)));\",\n        \"  }\"\n    ].join(\"\\n\");\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport { TypeOf, Dictionary } from \"@ff/core/types\";\nimport { LitElement } from \"lit-element\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { property, PropertyValues } from \"lit-element\";\nexport { html, svg, render, TemplateResult } from \"lit-html\";\nexport { repeat } from \"lit-html/directives/repeat\";\n\n@customElement(\"ff-custom-element\")\nexport default class CustomElement extends LitElement\n{\n    static readonly tagName: string = \"ff-custom-element\";\n    static readonly shady: boolean = false;\n\n    private _isFirstConnected = false;\n\n    static setStyle(element: HTMLElement, style: Partial<CSSStyleDeclaration>)\n    {\n        Object.assign(element.style, style);\n    }\n\n    static setAttribs(element: HTMLElement, attribs: Dictionary<string>)\n    {\n        for (let name in attribs) {\n            element.setAttribute(name, attribs[name]);\n        }\n    }\n\n    get shady()\n    {\n        return (this.constructor as typeof CustomElement).shady;\n    }\n\n    appendTo(parent: Element): this\n    {\n        parent.appendChild(this);\n        return this;\n    }\n\n    removeChildren()\n    {\n        while(this.firstChild) {\n            this.removeChild(this.firstChild);\n        }\n    }\n\n    getChildrenArray()\n    {\n        return Array.from(this.children);\n    }\n\n    appendElement<T extends HTMLElement>(\n        type: TypeOf<T> | T, style?: Partial<CSSStyleDeclaration>): T;\n\n    appendElement<K extends keyof HTMLElementTagNameMap>(\n        tagName: K, style?: Partial<CSSStyleDeclaration>): HTMLElementTagNameMap[K];\n\n    appendElement(tagOrType, style)\n    {\n        return this.createElement(tagOrType, style, this);\n    }\n\n    createElement<T extends HTMLElement>(\n        type: TypeOf<T> | T, style?: Partial<CSSStyleDeclaration>, parent?: Element): T;\n\n    createElement<K extends keyof HTMLElementTagNameMap>(\n        tagName: K, style?: Partial<CSSStyleDeclaration>, parent?: Element): HTMLElementTagNameMap[K];\n\n    createElement(tagOrType, style, parent)\n    {\n        let element;\n\n        if (typeof tagOrType === \"string\") {\n            element = document.createElement(tagOrType);\n        }\n        else if (tagOrType instanceof HTMLElement) {\n            element = tagOrType;\n        }\n        else {\n            element = new tagOrType();\n        }\n\n        if (style) {\n            Object.assign(element.style, style);\n        }\n        if (parent) {\n            parent.appendChild(element);\n        }\n\n        return element;\n    }\n\n    setStyle(style: Partial<CSSStyleDeclaration>): this\n    {\n        CustomElement.setStyle(this, style);\n        return this;\n    }\n\n    setAttribute(name: string, value: string)\n    {\n        super.setAttribute(name, value);\n        return this;\n    }\n\n    setAttributes(attribs: Dictionary<string>): this\n    {\n        CustomElement.setAttribs(this, attribs);\n        return this;\n    }\n\n    addClass(...classes: string[]): this\n    {\n        classes.forEach(klass => this.classList.add(klass));\n        return this;\n    }\n\n    removeClass(...classes: string[]): this\n    {\n        classes.forEach(klass => this.classList.remove(klass));\n        return this;\n    }\n\n    setClass(name: string, state: boolean): this\n    {\n        if (state) {\n            this.classList.add(name);\n        }\n        else {\n            this.classList.remove(name);\n        }\n\n        return this;\n    }\n\n    hasFocus()\n    {\n        return document.activeElement === this;\n    }\n\n    on<T extends Event>(type: string, listener: (event: T) => any, options?: boolean | AddEventListenerOptions)\n    {\n        this.addEventListener(type, listener, options);\n        return this;\n    }\n\n    off<T extends Event>(type: string, listener: (event: T) => any, options?: boolean | AddEventListenerOptions)\n    {\n        this.removeEventListener(type, listener, options);\n        return this;\n    }\n\n    connectedCallback()\n    {\n        if (!this._isFirstConnected) {\n            this._isFirstConnected = true;\n            this.firstConnected();\n        }\n\n        this.connected();\n\n        super.connectedCallback();\n    }\n\n    disconnectedCallback()\n    {\n        super.disconnectedCallback();\n        this.disconnected();\n    }\n\n    protected createRenderRoot()\n    {\n        return this.shady ? super.createRenderRoot() : this;\n    }\n\n    protected firstConnected()\n    {\n    }\n\n    protected connected()\n    {\n    }\n\n    protected disconnected()\n    {\n    }\n}\n\nexport function customElement<T extends CustomElement>(tagName?: string)\n{\n    return <T extends CustomElement>(constructor: TypeOf<T>) => {\n        (constructor as any).tagName = tagName;\n        customElements.define((constructor as any).tagName, constructor);\n        return constructor as any;\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport \"./Splitter\";\nimport { ISplitterChangeEvent } from \"./Splitter\";\nimport CustomElement, { customElement, html, property } from \"./CustomElement\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport enum EQuadViewLayout { Single, HorizontalSplit, VerticalSplit, Quad }\n\n\nexport interface IQuadSplitterChangeMessage\n{\n    layout: EQuadViewLayout;\n    horizontalSplit: number;\n    verticalSplit: number;\n    isDragging: boolean;\n}\n\n@customElement(\"ff-quad-splitter\")\nexport default class QuadSplitter extends CustomElement\n{\n    @property({ attribute: false })\n    layout: EQuadViewLayout = EQuadViewLayout.Single;\n\n    @property({ attribute: false })\n    horizontalPosition = 0.5;\n\n    @property({ attribute: false })\n    verticalPosition = 0.5;\n\n    onChange: (message: IQuadSplitterChangeMessage) => void;\n\n    protected render()\n    {\n        const layout = this.layout;\n\n        if (layout === EQuadViewLayout.Single) {\n            return html``;\n        }\n\n        const elements = [];\n\n        if (layout === EQuadViewLayout.HorizontalSplit || layout === EQuadViewLayout.Quad) {\n            elements.push(html`\n                <div class=\"ff-horizontal\" style=\"position:absolute; top:0; bottom:0; left:0; right:0; display:flex;\">\n                    <div class=\"ff-left\" style=\"flex:1 1;\"></div>\n                    <ff-splitter direction=\"horizontal\" position=${this.horizontalPosition} @ff-splitter-change=${this.onSplitterChange}></ff-splitter>\n                    <div style=\"flex:1 1;\"></div>\n                </div>\n            `);\n        }\n\n        if (layout === EQuadViewLayout.VerticalSplit || layout === EQuadViewLayout.Quad) {\n            elements.push(html`\n                <div class=\"ff-vertical\" style=\"position:absolute; top:0; bottom:0; left:0; right:0; display:flex; flex-direction: column\">\n                    <div class=\"ff-top\" style=\"flex:1 1;\"></div>\n                    <ff-splitter direction=\"vertical\" position=${this.verticalPosition} @ff-splitter-change=${this.onSplitterChange}></ff-splitter>\n                    <div style=\"flex:1 1;\"></div>\n                </div>\n            `);\n        }\n\n        return html`${elements}`;\n    }\n\n    protected onSplitterChange(event: ISplitterChangeEvent)\n    {\n        if (event.detail.direction === \"horizontal\") {\n            this.horizontalPosition = event.detail.position;\n        }\n        else {\n            this.verticalPosition = event.detail.position;\n        }\n\n        if (this.onChange) {\n            this.onChange({\n                layout: this.layout,\n                horizontalSplit: this.horizontalPosition,\n                verticalSplit: this.verticalPosition,\n                isDragging: event.detail.isDragging\n            });\n        }\n    }\n}","/**\n * FF Typescript Foundation Library\n * Copyright 2018 Ralph Wiedemeier, Frame Factory GmbH\n *\n * License: MIT\n */\n\nimport CustomElement, { customElement, property } from \"./CustomElement\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport interface ISplitterChangeEvent extends CustomEvent\n{\n    target: Splitter;\n\n    detail: {\n        direction: SplitterDirection;\n        position: number;\n        isDragging: boolean;\n    }\n}\n\nexport type SplitterDirection = \"horizontal\" | \"vertical\";\n\n@customElement(\"ff-splitter\")\nexport default class Splitter extends CustomElement\n{\n    static readonly changeEvent: string = \"ff-splitter-change\";\n\n    @property({ type: String })\n    direction: SplitterDirection = \"horizontal\";\n\n    @property({ type: Number })\n    width = 5;\n\n    @property({ type: Number })\n    margin = 20;\n\n    @property({ type: Boolean })\n    detached = false;\n\n    protected _isActive = false;\n    protected _offset = 0;\n    protected _position = 0;\n\n    constructor()\n    {\n        super();\n\n        this.addEventListener(\"pointerdown\", (e) => this.onPointerDown(e));\n        this.addEventListener(\"pointermove\", (e) => this.onPointerMove(e));\n        this.addEventListener(\"pointerup\", (e) => this.onPointerUpOrCancel(e));\n        this.addEventListener(\"pointercancel\", (e) => this.onPointerUpOrCancel(e));\n    }\n\n    get position()\n    {\n        return this._position;\n    }\n\n    isHorizontal()\n    {\n        return this.direction === \"horizontal\";\n    }\n\n    protected update(changedProperties)\n    {\n        super.update(changedProperties);\n\n        const isHorizontal = this.isHorizontal();\n        const width = this.width;\n\n        this.setStyle({\n            padding: isHorizontal ? `0 ${width}px` : `${width}px 0`,\n            margin: isHorizontal ? `0 ${-width}px` : `${-width}px 0`,\n            cursor: isHorizontal ? \"col-resize\" : \"row-resize\"\n        });\n    }\n\n    protected firstUpdated()\n    {\n        this.setAttribute(\"touch-action\", \"none\");\n\n        this.setStyle({\n            position: \"relative\",\n            display: \"block\",\n            zIndex: \"1\",\n            touchAction: \"none\"\n        });\n    }\n\n    protected onPointerDown(event: PointerEvent)\n    {\n        if (event.isPrimary) {\n            event.stopPropagation();\n            event.preventDefault();\n\n            this._isActive = true;\n\n            this.setPointerCapture(event.pointerId);\n            const rect = this.getBoundingClientRect();\n            this._offset = this.isHorizontal()\n                ? rect.left + rect.width * 0.5 - event.clientX\n                : rect.top + rect.height * 0.5 - event.clientY;\n        }\n    }\n\n    protected onPointerMove(event: PointerEvent)\n    {\n        if (event.isPrimary && this._isActive) {\n            event.stopPropagation();\n            event.preventDefault();\n\n            const parent = this.parentElement;\n            if (!parent) {\n                return;\n            }\n\n            const rect = parent.getBoundingClientRect();\n\n            const isHorizontal = this.isHorizontal();\n\n            const parentSize = isHorizontal ? rect.width : rect.height;\n            let position = this._offset + (isHorizontal ? event.clientX - rect.left : event.clientY - rect.top);\n            let relativePosition = position / parentSize;\n\n            if (!this.detached) {\n                const prevElement = this.previousElementSibling;\n                const nextElement = this.nextElementSibling;\n\n                if (prevElement instanceof HTMLElement && nextElement instanceof HTMLElement) {\n                    const children = Array.from(parent.children);\n                    let splitAreaStart = 0;\n                    let splitAreaSize = parentSize;\n                    let visited = false;\n\n                    children.forEach(child => {\n                        if (child instanceof Splitter) {\n                            return;\n                        }\n\n                        if (child === prevElement || child === nextElement) {\n                            visited = true;\n                            return;\n                        }\n\n                        const childRect = child.getBoundingClientRect();\n                        const childSize = isHorizontal ? childRect.width : childRect.height;\n                        splitAreaSize -= childSize;\n\n                        if (!visited) {\n                            splitAreaStart += childSize;\n                        }\n                    });\n\n                    const minSize = this.margin;\n                    const maxSize = splitAreaSize - minSize;\n\n                    position = (position - splitAreaStart);\n                    position = position < minSize ? minSize : (position > maxSize ? maxSize : position);\n\n                    const nextSize = (splitAreaSize - position) / parentSize;\n                    relativePosition = position / parentSize;\n\n                    prevElement.style.flexBasis = (relativePosition * 100).toFixed(3) + \"%\";\n                    nextElement.style.flexBasis = (nextSize * 100).toFixed(3) + \"%\";\n\n                    // send global resize event so components can adjust to new size\n                    setTimeout(() => window.dispatchEvent(new CustomEvent(\"resize\")), 0);\n                }\n            }\n\n            this._position = relativePosition;\n\n            this.dispatchEvent(new CustomEvent(Splitter.changeEvent, {\n                detail: {\n                    direction: this.direction,\n                    position: this._position,\n                    isDragging: true\n                }\n            }) as ISplitterChangeEvent);\n        }\n    }\n\n    protected onPointerUpOrCancel(event: PointerEvent)\n    {\n        if (event.isPrimary) {\n            event.stopPropagation();\n            event.preventDefault();\n\n            this._isActive = false;\n\n            this.dispatchEvent(new CustomEvent(Splitter.changeEvent, {\n                detail: {\n                    direction: this.direction,\n                    position: this._position,\n                    isDragging: false\n                }\n            }) as ISplitterChangeEvent);\n        }\n    }\n}","'use strict';\n\nvar compileSchema = require('./compile')\n  , resolve = require('./compile/resolve')\n  , Cache = require('./cache')\n  , SchemaObject = require('./compile/schema_obj')\n  , stableStringify = require('fast-json-stable-stringify')\n  , formats = require('./compile/formats')\n  , rules = require('./compile/rules')\n  , $dataMetaSchema = require('./data')\n  , util = require('./compile/util');\n\nmodule.exports = Ajv;\n\nAjv.prototype.validate = validate;\nAjv.prototype.compile = compile;\nAjv.prototype.addSchema = addSchema;\nAjv.prototype.addMetaSchema = addMetaSchema;\nAjv.prototype.validateSchema = validateSchema;\nAjv.prototype.getSchema = getSchema;\nAjv.prototype.removeSchema = removeSchema;\nAjv.prototype.addFormat = addFormat;\nAjv.prototype.errorsText = errorsText;\n\nAjv.prototype._addSchema = _addSchema;\nAjv.prototype._compile = _compile;\n\nAjv.prototype.compileAsync = require('./compile/async');\nvar customKeyword = require('./keyword');\nAjv.prototype.addKeyword = customKeyword.add;\nAjv.prototype.getKeyword = customKeyword.get;\nAjv.prototype.removeKeyword = customKeyword.remove;\n\nvar errorClasses = require('./compile/error_classes');\nAjv.ValidationError = errorClasses.Validation;\nAjv.MissingRefError = errorClasses.MissingRef;\nAjv.$dataMetaSchema = $dataMetaSchema;\n\nvar META_SCHEMA_ID = 'http://json-schema.org/draft-07/schema';\n\nvar META_IGNORE_OPTIONS = [ 'removeAdditional', 'useDefaults', 'coerceTypes' ];\nvar META_SUPPORT_DATA = ['/properties'];\n\n/**\n * Creates validator instance.\n * Usage: `Ajv(opts)`\n * @param {Object} opts optional options\n * @return {Object} ajv instance\n */\nfunction Ajv(opts) {\n  if (!(this instanceof Ajv)) return new Ajv(opts);\n  opts = this._opts = util.copy(opts) || {};\n  setLogger(this);\n  this._schemas = {};\n  this._refs = {};\n  this._fragments = {};\n  this._formats = formats(opts.format);\n\n  this._cache = opts.cache || new Cache;\n  this._loadingSchemas = {};\n  this._compilations = [];\n  this.RULES = rules();\n  this._getId = chooseGetId(opts);\n\n  opts.loopRequired = opts.loopRequired || Infinity;\n  if (opts.errorDataPath == 'property') opts._errorDataPathProperty = true;\n  if (opts.serialize === undefined) opts.serialize = stableStringify;\n  this._metaOpts = getMetaSchemaOptions(this);\n\n  if (opts.formats) addInitialFormats(this);\n  addDefaultMetaSchema(this);\n  if (typeof opts.meta == 'object') this.addMetaSchema(opts.meta);\n  if (opts.nullable) this.addKeyword('nullable', {metaSchema: {const: true}});\n  addInitialSchemas(this);\n}\n\n\n\n/**\n * Validate data using schema\n * Schema will be compiled and cached (using serialized JSON as key. [fast-json-stable-stringify](https://github.com/epoberezkin/fast-json-stable-stringify) is used to serialize.\n * @this   Ajv\n * @param  {String|Object} schemaKeyRef key, ref or schema object\n * @param  {Any} data to be validated\n * @return {Boolean} validation result. Errors from the last validation will be available in `ajv.errors` (and also in compiled schema: `schema.errors`).\n */\nfunction validate(schemaKeyRef, data) {\n  var v;\n  if (typeof schemaKeyRef == 'string') {\n    v = this.getSchema(schemaKeyRef);\n    if (!v) throw new Error('no schema with key or ref \"' + schemaKeyRef + '\"');\n  } else {\n    var schemaObj = this._addSchema(schemaKeyRef);\n    v = schemaObj.validate || this._compile(schemaObj);\n  }\n\n  var valid = v(data);\n  if (v.$async !== true) this.errors = v.errors;\n  return valid;\n}\n\n\n/**\n * Create validating function for passed schema.\n * @this   Ajv\n * @param  {Object} schema schema object\n * @param  {Boolean} _meta true if schema is a meta-schema. Used internally to compile meta schemas of custom keywords.\n * @return {Function} validating function\n */\nfunction compile(schema, _meta) {\n  var schemaObj = this._addSchema(schema, undefined, _meta);\n  return schemaObj.validate || this._compile(schemaObj);\n}\n\n\n/**\n * Adds schema to the instance.\n * @this   Ajv\n * @param {Object|Array} schema schema or array of schemas. If array is passed, `key` and other parameters will be ignored.\n * @param {String} key Optional schema key. Can be passed to `validate` method instead of schema object or id/ref. One schema per instance can have empty `id` and `key`.\n * @param {Boolean} _skipValidation true to skip schema validation. Used internally, option validateSchema should be used instead.\n * @param {Boolean} _meta true if schema is a meta-schema. Used internally, addMetaSchema should be used instead.\n * @return {Ajv} this for method chaining\n */\nfunction addSchema(schema, key, _skipValidation, _meta) {\n  if (Array.isArray(schema)){\n    for (var i=0; i<schema.length; i++) this.addSchema(schema[i], undefined, _skipValidation, _meta);\n    return this;\n  }\n  var id = this._getId(schema);\n  if (id !== undefined && typeof id != 'string')\n    throw new Error('schema id must be string');\n  key = resolve.normalizeId(key || id);\n  checkUnique(this, key);\n  this._schemas[key] = this._addSchema(schema, _skipValidation, _meta, true);\n  return this;\n}\n\n\n/**\n * Add schema that will be used to validate other schemas\n * options in META_IGNORE_OPTIONS are alway set to false\n * @this   Ajv\n * @param {Object} schema schema object\n * @param {String} key optional schema key\n * @param {Boolean} skipValidation true to skip schema validation, can be used to override validateSchema option for meta-schema\n * @return {Ajv} this for method chaining\n */\nfunction addMetaSchema(schema, key, skipValidation) {\n  this.addSchema(schema, key, skipValidation, true);\n  return this;\n}\n\n\n/**\n * Validate schema\n * @this   Ajv\n * @param {Object} schema schema to validate\n * @param {Boolean} throwOrLogError pass true to throw (or log) an error if invalid\n * @return {Boolean} true if schema is valid\n */\nfunction validateSchema(schema, throwOrLogError) {\n  var $schema = schema.$schema;\n  if ($schema !== undefined && typeof $schema != 'string')\n    throw new Error('$schema must be a string');\n  $schema = $schema || this._opts.defaultMeta || defaultMeta(this);\n  if (!$schema) {\n    this.logger.warn('meta-schema not available');\n    this.errors = null;\n    return true;\n  }\n  var valid = this.validate($schema, schema);\n  if (!valid && throwOrLogError) {\n    var message = 'schema is invalid: ' + this.errorsText();\n    if (this._opts.validateSchema == 'log') this.logger.error(message);\n    else throw new Error(message);\n  }\n  return valid;\n}\n\n\nfunction defaultMeta(self) {\n  var meta = self._opts.meta;\n  self._opts.defaultMeta = typeof meta == 'object'\n                            ? self._getId(meta) || meta\n                            : self.getSchema(META_SCHEMA_ID)\n                              ? META_SCHEMA_ID\n                              : undefined;\n  return self._opts.defaultMeta;\n}\n\n\n/**\n * Get compiled schema from the instance by `key` or `ref`.\n * @this   Ajv\n * @param  {String} keyRef `key` that was passed to `addSchema` or full schema reference (`schema.id` or resolved id).\n * @return {Function} schema validating function (with property `schema`).\n */\nfunction getSchema(keyRef) {\n  var schemaObj = _getSchemaObj(this, keyRef);\n  switch (typeof schemaObj) {\n    case 'object': return schemaObj.validate || this._compile(schemaObj);\n    case 'string': return this.getSchema(schemaObj);\n    case 'undefined': return _getSchemaFragment(this, keyRef);\n  }\n}\n\n\nfunction _getSchemaFragment(self, ref) {\n  var res = resolve.schema.call(self, { schema: {} }, ref);\n  if (res) {\n    var schema = res.schema\n      , root = res.root\n      , baseId = res.baseId;\n    var v = compileSchema.call(self, schema, root, undefined, baseId);\n    self._fragments[ref] = new SchemaObject({\n      ref: ref,\n      fragment: true,\n      schema: schema,\n      root: root,\n      baseId: baseId,\n      validate: v\n    });\n    return v;\n  }\n}\n\n\nfunction _getSchemaObj(self, keyRef) {\n  keyRef = resolve.normalizeId(keyRef);\n  return self._schemas[keyRef] || self._refs[keyRef] || self._fragments[keyRef];\n}\n\n\n/**\n * Remove cached schema(s).\n * If no parameter is passed all schemas but meta-schemas are removed.\n * If RegExp is passed all schemas with key/id matching pattern but meta-schemas are removed.\n * Even if schema is referenced by other schemas it still can be removed as other schemas have local references.\n * @this   Ajv\n * @param  {String|Object|RegExp} schemaKeyRef key, ref, pattern to match key/ref or schema object\n * @return {Ajv} this for method chaining\n */\nfunction removeSchema(schemaKeyRef) {\n  if (schemaKeyRef instanceof RegExp) {\n    _removeAllSchemas(this, this._schemas, schemaKeyRef);\n    _removeAllSchemas(this, this._refs, schemaKeyRef);\n    return this;\n  }\n  switch (typeof schemaKeyRef) {\n    case 'undefined':\n      _removeAllSchemas(this, this._schemas);\n      _removeAllSchemas(this, this._refs);\n      this._cache.clear();\n      return this;\n    case 'string':\n      var schemaObj = _getSchemaObj(this, schemaKeyRef);\n      if (schemaObj) this._cache.del(schemaObj.cacheKey);\n      delete this._schemas[schemaKeyRef];\n      delete this._refs[schemaKeyRef];\n      return this;\n    case 'object':\n      var serialize = this._opts.serialize;\n      var cacheKey = serialize ? serialize(schemaKeyRef) : schemaKeyRef;\n      this._cache.del(cacheKey);\n      var id = this._getId(schemaKeyRef);\n      if (id) {\n        id = resolve.normalizeId(id);\n        delete this._schemas[id];\n        delete this._refs[id];\n      }\n  }\n  return this;\n}\n\n\nfunction _removeAllSchemas(self, schemas, regex) {\n  for (var keyRef in schemas) {\n    var schemaObj = schemas[keyRef];\n    if (!schemaObj.meta && (!regex || regex.test(keyRef))) {\n      self._cache.del(schemaObj.cacheKey);\n      delete schemas[keyRef];\n    }\n  }\n}\n\n\n/* @this   Ajv */\nfunction _addSchema(schema, skipValidation, meta, shouldAddSchema) {\n  if (typeof schema != 'object' && typeof schema != 'boolean')\n    throw new Error('schema should be object or boolean');\n  var serialize = this._opts.serialize;\n  var cacheKey = serialize ? serialize(schema) : schema;\n  var cached = this._cache.get(cacheKey);\n  if (cached) return cached;\n\n  shouldAddSchema = shouldAddSchema || this._opts.addUsedSchema !== false;\n\n  var id = resolve.normalizeId(this._getId(schema));\n  if (id && shouldAddSchema) checkUnique(this, id);\n\n  var willValidate = this._opts.validateSchema !== false && !skipValidation;\n  var recursiveMeta;\n  if (willValidate && !(recursiveMeta = id && id == resolve.normalizeId(schema.$schema)))\n    this.validateSchema(schema, true);\n\n  var localRefs = resolve.ids.call(this, schema);\n\n  var schemaObj = new SchemaObject({\n    id: id,\n    schema: schema,\n    localRefs: localRefs,\n    cacheKey: cacheKey,\n    meta: meta\n  });\n\n  if (id[0] != '#' && shouldAddSchema) this._refs[id] = schemaObj;\n  this._cache.put(cacheKey, schemaObj);\n\n  if (willValidate && recursiveMeta) this.validateSchema(schema, true);\n\n  return schemaObj;\n}\n\n\n/* @this   Ajv */\nfunction _compile(schemaObj, root) {\n  if (schemaObj.compiling) {\n    schemaObj.validate = callValidate;\n    callValidate.schema = schemaObj.schema;\n    callValidate.errors = null;\n    callValidate.root = root ? root : callValidate;\n    if (schemaObj.schema.$async === true)\n      callValidate.$async = true;\n    return callValidate;\n  }\n  schemaObj.compiling = true;\n\n  var currentOpts;\n  if (schemaObj.meta) {\n    currentOpts = this._opts;\n    this._opts = this._metaOpts;\n  }\n\n  var v;\n  try { v = compileSchema.call(this, schemaObj.schema, root, schemaObj.localRefs); }\n  catch(e) {\n    delete schemaObj.validate;\n    throw e;\n  }\n  finally {\n    schemaObj.compiling = false;\n    if (schemaObj.meta) this._opts = currentOpts;\n  }\n\n  schemaObj.validate = v;\n  schemaObj.refs = v.refs;\n  schemaObj.refVal = v.refVal;\n  schemaObj.root = v.root;\n  return v;\n\n\n  /* @this   {*} - custom context, see passContext option */\n  function callValidate() {\n    /* jshint validthis: true */\n    var _validate = schemaObj.validate;\n    var result = _validate.apply(this, arguments);\n    callValidate.errors = _validate.errors;\n    return result;\n  }\n}\n\n\nfunction chooseGetId(opts) {\n  switch (opts.schemaId) {\n    case 'auto': return _get$IdOrId;\n    case 'id': return _getId;\n    default: return _get$Id;\n  }\n}\n\n/* @this   Ajv */\nfunction _getId(schema) {\n  if (schema.$id) this.logger.warn('schema $id ignored', schema.$id);\n  return schema.id;\n}\n\n/* @this   Ajv */\nfunction _get$Id(schema) {\n  if (schema.id) this.logger.warn('schema id ignored', schema.id);\n  return schema.$id;\n}\n\n\nfunction _get$IdOrId(schema) {\n  if (schema.$id && schema.id && schema.$id != schema.id)\n    throw new Error('schema $id is different from id');\n  return schema.$id || schema.id;\n}\n\n\n/**\n * Convert array of error message objects to string\n * @this   Ajv\n * @param  {Array<Object>} errors optional array of validation errors, if not passed errors from the instance are used.\n * @param  {Object} options optional options with properties `separator` and `dataVar`.\n * @return {String} human readable string with all errors descriptions\n */\nfunction errorsText(errors, options) {\n  errors = errors || this.errors;\n  if (!errors) return 'No errors';\n  options = options || {};\n  var separator = options.separator === undefined ? ', ' : options.separator;\n  var dataVar = options.dataVar === undefined ? 'data' : options.dataVar;\n\n  var text = '';\n  for (var i=0; i<errors.length; i++) {\n    var e = errors[i];\n    if (e) text += dataVar + e.dataPath + ' ' + e.message + separator;\n  }\n  return text.slice(0, -separator.length);\n}\n\n\n/**\n * Add custom format\n * @this   Ajv\n * @param {String} name format name\n * @param {String|RegExp|Function} format string is converted to RegExp; function should return boolean (true when valid)\n * @return {Ajv} this for method chaining\n */\nfunction addFormat(name, format) {\n  if (typeof format == 'string') format = new RegExp(format);\n  this._formats[name] = format;\n  return this;\n}\n\n\nfunction addDefaultMetaSchema(self) {\n  var $dataSchema;\n  if (self._opts.$data) {\n    $dataSchema = require('./refs/data.json');\n    self.addMetaSchema($dataSchema, $dataSchema.$id, true);\n  }\n  if (self._opts.meta === false) return;\n  var metaSchema = require('./refs/json-schema-draft-07.json');\n  if (self._opts.$data) metaSchema = $dataMetaSchema(metaSchema, META_SUPPORT_DATA);\n  self.addMetaSchema(metaSchema, META_SCHEMA_ID, true);\n  self._refs['http://json-schema.org/schema'] = META_SCHEMA_ID;\n}\n\n\nfunction addInitialSchemas(self) {\n  var optsSchemas = self._opts.schemas;\n  if (!optsSchemas) return;\n  if (Array.isArray(optsSchemas)) self.addSchema(optsSchemas);\n  else for (var key in optsSchemas) self.addSchema(optsSchemas[key], key);\n}\n\n\nfunction addInitialFormats(self) {\n  for (var name in self._opts.formats) {\n    var format = self._opts.formats[name];\n    self.addFormat(name, format);\n  }\n}\n\n\nfunction checkUnique(self, id) {\n  if (self._schemas[id] || self._refs[id])\n    throw new Error('schema with key or id \"' + id + '\" already exists');\n}\n\n\nfunction getMetaSchemaOptions(self) {\n  var metaOpts = util.copy(self._opts);\n  for (var i=0; i<META_IGNORE_OPTIONS.length; i++)\n    delete metaOpts[META_IGNORE_OPTIONS[i]];\n  return metaOpts;\n}\n\n\nfunction setLogger(self) {\n  var logger = self._opts.logger;\n  if (logger === false) {\n    self.logger = {log: noop, warn: noop, error: noop};\n  } else {\n    if (logger === undefined) logger = console;\n    if (!(typeof logger == 'object' && logger.log && logger.warn && logger.error))\n      throw new Error('logger must implement log, warn and error methods');\n    self.logger = logger;\n  }\n}\n\n\nfunction noop() {}\n","'use strict';\n\n\nvar Cache = module.exports = function Cache() {\n  this._cache = {};\n};\n\n\nCache.prototype.put = function Cache_put(key, value) {\n  this._cache[key] = value;\n};\n\n\nCache.prototype.get = function Cache_get(key) {\n  return this._cache[key];\n};\n\n\nCache.prototype.del = function Cache_del(key) {\n  delete this._cache[key];\n};\n\n\nCache.prototype.clear = function Cache_clear() {\n  this._cache = {};\n};\n","'use strict';\n\nvar MissingRefError = require('./error_classes').MissingRef;\n\nmodule.exports = compileAsync;\n\n\n/**\n * Creates validating function for passed schema with asynchronous loading of missing schemas.\n * `loadSchema` option should be a function that accepts schema uri and returns promise that resolves with the schema.\n * @this  Ajv\n * @param {Object}   schema schema object\n * @param {Boolean}  meta optional true to compile meta-schema; this parameter can be skipped\n * @param {Function} callback an optional node-style callback, it is called with 2 parameters: error (or null) and validating function.\n * @return {Promise} promise that resolves with a validating function.\n */\nfunction compileAsync(schema, meta, callback) {\n  /* eslint no-shadow: 0 */\n  /* global Promise */\n  /* jshint validthis: true */\n  var self = this;\n  if (typeof this._opts.loadSchema != 'function')\n    throw new Error('options.loadSchema should be a function');\n\n  if (typeof meta == 'function') {\n    callback = meta;\n    meta = undefined;\n  }\n\n  var p = loadMetaSchemaOf(schema).then(function () {\n    var schemaObj = self._addSchema(schema, undefined, meta);\n    return schemaObj.validate || _compileAsync(schemaObj);\n  });\n\n  if (callback) {\n    p.then(\n      function(v) { callback(null, v); },\n      callback\n    );\n  }\n\n  return p;\n\n\n  function loadMetaSchemaOf(sch) {\n    var $schema = sch.$schema;\n    return $schema && !self.getSchema($schema)\n            ? compileAsync.call(self, { $ref: $schema }, true)\n            : Promise.resolve();\n  }\n\n\n  function _compileAsync(schemaObj) {\n    try { return self._compile(schemaObj); }\n    catch(e) {\n      if (e instanceof MissingRefError) return loadMissingSchema(e);\n      throw e;\n    }\n\n\n    function loadMissingSchema(e) {\n      var ref = e.missingSchema;\n      if (added(ref)) throw new Error('Schema ' + ref + ' is loaded but ' + e.missingRef + ' cannot be resolved');\n\n      var schemaPromise = self._loadingSchemas[ref];\n      if (!schemaPromise) {\n        schemaPromise = self._loadingSchemas[ref] = self._opts.loadSchema(ref);\n        schemaPromise.then(removePromise, removePromise);\n      }\n\n      return schemaPromise.then(function (sch) {\n        if (!added(ref)) {\n          return loadMetaSchemaOf(sch).then(function () {\n            if (!added(ref)) self.addSchema(sch, ref, undefined, meta);\n          });\n        }\n      }).then(function() {\n        return _compileAsync(schemaObj);\n      });\n\n      function removePromise() {\n        delete self._loadingSchemas[ref];\n      }\n\n      function added(ref) {\n        return self._refs[ref] || self._schemas[ref];\n      }\n    }\n  }\n}\n","'use strict';\n\nvar resolve = require('./resolve');\n\nmodule.exports = {\n  Validation: errorSubclass(ValidationError),\n  MissingRef: errorSubclass(MissingRefError)\n};\n\n\nfunction ValidationError(errors) {\n  this.message = 'validation failed';\n  this.errors = errors;\n  this.ajv = this.validation = true;\n}\n\n\nMissingRefError.message = function (baseId, ref) {\n  return 'can\\'t resolve reference ' + ref + ' from id ' + baseId;\n};\n\n\nfunction MissingRefError(baseId, ref, message) {\n  this.message = message || MissingRefError.message(baseId, ref);\n  this.missingRef = resolve.url(baseId, ref);\n  this.missingSchema = resolve.normalizeId(resolve.fullPath(this.missingRef));\n}\n\n\nfunction errorSubclass(Subclass) {\n  Subclass.prototype = Object.create(Error.prototype);\n  Subclass.prototype.constructor = Subclass;\n  return Subclass;\n}\n","'use strict';\n\nvar util = require('./util');\n\nvar DATE = /^(\\d\\d\\d\\d)-(\\d\\d)-(\\d\\d)$/;\nvar DAYS = [0,31,28,31,30,31,30,31,31,30,31,30,31];\nvar TIME = /^(\\d\\d):(\\d\\d):(\\d\\d)(\\.\\d+)?(z|[+-]\\d\\d:\\d\\d)?$/i;\nvar HOSTNAME = /^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*$/i;\nvar URI = /^(?:[a-z][a-z0-9+\\-.]*:)(?:\\/?\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\\.[a-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|(?:[a-z0-9\\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\\d*)?(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\\?(?:[a-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;\nvar URIREF = /^(?:[a-z][a-z0-9+\\-.]*:)?(?:\\/?\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\\.[a-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|(?:[a-z0-9\\-._~!$&'\"()*+,;=]|%[0-9a-f]{2})*)(?::\\d*)?(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*|\\/(?:(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\\?(?:[a-z0-9\\-._~!$&'\"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\\-._~!$&'\"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;\n// uri-template: https://tools.ietf.org/html/rfc6570\nvar URITEMPLATE = /^(?:(?:[^\\x00-\\x20\"'<>%\\\\^`{|}]|%[0-9a-f]{2})|\\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\\*)?)*\\})*$/i;\n// For the source: https://gist.github.com/dperini/729294\n// For test cases: https://mathiasbynens.be/demo/url-regex\n// @todo Delete current URL in favour of the commented out URL rule when this issue is fixed https://github.com/eslint/eslint/issues/7983.\n// var URL = /^(?:(?:https?|ftp):\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!10(?:\\.\\d{1,3}){3})(?!127(?:\\.\\d{1,3}){3})(?!169\\.254(?:\\.\\d{1,3}){2})(?!192\\.168(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u{00a1}-\\u{ffff}0-9]+-?)*[a-z\\u{00a1}-\\u{ffff}0-9]+)(?:\\.(?:[a-z\\u{00a1}-\\u{ffff}0-9]+-?)*[a-z\\u{00a1}-\\u{ffff}0-9]+)*(?:\\.(?:[a-z\\u{00a1}-\\u{ffff}]{2,})))(?::\\d{2,5})?(?:\\/[^\\s]*)?$/iu;\nvar URL = /^(?:(?:http[s\\u017F]?|ftp):\\/\\/)(?:(?:[\\0-\\x08\\x0E-\\x1F!-\\x9F\\xA1-\\u167F\\u1681-\\u1FFF\\u200B-\\u2027\\u202A-\\u202E\\u2030-\\u205E\\u2060-\\u2FFF\\u3001-\\uD7FF\\uE000-\\uFEFE\\uFF00-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+(?::(?:[\\0-\\x08\\x0E-\\x1F!-\\x9F\\xA1-\\u167F\\u1681-\\u1FFF\\u200B-\\u2027\\u202A-\\u202E\\u2030-\\u205E\\u2060-\\u2FFF\\u3001-\\uD7FF\\uE000-\\uFEFE\\uFF00-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*)?@)?(?:(?!10(?:\\.[0-9]{1,3}){3})(?!127(?:\\.[0-9]{1,3}){3})(?!169\\.254(?:\\.[0-9]{1,3}){2})(?!192\\.168(?:\\.[0-9]{1,3}){2})(?!172\\.(?:1[6-9]|2[0-9]|3[01])(?:\\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\\xA1-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+-?)*(?:[0-9KSa-z\\xA1-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+)(?:\\.(?:(?:[0-9KSa-z\\xA1-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+-?)*(?:[0-9KSa-z\\xA1-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+)*(?:\\.(?:(?:[KSa-z\\xA1-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\\/(?:[\\0-\\x08\\x0E-\\x1F!-\\x9F\\xA1-\\u167F\\u1681-\\u1FFF\\u200B-\\u2027\\u202A-\\u202E\\u2030-\\u205E\\u2060-\\u2FFF\\u3001-\\uD7FF\\uE000-\\uFEFE\\uFF00-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*)?$/i;\nvar UUID = /^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i;\nvar JSON_POINTER = /^(?:\\/(?:[^~/]|~0|~1)*)*$/;\nvar JSON_POINTER_URI_FRAGMENT = /^#(?:\\/(?:[a-z0-9_\\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i;\nvar RELATIVE_JSON_POINTER = /^(?:0|[1-9][0-9]*)(?:#|(?:\\/(?:[^~/]|~0|~1)*)*)$/;\n\n\nmodule.exports = formats;\n\nfunction formats(mode) {\n  mode = mode == 'full' ? 'full' : 'fast';\n  return util.copy(formats[mode]);\n}\n\n\nformats.fast = {\n  // date: http://tools.ietf.org/html/rfc3339#section-5.6\n  date: /^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d$/,\n  // date-time: http://tools.ietf.org/html/rfc3339#section-5.6\n  time: /^(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d:\\d\\d)?$/i,\n  'date-time': /^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d[t\\s](?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d:\\d\\d)$/i,\n  // uri: https://github.com/mafintosh/is-my-json-valid/blob/master/formats.js\n  uri: /^(?:[a-z][a-z0-9+-.]*:)(?:\\/?\\/)?[^\\s]*$/i,\n  'uri-reference': /^(?:(?:[a-z][a-z0-9+-.]*:)?\\/?\\/)?(?:[^\\\\\\s#][^\\s#]*)?(?:#[^\\\\\\s]*)?$/i,\n  'uri-template': URITEMPLATE,\n  url: URL,\n  // email (sources from jsen validator):\n  // http://stackoverflow.com/questions/201323/using-a-regular-expression-to-validate-an-email-address#answer-8829363\n  // http://www.w3.org/TR/html5/forms.html#valid-e-mail-address (search for 'willful violation')\n  email: /^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,\n  hostname: HOSTNAME,\n  // optimized https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9780596802837/ch07s16.html\n  ipv4: /^(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$/,\n  // optimized http://stackoverflow.com/questions/53497/regular-expression-that-matches-valid-ipv6-addresses\n  ipv6: /^\\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(?:%.+)?\\s*$/i,\n  regex: regex,\n  // uuid: http://tools.ietf.org/html/rfc4122\n  uuid: UUID,\n  // JSON-pointer: https://tools.ietf.org/html/rfc6901\n  // uri fragment: https://tools.ietf.org/html/rfc3986#appendix-A\n  'json-pointer': JSON_POINTER,\n  'json-pointer-uri-fragment': JSON_POINTER_URI_FRAGMENT,\n  // relative JSON-pointer: http://tools.ietf.org/html/draft-luff-relative-json-pointer-00\n  'relative-json-pointer': RELATIVE_JSON_POINTER\n};\n\n\nformats.full = {\n  date: date,\n  time: time,\n  'date-time': date_time,\n  uri: uri,\n  'uri-reference': URIREF,\n  'uri-template': URITEMPLATE,\n  url: URL,\n  email: /^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,\n  hostname: hostname,\n  ipv4: /^(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$/,\n  ipv6: /^\\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(?:%.+)?\\s*$/i,\n  regex: regex,\n  uuid: UUID,\n  'json-pointer': JSON_POINTER,\n  'json-pointer-uri-fragment': JSON_POINTER_URI_FRAGMENT,\n  'relative-json-pointer': RELATIVE_JSON_POINTER\n};\n\n\nfunction isLeapYear(year) {\n  // https://tools.ietf.org/html/rfc3339#appendix-C\n  return year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0);\n}\n\n\nfunction date(str) {\n  // full-date from http://tools.ietf.org/html/rfc3339#section-5.6\n  var matches = str.match(DATE);\n  if (!matches) return false;\n\n  var year = +matches[1];\n  var month = +matches[2];\n  var day = +matches[3];\n\n  return month >= 1 && month <= 12 && day >= 1 &&\n          day <= (month == 2 && isLeapYear(year) ? 29 : DAYS[month]);\n}\n\n\nfunction time(str, full) {\n  var matches = str.match(TIME);\n  if (!matches) return false;\n\n  var hour = matches[1];\n  var minute = matches[2];\n  var second = matches[3];\n  var timeZone = matches[5];\n  return ((hour <= 23 && minute <= 59 && second <= 59) ||\n          (hour == 23 && minute == 59 && second == 60)) &&\n         (!full || timeZone);\n}\n\n\nvar DATE_TIME_SEPARATOR = /t|\\s/i;\nfunction date_time(str) {\n  // http://tools.ietf.org/html/rfc3339#section-5.6\n  var dateTime = str.split(DATE_TIME_SEPARATOR);\n  return dateTime.length == 2 && date(dateTime[0]) && time(dateTime[1], true);\n}\n\n\nfunction hostname(str) {\n  // https://tools.ietf.org/html/rfc1034#section-3.5\n  // https://tools.ietf.org/html/rfc1123#section-2\n  return str.length <= 255 && HOSTNAME.test(str);\n}\n\n\nvar NOT_URI_FRAGMENT = /\\/|:/;\nfunction uri(str) {\n  // http://jmrware.com/articles/2009/uri_regexp/URI_regex.html + optional protocol + required \".\"\n  return NOT_URI_FRAGMENT.test(str) && URI.test(str);\n}\n\n\nvar Z_ANCHOR = /[^\\\\]\\\\Z/;\nfunction regex(str) {\n  if (Z_ANCHOR.test(str)) return false;\n  try {\n    new RegExp(str);\n    return true;\n  } catch(e) {\n    return false;\n  }\n}\n","'use strict';\n\nvar resolve = require('./resolve')\n  , util = require('./util')\n  , errorClasses = require('./error_classes')\n  , stableStringify = require('fast-json-stable-stringify');\n\nvar validateGenerator = require('../dotjs/validate');\n\n/**\n * Functions below are used inside compiled validations function\n */\n\nvar ucs2length = util.ucs2length;\nvar equal = require('fast-deep-equal');\n\n// this error is thrown by async schemas to return validation errors via exception\nvar ValidationError = errorClasses.Validation;\n\nmodule.exports = compile;\n\n\n/**\n * Compiles schema to validation function\n * @this   Ajv\n * @param  {Object} schema schema object\n * @param  {Object} root object with information about the root schema for this schema\n * @param  {Object} localRefs the hash of local references inside the schema (created by resolve.id), used for inline resolution\n * @param  {String} baseId base ID for IDs in the schema\n * @return {Function} validation function\n */\nfunction compile(schema, root, localRefs, baseId) {\n  /* jshint validthis: true, evil: true */\n  /* eslint no-shadow: 0 */\n  var self = this\n    , opts = this._opts\n    , refVal = [ undefined ]\n    , refs = {}\n    , patterns = []\n    , patternsHash = {}\n    , defaults = []\n    , defaultsHash = {}\n    , customRules = [];\n\n  root = root || { schema: schema, refVal: refVal, refs: refs };\n\n  var c = checkCompiling.call(this, schema, root, baseId);\n  var compilation = this._compilations[c.index];\n  if (c.compiling) return (compilation.callValidate = callValidate);\n\n  var formats = this._formats;\n  var RULES = this.RULES;\n\n  try {\n    var v = localCompile(schema, root, localRefs, baseId);\n    compilation.validate = v;\n    var cv = compilation.callValidate;\n    if (cv) {\n      cv.schema = v.schema;\n      cv.errors = null;\n      cv.refs = v.refs;\n      cv.refVal = v.refVal;\n      cv.root = v.root;\n      cv.$async = v.$async;\n      if (opts.sourceCode) cv.source = v.source;\n    }\n    return v;\n  } finally {\n    endCompiling.call(this, schema, root, baseId);\n  }\n\n  /* @this   {*} - custom context, see passContext option */\n  function callValidate() {\n    /* jshint validthis: true */\n    var validate = compilation.validate;\n    var result = validate.apply(this, arguments);\n    callValidate.errors = validate.errors;\n    return result;\n  }\n\n  function localCompile(_schema, _root, localRefs, baseId) {\n    var isRoot = !_root || (_root && _root.schema == _schema);\n    if (_root.schema != root.schema)\n      return compile.call(self, _schema, _root, localRefs, baseId);\n\n    var $async = _schema.$async === true;\n\n    var sourceCode = validateGenerator({\n      isTop: true,\n      schema: _schema,\n      isRoot: isRoot,\n      baseId: baseId,\n      root: _root,\n      schemaPath: '',\n      errSchemaPath: '#',\n      errorPath: '\"\"',\n      MissingRefError: errorClasses.MissingRef,\n      RULES: RULES,\n      validate: validateGenerator,\n      util: util,\n      resolve: resolve,\n      resolveRef: resolveRef,\n      usePattern: usePattern,\n      useDefault: useDefault,\n      useCustomRule: useCustomRule,\n      opts: opts,\n      formats: formats,\n      logger: self.logger,\n      self: self\n    });\n\n    sourceCode = vars(refVal, refValCode) + vars(patterns, patternCode)\n                   + vars(defaults, defaultCode) + vars(customRules, customRuleCode)\n                   + sourceCode;\n\n    if (opts.processCode) sourceCode = opts.processCode(sourceCode);\n    // console.log('\\n\\n\\n *** \\n', JSON.stringify(sourceCode));\n    var validate;\n    try {\n      var makeValidate = new Function(\n        'self',\n        'RULES',\n        'formats',\n        'root',\n        'refVal',\n        'defaults',\n        'customRules',\n        'equal',\n        'ucs2length',\n        'ValidationError',\n        sourceCode\n      );\n\n      validate = makeValidate(\n        self,\n        RULES,\n        formats,\n        root,\n        refVal,\n        defaults,\n        customRules,\n        equal,\n        ucs2length,\n        ValidationError\n      );\n\n      refVal[0] = validate;\n    } catch(e) {\n      self.logger.error('Error compiling schema, function code:', sourceCode);\n      throw e;\n    }\n\n    validate.schema = _schema;\n    validate.errors = null;\n    validate.refs = refs;\n    validate.refVal = refVal;\n    validate.root = isRoot ? validate : _root;\n    if ($async) validate.$async = true;\n    if (opts.sourceCode === true) {\n      validate.source = {\n        code: sourceCode,\n        patterns: patterns,\n        defaults: defaults\n      };\n    }\n\n    return validate;\n  }\n\n  function resolveRef(baseId, ref, isRoot) {\n    ref = resolve.url(baseId, ref);\n    var refIndex = refs[ref];\n    var _refVal, refCode;\n    if (refIndex !== undefined) {\n      _refVal = refVal[refIndex];\n      refCode = 'refVal[' + refIndex + ']';\n      return resolvedRef(_refVal, refCode);\n    }\n    if (!isRoot && root.refs) {\n      var rootRefId = root.refs[ref];\n      if (rootRefId !== undefined) {\n        _refVal = root.refVal[rootRefId];\n        refCode = addLocalRef(ref, _refVal);\n        return resolvedRef(_refVal, refCode);\n      }\n    }\n\n    refCode = addLocalRef(ref);\n    var v = resolve.call(self, localCompile, root, ref);\n    if (v === undefined) {\n      var localSchema = localRefs && localRefs[ref];\n      if (localSchema) {\n        v = resolve.inlineRef(localSchema, opts.inlineRefs)\n            ? localSchema\n            : compile.call(self, localSchema, root, localRefs, baseId);\n      }\n    }\n\n    if (v === undefined) {\n      removeLocalRef(ref);\n    } else {\n      replaceLocalRef(ref, v);\n      return resolvedRef(v, refCode);\n    }\n  }\n\n  function addLocalRef(ref, v) {\n    var refId = refVal.length;\n    refVal[refId] = v;\n    refs[ref] = refId;\n    return 'refVal' + refId;\n  }\n\n  function removeLocalRef(ref) {\n    delete refs[ref];\n  }\n\n  function replaceLocalRef(ref, v) {\n    var refId = refs[ref];\n    refVal[refId] = v;\n  }\n\n  function resolvedRef(refVal, code) {\n    return typeof refVal == 'object' || typeof refVal == 'boolean'\n            ? { code: code, schema: refVal, inline: true }\n            : { code: code, $async: refVal && !!refVal.$async };\n  }\n\n  function usePattern(regexStr) {\n    var index = patternsHash[regexStr];\n    if (index === undefined) {\n      index = patternsHash[regexStr] = patterns.length;\n      patterns[index] = regexStr;\n    }\n    return 'pattern' + index;\n  }\n\n  function useDefault(value) {\n    switch (typeof value) {\n      case 'boolean':\n      case 'number':\n        return '' + value;\n      case 'string':\n        return util.toQuotedString(value);\n      case 'object':\n        if (value === null) return 'null';\n        var valueStr = stableStringify(value);\n        var index = defaultsHash[valueStr];\n        if (index === undefined) {\n          index = defaultsHash[valueStr] = defaults.length;\n          defaults[index] = value;\n        }\n        return 'default' + index;\n    }\n  }\n\n  function useCustomRule(rule, schema, parentSchema, it) {\n    var validateSchema = rule.definition.validateSchema;\n    if (validateSchema && self._opts.validateSchema !== false) {\n      var valid = validateSchema(schema);\n      if (!valid) {\n        var message = 'keyword schema is invalid: ' + self.errorsText(validateSchema.errors);\n        if (self._opts.validateSchema == 'log') self.logger.error(message);\n        else throw new Error(message);\n      }\n    }\n\n    var compile = rule.definition.compile\n      , inline = rule.definition.inline\n      , macro = rule.definition.macro;\n\n    var validate;\n    if (compile) {\n      validate = compile.call(self, schema, parentSchema, it);\n    } else if (macro) {\n      validate = macro.call(self, schema, parentSchema, it);\n      if (opts.validateSchema !== false) self.validateSchema(validate, true);\n    } else if (inline) {\n      validate = inline.call(self, it, rule.keyword, schema, parentSchema);\n    } else {\n      validate = rule.definition.validate;\n      if (!validate) return;\n    }\n\n    if (validate === undefined)\n      throw new Error('custom keyword \"' + rule.keyword + '\"failed to compile');\n\n    var index = customRules.length;\n    customRules[index] = validate;\n\n    return {\n      code: 'customRule' + index,\n      validate: validate\n    };\n  }\n}\n\n\n/**\n * Checks if the schema is currently compiled\n * @this   Ajv\n * @param  {Object} schema schema to compile\n * @param  {Object} root root object\n * @param  {String} baseId base schema ID\n * @return {Object} object with properties \"index\" (compilation index) and \"compiling\" (boolean)\n */\nfunction checkCompiling(schema, root, baseId) {\n  /* jshint validthis: true */\n  var index = compIndex.call(this, schema, root, baseId);\n  if (index >= 0) return { index: index, compiling: true };\n  index = this._compilations.length;\n  this._compilations[index] = {\n    schema: schema,\n    root: root,\n    baseId: baseId\n  };\n  return { index: index, compiling: false };\n}\n\n\n/**\n * Removes the schema from the currently compiled list\n * @this   Ajv\n * @param  {Object} schema schema to compile\n * @param  {Object} root root object\n * @param  {String} baseId base schema ID\n */\nfunction endCompiling(schema, root, baseId) {\n  /* jshint validthis: true */\n  var i = compIndex.call(this, schema, root, baseId);\n  if (i >= 0) this._compilations.splice(i, 1);\n}\n\n\n/**\n * Index of schema compilation in the currently compiled list\n * @this   Ajv\n * @param  {Object} schema schema to compile\n * @param  {Object} root root object\n * @param  {String} baseId base schema ID\n * @return {Integer} compilation index\n */\nfunction compIndex(schema, root, baseId) {\n  /* jshint validthis: true */\n  for (var i=0; i<this._compilations.length; i++) {\n    var c = this._compilations[i];\n    if (c.schema == schema && c.root == root && c.baseId == baseId) return i;\n  }\n  return -1;\n}\n\n\nfunction patternCode(i, patterns) {\n  return 'var pattern' + i + ' = new RegExp(' + util.toQuotedString(patterns[i]) + ');';\n}\n\n\nfunction defaultCode(i) {\n  return 'var default' + i + ' = defaults[' + i + '];';\n}\n\n\nfunction refValCode(i, refVal) {\n  return refVal[i] === undefined ? '' : 'var refVal' + i + ' = refVal[' + i + '];';\n}\n\n\nfunction customRuleCode(i) {\n  return 'var customRule' + i + ' = customRules[' + i + '];';\n}\n\n\nfunction vars(arr, statement) {\n  if (!arr.length) return '';\n  var code = '';\n  for (var i=0; i<arr.length; i++)\n    code += statement(i, arr);\n  return code;\n}\n","'use strict';\n\nvar URI = require('uri-js')\n  , equal = require('fast-deep-equal')\n  , util = require('./util')\n  , SchemaObject = require('./schema_obj')\n  , traverse = require('json-schema-traverse');\n\nmodule.exports = resolve;\n\nresolve.normalizeId = normalizeId;\nresolve.fullPath = getFullPath;\nresolve.url = resolveUrl;\nresolve.ids = resolveIds;\nresolve.inlineRef = inlineRef;\nresolve.schema = resolveSchema;\n\n/**\n * [resolve and compile the references ($ref)]\n * @this   Ajv\n * @param  {Function} compile reference to schema compilation funciton (localCompile)\n * @param  {Object} root object with information about the root schema for the current schema\n * @param  {String} ref reference to resolve\n * @return {Object|Function} schema object (if the schema can be inlined) or validation function\n */\nfunction resolve(compile, root, ref) {\n  /* jshint validthis: true */\n  var refVal = this._refs[ref];\n  if (typeof refVal == 'string') {\n    if (this._refs[refVal]) refVal = this._refs[refVal];\n    else return resolve.call(this, compile, root, refVal);\n  }\n\n  refVal = refVal || this._schemas[ref];\n  if (refVal instanceof SchemaObject) {\n    return inlineRef(refVal.schema, this._opts.inlineRefs)\n            ? refVal.schema\n            : refVal.validate || this._compile(refVal);\n  }\n\n  var res = resolveSchema.call(this, root, ref);\n  var schema, v, baseId;\n  if (res) {\n    schema = res.schema;\n    root = res.root;\n    baseId = res.baseId;\n  }\n\n  if (schema instanceof SchemaObject) {\n    v = schema.validate || compile.call(this, schema.schema, root, undefined, baseId);\n  } else if (schema !== undefined) {\n    v = inlineRef(schema, this._opts.inlineRefs)\n        ? schema\n        : compile.call(this, schema, root, undefined, baseId);\n  }\n\n  return v;\n}\n\n\n/**\n * Resolve schema, its root and baseId\n * @this Ajv\n * @param  {Object} root root object with properties schema, refVal, refs\n * @param  {String} ref  reference to resolve\n * @return {Object} object with properties schema, root, baseId\n */\nfunction resolveSchema(root, ref) {\n  /* jshint validthis: true */\n  var p = URI.parse(ref)\n    , refPath = _getFullPath(p)\n    , baseId = getFullPath(this._getId(root.schema));\n  if (Object.keys(root.schema).length === 0 || refPath !== baseId) {\n    var id = normalizeId(refPath);\n    var refVal = this._refs[id];\n    if (typeof refVal == 'string') {\n      return resolveRecursive.call(this, root, refVal, p);\n    } else if (refVal instanceof SchemaObject) {\n      if (!refVal.validate) this._compile(refVal);\n      root = refVal;\n    } else {\n      refVal = this._schemas[id];\n      if (refVal instanceof SchemaObject) {\n        if (!refVal.validate) this._compile(refVal);\n        if (id == normalizeId(ref))\n          return { schema: refVal, root: root, baseId: baseId };\n        root = refVal;\n      } else {\n        return;\n      }\n    }\n    if (!root.schema) return;\n    baseId = getFullPath(this._getId(root.schema));\n  }\n  return getJsonPointer.call(this, p, baseId, root.schema, root);\n}\n\n\n/* @this Ajv */\nfunction resolveRecursive(root, ref, parsedRef) {\n  /* jshint validthis: true */\n  var res = resolveSchema.call(this, root, ref);\n  if (res) {\n    var schema = res.schema;\n    var baseId = res.baseId;\n    root = res.root;\n    var id = this._getId(schema);\n    if (id) baseId = resolveUrl(baseId, id);\n    return getJsonPointer.call(this, parsedRef, baseId, schema, root);\n  }\n}\n\n\nvar PREVENT_SCOPE_CHANGE = util.toHash(['properties', 'patternProperties', 'enum', 'dependencies', 'definitions']);\n/* @this Ajv */\nfunction getJsonPointer(parsedRef, baseId, schema, root) {\n  /* jshint validthis: true */\n  parsedRef.fragment = parsedRef.fragment || '';\n  if (parsedRef.fragment.slice(0,1) != '/') return;\n  var parts = parsedRef.fragment.split('/');\n\n  for (var i = 1; i < parts.length; i++) {\n    var part = parts[i];\n    if (part) {\n      part = util.unescapeFragment(part);\n      schema = schema[part];\n      if (schema === undefined) break;\n      var id;\n      if (!PREVENT_SCOPE_CHANGE[part]) {\n        id = this._getId(schema);\n        if (id) baseId = resolveUrl(baseId, id);\n        if (schema.$ref) {\n          var $ref = resolveUrl(baseId, schema.$ref);\n          var res = resolveSchema.call(this, root, $ref);\n          if (res) {\n            schema = res.schema;\n            root = res.root;\n            baseId = res.baseId;\n          }\n        }\n      }\n    }\n  }\n  if (schema !== undefined && schema !== root.schema)\n    return { schema: schema, root: root, baseId: baseId };\n}\n\n\nvar SIMPLE_INLINED = util.toHash([\n  'type', 'format', 'pattern',\n  'maxLength', 'minLength',\n  'maxProperties', 'minProperties',\n  'maxItems', 'minItems',\n  'maximum', 'minimum',\n  'uniqueItems', 'multipleOf',\n  'required', 'enum'\n]);\nfunction inlineRef(schema, limit) {\n  if (limit === false) return false;\n  if (limit === undefined || limit === true) return checkNoRef(schema);\n  else if (limit) return countKeys(schema) <= limit;\n}\n\n\nfunction checkNoRef(schema) {\n  var item;\n  if (Array.isArray(schema)) {\n    for (var i=0; i<schema.length; i++) {\n      item = schema[i];\n      if (typeof item == 'object' && !checkNoRef(item)) return false;\n    }\n  } else {\n    for (var key in schema) {\n      if (key == '$ref') return false;\n      item = schema[key];\n      if (typeof item == 'object' && !checkNoRef(item)) return false;\n    }\n  }\n  return true;\n}\n\n\nfunction countKeys(schema) {\n  var count = 0, item;\n  if (Array.isArray(schema)) {\n    for (var i=0; i<schema.length; i++) {\n      item = schema[i];\n      if (typeof item == 'object') count += countKeys(item);\n      if (count == Infinity) return Infinity;\n    }\n  } else {\n    for (var key in schema) {\n      if (key == '$ref') return Infinity;\n      if (SIMPLE_INLINED[key]) {\n        count++;\n      } else {\n        item = schema[key];\n        if (typeof item == 'object') count += countKeys(item) + 1;\n        if (count == Infinity) return Infinity;\n      }\n    }\n  }\n  return count;\n}\n\n\nfunction getFullPath(id, normalize) {\n  if (normalize !== false) id = normalizeId(id);\n  var p = URI.parse(id);\n  return _getFullPath(p);\n}\n\n\nfunction _getFullPath(p) {\n  return URI.serialize(p).split('#')[0] + '#';\n}\n\n\nvar TRAILING_SLASH_HASH = /#\\/?$/;\nfunction normalizeId(id) {\n  return id ? id.replace(TRAILING_SLASH_HASH, '') : '';\n}\n\n\nfunction resolveUrl(baseId, id) {\n  id = normalizeId(id);\n  return URI.resolve(baseId, id);\n}\n\n\n/* @this Ajv */\nfunction resolveIds(schema) {\n  var schemaId = normalizeId(this._getId(schema));\n  var baseIds = {'': schemaId};\n  var fullPaths = {'': getFullPath(schemaId, false)};\n  var localRefs = {};\n  var self = this;\n\n  traverse(schema, {allKeys: true}, function(sch, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex) {\n    if (jsonPtr === '') return;\n    var id = self._getId(sch);\n    var baseId = baseIds[parentJsonPtr];\n    var fullPath = fullPaths[parentJsonPtr] + '/' + parentKeyword;\n    if (keyIndex !== undefined)\n      fullPath += '/' + (typeof keyIndex == 'number' ? keyIndex : util.escapeFragment(keyIndex));\n\n    if (typeof id == 'string') {\n      id = baseId = normalizeId(baseId ? URI.resolve(baseId, id) : id);\n\n      var refVal = self._refs[id];\n      if (typeof refVal == 'string') refVal = self._refs[refVal];\n      if (refVal && refVal.schema) {\n        if (!equal(sch, refVal.schema))\n          throw new Error('id \"' + id + '\" resolves to more than one schema');\n      } else if (id != normalizeId(fullPath)) {\n        if (id[0] == '#') {\n          if (localRefs[id] && !equal(sch, localRefs[id]))\n            throw new Error('id \"' + id + '\" resolves to more than one schema');\n          localRefs[id] = sch;\n        } else {\n          self._refs[id] = fullPath;\n        }\n      }\n    }\n    baseIds[jsonPtr] = baseId;\n    fullPaths[jsonPtr] = fullPath;\n  });\n\n  return localRefs;\n}\n","'use strict';\n\nvar ruleModules = require('../dotjs')\n  , toHash = require('./util').toHash;\n\nmodule.exports = function rules() {\n  var RULES = [\n    { type: 'number',\n      rules: [ { 'maximum': ['exclusiveMaximum'] },\n               { 'minimum': ['exclusiveMinimum'] }, 'multipleOf', 'format'] },\n    { type: 'string',\n      rules: [ 'maxLength', 'minLength', 'pattern', 'format' ] },\n    { type: 'array',\n      rules: [ 'maxItems', 'minItems', 'items', 'contains', 'uniqueItems' ] },\n    { type: 'object',\n      rules: [ 'maxProperties', 'minProperties', 'required', 'dependencies', 'propertyNames',\n               { 'properties': ['additionalProperties', 'patternProperties'] } ] },\n    { rules: [ '$ref', 'const', 'enum', 'not', 'anyOf', 'oneOf', 'allOf', 'if' ] }\n  ];\n\n  var ALL = [ 'type', '$comment' ];\n  var KEYWORDS = [\n    '$schema', '$id', 'id', '$data', 'title',\n    'description', 'default', 'definitions',\n    'examples', 'readOnly', 'writeOnly',\n    'contentMediaType', 'contentEncoding',\n    'additionalItems', 'then', 'else'\n  ];\n  var TYPES = [ 'number', 'integer', 'string', 'array', 'object', 'boolean', 'null' ];\n  RULES.all = toHash(ALL);\n  RULES.types = toHash(TYPES);\n\n  RULES.forEach(function (group) {\n    group.rules = group.rules.map(function (keyword) {\n      var implKeywords;\n      if (typeof keyword == 'object') {\n        var key = Object.keys(keyword)[0];\n        implKeywords = keyword[key];\n        keyword = key;\n        implKeywords.forEach(function (k) {\n          ALL.push(k);\n          RULES.all[k] = true;\n        });\n      }\n      ALL.push(keyword);\n      var rule = RULES.all[keyword] = {\n        keyword: keyword,\n        code: ruleModules[keyword],\n        implements: implKeywords\n      };\n      return rule;\n    });\n\n    RULES.all.$comment = {\n      keyword: '$comment',\n      code: ruleModules.$comment\n    };\n\n    if (group.type) RULES.types[group.type] = group;\n  });\n\n  RULES.keywords = toHash(ALL.concat(KEYWORDS));\n  RULES.custom = {};\n\n  return RULES;\n};\n","'use strict';\n\nvar util = require('./util');\n\nmodule.exports = SchemaObject;\n\nfunction SchemaObject(obj) {\n  util.copy(obj, this);\n}\n","'use strict';\n\n// https://mathiasbynens.be/notes/javascript-encoding\n// https://github.com/bestiejs/punycode.js - punycode.ucs2.decode\nmodule.exports = function ucs2length(str) {\n  var length = 0\n    , len = str.length\n    , pos = 0\n    , value;\n  while (pos < len) {\n    length++;\n    value = str.charCodeAt(pos++);\n    if (value >= 0xD800 && value <= 0xDBFF && pos < len) {\n      // high surrogate, and there is a next character\n      value = str.charCodeAt(pos);\n      if ((value & 0xFC00) == 0xDC00) pos++; // low surrogate\n    }\n  }\n  return length;\n};\n","'use strict';\n\n\nmodule.exports = {\n  copy: copy,\n  checkDataType: checkDataType,\n  checkDataTypes: checkDataTypes,\n  coerceToTypes: coerceToTypes,\n  toHash: toHash,\n  getProperty: getProperty,\n  escapeQuotes: escapeQuotes,\n  equal: require('fast-deep-equal'),\n  ucs2length: require('./ucs2length'),\n  varOccurences: varOccurences,\n  varReplace: varReplace,\n  cleanUpCode: cleanUpCode,\n  finalCleanUpCode: finalCleanUpCode,\n  schemaHasRules: schemaHasRules,\n  schemaHasRulesExcept: schemaHasRulesExcept,\n  toQuotedString: toQuotedString,\n  getPathExpr: getPathExpr,\n  getPath: getPath,\n  getData: getData,\n  unescapeFragment: unescapeFragment,\n  unescapeJsonPointer: unescapeJsonPointer,\n  escapeFragment: escapeFragment,\n  escapeJsonPointer: escapeJsonPointer\n};\n\n\nfunction copy(o, to) {\n  to = to || {};\n  for (var key in o) to[key] = o[key];\n  return to;\n}\n\n\nfunction checkDataType(dataType, data, negate) {\n  var EQUAL = negate ? ' !== ' : ' === '\n    , AND = negate ? ' || ' : ' && '\n    , OK = negate ? '!' : ''\n    , NOT = negate ? '' : '!';\n  switch (dataType) {\n    case 'null': return data + EQUAL + 'null';\n    case 'array': return OK + 'Array.isArray(' + data + ')';\n    case 'object': return '(' + OK + data + AND +\n                          'typeof ' + data + EQUAL + '\"object\"' + AND +\n                          NOT + 'Array.isArray(' + data + '))';\n    case 'integer': return '(typeof ' + data + EQUAL + '\"number\"' + AND +\n                           NOT + '(' + data + ' % 1)' +\n                           AND + data + EQUAL + data + ')';\n    default: return 'typeof ' + data + EQUAL + '\"' + dataType + '\"';\n  }\n}\n\n\nfunction checkDataTypes(dataTypes, data) {\n  switch (dataTypes.length) {\n    case 1: return checkDataType(dataTypes[0], data, true);\n    default:\n      var code = '';\n      var types = toHash(dataTypes);\n      if (types.array && types.object) {\n        code = types.null ? '(': '(!' + data + ' || ';\n        code += 'typeof ' + data + ' !== \"object\")';\n        delete types.null;\n        delete types.array;\n        delete types.object;\n      }\n      if (types.number) delete types.integer;\n      for (var t in types)\n        code += (code ? ' && ' : '' ) + checkDataType(t, data, true);\n\n      return code;\n  }\n}\n\n\nvar COERCE_TO_TYPES = toHash([ 'string', 'number', 'integer', 'boolean', 'null' ]);\nfunction coerceToTypes(optionCoerceTypes, dataTypes) {\n  if (Array.isArray(dataTypes)) {\n    var types = [];\n    for (var i=0; i<dataTypes.length; i++) {\n      var t = dataTypes[i];\n      if (COERCE_TO_TYPES[t]) types[types.length] = t;\n      else if (optionCoerceTypes === 'array' && t === 'array') types[types.length] = t;\n    }\n    if (types.length) return types;\n  } else if (COERCE_TO_TYPES[dataTypes]) {\n    return [dataTypes];\n  } else if (optionCoerceTypes === 'array' && dataTypes === 'array') {\n    return ['array'];\n  }\n}\n\n\nfunction toHash(arr) {\n  var hash = {};\n  for (var i=0; i<arr.length; i++) hash[arr[i]] = true;\n  return hash;\n}\n\n\nvar IDENTIFIER = /^[a-z$_][a-z$_0-9]*$/i;\nvar SINGLE_QUOTE = /'|\\\\/g;\nfunction getProperty(key) {\n  return typeof key == 'number'\n          ? '[' + key + ']'\n          : IDENTIFIER.test(key)\n            ? '.' + key\n            : \"['\" + escapeQuotes(key) + \"']\";\n}\n\n\nfunction escapeQuotes(str) {\n  return str.replace(SINGLE_QUOTE, '\\\\$&')\n            .replace(/\\n/g, '\\\\n')\n            .replace(/\\r/g, '\\\\r')\n            .replace(/\\f/g, '\\\\f')\n            .replace(/\\t/g, '\\\\t');\n}\n\n\nfunction varOccurences(str, dataVar) {\n  dataVar += '[^0-9]';\n  var matches = str.match(new RegExp(dataVar, 'g'));\n  return matches ? matches.length : 0;\n}\n\n\nfunction varReplace(str, dataVar, expr) {\n  dataVar += '([^0-9])';\n  expr = expr.replace(/\\$/g, '$$$$');\n  return str.replace(new RegExp(dataVar, 'g'), expr + '$1');\n}\n\n\nvar EMPTY_ELSE = /else\\s*{\\s*}/g\n  , EMPTY_IF_NO_ELSE = /if\\s*\\([^)]+\\)\\s*\\{\\s*\\}(?!\\s*else)/g\n  , EMPTY_IF_WITH_ELSE = /if\\s*\\(([^)]+)\\)\\s*\\{\\s*\\}\\s*else(?!\\s*if)/g;\nfunction cleanUpCode(out) {\n  return out.replace(EMPTY_ELSE, '')\n            .replace(EMPTY_IF_NO_ELSE, '')\n            .replace(EMPTY_IF_WITH_ELSE, 'if (!($1))');\n}\n\n\nvar ERRORS_REGEXP = /[^v.]errors/g\n  , REMOVE_ERRORS = /var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g\n  , REMOVE_ERRORS_ASYNC = /var errors = 0;|var vErrors = null;/g\n  , RETURN_VALID = 'return errors === 0;'\n  , RETURN_TRUE = 'validate.errors = null; return true;'\n  , RETURN_ASYNC = /if \\(errors === 0\\) return data;\\s*else throw new ValidationError\\(vErrors\\);/\n  , RETURN_DATA_ASYNC = 'return data;'\n  , ROOTDATA_REGEXP = /[^A-Za-z_$]rootData[^A-Za-z0-9_$]/g\n  , REMOVE_ROOTDATA = /if \\(rootData === undefined\\) rootData = data;/;\n\nfunction finalCleanUpCode(out, async) {\n  var matches = out.match(ERRORS_REGEXP);\n  if (matches && matches.length == 2) {\n    out = async\n          ? out.replace(REMOVE_ERRORS_ASYNC, '')\n               .replace(RETURN_ASYNC, RETURN_DATA_ASYNC)\n          : out.replace(REMOVE_ERRORS, '')\n               .replace(RETURN_VALID, RETURN_TRUE);\n  }\n\n  matches = out.match(ROOTDATA_REGEXP);\n  if (!matches || matches.length !== 3) return out;\n  return out.replace(REMOVE_ROOTDATA, '');\n}\n\n\nfunction schemaHasRules(schema, rules) {\n  if (typeof schema == 'boolean') return !schema;\n  for (var key in schema) if (rules[key]) return true;\n}\n\n\nfunction schemaHasRulesExcept(schema, rules, exceptKeyword) {\n  if (typeof schema == 'boolean') return !schema && exceptKeyword != 'not';\n  for (var key in schema) if (key != exceptKeyword && rules[key]) return true;\n}\n\n\nfunction toQuotedString(str) {\n  return '\\'' + escapeQuotes(str) + '\\'';\n}\n\n\nfunction getPathExpr(currentPath, expr, jsonPointers, isNumber) {\n  var path = jsonPointers // false by default\n              ? '\\'/\\' + ' + expr + (isNumber ? '' : '.replace(/~/g, \\'~0\\').replace(/\\\\//g, \\'~1\\')')\n              : (isNumber ? '\\'[\\' + ' + expr + ' + \\']\\'' : '\\'[\\\\\\'\\' + ' + expr + ' + \\'\\\\\\']\\'');\n  return joinPaths(currentPath, path);\n}\n\n\nfunction getPath(currentPath, prop, jsonPointers) {\n  var path = jsonPointers // false by default\n              ? toQuotedString('/' + escapeJsonPointer(prop))\n              : toQuotedString(getProperty(prop));\n  return joinPaths(currentPath, path);\n}\n\n\nvar JSON_POINTER = /^\\/(?:[^~]|~0|~1)*$/;\nvar RELATIVE_JSON_POINTER = /^([0-9]+)(#|\\/(?:[^~]|~0|~1)*)?$/;\nfunction getData($data, lvl, paths) {\n  var up, jsonPointer, data, matches;\n  if ($data === '') return 'rootData';\n  if ($data[0] == '/') {\n    if (!JSON_POINTER.test($data)) throw new Error('Invalid JSON-pointer: ' + $data);\n    jsonPointer = $data;\n    data = 'rootData';\n  } else {\n    matches = $data.match(RELATIVE_JSON_POINTER);\n    if (!matches) throw new Error('Invalid JSON-pointer: ' + $data);\n    up = +matches[1];\n    jsonPointer = matches[2];\n    if (jsonPointer == '#') {\n      if (up >= lvl) throw new Error('Cannot access property/index ' + up + ' levels up, current level is ' + lvl);\n      return paths[lvl - up];\n    }\n\n    if (up > lvl) throw new Error('Cannot access data ' + up + ' levels up, current level is ' + lvl);\n    data = 'data' + ((lvl - up) || '');\n    if (!jsonPointer) return data;\n  }\n\n  var expr = data;\n  var segments = jsonPointer.split('/');\n  for (var i=0; i<segments.length; i++) {\n    var segment = segments[i];\n    if (segment) {\n      data += getProperty(unescapeJsonPointer(segment));\n      expr += ' && ' + data;\n    }\n  }\n  return expr;\n}\n\n\nfunction joinPaths (a, b) {\n  if (a == '\"\"') return b;\n  return (a + ' + ' + b).replace(/' \\+ '/g, '');\n}\n\n\nfunction unescapeFragment(str) {\n  return unescapeJsonPointer(decodeURIComponent(str));\n}\n\n\nfunction escapeFragment(str) {\n  return encodeURIComponent(escapeJsonPointer(str));\n}\n\n\nfunction escapeJsonPointer(str) {\n  return str.replace(/~/g, '~0').replace(/\\//g, '~1');\n}\n\n\nfunction unescapeJsonPointer(str) {\n  return str.replace(/~1/g, '/').replace(/~0/g, '~');\n}\n","'use strict';\n\nvar KEYWORDS = [\n  'multipleOf',\n  'maximum',\n  'exclusiveMaximum',\n  'minimum',\n  'exclusiveMinimum',\n  'maxLength',\n  'minLength',\n  'pattern',\n  'additionalItems',\n  'maxItems',\n  'minItems',\n  'uniqueItems',\n  'maxProperties',\n  'minProperties',\n  'required',\n  'additionalProperties',\n  'enum',\n  'format',\n  'const'\n];\n\nmodule.exports = function (metaSchema, keywordsJsonPointers) {\n  for (var i=0; i<keywordsJsonPointers.length; i++) {\n    metaSchema = JSON.parse(JSON.stringify(metaSchema));\n    var segments = keywordsJsonPointers[i].split('/');\n    var keywords = metaSchema;\n    var j;\n    for (j=1; j<segments.length; j++)\n      keywords = keywords[segments[j]];\n\n    for (j=0; j<KEYWORDS.length; j++) {\n      var key = KEYWORDS[j];\n      var schema = keywords[key];\n      if (schema) {\n        keywords[key] = {\n          anyOf: [\n            schema,\n            { $ref: 'https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#' }\n          ]\n        };\n      }\n    }\n  }\n\n  return metaSchema;\n};\n","'use strict';\nmodule.exports = function generate__limit(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $errorKeyword;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $isMax = $keyword == 'maximum',\n    $exclusiveKeyword = $isMax ? 'exclusiveMaximum' : 'exclusiveMinimum',\n    $schemaExcl = it.schema[$exclusiveKeyword],\n    $isDataExcl = it.opts.$data && $schemaExcl && $schemaExcl.$data,\n    $op = $isMax ? '<' : '>',\n    $notOp = $isMax ? '>' : '<',\n    $errorKeyword = undefined;\n  if ($isDataExcl) {\n    var $schemaValueExcl = it.util.getData($schemaExcl.$data, $dataLvl, it.dataPathArr),\n      $exclusive = 'exclusive' + $lvl,\n      $exclType = 'exclType' + $lvl,\n      $exclIsNumber = 'exclIsNumber' + $lvl,\n      $opExpr = 'op' + $lvl,\n      $opStr = '\\' + ' + $opExpr + ' + \\'';\n    out += ' var schemaExcl' + ($lvl) + ' = ' + ($schemaValueExcl) + '; ';\n    $schemaValueExcl = 'schemaExcl' + $lvl;\n    out += ' var ' + ($exclusive) + '; var ' + ($exclType) + ' = typeof ' + ($schemaValueExcl) + '; if (' + ($exclType) + ' != \\'boolean\\' && ' + ($exclType) + ' != \\'undefined\\' && ' + ($exclType) + ' != \\'number\\') { ';\n    var $errorKeyword = $exclusiveKeyword;\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = ''; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ($errorKeyword || '_exclusiveLimit') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'' + ($exclusiveKeyword) + ' should be boolean\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    var __err = out;\n    out = $$outStack.pop();\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError([' + (__err) + ']); ';\n      } else {\n        out += ' validate.errors = [' + (__err) + ']; return false; ';\n      }\n    } else {\n      out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    }\n    out += ' } else if ( ';\n    if ($isData) {\n      out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n    }\n    out += ' ' + ($exclType) + ' == \\'number\\' ? ( (' + ($exclusive) + ' = ' + ($schemaValue) + ' === undefined || ' + ($schemaValueExcl) + ' ' + ($op) + '= ' + ($schemaValue) + ') ? ' + ($data) + ' ' + ($notOp) + '= ' + ($schemaValueExcl) + ' : ' + ($data) + ' ' + ($notOp) + ' ' + ($schemaValue) + ' ) : ( (' + ($exclusive) + ' = ' + ($schemaValueExcl) + ' === true) ? ' + ($data) + ' ' + ($notOp) + '= ' + ($schemaValue) + ' : ' + ($data) + ' ' + ($notOp) + ' ' + ($schemaValue) + ' ) || ' + ($data) + ' !== ' + ($data) + ') { var op' + ($lvl) + ' = ' + ($exclusive) + ' ? \\'' + ($op) + '\\' : \\'' + ($op) + '=\\'; ';\n    if ($schema === undefined) {\n      $errorKeyword = $exclusiveKeyword;\n      $errSchemaPath = it.errSchemaPath + '/' + $exclusiveKeyword;\n      $schemaValue = $schemaValueExcl;\n      $isData = $isDataExcl;\n    }\n  } else {\n    var $exclIsNumber = typeof $schemaExcl == 'number',\n      $opStr = $op;\n    if ($exclIsNumber && $isData) {\n      var $opExpr = '\\'' + $opStr + '\\'';\n      out += ' if ( ';\n      if ($isData) {\n        out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n      }\n      out += ' ( ' + ($schemaValue) + ' === undefined || ' + ($schemaExcl) + ' ' + ($op) + '= ' + ($schemaValue) + ' ? ' + ($data) + ' ' + ($notOp) + '= ' + ($schemaExcl) + ' : ' + ($data) + ' ' + ($notOp) + ' ' + ($schemaValue) + ' ) || ' + ($data) + ' !== ' + ($data) + ') { ';\n    } else {\n      if ($exclIsNumber && $schema === undefined) {\n        $exclusive = true;\n        $errorKeyword = $exclusiveKeyword;\n        $errSchemaPath = it.errSchemaPath + '/' + $exclusiveKeyword;\n        $schemaValue = $schemaExcl;\n        $notOp += '=';\n      } else {\n        if ($exclIsNumber) $schemaValue = Math[$isMax ? 'min' : 'max']($schemaExcl, $schema);\n        if ($schemaExcl === ($exclIsNumber ? $schemaValue : true)) {\n          $exclusive = true;\n          $errorKeyword = $exclusiveKeyword;\n          $errSchemaPath = it.errSchemaPath + '/' + $exclusiveKeyword;\n          $notOp += '=';\n        } else {\n          $exclusive = false;\n          $opStr += '=';\n        }\n      }\n      var $opExpr = '\\'' + $opStr + '\\'';\n      out += ' if ( ';\n      if ($isData) {\n        out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n      }\n      out += ' ' + ($data) + ' ' + ($notOp) + ' ' + ($schemaValue) + ' || ' + ($data) + ' !== ' + ($data) + ') { ';\n    }\n  }\n  $errorKeyword = $errorKeyword || $keyword;\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ($errorKeyword || '_limit') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { comparison: ' + ($opExpr) + ', limit: ' + ($schemaValue) + ', exclusive: ' + ($exclusive) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should be ' + ($opStr) + ' ';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue);\n      } else {\n        out += '' + ($schemaValue) + '\\'';\n      }\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + ($schema);\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += ' } ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate__limitItems(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $errorKeyword;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $op = $keyword == 'maxItems' ? '>' : '<';\n  out += 'if ( ';\n  if ($isData) {\n    out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n  }\n  out += ' ' + ($data) + '.length ' + ($op) + ' ' + ($schemaValue) + ') { ';\n  var $errorKeyword = $keyword;\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ($errorKeyword || '_limitItems') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { limit: ' + ($schemaValue) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should NOT have ';\n      if ($keyword == 'maxItems') {\n        out += 'more';\n      } else {\n        out += 'fewer';\n      }\n      out += ' than ';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue) + ' + \\'';\n      } else {\n        out += '' + ($schema);\n      }\n      out += ' items\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + ($schema);\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += '} ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate__limitLength(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $errorKeyword;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $op = $keyword == 'maxLength' ? '>' : '<';\n  out += 'if ( ';\n  if ($isData) {\n    out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n  }\n  if (it.opts.unicode === false) {\n    out += ' ' + ($data) + '.length ';\n  } else {\n    out += ' ucs2length(' + ($data) + ') ';\n  }\n  out += ' ' + ($op) + ' ' + ($schemaValue) + ') { ';\n  var $errorKeyword = $keyword;\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ($errorKeyword || '_limitLength') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { limit: ' + ($schemaValue) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should NOT be ';\n      if ($keyword == 'maxLength') {\n        out += 'longer';\n      } else {\n        out += 'shorter';\n      }\n      out += ' than ';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue) + ' + \\'';\n      } else {\n        out += '' + ($schema);\n      }\n      out += ' characters\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + ($schema);\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += '} ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate__limitProperties(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $errorKeyword;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $op = $keyword == 'maxProperties' ? '>' : '<';\n  out += 'if ( ';\n  if ($isData) {\n    out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'number\\') || ';\n  }\n  out += ' Object.keys(' + ($data) + ').length ' + ($op) + ' ' + ($schemaValue) + ') { ';\n  var $errorKeyword = $keyword;\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ($errorKeyword || '_limitProperties') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { limit: ' + ($schemaValue) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should NOT have ';\n      if ($keyword == 'maxProperties') {\n        out += 'more';\n      } else {\n        out += 'fewer';\n      }\n      out += ' than ';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue) + ' + \\'';\n      } else {\n        out += '' + ($schema);\n      }\n      out += ' properties\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + ($schema);\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += '} ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_allOf(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $currentBaseId = $it.baseId,\n    $allSchemasEmpty = true;\n  var arr1 = $schema;\n  if (arr1) {\n    var $sch, $i = -1,\n      l1 = arr1.length - 1;\n    while ($i < l1) {\n      $sch = arr1[$i += 1];\n      if (it.util.schemaHasRules($sch, it.RULES.all)) {\n        $allSchemasEmpty = false;\n        $it.schema = $sch;\n        $it.schemaPath = $schemaPath + '[' + $i + ']';\n        $it.errSchemaPath = $errSchemaPath + '/' + $i;\n        out += '  ' + (it.validate($it)) + ' ';\n        $it.baseId = $currentBaseId;\n        if ($breakOnError) {\n          out += ' if (' + ($nextValid) + ') { ';\n          $closingBraces += '}';\n        }\n      }\n    }\n  }\n  if ($breakOnError) {\n    if ($allSchemasEmpty) {\n      out += ' if (true) { ';\n    } else {\n      out += ' ' + ($closingBraces.slice(0, -1)) + ' ';\n    }\n  }\n  out = it.util.cleanUpCode(out);\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_anyOf(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $noEmptySchema = $schema.every(function($sch) {\n    return it.util.schemaHasRules($sch, it.RULES.all);\n  });\n  if ($noEmptySchema) {\n    var $currentBaseId = $it.baseId;\n    out += ' var ' + ($errs) + ' = errors; var ' + ($valid) + ' = false;  ';\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    var arr1 = $schema;\n    if (arr1) {\n      var $sch, $i = -1,\n        l1 = arr1.length - 1;\n      while ($i < l1) {\n        $sch = arr1[$i += 1];\n        $it.schema = $sch;\n        $it.schemaPath = $schemaPath + '[' + $i + ']';\n        $it.errSchemaPath = $errSchemaPath + '/' + $i;\n        out += '  ' + (it.validate($it)) + ' ';\n        $it.baseId = $currentBaseId;\n        out += ' ' + ($valid) + ' = ' + ($valid) + ' || ' + ($nextValid) + '; if (!' + ($valid) + ') { ';\n        $closingBraces += '}';\n      }\n    }\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    out += ' ' + ($closingBraces) + ' if (!' + ($valid) + ') {   var err =   '; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('anyOf') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should match some schema in anyOf\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError(vErrors); ';\n      } else {\n        out += ' validate.errors = vErrors; return false; ';\n      }\n    }\n    out += ' } else {  errors = ' + ($errs) + '; if (vErrors !== null) { if (' + ($errs) + ') vErrors.length = ' + ($errs) + '; else vErrors = null; } ';\n    if (it.opts.allErrors) {\n      out += ' } ';\n    }\n    out = it.util.cleanUpCode(out);\n  } else {\n    if ($breakOnError) {\n      out += ' if (true) { ';\n    }\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_comment(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $schema = it.schema[$keyword];\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $comment = it.util.toQuotedString($schema);\n  if (it.opts.$comment === true) {\n    out += ' console.log(' + ($comment) + ');';\n  } else if (typeof it.opts.$comment == 'function') {\n    out += ' self._opts.$comment(' + ($comment) + ', ' + (it.util.toQuotedString($errSchemaPath)) + ', validate.root.schema);';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_const(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  if (!$isData) {\n    out += ' var schema' + ($lvl) + ' = validate.schema' + ($schemaPath) + ';';\n  }\n  out += 'var ' + ($valid) + ' = equal(' + ($data) + ', schema' + ($lvl) + '); if (!' + ($valid) + ') {   ';\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('const') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { allowedValue: schema' + ($lvl) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should be equal to constant\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += ' }';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_contains(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $idx = 'i' + $lvl,\n    $dataNxt = $it.dataLevel = it.dataLevel + 1,\n    $nextData = 'data' + $dataNxt,\n    $currentBaseId = it.baseId,\n    $nonEmptySchema = it.util.schemaHasRules($schema, it.RULES.all);\n  out += 'var ' + ($errs) + ' = errors;var ' + ($valid) + ';';\n  if ($nonEmptySchema) {\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    $it.schema = $schema;\n    $it.schemaPath = $schemaPath;\n    $it.errSchemaPath = $errSchemaPath;\n    out += ' var ' + ($nextValid) + ' = false; for (var ' + ($idx) + ' = 0; ' + ($idx) + ' < ' + ($data) + '.length; ' + ($idx) + '++) { ';\n    $it.errorPath = it.util.getPathExpr(it.errorPath, $idx, it.opts.jsonPointers, true);\n    var $passData = $data + '[' + $idx + ']';\n    $it.dataPathArr[$dataNxt] = $idx;\n    var $code = it.validate($it);\n    $it.baseId = $currentBaseId;\n    if (it.util.varOccurences($code, $nextData) < 2) {\n      out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n    } else {\n      out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n    }\n    out += ' if (' + ($nextValid) + ') break; }  ';\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    out += ' ' + ($closingBraces) + ' if (!' + ($nextValid) + ') {';\n  } else {\n    out += ' if (' + ($data) + '.length == 0) {';\n  }\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('contains') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should contain a valid item\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += ' } else { ';\n  if ($nonEmptySchema) {\n    out += '  errors = ' + ($errs) + '; if (vErrors !== null) { if (' + ($errs) + ') vErrors.length = ' + ($errs) + '; else vErrors = null; } ';\n  }\n  if (it.opts.allErrors) {\n    out += ' } ';\n  }\n  out = it.util.cleanUpCode(out);\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_custom(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $errorKeyword;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $rule = this,\n    $definition = 'definition' + $lvl,\n    $rDef = $rule.definition,\n    $closingBraces = '';\n  var $compile, $inline, $macro, $ruleValidate, $validateCode;\n  if ($isData && $rDef.$data) {\n    $validateCode = 'keywordValidate' + $lvl;\n    var $validateSchema = $rDef.validateSchema;\n    out += ' var ' + ($definition) + ' = RULES.custom[\\'' + ($keyword) + '\\'].definition; var ' + ($validateCode) + ' = ' + ($definition) + '.validate;';\n  } else {\n    $ruleValidate = it.useCustomRule($rule, $schema, it.schema, it);\n    if (!$ruleValidate) return;\n    $schemaValue = 'validate.schema' + $schemaPath;\n    $validateCode = $ruleValidate.code;\n    $compile = $rDef.compile;\n    $inline = $rDef.inline;\n    $macro = $rDef.macro;\n  }\n  var $ruleErrs = $validateCode + '.errors',\n    $i = 'i' + $lvl,\n    $ruleErr = 'ruleErr' + $lvl,\n    $asyncKeyword = $rDef.async;\n  if ($asyncKeyword && !it.async) throw new Error('async keyword in sync schema');\n  if (!($inline || $macro)) {\n    out += '' + ($ruleErrs) + ' = null;';\n  }\n  out += 'var ' + ($errs) + ' = errors;var ' + ($valid) + ';';\n  if ($isData && $rDef.$data) {\n    $closingBraces += '}';\n    out += ' if (' + ($schemaValue) + ' === undefined) { ' + ($valid) + ' = true; } else { ';\n    if ($validateSchema) {\n      $closingBraces += '}';\n      out += ' ' + ($valid) + ' = ' + ($definition) + '.validateSchema(' + ($schemaValue) + '); if (' + ($valid) + ') { ';\n    }\n  }\n  if ($inline) {\n    if ($rDef.statements) {\n      out += ' ' + ($ruleValidate.validate) + ' ';\n    } else {\n      out += ' ' + ($valid) + ' = ' + ($ruleValidate.validate) + '; ';\n    }\n  } else if ($macro) {\n    var $it = it.util.copy(it);\n    var $closingBraces = '';\n    $it.level++;\n    var $nextValid = 'valid' + $it.level;\n    $it.schema = $ruleValidate.validate;\n    $it.schemaPath = '';\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    var $code = it.validate($it).replace(/validate\\.schema/g, $validateCode);\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    out += ' ' + ($code);\n  } else {\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = '';\n    out += '  ' + ($validateCode) + '.call( ';\n    if (it.opts.passContext) {\n      out += 'this';\n    } else {\n      out += 'self';\n    }\n    if ($compile || $rDef.schema === false) {\n      out += ' , ' + ($data) + ' ';\n    } else {\n      out += ' , ' + ($schemaValue) + ' , ' + ($data) + ' , validate.schema' + (it.schemaPath) + ' ';\n    }\n    out += ' , (dataPath || \\'\\')';\n    if (it.errorPath != '\"\"') {\n      out += ' + ' + (it.errorPath);\n    }\n    var $parentData = $dataLvl ? 'data' + (($dataLvl - 1) || '') : 'parentData',\n      $parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : 'parentDataProperty';\n    out += ' , ' + ($parentData) + ' , ' + ($parentDataProperty) + ' , rootData )  ';\n    var def_callRuleValidate = out;\n    out = $$outStack.pop();\n    if ($rDef.errors === false) {\n      out += ' ' + ($valid) + ' = ';\n      if ($asyncKeyword) {\n        out += 'await ';\n      }\n      out += '' + (def_callRuleValidate) + '; ';\n    } else {\n      if ($asyncKeyword) {\n        $ruleErrs = 'customErrors' + $lvl;\n        out += ' var ' + ($ruleErrs) + ' = null; try { ' + ($valid) + ' = await ' + (def_callRuleValidate) + '; } catch (e) { ' + ($valid) + ' = false; if (e instanceof ValidationError) ' + ($ruleErrs) + ' = e.errors; else throw e; } ';\n      } else {\n        out += ' ' + ($ruleErrs) + ' = null; ' + ($valid) + ' = ' + (def_callRuleValidate) + '; ';\n      }\n    }\n  }\n  if ($rDef.modifying) {\n    out += ' if (' + ($parentData) + ') ' + ($data) + ' = ' + ($parentData) + '[' + ($parentDataProperty) + '];';\n  }\n  out += '' + ($closingBraces);\n  if ($rDef.valid) {\n    if ($breakOnError) {\n      out += ' if (true) { ';\n    }\n  } else {\n    out += ' if ( ';\n    if ($rDef.valid === undefined) {\n      out += ' !';\n      if ($macro) {\n        out += '' + ($nextValid);\n      } else {\n        out += '' + ($valid);\n      }\n    } else {\n      out += ' ' + (!$rDef.valid) + ' ';\n    }\n    out += ') { ';\n    $errorKeyword = $rule.keyword;\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = '';\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = ''; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ($errorKeyword || 'custom') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { keyword: \\'' + ($rule.keyword) + '\\' } ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should pass \"' + ($rule.keyword) + '\" keyword validation\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    var __err = out;\n    out = $$outStack.pop();\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError([' + (__err) + ']); ';\n      } else {\n        out += ' validate.errors = [' + (__err) + ']; return false; ';\n      }\n    } else {\n      out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    }\n    var def_customError = out;\n    out = $$outStack.pop();\n    if ($inline) {\n      if ($rDef.errors) {\n        if ($rDef.errors != 'full') {\n          out += '  for (var ' + ($i) + '=' + ($errs) + '; ' + ($i) + '<errors; ' + ($i) + '++) { var ' + ($ruleErr) + ' = vErrors[' + ($i) + ']; if (' + ($ruleErr) + '.dataPath === undefined) ' + ($ruleErr) + '.dataPath = (dataPath || \\'\\') + ' + (it.errorPath) + '; if (' + ($ruleErr) + '.schemaPath === undefined) { ' + ($ruleErr) + '.schemaPath = \"' + ($errSchemaPath) + '\"; } ';\n          if (it.opts.verbose) {\n            out += ' ' + ($ruleErr) + '.schema = ' + ($schemaValue) + '; ' + ($ruleErr) + '.data = ' + ($data) + '; ';\n          }\n          out += ' } ';\n        }\n      } else {\n        if ($rDef.errors === false) {\n          out += ' ' + (def_customError) + ' ';\n        } else {\n          out += ' if (' + ($errs) + ' == errors) { ' + (def_customError) + ' } else {  for (var ' + ($i) + '=' + ($errs) + '; ' + ($i) + '<errors; ' + ($i) + '++) { var ' + ($ruleErr) + ' = vErrors[' + ($i) + ']; if (' + ($ruleErr) + '.dataPath === undefined) ' + ($ruleErr) + '.dataPath = (dataPath || \\'\\') + ' + (it.errorPath) + '; if (' + ($ruleErr) + '.schemaPath === undefined) { ' + ($ruleErr) + '.schemaPath = \"' + ($errSchemaPath) + '\"; } ';\n          if (it.opts.verbose) {\n            out += ' ' + ($ruleErr) + '.schema = ' + ($schemaValue) + '; ' + ($ruleErr) + '.data = ' + ($data) + '; ';\n          }\n          out += ' } } ';\n        }\n      }\n    } else if ($macro) {\n      out += '   var err =   '; /* istanbul ignore else */\n      if (it.createErrors !== false) {\n        out += ' { keyword: \\'' + ($errorKeyword || 'custom') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { keyword: \\'' + ($rule.keyword) + '\\' } ';\n        if (it.opts.messages !== false) {\n          out += ' , message: \\'should pass \"' + ($rule.keyword) + '\" keyword validation\\' ';\n        }\n        if (it.opts.verbose) {\n          out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n        }\n        out += ' } ';\n      } else {\n        out += ' {} ';\n      }\n      out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n      if (!it.compositeRule && $breakOnError) {\n        /* istanbul ignore if */\n        if (it.async) {\n          out += ' throw new ValidationError(vErrors); ';\n        } else {\n          out += ' validate.errors = vErrors; return false; ';\n        }\n      }\n    } else {\n      if ($rDef.errors === false) {\n        out += ' ' + (def_customError) + ' ';\n      } else {\n        out += ' if (Array.isArray(' + ($ruleErrs) + ')) { if (vErrors === null) vErrors = ' + ($ruleErrs) + '; else vErrors = vErrors.concat(' + ($ruleErrs) + '); errors = vErrors.length;  for (var ' + ($i) + '=' + ($errs) + '; ' + ($i) + '<errors; ' + ($i) + '++) { var ' + ($ruleErr) + ' = vErrors[' + ($i) + ']; if (' + ($ruleErr) + '.dataPath === undefined) ' + ($ruleErr) + '.dataPath = (dataPath || \\'\\') + ' + (it.errorPath) + ';  ' + ($ruleErr) + '.schemaPath = \"' + ($errSchemaPath) + '\";  ';\n        if (it.opts.verbose) {\n          out += ' ' + ($ruleErr) + '.schema = ' + ($schemaValue) + '; ' + ($ruleErr) + '.data = ' + ($data) + '; ';\n        }\n        out += ' } } else { ' + (def_customError) + ' } ';\n      }\n    }\n    out += ' } ';\n    if ($breakOnError) {\n      out += ' else { ';\n    }\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_dependencies(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $schemaDeps = {},\n    $propertyDeps = {},\n    $ownProperties = it.opts.ownProperties;\n  for ($property in $schema) {\n    var $sch = $schema[$property];\n    var $deps = Array.isArray($sch) ? $propertyDeps : $schemaDeps;\n    $deps[$property] = $sch;\n  }\n  out += 'var ' + ($errs) + ' = errors;';\n  var $currentErrorPath = it.errorPath;\n  out += 'var missing' + ($lvl) + ';';\n  for (var $property in $propertyDeps) {\n    $deps = $propertyDeps[$property];\n    if ($deps.length) {\n      out += ' if ( ' + ($data) + (it.util.getProperty($property)) + ' !== undefined ';\n      if ($ownProperties) {\n        out += ' && Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($property)) + '\\') ';\n      }\n      if ($breakOnError) {\n        out += ' && ( ';\n        var arr1 = $deps;\n        if (arr1) {\n          var $propertyKey, $i = -1,\n            l1 = arr1.length - 1;\n          while ($i < l1) {\n            $propertyKey = arr1[$i += 1];\n            if ($i) {\n              out += ' || ';\n            }\n            var $prop = it.util.getProperty($propertyKey),\n              $useData = $data + $prop;\n            out += ' ( ( ' + ($useData) + ' === undefined ';\n            if ($ownProperties) {\n              out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n            }\n            out += ') && (missing' + ($lvl) + ' = ' + (it.util.toQuotedString(it.opts.jsonPointers ? $propertyKey : $prop)) + ') ) ';\n          }\n        }\n        out += ')) {  ';\n        var $propertyPath = 'missing' + $lvl,\n          $missingProperty = '\\' + ' + $propertyPath + ' + \\'';\n        if (it.opts._errorDataPathProperty) {\n          it.errorPath = it.opts.jsonPointers ? it.util.getPathExpr($currentErrorPath, $propertyPath, true) : $currentErrorPath + ' + ' + $propertyPath;\n        }\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ('dependencies') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { property: \\'' + (it.util.escapeQuotes($property)) + '\\', missingProperty: \\'' + ($missingProperty) + '\\', depsCount: ' + ($deps.length) + ', deps: \\'' + (it.util.escapeQuotes($deps.length == 1 ? $deps[0] : $deps.join(\", \"))) + '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'should have ';\n            if ($deps.length == 1) {\n              out += 'property ' + (it.util.escapeQuotes($deps[0]));\n            } else {\n              out += 'properties ' + (it.util.escapeQuotes($deps.join(\", \")));\n            }\n            out += ' when property ' + (it.util.escapeQuotes($property)) + ' is present\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n      } else {\n        out += ' ) { ';\n        var arr2 = $deps;\n        if (arr2) {\n          var $propertyKey, i2 = -1,\n            l2 = arr2.length - 1;\n          while (i2 < l2) {\n            $propertyKey = arr2[i2 += 1];\n            var $prop = it.util.getProperty($propertyKey),\n              $missingProperty = it.util.escapeQuotes($propertyKey),\n              $useData = $data + $prop;\n            if (it.opts._errorDataPathProperty) {\n              it.errorPath = it.util.getPath($currentErrorPath, $propertyKey, it.opts.jsonPointers);\n            }\n            out += ' if ( ' + ($useData) + ' === undefined ';\n            if ($ownProperties) {\n              out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n            }\n            out += ') {  var err =   '; /* istanbul ignore else */\n            if (it.createErrors !== false) {\n              out += ' { keyword: \\'' + ('dependencies') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { property: \\'' + (it.util.escapeQuotes($property)) + '\\', missingProperty: \\'' + ($missingProperty) + '\\', depsCount: ' + ($deps.length) + ', deps: \\'' + (it.util.escapeQuotes($deps.length == 1 ? $deps[0] : $deps.join(\", \"))) + '\\' } ';\n              if (it.opts.messages !== false) {\n                out += ' , message: \\'should have ';\n                if ($deps.length == 1) {\n                  out += 'property ' + (it.util.escapeQuotes($deps[0]));\n                } else {\n                  out += 'properties ' + (it.util.escapeQuotes($deps.join(\", \")));\n                }\n                out += ' when property ' + (it.util.escapeQuotes($property)) + ' is present\\' ';\n              }\n              if (it.opts.verbose) {\n                out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n              }\n              out += ' } ';\n            } else {\n              out += ' {} ';\n            }\n            out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } ';\n          }\n        }\n      }\n      out += ' }   ';\n      if ($breakOnError) {\n        $closingBraces += '}';\n        out += ' else { ';\n      }\n    }\n  }\n  it.errorPath = $currentErrorPath;\n  var $currentBaseId = $it.baseId;\n  for (var $property in $schemaDeps) {\n    var $sch = $schemaDeps[$property];\n    if (it.util.schemaHasRules($sch, it.RULES.all)) {\n      out += ' ' + ($nextValid) + ' = true; if ( ' + ($data) + (it.util.getProperty($property)) + ' !== undefined ';\n      if ($ownProperties) {\n        out += ' && Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($property)) + '\\') ';\n      }\n      out += ') { ';\n      $it.schema = $sch;\n      $it.schemaPath = $schemaPath + it.util.getProperty($property);\n      $it.errSchemaPath = $errSchemaPath + '/' + it.util.escapeFragment($property);\n      out += '  ' + (it.validate($it)) + ' ';\n      $it.baseId = $currentBaseId;\n      out += ' }  ';\n      if ($breakOnError) {\n        out += ' if (' + ($nextValid) + ') { ';\n        $closingBraces += '}';\n      }\n    }\n  }\n  if ($breakOnError) {\n    out += '   ' + ($closingBraces) + ' if (' + ($errs) + ' == errors) {';\n  }\n  out = it.util.cleanUpCode(out);\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_enum(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $i = 'i' + $lvl,\n    $vSchema = 'schema' + $lvl;\n  if (!$isData) {\n    out += ' var ' + ($vSchema) + ' = validate.schema' + ($schemaPath) + ';';\n  }\n  out += 'var ' + ($valid) + ';';\n  if ($isData) {\n    out += ' if (schema' + ($lvl) + ' === undefined) ' + ($valid) + ' = true; else if (!Array.isArray(schema' + ($lvl) + ')) ' + ($valid) + ' = false; else {';\n  }\n  out += '' + ($valid) + ' = false;for (var ' + ($i) + '=0; ' + ($i) + '<' + ($vSchema) + '.length; ' + ($i) + '++) if (equal(' + ($data) + ', ' + ($vSchema) + '[' + ($i) + '])) { ' + ($valid) + ' = true; break; }';\n  if ($isData) {\n    out += '  }  ';\n  }\n  out += ' if (!' + ($valid) + ') {   ';\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('enum') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { allowedValues: schema' + ($lvl) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should be equal to one of the allowed values\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += ' }';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_format(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  if (it.opts.format === false) {\n    if ($breakOnError) {\n      out += ' if (true) { ';\n    }\n    return out;\n  }\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $unknownFormats = it.opts.unknownFormats,\n    $allowUnknown = Array.isArray($unknownFormats);\n  if ($isData) {\n    var $format = 'format' + $lvl,\n      $isObject = 'isObject' + $lvl,\n      $formatType = 'formatType' + $lvl;\n    out += ' var ' + ($format) + ' = formats[' + ($schemaValue) + ']; var ' + ($isObject) + ' = typeof ' + ($format) + ' == \\'object\\' && !(' + ($format) + ' instanceof RegExp) && ' + ($format) + '.validate; var ' + ($formatType) + ' = ' + ($isObject) + ' && ' + ($format) + '.type || \\'string\\'; if (' + ($isObject) + ') { ';\n    if (it.async) {\n      out += ' var async' + ($lvl) + ' = ' + ($format) + '.async; ';\n    }\n    out += ' ' + ($format) + ' = ' + ($format) + '.validate; } if (  ';\n    if ($isData) {\n      out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'string\\') || ';\n    }\n    out += ' (';\n    if ($unknownFormats != 'ignore') {\n      out += ' (' + ($schemaValue) + ' && !' + ($format) + ' ';\n      if ($allowUnknown) {\n        out += ' && self._opts.unknownFormats.indexOf(' + ($schemaValue) + ') == -1 ';\n      }\n      out += ') || ';\n    }\n    out += ' (' + ($format) + ' && ' + ($formatType) + ' == \\'' + ($ruleType) + '\\' && !(typeof ' + ($format) + ' == \\'function\\' ? ';\n    if (it.async) {\n      out += ' (async' + ($lvl) + ' ? await ' + ($format) + '(' + ($data) + ') : ' + ($format) + '(' + ($data) + ')) ';\n    } else {\n      out += ' ' + ($format) + '(' + ($data) + ') ';\n    }\n    out += ' : ' + ($format) + '.test(' + ($data) + '))))) {';\n  } else {\n    var $format = it.formats[$schema];\n    if (!$format) {\n      if ($unknownFormats == 'ignore') {\n        it.logger.warn('unknown format \"' + $schema + '\" ignored in schema at path \"' + it.errSchemaPath + '\"');\n        if ($breakOnError) {\n          out += ' if (true) { ';\n        }\n        return out;\n      } else if ($allowUnknown && $unknownFormats.indexOf($schema) >= 0) {\n        if ($breakOnError) {\n          out += ' if (true) { ';\n        }\n        return out;\n      } else {\n        throw new Error('unknown format \"' + $schema + '\" is used in schema at path \"' + it.errSchemaPath + '\"');\n      }\n    }\n    var $isObject = typeof $format == 'object' && !($format instanceof RegExp) && $format.validate;\n    var $formatType = $isObject && $format.type || 'string';\n    if ($isObject) {\n      var $async = $format.async === true;\n      $format = $format.validate;\n    }\n    if ($formatType != $ruleType) {\n      if ($breakOnError) {\n        out += ' if (true) { ';\n      }\n      return out;\n    }\n    if ($async) {\n      if (!it.async) throw new Error('async format in sync schema');\n      var $formatRef = 'formats' + it.util.getProperty($schema) + '.validate';\n      out += ' if (!(await ' + ($formatRef) + '(' + ($data) + '))) { ';\n    } else {\n      out += ' if (! ';\n      var $formatRef = 'formats' + it.util.getProperty($schema);\n      if ($isObject) $formatRef += '.validate';\n      if (typeof $format == 'function') {\n        out += ' ' + ($formatRef) + '(' + ($data) + ') ';\n      } else {\n        out += ' ' + ($formatRef) + '.test(' + ($data) + ') ';\n      }\n      out += ') { ';\n    }\n  }\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('format') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { format:  ';\n    if ($isData) {\n      out += '' + ($schemaValue);\n    } else {\n      out += '' + (it.util.toQuotedString($schema));\n    }\n    out += '  } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should match format \"';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue) + ' + \\'';\n      } else {\n        out += '' + (it.util.escapeQuotes($schema));\n      }\n      out += '\"\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + (it.util.toQuotedString($schema));\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += ' } ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_if(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $thenSch = it.schema['then'],\n    $elseSch = it.schema['else'],\n    $thenPresent = $thenSch !== undefined && it.util.schemaHasRules($thenSch, it.RULES.all),\n    $elsePresent = $elseSch !== undefined && it.util.schemaHasRules($elseSch, it.RULES.all),\n    $currentBaseId = $it.baseId;\n  if ($thenPresent || $elsePresent) {\n    var $ifClause;\n    $it.createErrors = false;\n    $it.schema = $schema;\n    $it.schemaPath = $schemaPath;\n    $it.errSchemaPath = $errSchemaPath;\n    out += ' var ' + ($errs) + ' = errors; var ' + ($valid) + ' = true;  ';\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    out += '  ' + (it.validate($it)) + ' ';\n    $it.baseId = $currentBaseId;\n    $it.createErrors = true;\n    out += '  errors = ' + ($errs) + '; if (vErrors !== null) { if (' + ($errs) + ') vErrors.length = ' + ($errs) + '; else vErrors = null; }  ';\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    if ($thenPresent) {\n      out += ' if (' + ($nextValid) + ') {  ';\n      $it.schema = it.schema['then'];\n      $it.schemaPath = it.schemaPath + '.then';\n      $it.errSchemaPath = it.errSchemaPath + '/then';\n      out += '  ' + (it.validate($it)) + ' ';\n      $it.baseId = $currentBaseId;\n      out += ' ' + ($valid) + ' = ' + ($nextValid) + '; ';\n      if ($thenPresent && $elsePresent) {\n        $ifClause = 'ifClause' + $lvl;\n        out += ' var ' + ($ifClause) + ' = \\'then\\'; ';\n      } else {\n        $ifClause = '\\'then\\'';\n      }\n      out += ' } ';\n      if ($elsePresent) {\n        out += ' else { ';\n      }\n    } else {\n      out += ' if (!' + ($nextValid) + ') { ';\n    }\n    if ($elsePresent) {\n      $it.schema = it.schema['else'];\n      $it.schemaPath = it.schemaPath + '.else';\n      $it.errSchemaPath = it.errSchemaPath + '/else';\n      out += '  ' + (it.validate($it)) + ' ';\n      $it.baseId = $currentBaseId;\n      out += ' ' + ($valid) + ' = ' + ($nextValid) + '; ';\n      if ($thenPresent && $elsePresent) {\n        $ifClause = 'ifClause' + $lvl;\n        out += ' var ' + ($ifClause) + ' = \\'else\\'; ';\n      } else {\n        $ifClause = '\\'else\\'';\n      }\n      out += ' } ';\n    }\n    out += ' if (!' + ($valid) + ') {   var err =   '; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('if') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { failingKeyword: ' + ($ifClause) + ' } ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should match \"\\' + ' + ($ifClause) + ' + \\'\" schema\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError(vErrors); ';\n      } else {\n        out += ' validate.errors = vErrors; return false; ';\n      }\n    }\n    out += ' }   ';\n    if ($breakOnError) {\n      out += ' else { ';\n    }\n    out = it.util.cleanUpCode(out);\n  } else {\n    if ($breakOnError) {\n      out += ' if (true) { ';\n    }\n  }\n  return out;\n}\n","'use strict';\n\n//all requires must be explicit because browserify won't work with dynamic requires\nmodule.exports = {\n  '$ref': require('./ref'),\n  allOf: require('./allOf'),\n  anyOf: require('./anyOf'),\n  '$comment': require('./comment'),\n  const: require('./const'),\n  contains: require('./contains'),\n  dependencies: require('./dependencies'),\n  'enum': require('./enum'),\n  format: require('./format'),\n  'if': require('./if'),\n  items: require('./items'),\n  maximum: require('./_limit'),\n  minimum: require('./_limit'),\n  maxItems: require('./_limitItems'),\n  minItems: require('./_limitItems'),\n  maxLength: require('./_limitLength'),\n  minLength: require('./_limitLength'),\n  maxProperties: require('./_limitProperties'),\n  minProperties: require('./_limitProperties'),\n  multipleOf: require('./multipleOf'),\n  not: require('./not'),\n  oneOf: require('./oneOf'),\n  pattern: require('./pattern'),\n  properties: require('./properties'),\n  propertyNames: require('./propertyNames'),\n  required: require('./required'),\n  uniqueItems: require('./uniqueItems'),\n  validate: require('./validate')\n};\n","'use strict';\nmodule.exports = function generate_items(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $idx = 'i' + $lvl,\n    $dataNxt = $it.dataLevel = it.dataLevel + 1,\n    $nextData = 'data' + $dataNxt,\n    $currentBaseId = it.baseId;\n  out += 'var ' + ($errs) + ' = errors;var ' + ($valid) + ';';\n  if (Array.isArray($schema)) {\n    var $additionalItems = it.schema.additionalItems;\n    if ($additionalItems === false) {\n      out += ' ' + ($valid) + ' = ' + ($data) + '.length <= ' + ($schema.length) + '; ';\n      var $currErrSchemaPath = $errSchemaPath;\n      $errSchemaPath = it.errSchemaPath + '/additionalItems';\n      out += '  if (!' + ($valid) + ') {   ';\n      var $$outStack = $$outStack || [];\n      $$outStack.push(out);\n      out = ''; /* istanbul ignore else */\n      if (it.createErrors !== false) {\n        out += ' { keyword: \\'' + ('additionalItems') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { limit: ' + ($schema.length) + ' } ';\n        if (it.opts.messages !== false) {\n          out += ' , message: \\'should NOT have more than ' + ($schema.length) + ' items\\' ';\n        }\n        if (it.opts.verbose) {\n          out += ' , schema: false , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n        }\n        out += ' } ';\n      } else {\n        out += ' {} ';\n      }\n      var __err = out;\n      out = $$outStack.pop();\n      if (!it.compositeRule && $breakOnError) {\n        /* istanbul ignore if */\n        if (it.async) {\n          out += ' throw new ValidationError([' + (__err) + ']); ';\n        } else {\n          out += ' validate.errors = [' + (__err) + ']; return false; ';\n        }\n      } else {\n        out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n      }\n      out += ' } ';\n      $errSchemaPath = $currErrSchemaPath;\n      if ($breakOnError) {\n        $closingBraces += '}';\n        out += ' else { ';\n      }\n    }\n    var arr1 = $schema;\n    if (arr1) {\n      var $sch, $i = -1,\n        l1 = arr1.length - 1;\n      while ($i < l1) {\n        $sch = arr1[$i += 1];\n        if (it.util.schemaHasRules($sch, it.RULES.all)) {\n          out += ' ' + ($nextValid) + ' = true; if (' + ($data) + '.length > ' + ($i) + ') { ';\n          var $passData = $data + '[' + $i + ']';\n          $it.schema = $sch;\n          $it.schemaPath = $schemaPath + '[' + $i + ']';\n          $it.errSchemaPath = $errSchemaPath + '/' + $i;\n          $it.errorPath = it.util.getPathExpr(it.errorPath, $i, it.opts.jsonPointers, true);\n          $it.dataPathArr[$dataNxt] = $i;\n          var $code = it.validate($it);\n          $it.baseId = $currentBaseId;\n          if (it.util.varOccurences($code, $nextData) < 2) {\n            out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n          } else {\n            out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n          }\n          out += ' }  ';\n          if ($breakOnError) {\n            out += ' if (' + ($nextValid) + ') { ';\n            $closingBraces += '}';\n          }\n        }\n      }\n    }\n    if (typeof $additionalItems == 'object' && it.util.schemaHasRules($additionalItems, it.RULES.all)) {\n      $it.schema = $additionalItems;\n      $it.schemaPath = it.schemaPath + '.additionalItems';\n      $it.errSchemaPath = it.errSchemaPath + '/additionalItems';\n      out += ' ' + ($nextValid) + ' = true; if (' + ($data) + '.length > ' + ($schema.length) + ') {  for (var ' + ($idx) + ' = ' + ($schema.length) + '; ' + ($idx) + ' < ' + ($data) + '.length; ' + ($idx) + '++) { ';\n      $it.errorPath = it.util.getPathExpr(it.errorPath, $idx, it.opts.jsonPointers, true);\n      var $passData = $data + '[' + $idx + ']';\n      $it.dataPathArr[$dataNxt] = $idx;\n      var $code = it.validate($it);\n      $it.baseId = $currentBaseId;\n      if (it.util.varOccurences($code, $nextData) < 2) {\n        out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n      } else {\n        out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n      }\n      if ($breakOnError) {\n        out += ' if (!' + ($nextValid) + ') break; ';\n      }\n      out += ' } }  ';\n      if ($breakOnError) {\n        out += ' if (' + ($nextValid) + ') { ';\n        $closingBraces += '}';\n      }\n    }\n  } else if (it.util.schemaHasRules($schema, it.RULES.all)) {\n    $it.schema = $schema;\n    $it.schemaPath = $schemaPath;\n    $it.errSchemaPath = $errSchemaPath;\n    out += '  for (var ' + ($idx) + ' = ' + (0) + '; ' + ($idx) + ' < ' + ($data) + '.length; ' + ($idx) + '++) { ';\n    $it.errorPath = it.util.getPathExpr(it.errorPath, $idx, it.opts.jsonPointers, true);\n    var $passData = $data + '[' + $idx + ']';\n    $it.dataPathArr[$dataNxt] = $idx;\n    var $code = it.validate($it);\n    $it.baseId = $currentBaseId;\n    if (it.util.varOccurences($code, $nextData) < 2) {\n      out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n    } else {\n      out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n    }\n    if ($breakOnError) {\n      out += ' if (!' + ($nextValid) + ') break; ';\n    }\n    out += ' }';\n  }\n  if ($breakOnError) {\n    out += ' ' + ($closingBraces) + ' if (' + ($errs) + ' == errors) {';\n  }\n  out = it.util.cleanUpCode(out);\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_multipleOf(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  out += 'var division' + ($lvl) + ';if (';\n  if ($isData) {\n    out += ' ' + ($schemaValue) + ' !== undefined && ( typeof ' + ($schemaValue) + ' != \\'number\\' || ';\n  }\n  out += ' (division' + ($lvl) + ' = ' + ($data) + ' / ' + ($schemaValue) + ', ';\n  if (it.opts.multipleOfPrecision) {\n    out += ' Math.abs(Math.round(division' + ($lvl) + ') - division' + ($lvl) + ') > 1e-' + (it.opts.multipleOfPrecision) + ' ';\n  } else {\n    out += ' division' + ($lvl) + ' !== parseInt(division' + ($lvl) + ') ';\n  }\n  out += ' ) ';\n  if ($isData) {\n    out += '  )  ';\n  }\n  out += ' ) {   ';\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('multipleOf') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { multipleOf: ' + ($schemaValue) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should be multiple of ';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue);\n      } else {\n        out += '' + ($schemaValue) + '\\'';\n      }\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + ($schema);\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += '} ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_not(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  if (it.util.schemaHasRules($schema, it.RULES.all)) {\n    $it.schema = $schema;\n    $it.schemaPath = $schemaPath;\n    $it.errSchemaPath = $errSchemaPath;\n    out += ' var ' + ($errs) + ' = errors;  ';\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    $it.createErrors = false;\n    var $allErrorsOption;\n    if ($it.opts.allErrors) {\n      $allErrorsOption = $it.opts.allErrors;\n      $it.opts.allErrors = false;\n    }\n    out += ' ' + (it.validate($it)) + ' ';\n    $it.createErrors = true;\n    if ($allErrorsOption) $it.opts.allErrors = $allErrorsOption;\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    out += ' if (' + ($nextValid) + ') {   ';\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = ''; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('not') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should NOT be valid\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    var __err = out;\n    out = $$outStack.pop();\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError([' + (__err) + ']); ';\n      } else {\n        out += ' validate.errors = [' + (__err) + ']; return false; ';\n      }\n    } else {\n      out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    }\n    out += ' } else {  errors = ' + ($errs) + '; if (vErrors !== null) { if (' + ($errs) + ') vErrors.length = ' + ($errs) + '; else vErrors = null; } ';\n    if (it.opts.allErrors) {\n      out += ' } ';\n    }\n  } else {\n    out += '  var err =   '; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('not') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should NOT be valid\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    if ($breakOnError) {\n      out += ' if (false) { ';\n    }\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_oneOf(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $currentBaseId = $it.baseId,\n    $prevValid = 'prevValid' + $lvl,\n    $passingSchemas = 'passingSchemas' + $lvl;\n  out += 'var ' + ($errs) + ' = errors , ' + ($prevValid) + ' = false , ' + ($valid) + ' = false , ' + ($passingSchemas) + ' = null; ';\n  var $wasComposite = it.compositeRule;\n  it.compositeRule = $it.compositeRule = true;\n  var arr1 = $schema;\n  if (arr1) {\n    var $sch, $i = -1,\n      l1 = arr1.length - 1;\n    while ($i < l1) {\n      $sch = arr1[$i += 1];\n      if (it.util.schemaHasRules($sch, it.RULES.all)) {\n        $it.schema = $sch;\n        $it.schemaPath = $schemaPath + '[' + $i + ']';\n        $it.errSchemaPath = $errSchemaPath + '/' + $i;\n        out += '  ' + (it.validate($it)) + ' ';\n        $it.baseId = $currentBaseId;\n      } else {\n        out += ' var ' + ($nextValid) + ' = true; ';\n      }\n      if ($i) {\n        out += ' if (' + ($nextValid) + ' && ' + ($prevValid) + ') { ' + ($valid) + ' = false; ' + ($passingSchemas) + ' = [' + ($passingSchemas) + ', ' + ($i) + ']; } else { ';\n        $closingBraces += '}';\n      }\n      out += ' if (' + ($nextValid) + ') { ' + ($valid) + ' = ' + ($prevValid) + ' = true; ' + ($passingSchemas) + ' = ' + ($i) + '; }';\n    }\n  }\n  it.compositeRule = $it.compositeRule = $wasComposite;\n  out += '' + ($closingBraces) + 'if (!' + ($valid) + ') {   var err =   '; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('oneOf') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { passingSchemas: ' + ($passingSchemas) + ' } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should match exactly one schema in oneOf\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError(vErrors); ';\n    } else {\n      out += ' validate.errors = vErrors; return false; ';\n    }\n  }\n  out += '} else {  errors = ' + ($errs) + '; if (vErrors !== null) { if (' + ($errs) + ') vErrors.length = ' + ($errs) + '; else vErrors = null; }';\n  if (it.opts.allErrors) {\n    out += ' } ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_pattern(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $regexp = $isData ? '(new RegExp(' + $schemaValue + '))' : it.usePattern($schema);\n  out += 'if ( ';\n  if ($isData) {\n    out += ' (' + ($schemaValue) + ' !== undefined && typeof ' + ($schemaValue) + ' != \\'string\\') || ';\n  }\n  out += ' !' + ($regexp) + '.test(' + ($data) + ') ) {   ';\n  var $$outStack = $$outStack || [];\n  $$outStack.push(out);\n  out = ''; /* istanbul ignore else */\n  if (it.createErrors !== false) {\n    out += ' { keyword: \\'' + ('pattern') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { pattern:  ';\n    if ($isData) {\n      out += '' + ($schemaValue);\n    } else {\n      out += '' + (it.util.toQuotedString($schema));\n    }\n    out += '  } ';\n    if (it.opts.messages !== false) {\n      out += ' , message: \\'should match pattern \"';\n      if ($isData) {\n        out += '\\' + ' + ($schemaValue) + ' + \\'';\n      } else {\n        out += '' + (it.util.escapeQuotes($schema));\n      }\n      out += '\"\\' ';\n    }\n    if (it.opts.verbose) {\n      out += ' , schema:  ';\n      if ($isData) {\n        out += 'validate.schema' + ($schemaPath);\n      } else {\n        out += '' + (it.util.toQuotedString($schema));\n      }\n      out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n    }\n    out += ' } ';\n  } else {\n    out += ' {} ';\n  }\n  var __err = out;\n  out = $$outStack.pop();\n  if (!it.compositeRule && $breakOnError) {\n    /* istanbul ignore if */\n    if (it.async) {\n      out += ' throw new ValidationError([' + (__err) + ']); ';\n    } else {\n      out += ' validate.errors = [' + (__err) + ']; return false; ';\n    }\n  } else {\n    out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n  }\n  out += '} ';\n  if ($breakOnError) {\n    out += ' else { ';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_properties(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  var $key = 'key' + $lvl,\n    $idx = 'idx' + $lvl,\n    $dataNxt = $it.dataLevel = it.dataLevel + 1,\n    $nextData = 'data' + $dataNxt,\n    $dataProperties = 'dataProperties' + $lvl;\n  var $schemaKeys = Object.keys($schema || {}),\n    $pProperties = it.schema.patternProperties || {},\n    $pPropertyKeys = Object.keys($pProperties),\n    $aProperties = it.schema.additionalProperties,\n    $someProperties = $schemaKeys.length || $pPropertyKeys.length,\n    $noAdditional = $aProperties === false,\n    $additionalIsSchema = typeof $aProperties == 'object' && Object.keys($aProperties).length,\n    $removeAdditional = it.opts.removeAdditional,\n    $checkAdditional = $noAdditional || $additionalIsSchema || $removeAdditional,\n    $ownProperties = it.opts.ownProperties,\n    $currentBaseId = it.baseId;\n  var $required = it.schema.required;\n  if ($required && !(it.opts.$data && $required.$data) && $required.length < it.opts.loopRequired) var $requiredHash = it.util.toHash($required);\n  out += 'var ' + ($errs) + ' = errors;var ' + ($nextValid) + ' = true;';\n  if ($ownProperties) {\n    out += ' var ' + ($dataProperties) + ' = undefined;';\n  }\n  if ($checkAdditional) {\n    if ($ownProperties) {\n      out += ' ' + ($dataProperties) + ' = ' + ($dataProperties) + ' || Object.keys(' + ($data) + '); for (var ' + ($idx) + '=0; ' + ($idx) + '<' + ($dataProperties) + '.length; ' + ($idx) + '++) { var ' + ($key) + ' = ' + ($dataProperties) + '[' + ($idx) + ']; ';\n    } else {\n      out += ' for (var ' + ($key) + ' in ' + ($data) + ') { ';\n    }\n    if ($someProperties) {\n      out += ' var isAdditional' + ($lvl) + ' = !(false ';\n      if ($schemaKeys.length) {\n        if ($schemaKeys.length > 8) {\n          out += ' || validate.schema' + ($schemaPath) + '.hasOwnProperty(' + ($key) + ') ';\n        } else {\n          var arr1 = $schemaKeys;\n          if (arr1) {\n            var $propertyKey, i1 = -1,\n              l1 = arr1.length - 1;\n            while (i1 < l1) {\n              $propertyKey = arr1[i1 += 1];\n              out += ' || ' + ($key) + ' == ' + (it.util.toQuotedString($propertyKey)) + ' ';\n            }\n          }\n        }\n      }\n      if ($pPropertyKeys.length) {\n        var arr2 = $pPropertyKeys;\n        if (arr2) {\n          var $pProperty, $i = -1,\n            l2 = arr2.length - 1;\n          while ($i < l2) {\n            $pProperty = arr2[$i += 1];\n            out += ' || ' + (it.usePattern($pProperty)) + '.test(' + ($key) + ') ';\n          }\n        }\n      }\n      out += ' ); if (isAdditional' + ($lvl) + ') { ';\n    }\n    if ($removeAdditional == 'all') {\n      out += ' delete ' + ($data) + '[' + ($key) + ']; ';\n    } else {\n      var $currentErrorPath = it.errorPath;\n      var $additionalProperty = '\\' + ' + $key + ' + \\'';\n      if (it.opts._errorDataPathProperty) {\n        it.errorPath = it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);\n      }\n      if ($noAdditional) {\n        if ($removeAdditional) {\n          out += ' delete ' + ($data) + '[' + ($key) + ']; ';\n        } else {\n          out += ' ' + ($nextValid) + ' = false; ';\n          var $currErrSchemaPath = $errSchemaPath;\n          $errSchemaPath = it.errSchemaPath + '/additionalProperties';\n          var $$outStack = $$outStack || [];\n          $$outStack.push(out);\n          out = ''; /* istanbul ignore else */\n          if (it.createErrors !== false) {\n            out += ' { keyword: \\'' + ('additionalProperties') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { additionalProperty: \\'' + ($additionalProperty) + '\\' } ';\n            if (it.opts.messages !== false) {\n              out += ' , message: \\'';\n              if (it.opts._errorDataPathProperty) {\n                out += 'is an invalid additional property';\n              } else {\n                out += 'should NOT have additional properties';\n              }\n              out += '\\' ';\n            }\n            if (it.opts.verbose) {\n              out += ' , schema: false , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n            }\n            out += ' } ';\n          } else {\n            out += ' {} ';\n          }\n          var __err = out;\n          out = $$outStack.pop();\n          if (!it.compositeRule && $breakOnError) {\n            /* istanbul ignore if */\n            if (it.async) {\n              out += ' throw new ValidationError([' + (__err) + ']); ';\n            } else {\n              out += ' validate.errors = [' + (__err) + ']; return false; ';\n            }\n          } else {\n            out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n          }\n          $errSchemaPath = $currErrSchemaPath;\n          if ($breakOnError) {\n            out += ' break; ';\n          }\n        }\n      } else if ($additionalIsSchema) {\n        if ($removeAdditional == 'failing') {\n          out += ' var ' + ($errs) + ' = errors;  ';\n          var $wasComposite = it.compositeRule;\n          it.compositeRule = $it.compositeRule = true;\n          $it.schema = $aProperties;\n          $it.schemaPath = it.schemaPath + '.additionalProperties';\n          $it.errSchemaPath = it.errSchemaPath + '/additionalProperties';\n          $it.errorPath = it.opts._errorDataPathProperty ? it.errorPath : it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);\n          var $passData = $data + '[' + $key + ']';\n          $it.dataPathArr[$dataNxt] = $key;\n          var $code = it.validate($it);\n          $it.baseId = $currentBaseId;\n          if (it.util.varOccurences($code, $nextData) < 2) {\n            out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n          } else {\n            out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n          }\n          out += ' if (!' + ($nextValid) + ') { errors = ' + ($errs) + '; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete ' + ($data) + '[' + ($key) + ']; }  ';\n          it.compositeRule = $it.compositeRule = $wasComposite;\n        } else {\n          $it.schema = $aProperties;\n          $it.schemaPath = it.schemaPath + '.additionalProperties';\n          $it.errSchemaPath = it.errSchemaPath + '/additionalProperties';\n          $it.errorPath = it.opts._errorDataPathProperty ? it.errorPath : it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);\n          var $passData = $data + '[' + $key + ']';\n          $it.dataPathArr[$dataNxt] = $key;\n          var $code = it.validate($it);\n          $it.baseId = $currentBaseId;\n          if (it.util.varOccurences($code, $nextData) < 2) {\n            out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n          } else {\n            out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n          }\n          if ($breakOnError) {\n            out += ' if (!' + ($nextValid) + ') break; ';\n          }\n        }\n      }\n      it.errorPath = $currentErrorPath;\n    }\n    if ($someProperties) {\n      out += ' } ';\n    }\n    out += ' }  ';\n    if ($breakOnError) {\n      out += ' if (' + ($nextValid) + ') { ';\n      $closingBraces += '}';\n    }\n  }\n  var $useDefaults = it.opts.useDefaults && !it.compositeRule;\n  if ($schemaKeys.length) {\n    var arr3 = $schemaKeys;\n    if (arr3) {\n      var $propertyKey, i3 = -1,\n        l3 = arr3.length - 1;\n      while (i3 < l3) {\n        $propertyKey = arr3[i3 += 1];\n        var $sch = $schema[$propertyKey];\n        if (it.util.schemaHasRules($sch, it.RULES.all)) {\n          var $prop = it.util.getProperty($propertyKey),\n            $passData = $data + $prop,\n            $hasDefault = $useDefaults && $sch.default !== undefined;\n          $it.schema = $sch;\n          $it.schemaPath = $schemaPath + $prop;\n          $it.errSchemaPath = $errSchemaPath + '/' + it.util.escapeFragment($propertyKey);\n          $it.errorPath = it.util.getPath(it.errorPath, $propertyKey, it.opts.jsonPointers);\n          $it.dataPathArr[$dataNxt] = it.util.toQuotedString($propertyKey);\n          var $code = it.validate($it);\n          $it.baseId = $currentBaseId;\n          if (it.util.varOccurences($code, $nextData) < 2) {\n            $code = it.util.varReplace($code, $nextData, $passData);\n            var $useData = $passData;\n          } else {\n            var $useData = $nextData;\n            out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ';\n          }\n          if ($hasDefault) {\n            out += ' ' + ($code) + ' ';\n          } else {\n            if ($requiredHash && $requiredHash[$propertyKey]) {\n              out += ' if ( ' + ($useData) + ' === undefined ';\n              if ($ownProperties) {\n                out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n              }\n              out += ') { ' + ($nextValid) + ' = false; ';\n              var $currentErrorPath = it.errorPath,\n                $currErrSchemaPath = $errSchemaPath,\n                $missingProperty = it.util.escapeQuotes($propertyKey);\n              if (it.opts._errorDataPathProperty) {\n                it.errorPath = it.util.getPath($currentErrorPath, $propertyKey, it.opts.jsonPointers);\n              }\n              $errSchemaPath = it.errSchemaPath + '/required';\n              var $$outStack = $$outStack || [];\n              $$outStack.push(out);\n              out = ''; /* istanbul ignore else */\n              if (it.createErrors !== false) {\n                out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n                if (it.opts.messages !== false) {\n                  out += ' , message: \\'';\n                  if (it.opts._errorDataPathProperty) {\n                    out += 'is a required property';\n                  } else {\n                    out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n                  }\n                  out += '\\' ';\n                }\n                if (it.opts.verbose) {\n                  out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n                }\n                out += ' } ';\n              } else {\n                out += ' {} ';\n              }\n              var __err = out;\n              out = $$outStack.pop();\n              if (!it.compositeRule && $breakOnError) {\n                /* istanbul ignore if */\n                if (it.async) {\n                  out += ' throw new ValidationError([' + (__err) + ']); ';\n                } else {\n                  out += ' validate.errors = [' + (__err) + ']; return false; ';\n                }\n              } else {\n                out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n              }\n              $errSchemaPath = $currErrSchemaPath;\n              it.errorPath = $currentErrorPath;\n              out += ' } else { ';\n            } else {\n              if ($breakOnError) {\n                out += ' if ( ' + ($useData) + ' === undefined ';\n                if ($ownProperties) {\n                  out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n                }\n                out += ') { ' + ($nextValid) + ' = true; } else { ';\n              } else {\n                out += ' if (' + ($useData) + ' !== undefined ';\n                if ($ownProperties) {\n                  out += ' &&   Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n                }\n                out += ' ) { ';\n              }\n            }\n            out += ' ' + ($code) + ' } ';\n          }\n        }\n        if ($breakOnError) {\n          out += ' if (' + ($nextValid) + ') { ';\n          $closingBraces += '}';\n        }\n      }\n    }\n  }\n  if ($pPropertyKeys.length) {\n    var arr4 = $pPropertyKeys;\n    if (arr4) {\n      var $pProperty, i4 = -1,\n        l4 = arr4.length - 1;\n      while (i4 < l4) {\n        $pProperty = arr4[i4 += 1];\n        var $sch = $pProperties[$pProperty];\n        if (it.util.schemaHasRules($sch, it.RULES.all)) {\n          $it.schema = $sch;\n          $it.schemaPath = it.schemaPath + '.patternProperties' + it.util.getProperty($pProperty);\n          $it.errSchemaPath = it.errSchemaPath + '/patternProperties/' + it.util.escapeFragment($pProperty);\n          if ($ownProperties) {\n            out += ' ' + ($dataProperties) + ' = ' + ($dataProperties) + ' || Object.keys(' + ($data) + '); for (var ' + ($idx) + '=0; ' + ($idx) + '<' + ($dataProperties) + '.length; ' + ($idx) + '++) { var ' + ($key) + ' = ' + ($dataProperties) + '[' + ($idx) + ']; ';\n          } else {\n            out += ' for (var ' + ($key) + ' in ' + ($data) + ') { ';\n          }\n          out += ' if (' + (it.usePattern($pProperty)) + '.test(' + ($key) + ')) { ';\n          $it.errorPath = it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);\n          var $passData = $data + '[' + $key + ']';\n          $it.dataPathArr[$dataNxt] = $key;\n          var $code = it.validate($it);\n          $it.baseId = $currentBaseId;\n          if (it.util.varOccurences($code, $nextData) < 2) {\n            out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n          } else {\n            out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n          }\n          if ($breakOnError) {\n            out += ' if (!' + ($nextValid) + ') break; ';\n          }\n          out += ' } ';\n          if ($breakOnError) {\n            out += ' else ' + ($nextValid) + ' = true; ';\n          }\n          out += ' }  ';\n          if ($breakOnError) {\n            out += ' if (' + ($nextValid) + ') { ';\n            $closingBraces += '}';\n          }\n        }\n      }\n    }\n  }\n  if ($breakOnError) {\n    out += ' ' + ($closingBraces) + ' if (' + ($errs) + ' == errors) {';\n  }\n  out = it.util.cleanUpCode(out);\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_propertyNames(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $errs = 'errs__' + $lvl;\n  var $it = it.util.copy(it);\n  var $closingBraces = '';\n  $it.level++;\n  var $nextValid = 'valid' + $it.level;\n  out += 'var ' + ($errs) + ' = errors;';\n  if (it.util.schemaHasRules($schema, it.RULES.all)) {\n    $it.schema = $schema;\n    $it.schemaPath = $schemaPath;\n    $it.errSchemaPath = $errSchemaPath;\n    var $key = 'key' + $lvl,\n      $idx = 'idx' + $lvl,\n      $i = 'i' + $lvl,\n      $invalidName = '\\' + ' + $key + ' + \\'',\n      $dataNxt = $it.dataLevel = it.dataLevel + 1,\n      $nextData = 'data' + $dataNxt,\n      $dataProperties = 'dataProperties' + $lvl,\n      $ownProperties = it.opts.ownProperties,\n      $currentBaseId = it.baseId;\n    if ($ownProperties) {\n      out += ' var ' + ($dataProperties) + ' = undefined; ';\n    }\n    if ($ownProperties) {\n      out += ' ' + ($dataProperties) + ' = ' + ($dataProperties) + ' || Object.keys(' + ($data) + '); for (var ' + ($idx) + '=0; ' + ($idx) + '<' + ($dataProperties) + '.length; ' + ($idx) + '++) { var ' + ($key) + ' = ' + ($dataProperties) + '[' + ($idx) + ']; ';\n    } else {\n      out += ' for (var ' + ($key) + ' in ' + ($data) + ') { ';\n    }\n    out += ' var startErrs' + ($lvl) + ' = errors; ';\n    var $passData = $key;\n    var $wasComposite = it.compositeRule;\n    it.compositeRule = $it.compositeRule = true;\n    var $code = it.validate($it);\n    $it.baseId = $currentBaseId;\n    if (it.util.varOccurences($code, $nextData) < 2) {\n      out += ' ' + (it.util.varReplace($code, $nextData, $passData)) + ' ';\n    } else {\n      out += ' var ' + ($nextData) + ' = ' + ($passData) + '; ' + ($code) + ' ';\n    }\n    it.compositeRule = $it.compositeRule = $wasComposite;\n    out += ' if (!' + ($nextValid) + ') { for (var ' + ($i) + '=startErrs' + ($lvl) + '; ' + ($i) + '<errors; ' + ($i) + '++) { vErrors[' + ($i) + '].propertyName = ' + ($key) + '; }   var err =   '; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('propertyNames') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { propertyName: \\'' + ($invalidName) + '\\' } ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'property name \\\\\\'' + ($invalidName) + '\\\\\\' is invalid\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError(vErrors); ';\n      } else {\n        out += ' validate.errors = vErrors; return false; ';\n      }\n    }\n    if ($breakOnError) {\n      out += ' break; ';\n    }\n    out += ' } }';\n  }\n  if ($breakOnError) {\n    out += ' ' + ($closingBraces) + ' if (' + ($errs) + ' == errors) {';\n  }\n  out = it.util.cleanUpCode(out);\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_ref(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $async, $refCode;\n  if ($schema == '#' || $schema == '#/') {\n    if (it.isRoot) {\n      $async = it.async;\n      $refCode = 'validate';\n    } else {\n      $async = it.root.schema.$async === true;\n      $refCode = 'root.refVal[0]';\n    }\n  } else {\n    var $refVal = it.resolveRef(it.baseId, $schema, it.isRoot);\n    if ($refVal === undefined) {\n      var $message = it.MissingRefError.message(it.baseId, $schema);\n      if (it.opts.missingRefs == 'fail') {\n        it.logger.error($message);\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ('$ref') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { ref: \\'' + (it.util.escapeQuotes($schema)) + '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'can\\\\\\'t resolve reference ' + (it.util.escapeQuotes($schema)) + '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: ' + (it.util.toQuotedString($schema)) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n        if ($breakOnError) {\n          out += ' if (false) { ';\n        }\n      } else if (it.opts.missingRefs == 'ignore') {\n        it.logger.warn($message);\n        if ($breakOnError) {\n          out += ' if (true) { ';\n        }\n      } else {\n        throw new it.MissingRefError(it.baseId, $schema, $message);\n      }\n    } else if ($refVal.inline) {\n      var $it = it.util.copy(it);\n      $it.level++;\n      var $nextValid = 'valid' + $it.level;\n      $it.schema = $refVal.schema;\n      $it.schemaPath = '';\n      $it.errSchemaPath = $schema;\n      var $code = it.validate($it).replace(/validate\\.schema/g, $refVal.code);\n      out += ' ' + ($code) + ' ';\n      if ($breakOnError) {\n        out += ' if (' + ($nextValid) + ') { ';\n      }\n    } else {\n      $async = $refVal.$async === true || (it.async && $refVal.$async !== false);\n      $refCode = $refVal.code;\n    }\n  }\n  if ($refCode) {\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = '';\n    if (it.opts.passContext) {\n      out += ' ' + ($refCode) + '.call(this, ';\n    } else {\n      out += ' ' + ($refCode) + '( ';\n    }\n    out += ' ' + ($data) + ', (dataPath || \\'\\')';\n    if (it.errorPath != '\"\"') {\n      out += ' + ' + (it.errorPath);\n    }\n    var $parentData = $dataLvl ? 'data' + (($dataLvl - 1) || '') : 'parentData',\n      $parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : 'parentDataProperty';\n    out += ' , ' + ($parentData) + ' , ' + ($parentDataProperty) + ', rootData)  ';\n    var __callValidate = out;\n    out = $$outStack.pop();\n    if ($async) {\n      if (!it.async) throw new Error('async schema referenced by sync schema');\n      if ($breakOnError) {\n        out += ' var ' + ($valid) + '; ';\n      }\n      out += ' try { await ' + (__callValidate) + '; ';\n      if ($breakOnError) {\n        out += ' ' + ($valid) + ' = true; ';\n      }\n      out += ' } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ';\n      if ($breakOnError) {\n        out += ' ' + ($valid) + ' = false; ';\n      }\n      out += ' } ';\n      if ($breakOnError) {\n        out += ' if (' + ($valid) + ') { ';\n      }\n    } else {\n      out += ' if (!' + (__callValidate) + ') { if (vErrors === null) vErrors = ' + ($refCode) + '.errors; else vErrors = vErrors.concat(' + ($refCode) + '.errors); errors = vErrors.length; } ';\n      if ($breakOnError) {\n        out += ' else { ';\n      }\n    }\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_required(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  var $vSchema = 'schema' + $lvl;\n  if (!$isData) {\n    if ($schema.length < it.opts.loopRequired && it.schema.properties && Object.keys(it.schema.properties).length) {\n      var $required = [];\n      var arr1 = $schema;\n      if (arr1) {\n        var $property, i1 = -1,\n          l1 = arr1.length - 1;\n        while (i1 < l1) {\n          $property = arr1[i1 += 1];\n          var $propertySch = it.schema.properties[$property];\n          if (!($propertySch && it.util.schemaHasRules($propertySch, it.RULES.all))) {\n            $required[$required.length] = $property;\n          }\n        }\n      }\n    } else {\n      var $required = $schema;\n    }\n  }\n  if ($isData || $required.length) {\n    var $currentErrorPath = it.errorPath,\n      $loopRequired = $isData || $required.length >= it.opts.loopRequired,\n      $ownProperties = it.opts.ownProperties;\n    if ($breakOnError) {\n      out += ' var missing' + ($lvl) + '; ';\n      if ($loopRequired) {\n        if (!$isData) {\n          out += ' var ' + ($vSchema) + ' = validate.schema' + ($schemaPath) + '; ';\n        }\n        var $i = 'i' + $lvl,\n          $propertyPath = 'schema' + $lvl + '[' + $i + ']',\n          $missingProperty = '\\' + ' + $propertyPath + ' + \\'';\n        if (it.opts._errorDataPathProperty) {\n          it.errorPath = it.util.getPathExpr($currentErrorPath, $propertyPath, it.opts.jsonPointers);\n        }\n        out += ' var ' + ($valid) + ' = true; ';\n        if ($isData) {\n          out += ' if (schema' + ($lvl) + ' === undefined) ' + ($valid) + ' = true; else if (!Array.isArray(schema' + ($lvl) + ')) ' + ($valid) + ' = false; else {';\n        }\n        out += ' for (var ' + ($i) + ' = 0; ' + ($i) + ' < ' + ($vSchema) + '.length; ' + ($i) + '++) { ' + ($valid) + ' = ' + ($data) + '[' + ($vSchema) + '[' + ($i) + ']] !== undefined ';\n        if ($ownProperties) {\n          out += ' &&   Object.prototype.hasOwnProperty.call(' + ($data) + ', ' + ($vSchema) + '[' + ($i) + ']) ';\n        }\n        out += '; if (!' + ($valid) + ') break; } ';\n        if ($isData) {\n          out += '  }  ';\n        }\n        out += '  if (!' + ($valid) + ') {   ';\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'';\n            if (it.opts._errorDataPathProperty) {\n              out += 'is a required property';\n            } else {\n              out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n            }\n            out += '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n        out += ' } else { ';\n      } else {\n        out += ' if ( ';\n        var arr2 = $required;\n        if (arr2) {\n          var $propertyKey, $i = -1,\n            l2 = arr2.length - 1;\n          while ($i < l2) {\n            $propertyKey = arr2[$i += 1];\n            if ($i) {\n              out += ' || ';\n            }\n            var $prop = it.util.getProperty($propertyKey),\n              $useData = $data + $prop;\n            out += ' ( ( ' + ($useData) + ' === undefined ';\n            if ($ownProperties) {\n              out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n            }\n            out += ') && (missing' + ($lvl) + ' = ' + (it.util.toQuotedString(it.opts.jsonPointers ? $propertyKey : $prop)) + ') ) ';\n          }\n        }\n        out += ') {  ';\n        var $propertyPath = 'missing' + $lvl,\n          $missingProperty = '\\' + ' + $propertyPath + ' + \\'';\n        if (it.opts._errorDataPathProperty) {\n          it.errorPath = it.opts.jsonPointers ? it.util.getPathExpr($currentErrorPath, $propertyPath, true) : $currentErrorPath + ' + ' + $propertyPath;\n        }\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'';\n            if (it.opts._errorDataPathProperty) {\n              out += 'is a required property';\n            } else {\n              out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n            }\n            out += '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n        out += ' } else { ';\n      }\n    } else {\n      if ($loopRequired) {\n        if (!$isData) {\n          out += ' var ' + ($vSchema) + ' = validate.schema' + ($schemaPath) + '; ';\n        }\n        var $i = 'i' + $lvl,\n          $propertyPath = 'schema' + $lvl + '[' + $i + ']',\n          $missingProperty = '\\' + ' + $propertyPath + ' + \\'';\n        if (it.opts._errorDataPathProperty) {\n          it.errorPath = it.util.getPathExpr($currentErrorPath, $propertyPath, it.opts.jsonPointers);\n        }\n        if ($isData) {\n          out += ' if (' + ($vSchema) + ' && !Array.isArray(' + ($vSchema) + ')) {  var err =   '; /* istanbul ignore else */\n          if (it.createErrors !== false) {\n            out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n            if (it.opts.messages !== false) {\n              out += ' , message: \\'';\n              if (it.opts._errorDataPathProperty) {\n                out += 'is a required property';\n              } else {\n                out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n              }\n              out += '\\' ';\n            }\n            if (it.opts.verbose) {\n              out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n            }\n            out += ' } ';\n          } else {\n            out += ' {} ';\n          }\n          out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if (' + ($vSchema) + ' !== undefined) { ';\n        }\n        out += ' for (var ' + ($i) + ' = 0; ' + ($i) + ' < ' + ($vSchema) + '.length; ' + ($i) + '++) { if (' + ($data) + '[' + ($vSchema) + '[' + ($i) + ']] === undefined ';\n        if ($ownProperties) {\n          out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', ' + ($vSchema) + '[' + ($i) + ']) ';\n        }\n        out += ') {  var err =   '; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'';\n            if (it.opts._errorDataPathProperty) {\n              out += 'is a required property';\n            } else {\n              out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n            }\n            out += '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ';\n        if ($isData) {\n          out += '  }  ';\n        }\n      } else {\n        var arr3 = $required;\n        if (arr3) {\n          var $propertyKey, i3 = -1,\n            l3 = arr3.length - 1;\n          while (i3 < l3) {\n            $propertyKey = arr3[i3 += 1];\n            var $prop = it.util.getProperty($propertyKey),\n              $missingProperty = it.util.escapeQuotes($propertyKey),\n              $useData = $data + $prop;\n            if (it.opts._errorDataPathProperty) {\n              it.errorPath = it.util.getPath($currentErrorPath, $propertyKey, it.opts.jsonPointers);\n            }\n            out += ' if ( ' + ($useData) + ' === undefined ';\n            if ($ownProperties) {\n              out += ' || ! Object.prototype.hasOwnProperty.call(' + ($data) + ', \\'' + (it.util.escapeQuotes($propertyKey)) + '\\') ';\n            }\n            out += ') {  var err =   '; /* istanbul ignore else */\n            if (it.createErrors !== false) {\n              out += ' { keyword: \\'' + ('required') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { missingProperty: \\'' + ($missingProperty) + '\\' } ';\n              if (it.opts.messages !== false) {\n                out += ' , message: \\'';\n                if (it.opts._errorDataPathProperty) {\n                  out += 'is a required property';\n                } else {\n                  out += 'should have required property \\\\\\'' + ($missingProperty) + '\\\\\\'';\n                }\n                out += '\\' ';\n              }\n              if (it.opts.verbose) {\n                out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n              }\n              out += ' } ';\n            } else {\n              out += ' {} ';\n            }\n            out += ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } ';\n          }\n        }\n      }\n    }\n    it.errorPath = $currentErrorPath;\n  } else if ($breakOnError) {\n    out += ' if (true) {';\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_uniqueItems(it, $keyword, $ruleType) {\n  var out = ' ';\n  var $lvl = it.level;\n  var $dataLvl = it.dataLevel;\n  var $schema = it.schema[$keyword];\n  var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n  var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n  var $breakOnError = !it.opts.allErrors;\n  var $data = 'data' + ($dataLvl || '');\n  var $valid = 'valid' + $lvl;\n  var $isData = it.opts.$data && $schema && $schema.$data,\n    $schemaValue;\n  if ($isData) {\n    out += ' var schema' + ($lvl) + ' = ' + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + '; ';\n    $schemaValue = 'schema' + $lvl;\n  } else {\n    $schemaValue = $schema;\n  }\n  if (($schema || $isData) && it.opts.uniqueItems !== false) {\n    if ($isData) {\n      out += ' var ' + ($valid) + '; if (' + ($schemaValue) + ' === false || ' + ($schemaValue) + ' === undefined) ' + ($valid) + ' = true; else if (typeof ' + ($schemaValue) + ' != \\'boolean\\') ' + ($valid) + ' = false; else { ';\n    }\n    out += ' var i = ' + ($data) + '.length , ' + ($valid) + ' = true , j; if (i > 1) { ';\n    var $itemType = it.schema.items && it.schema.items.type,\n      $typeIsArray = Array.isArray($itemType);\n    if (!$itemType || $itemType == 'object' || $itemType == 'array' || ($typeIsArray && ($itemType.indexOf('object') >= 0 || $itemType.indexOf('array') >= 0))) {\n      out += ' outer: for (;i--;) { for (j = i; j--;) { if (equal(' + ($data) + '[i], ' + ($data) + '[j])) { ' + ($valid) + ' = false; break outer; } } } ';\n    } else {\n      out += ' var itemIndices = {}, item; for (;i--;) { var item = ' + ($data) + '[i]; ';\n      var $method = 'checkDataType' + ($typeIsArray ? 's' : '');\n      out += ' if (' + (it.util[$method]($itemType, 'item', true)) + ') continue; ';\n      if ($typeIsArray) {\n        out += ' if (typeof item == \\'string\\') item = \\'\"\\' + item; ';\n      }\n      out += ' if (typeof itemIndices[item] == \\'number\\') { ' + ($valid) + ' = false; j = itemIndices[item]; break; } itemIndices[item] = i; } ';\n    }\n    out += ' } ';\n    if ($isData) {\n      out += '  }  ';\n    }\n    out += ' if (!' + ($valid) + ') {   ';\n    var $$outStack = $$outStack || [];\n    $$outStack.push(out);\n    out = ''; /* istanbul ignore else */\n    if (it.createErrors !== false) {\n      out += ' { keyword: \\'' + ('uniqueItems') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { i: i, j: j } ';\n      if (it.opts.messages !== false) {\n        out += ' , message: \\'should NOT have duplicate items (items ## \\' + j + \\' and \\' + i + \\' are identical)\\' ';\n      }\n      if (it.opts.verbose) {\n        out += ' , schema:  ';\n        if ($isData) {\n          out += 'validate.schema' + ($schemaPath);\n        } else {\n          out += '' + ($schema);\n        }\n        out += '         , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n      }\n      out += ' } ';\n    } else {\n      out += ' {} ';\n    }\n    var __err = out;\n    out = $$outStack.pop();\n    if (!it.compositeRule && $breakOnError) {\n      /* istanbul ignore if */\n      if (it.async) {\n        out += ' throw new ValidationError([' + (__err) + ']); ';\n      } else {\n        out += ' validate.errors = [' + (__err) + ']; return false; ';\n      }\n    } else {\n      out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n    }\n    out += ' } ';\n    if ($breakOnError) {\n      out += ' else { ';\n    }\n  } else {\n    if ($breakOnError) {\n      out += ' if (true) { ';\n    }\n  }\n  return out;\n}\n","'use strict';\nmodule.exports = function generate_validate(it, $keyword, $ruleType) {\n  var out = '';\n  var $async = it.schema.$async === true,\n    $refKeywords = it.util.schemaHasRulesExcept(it.schema, it.RULES.all, '$ref'),\n    $id = it.self._getId(it.schema);\n  if (it.isTop) {\n    out += ' var validate = ';\n    if ($async) {\n      it.async = true;\n      out += 'async ';\n    }\n    out += 'function(data, dataPath, parentData, parentDataProperty, rootData) { \\'use strict\\'; ';\n    if ($id && (it.opts.sourceCode || it.opts.processCode)) {\n      out += ' ' + ('/\\*# sourceURL=' + $id + ' */') + ' ';\n    }\n  }\n  if (typeof it.schema == 'boolean' || !($refKeywords || it.schema.$ref)) {\n    var $keyword = 'false schema';\n    var $lvl = it.level;\n    var $dataLvl = it.dataLevel;\n    var $schema = it.schema[$keyword];\n    var $schemaPath = it.schemaPath + it.util.getProperty($keyword);\n    var $errSchemaPath = it.errSchemaPath + '/' + $keyword;\n    var $breakOnError = !it.opts.allErrors;\n    var $errorKeyword;\n    var $data = 'data' + ($dataLvl || '');\n    var $valid = 'valid' + $lvl;\n    if (it.schema === false) {\n      if (it.isTop) {\n        $breakOnError = true;\n      } else {\n        out += ' var ' + ($valid) + ' = false; ';\n      }\n      var $$outStack = $$outStack || [];\n      $$outStack.push(out);\n      out = ''; /* istanbul ignore else */\n      if (it.createErrors !== false) {\n        out += ' { keyword: \\'' + ($errorKeyword || 'false schema') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: {} ';\n        if (it.opts.messages !== false) {\n          out += ' , message: \\'boolean schema is false\\' ';\n        }\n        if (it.opts.verbose) {\n          out += ' , schema: false , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n        }\n        out += ' } ';\n      } else {\n        out += ' {} ';\n      }\n      var __err = out;\n      out = $$outStack.pop();\n      if (!it.compositeRule && $breakOnError) {\n        /* istanbul ignore if */\n        if (it.async) {\n          out += ' throw new ValidationError([' + (__err) + ']); ';\n        } else {\n          out += ' validate.errors = [' + (__err) + ']; return false; ';\n        }\n      } else {\n        out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n      }\n    } else {\n      if (it.isTop) {\n        if ($async) {\n          out += ' return data; ';\n        } else {\n          out += ' validate.errors = null; return true; ';\n        }\n      } else {\n        out += ' var ' + ($valid) + ' = true; ';\n      }\n    }\n    if (it.isTop) {\n      out += ' }; return validate; ';\n    }\n    return out;\n  }\n  if (it.isTop) {\n    var $top = it.isTop,\n      $lvl = it.level = 0,\n      $dataLvl = it.dataLevel = 0,\n      $data = 'data';\n    it.rootId = it.resolve.fullPath(it.self._getId(it.root.schema));\n    it.baseId = it.baseId || it.rootId;\n    delete it.isTop;\n    it.dataPathArr = [undefined];\n    out += ' var vErrors = null; ';\n    out += ' var errors = 0;     ';\n    out += ' if (rootData === undefined) rootData = data; ';\n  } else {\n    var $lvl = it.level,\n      $dataLvl = it.dataLevel,\n      $data = 'data' + ($dataLvl || '');\n    if ($id) it.baseId = it.resolve.url(it.baseId, $id);\n    if ($async && !it.async) throw new Error('async schema in sync schema');\n    out += ' var errs_' + ($lvl) + ' = errors;';\n  }\n  var $valid = 'valid' + $lvl,\n    $breakOnError = !it.opts.allErrors,\n    $closingBraces1 = '',\n    $closingBraces2 = '';\n  var $errorKeyword;\n  var $typeSchema = it.schema.type,\n    $typeIsArray = Array.isArray($typeSchema);\n  if ($typeSchema && it.opts.nullable && it.schema.nullable === true) {\n    if ($typeIsArray) {\n      if ($typeSchema.indexOf('null') == -1) $typeSchema = $typeSchema.concat('null');\n    } else if ($typeSchema != 'null') {\n      $typeSchema = [$typeSchema, 'null'];\n      $typeIsArray = true;\n    }\n  }\n  if ($typeIsArray && $typeSchema.length == 1) {\n    $typeSchema = $typeSchema[0];\n    $typeIsArray = false;\n  }\n  if (it.schema.$ref && $refKeywords) {\n    if (it.opts.extendRefs == 'fail') {\n      throw new Error('$ref: validation keywords used in schema at path \"' + it.errSchemaPath + '\" (see option extendRefs)');\n    } else if (it.opts.extendRefs !== true) {\n      $refKeywords = false;\n      it.logger.warn('$ref: keywords ignored in schema at path \"' + it.errSchemaPath + '\"');\n    }\n  }\n  if (it.schema.$comment && it.opts.$comment) {\n    out += ' ' + (it.RULES.all.$comment.code(it, '$comment'));\n  }\n  if ($typeSchema) {\n    if (it.opts.coerceTypes) {\n      var $coerceToTypes = it.util.coerceToTypes(it.opts.coerceTypes, $typeSchema);\n    }\n    var $rulesGroup = it.RULES.types[$typeSchema];\n    if ($coerceToTypes || $typeIsArray || $rulesGroup === true || ($rulesGroup && !$shouldUseGroup($rulesGroup))) {\n      var $schemaPath = it.schemaPath + '.type',\n        $errSchemaPath = it.errSchemaPath + '/type';\n      var $schemaPath = it.schemaPath + '.type',\n        $errSchemaPath = it.errSchemaPath + '/type',\n        $method = $typeIsArray ? 'checkDataTypes' : 'checkDataType';\n      out += ' if (' + (it.util[$method]($typeSchema, $data, true)) + ') { ';\n      if ($coerceToTypes) {\n        var $dataType = 'dataType' + $lvl,\n          $coerced = 'coerced' + $lvl;\n        out += ' var ' + ($dataType) + ' = typeof ' + ($data) + '; ';\n        if (it.opts.coerceTypes == 'array') {\n          out += ' if (' + ($dataType) + ' == \\'object\\' && Array.isArray(' + ($data) + ')) ' + ($dataType) + ' = \\'array\\'; ';\n        }\n        out += ' var ' + ($coerced) + ' = undefined; ';\n        var $bracesCoercion = '';\n        var arr1 = $coerceToTypes;\n        if (arr1) {\n          var $type, $i = -1,\n            l1 = arr1.length - 1;\n          while ($i < l1) {\n            $type = arr1[$i += 1];\n            if ($i) {\n              out += ' if (' + ($coerced) + ' === undefined) { ';\n              $bracesCoercion += '}';\n            }\n            if (it.opts.coerceTypes == 'array' && $type != 'array') {\n              out += ' if (' + ($dataType) + ' == \\'array\\' && ' + ($data) + '.length == 1) { ' + ($coerced) + ' = ' + ($data) + ' = ' + ($data) + '[0]; ' + ($dataType) + ' = typeof ' + ($data) + ';  } ';\n            }\n            if ($type == 'string') {\n              out += ' if (' + ($dataType) + ' == \\'number\\' || ' + ($dataType) + ' == \\'boolean\\') ' + ($coerced) + ' = \\'\\' + ' + ($data) + '; else if (' + ($data) + ' === null) ' + ($coerced) + ' = \\'\\'; ';\n            } else if ($type == 'number' || $type == 'integer') {\n              out += ' if (' + ($dataType) + ' == \\'boolean\\' || ' + ($data) + ' === null || (' + ($dataType) + ' == \\'string\\' && ' + ($data) + ' && ' + ($data) + ' == +' + ($data) + ' ';\n              if ($type == 'integer') {\n                out += ' && !(' + ($data) + ' % 1)';\n              }\n              out += ')) ' + ($coerced) + ' = +' + ($data) + '; ';\n            } else if ($type == 'boolean') {\n              out += ' if (' + ($data) + ' === \\'false\\' || ' + ($data) + ' === 0 || ' + ($data) + ' === null) ' + ($coerced) + ' = false; else if (' + ($data) + ' === \\'true\\' || ' + ($data) + ' === 1) ' + ($coerced) + ' = true; ';\n            } else if ($type == 'null') {\n              out += ' if (' + ($data) + ' === \\'\\' || ' + ($data) + ' === 0 || ' + ($data) + ' === false) ' + ($coerced) + ' = null; ';\n            } else if (it.opts.coerceTypes == 'array' && $type == 'array') {\n              out += ' if (' + ($dataType) + ' == \\'string\\' || ' + ($dataType) + ' == \\'number\\' || ' + ($dataType) + ' == \\'boolean\\' || ' + ($data) + ' == null) ' + ($coerced) + ' = [' + ($data) + ']; ';\n            }\n          }\n        }\n        out += ' ' + ($bracesCoercion) + ' if (' + ($coerced) + ' === undefined) {   ';\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ($errorKeyword || 'type') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { type: \\'';\n          if ($typeIsArray) {\n            out += '' + ($typeSchema.join(\",\"));\n          } else {\n            out += '' + ($typeSchema);\n          }\n          out += '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'should be ';\n            if ($typeIsArray) {\n              out += '' + ($typeSchema.join(\",\"));\n            } else {\n              out += '' + ($typeSchema);\n            }\n            out += '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n        out += ' } else {  ';\n        var $parentData = $dataLvl ? 'data' + (($dataLvl - 1) || '') : 'parentData',\n          $parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : 'parentDataProperty';\n        out += ' ' + ($data) + ' = ' + ($coerced) + '; ';\n        if (!$dataLvl) {\n          out += 'if (' + ($parentData) + ' !== undefined)';\n        }\n        out += ' ' + ($parentData) + '[' + ($parentDataProperty) + '] = ' + ($coerced) + '; } ';\n      } else {\n        var $$outStack = $$outStack || [];\n        $$outStack.push(out);\n        out = ''; /* istanbul ignore else */\n        if (it.createErrors !== false) {\n          out += ' { keyword: \\'' + ($errorKeyword || 'type') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { type: \\'';\n          if ($typeIsArray) {\n            out += '' + ($typeSchema.join(\",\"));\n          } else {\n            out += '' + ($typeSchema);\n          }\n          out += '\\' } ';\n          if (it.opts.messages !== false) {\n            out += ' , message: \\'should be ';\n            if ($typeIsArray) {\n              out += '' + ($typeSchema.join(\",\"));\n            } else {\n              out += '' + ($typeSchema);\n            }\n            out += '\\' ';\n          }\n          if (it.opts.verbose) {\n            out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n          }\n          out += ' } ';\n        } else {\n          out += ' {} ';\n        }\n        var __err = out;\n        out = $$outStack.pop();\n        if (!it.compositeRule && $breakOnError) {\n          /* istanbul ignore if */\n          if (it.async) {\n            out += ' throw new ValidationError([' + (__err) + ']); ';\n          } else {\n            out += ' validate.errors = [' + (__err) + ']; return false; ';\n          }\n        } else {\n          out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n        }\n      }\n      out += ' } ';\n    }\n  }\n  if (it.schema.$ref && !$refKeywords) {\n    out += ' ' + (it.RULES.all.$ref.code(it, '$ref')) + ' ';\n    if ($breakOnError) {\n      out += ' } if (errors === ';\n      if ($top) {\n        out += '0';\n      } else {\n        out += 'errs_' + ($lvl);\n      }\n      out += ') { ';\n      $closingBraces2 += '}';\n    }\n  } else {\n    var arr2 = it.RULES;\n    if (arr2) {\n      var $rulesGroup, i2 = -1,\n        l2 = arr2.length - 1;\n      while (i2 < l2) {\n        $rulesGroup = arr2[i2 += 1];\n        if ($shouldUseGroup($rulesGroup)) {\n          if ($rulesGroup.type) {\n            out += ' if (' + (it.util.checkDataType($rulesGroup.type, $data)) + ') { ';\n          }\n          if (it.opts.useDefaults && !it.compositeRule) {\n            if ($rulesGroup.type == 'object' && it.schema.properties) {\n              var $schema = it.schema.properties,\n                $schemaKeys = Object.keys($schema);\n              var arr3 = $schemaKeys;\n              if (arr3) {\n                var $propertyKey, i3 = -1,\n                  l3 = arr3.length - 1;\n                while (i3 < l3) {\n                  $propertyKey = arr3[i3 += 1];\n                  var $sch = $schema[$propertyKey];\n                  if ($sch.default !== undefined) {\n                    var $passData = $data + it.util.getProperty($propertyKey);\n                    out += '  if (' + ($passData) + ' === undefined ';\n                    if (it.opts.useDefaults == 'empty') {\n                      out += ' || ' + ($passData) + ' === null || ' + ($passData) + ' === \\'\\' ';\n                    }\n                    out += ' ) ' + ($passData) + ' = ';\n                    if (it.opts.useDefaults == 'shared') {\n                      out += ' ' + (it.useDefault($sch.default)) + ' ';\n                    } else {\n                      out += ' ' + (JSON.stringify($sch.default)) + ' ';\n                    }\n                    out += '; ';\n                  }\n                }\n              }\n            } else if ($rulesGroup.type == 'array' && Array.isArray(it.schema.items)) {\n              var arr4 = it.schema.items;\n              if (arr4) {\n                var $sch, $i = -1,\n                  l4 = arr4.length - 1;\n                while ($i < l4) {\n                  $sch = arr4[$i += 1];\n                  if ($sch.default !== undefined) {\n                    var $passData = $data + '[' + $i + ']';\n                    out += '  if (' + ($passData) + ' === undefined ';\n                    if (it.opts.useDefaults == 'empty') {\n                      out += ' || ' + ($passData) + ' === null || ' + ($passData) + ' === \\'\\' ';\n                    }\n                    out += ' ) ' + ($passData) + ' = ';\n                    if (it.opts.useDefaults == 'shared') {\n                      out += ' ' + (it.useDefault($sch.default)) + ' ';\n                    } else {\n                      out += ' ' + (JSON.stringify($sch.default)) + ' ';\n                    }\n                    out += '; ';\n                  }\n                }\n              }\n            }\n          }\n          var arr5 = $rulesGroup.rules;\n          if (arr5) {\n            var $rule, i5 = -1,\n              l5 = arr5.length - 1;\n            while (i5 < l5) {\n              $rule = arr5[i5 += 1];\n              if ($shouldUseRule($rule)) {\n                var $code = $rule.code(it, $rule.keyword, $rulesGroup.type);\n                if ($code) {\n                  out += ' ' + ($code) + ' ';\n                  if ($breakOnError) {\n                    $closingBraces1 += '}';\n                  }\n                }\n              }\n            }\n          }\n          if ($breakOnError) {\n            out += ' ' + ($closingBraces1) + ' ';\n            $closingBraces1 = '';\n          }\n          if ($rulesGroup.type) {\n            out += ' } ';\n            if ($typeSchema && $typeSchema === $rulesGroup.type && !$coerceToTypes) {\n              out += ' else { ';\n              var $schemaPath = it.schemaPath + '.type',\n                $errSchemaPath = it.errSchemaPath + '/type';\n              var $$outStack = $$outStack || [];\n              $$outStack.push(out);\n              out = ''; /* istanbul ignore else */\n              if (it.createErrors !== false) {\n                out += ' { keyword: \\'' + ($errorKeyword || 'type') + '\\' , dataPath: (dataPath || \\'\\') + ' + (it.errorPath) + ' , schemaPath: ' + (it.util.toQuotedString($errSchemaPath)) + ' , params: { type: \\'';\n                if ($typeIsArray) {\n                  out += '' + ($typeSchema.join(\",\"));\n                } else {\n                  out += '' + ($typeSchema);\n                }\n                out += '\\' } ';\n                if (it.opts.messages !== false) {\n                  out += ' , message: \\'should be ';\n                  if ($typeIsArray) {\n                    out += '' + ($typeSchema.join(\",\"));\n                  } else {\n                    out += '' + ($typeSchema);\n                  }\n                  out += '\\' ';\n                }\n                if (it.opts.verbose) {\n                  out += ' , schema: validate.schema' + ($schemaPath) + ' , parentSchema: validate.schema' + (it.schemaPath) + ' , data: ' + ($data) + ' ';\n                }\n                out += ' } ';\n              } else {\n                out += ' {} ';\n              }\n              var __err = out;\n              out = $$outStack.pop();\n              if (!it.compositeRule && $breakOnError) {\n                /* istanbul ignore if */\n                if (it.async) {\n                  out += ' throw new ValidationError([' + (__err) + ']); ';\n                } else {\n                  out += ' validate.errors = [' + (__err) + ']; return false; ';\n                }\n              } else {\n                out += ' var err = ' + (__err) + ';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ';\n              }\n              out += ' } ';\n            }\n          }\n          if ($breakOnError) {\n            out += ' if (errors === ';\n            if ($top) {\n              out += '0';\n            } else {\n              out += 'errs_' + ($lvl);\n            }\n            out += ') { ';\n            $closingBraces2 += '}';\n          }\n        }\n      }\n    }\n  }\n  if ($breakOnError) {\n    out += ' ' + ($closingBraces2) + ' ';\n  }\n  if ($top) {\n    if ($async) {\n      out += ' if (errors === 0) return data;           ';\n      out += ' else throw new ValidationError(vErrors); ';\n    } else {\n      out += ' validate.errors = vErrors; ';\n      out += ' return errors === 0;       ';\n    }\n    out += ' }; return validate;';\n  } else {\n    out += ' var ' + ($valid) + ' = errors === errs_' + ($lvl) + ';';\n  }\n  out = it.util.cleanUpCode(out);\n  if ($top) {\n    out = it.util.finalCleanUpCode(out, $async);\n  }\n\n  function $shouldUseGroup($rulesGroup) {\n    var rules = $rulesGroup.rules;\n    for (var i = 0; i < rules.length; i++)\n      if ($shouldUseRule(rules[i])) return true;\n  }\n\n  function $shouldUseRule($rule) {\n    return it.schema[$rule.keyword] !== undefined || ($rule.implements && $ruleImplementsSomeKeyword($rule));\n  }\n\n  function $ruleImplementsSomeKeyword($rule) {\n    var impl = $rule.implements;\n    for (var i = 0; i < impl.length; i++)\n      if (it.schema[impl[i]] !== undefined) return true;\n  }\n  return out;\n}\n","'use strict';\n\nvar IDENTIFIER = /^[a-z_$][a-z0-9_$-]*$/i;\nvar customRuleCode = require('./dotjs/custom');\n\nmodule.exports = {\n  add: addKeyword,\n  get: getKeyword,\n  remove: removeKeyword\n};\n\n/**\n * Define custom keyword\n * @this  Ajv\n * @param {String} keyword custom keyword, should be unique (including different from all standard, custom and macro keywords).\n * @param {Object} definition keyword definition object with properties `type` (type(s) which the keyword applies to), `validate` or `compile`.\n * @return {Ajv} this for method chaining\n */\nfunction addKeyword(keyword, definition) {\n  /* jshint validthis: true */\n  /* eslint no-shadow: 0 */\n  var RULES = this.RULES;\n\n  if (RULES.keywords[keyword])\n    throw new Error('Keyword ' + keyword + ' is already defined');\n\n  if (!IDENTIFIER.test(keyword))\n    throw new Error('Keyword ' + keyword + ' is not a valid identifier');\n\n  if (definition) {\n    if (definition.macro && definition.valid !== undefined)\n      throw new Error('\"valid\" option cannot be used with macro keywords');\n\n    var dataType = definition.type;\n    if (Array.isArray(dataType)) {\n      var i, len = dataType.length;\n      for (i=0; i<len; i++) checkDataType(dataType[i]);\n      for (i=0; i<len; i++) _addRule(keyword, dataType[i], definition);\n    } else {\n      if (dataType) checkDataType(dataType);\n      _addRule(keyword, dataType, definition);\n    }\n\n    var $data = definition.$data === true && this._opts.$data;\n    if ($data && !definition.validate)\n      throw new Error('$data support: \"validate\" function is not defined');\n\n    var metaSchema = definition.metaSchema;\n    if (metaSchema) {\n      if ($data) {\n        metaSchema = {\n          anyOf: [\n            metaSchema,\n            { '$ref': 'https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#' }\n          ]\n        };\n      }\n      definition.validateSchema = this.compile(metaSchema, true);\n    }\n  }\n\n  RULES.keywords[keyword] = RULES.all[keyword] = true;\n\n\n  function _addRule(keyword, dataType, definition) {\n    var ruleGroup;\n    for (var i=0; i<RULES.length; i++) {\n      var rg = RULES[i];\n      if (rg.type == dataType) {\n        ruleGroup = rg;\n        break;\n      }\n    }\n\n    if (!ruleGroup) {\n      ruleGroup = { type: dataType, rules: [] };\n      RULES.push(ruleGroup);\n    }\n\n    var rule = {\n      keyword: keyword,\n      definition: definition,\n      custom: true,\n      code: customRuleCode,\n      implements: definition.implements\n    };\n    ruleGroup.rules.push(rule);\n    RULES.custom[keyword] = rule;\n  }\n\n\n  function checkDataType(dataType) {\n    if (!RULES.types[dataType]) throw new Error('Unknown type ' + dataType);\n  }\n\n  return this;\n}\n\n\n/**\n * Get keyword\n * @this  Ajv\n * @param {String} keyword pre-defined or custom keyword.\n * @return {Object|Boolean} custom keyword definition, `true` if it is a predefined keyword, `false` otherwise.\n */\nfunction getKeyword(keyword) {\n  /* jshint validthis: true */\n  var rule = this.RULES.custom[keyword];\n  return rule ? rule.definition : this.RULES.keywords[keyword] || false;\n}\n\n\n/**\n * Remove keyword\n * @this  Ajv\n * @param {String} keyword pre-defined or custom keyword.\n * @return {Ajv} this for method chaining\n */\nfunction removeKeyword(keyword) {\n  /* jshint validthis: true */\n  var RULES = this.RULES;\n  delete RULES.keywords[keyword];\n  delete RULES.all[keyword];\n  delete RULES.custom[keyword];\n  for (var i=0; i<RULES.length; i++) {\n    var rules = RULES[i].rules;\n    for (var j=0; j<rules.length; j++) {\n      if (rules[j].keyword == keyword) {\n        rules.splice(j, 1);\n        break;\n      }\n    }\n  }\n  return this;\n}\n","'use strict';\n\nvar isArray = Array.isArray;\nvar keyList = Object.keys;\nvar hasProp = Object.prototype.hasOwnProperty;\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    var arrA = isArray(a)\n      , arrB = isArray(b)\n      , i\n      , length\n      , key;\n\n    if (arrA && arrB) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n    if (arrA != arrB) return false;\n\n    var dateA = a instanceof Date\n      , dateB = b instanceof Date;\n    if (dateA != dateB) return false;\n    if (dateA && dateB) return a.getTime() == b.getTime();\n\n    var regexpA = a instanceof RegExp\n      , regexpB = b instanceof RegExp;\n    if (regexpA != regexpB) return false;\n    if (regexpA && regexpB) return a.toString() == b.toString();\n\n    var keys = keyList(a);\n    length = keys.length;\n\n    if (length !== keyList(b).length)\n      return false;\n\n    for (i = length; i-- !== 0;)\n      if (!hasProp.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      key = keys[i];\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  return a!==a && b!==b;\n};\n","'use strict';\n\nmodule.exports = function (data, opts) {\n    if (!opts) opts = {};\n    if (typeof opts === 'function') opts = { cmp: opts };\n    var cycles = (typeof opts.cycles === 'boolean') ? opts.cycles : false;\n\n    var cmp = opts.cmp && (function (f) {\n        return function (node) {\n            return function (a, b) {\n                var aobj = { key: a, value: node[a] };\n                var bobj = { key: b, value: node[b] };\n                return f(aobj, bobj);\n            };\n        };\n    })(opts.cmp);\n\n    var seen = [];\n    return (function stringify (node) {\n        if (node && node.toJSON && typeof node.toJSON === 'function') {\n            node = node.toJSON();\n        }\n\n        if (node === undefined) return;\n        if (typeof node == 'number') return isFinite(node) ? '' + node : 'null';\n        if (typeof node !== 'object') return JSON.stringify(node);\n\n        var i, out;\n        if (Array.isArray(node)) {\n            out = '[';\n            for (i = 0; i < node.length; i++) {\n                if (i) out += ',';\n                out += stringify(node[i]) || 'null';\n            }\n            return out + ']';\n        }\n\n        if (node === null) return 'null';\n\n        if (seen.indexOf(node) !== -1) {\n            if (cycles) return JSON.stringify('__cycle__');\n            throw new TypeError('Converting circular structure to JSON');\n        }\n\n        var seenIndex = seen.push(node) - 1;\n        var keys = Object.keys(node).sort(cmp && cmp(node));\n        out = '';\n        for (i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            var value = stringify(node[key]);\n\n            if (!value) continue;\n            if (out) out += ',';\n            out += JSON.stringify(key) + ':' + value;\n        }\n        seen.splice(seenIndex, 1);\n        return '{' + out + '}';\n    })(data);\n};\n","'use strict';\n\nvar traverse = module.exports = function (schema, opts, cb) {\n  // Legacy support for v0.3.1 and earlier.\n  if (typeof opts == 'function') {\n    cb = opts;\n    opts = {};\n  }\n\n  cb = opts.cb || cb;\n  var pre = (typeof cb == 'function') ? cb : cb.pre || function() {};\n  var post = cb.post || function() {};\n\n  _traverse(opts, pre, post, schema, '', schema);\n};\n\n\ntraverse.keywords = {\n  additionalItems: true,\n  items: true,\n  contains: true,\n  additionalProperties: true,\n  propertyNames: true,\n  not: true\n};\n\ntraverse.arrayKeywords = {\n  items: true,\n  allOf: true,\n  anyOf: true,\n  oneOf: true\n};\n\ntraverse.propsKeywords = {\n  definitions: true,\n  properties: true,\n  patternProperties: true,\n  dependencies: true\n};\n\ntraverse.skipKeywords = {\n  default: true,\n  enum: true,\n  const: true,\n  required: true,\n  maximum: true,\n  minimum: true,\n  exclusiveMaximum: true,\n  exclusiveMinimum: true,\n  multipleOf: true,\n  maxLength: true,\n  minLength: true,\n  pattern: true,\n  format: true,\n  maxItems: true,\n  minItems: true,\n  uniqueItems: true,\n  maxProperties: true,\n  minProperties: true\n};\n\n\nfunction _traverse(opts, pre, post, schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex) {\n  if (schema && typeof schema == 'object' && !Array.isArray(schema)) {\n    pre(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);\n    for (var key in schema) {\n      var sch = schema[key];\n      if (Array.isArray(sch)) {\n        if (key in traverse.arrayKeywords) {\n          for (var i=0; i<sch.length; i++)\n            _traverse(opts, pre, post, sch[i], jsonPtr + '/' + key + '/' + i, rootSchema, jsonPtr, key, schema, i);\n        }\n      } else if (key in traverse.propsKeywords) {\n        if (sch && typeof sch == 'object') {\n          for (var prop in sch)\n            _traverse(opts, pre, post, sch[prop], jsonPtr + '/' + key + '/' + escapeJsonPtr(prop), rootSchema, jsonPtr, key, schema, prop);\n        }\n      } else if (key in traverse.keywords || (opts.allKeys && !(key in traverse.skipKeywords))) {\n        _traverse(opts, pre, post, sch, jsonPtr + '/' + key, rootSchema, jsonPtr, key, schema);\n      }\n    }\n    post(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);\n  }\n}\n\n\nfunction escapeJsonPtr(str) {\n  return str.replace(/~/g, '~0').replace(/\\//g, '~1');\n}\n","/**\n@license\nCopyright (c) 2019 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\n\nexport const supportsAdoptingStyleSheets =\n    ('adoptedStyleSheets' in Document.prototype);\n\nexport class CSSResult {\n\n  _styleSheet?: CSSStyleSheet|null;\n\n  readonly cssText: string;\n\n  constructor(cssText: string) { this.cssText = cssText; }\n\n  // Note, this is a getter so that it's lazy. In practice, this means\n  // stylesheets are not created until the first element instance is made.\n  get styleSheet(): CSSStyleSheet|null {\n    if (this._styleSheet === undefined) {\n      // Note, if `adoptedStyleSheets` is supported then we assume CSSStyleSheet\n      // is constructable.\n      if (supportsAdoptingStyleSheets) {\n        this._styleSheet = new CSSStyleSheet();\n        this._styleSheet.replaceSync(this.cssText);\n      } else {\n        this._styleSheet = null;\n      }\n    }\n    return this._styleSheet;\n  }\n}\n\nconst textFromCSSResult = (value: CSSResult) => {\n  if (value instanceof CSSResult) {\n    return value.cssText;\n  } else {\n    throw new Error(\n        `Value passed to 'css' function must be a 'css' function result: ${\n            value}.`);\n  }\n};\n\nexport const css =\n    (strings: TemplateStringsArray, ...values: CSSResult[]): CSSResult => {\n      const cssText = values.reduce(\n          (acc, v, idx) => acc + textFromCSSResult(v) + strings[idx + 1],\n          strings[0]);\n      return new CSSResult(cssText);\n    };","\n/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\nimport {LitElement} from '../lit-element.js';\n\nimport {PropertyDeclaration, UpdatingElement} from './updating-element.js';\n\nexport type Constructor<T> = {\n  new (...args: any[]): T\n};\n\n// From the TC39 Decorators proposal\ninterface ClassDescriptor {\n  kind: 'class';\n  elements: ClassElement[];\n  finisher?: <T>(clazz: Constructor<T>) => undefined | Constructor<T>;\n}\n\n// From the TC39 Decorators proposal\ninterface ClassElement {\n  kind: 'field'|'method';\n  key: PropertyKey;\n  placement: 'static'|'prototype'|'own';\n  initializer?: Function;\n  extras?: ClassElement[];\n  finisher?: <T>(clazz: Constructor<T>) => undefined | Constructor<T>;\n  descriptor?: PropertyDescriptor;\n}\n\nconst legacyCustomElement =\n    (tagName: string, clazz: Constructor<HTMLElement>) => {\n      window.customElements.define(tagName, clazz);\n      // Cast as any because TS doesn't recognize the return type as being a\n      // subtype of the decorated class when clazz is typed as\n      // `Constructor<HTMLElement>` for some reason.\n      // `Constructor<HTMLElement>` is helpful to make sure the decorator is\n      // applied to elements however.\n      return clazz as any;\n    };\n\nconst standardCustomElement =\n    (tagName: string, descriptor: ClassDescriptor) => {\n      const {kind, elements} = descriptor;\n      return {\n        kind,\n        elements,\n        // This callback is called once the class is otherwise fully defined\n        finisher(clazz: Constructor<HTMLElement>) {\n          window.customElements.define(tagName, clazz);\n        }\n      };\n    };\n\n/**\n * Class decorator factory that defines the decorated class as a custom element.\n *\n * @param tagName the name of the custom element to define\n *\n * In TypeScript, the `tagName` passed to `customElement` should be a key of the\n * `HTMLElementTagNameMap` interface. To add your element to the interface,\n * declare the interface in this module:\n *\n *     @customElement('my-element')\n *     export class MyElement extends LitElement {}\n *\n *     declare global {\n *       interface HTMLElementTagNameMap {\n *         'my-element': MyElement;\n *       }\n *     }\n *\n */\nexport const customElement = (tagName: string) => (\n    classOrDescriptor: Constructor<HTMLElement>|ClassDescriptor) =>\n    (typeof classOrDescriptor === 'function')\n        ? legacyCustomElement(tagName,\n                              classOrDescriptor as Constructor<HTMLElement>)\n        : standardCustomElement(tagName, classOrDescriptor as ClassDescriptor);\n\nconst standardProperty =\n    (options: PropertyDeclaration, element: ClassElement) => {\n      // When decorating an accessor, pass it through and add property metadata.\n      // Note, the `hasOwnProperty` check in `createProperty` ensures we don't\n      // stomp over the user's accessor.\n      if (element.kind === 'method' && element.descriptor &&\n          !('value' in element.descriptor)) {\n        return {\n          ...element,\n          finisher(clazz: typeof UpdatingElement) {\n            clazz.createProperty(element.key, options);\n          }\n        };\n      } else {\n        // createProperty() takes care of defining the property, but we still\n        // must return some kind of descriptor, so return a descriptor for an\n        // unused prototype field. The finisher calls createProperty().\n        return {\n          kind : 'field',\n          key : Symbol(),\n          placement : 'own',\n          descriptor : {},\n          // When @babel/plugin-proposal-decorators implements initializers,\n          // do this instead of the initializer below. See:\n          // https://github.com/babel/babel/issues/9260 extras: [\n          //   {\n          //     kind: 'initializer',\n          //     placement: 'own',\n          //     initializer: descriptor.initializer,\n          //   }\n          // ],\n          initializer(this: any) {\n            if (typeof element.initializer === 'function') {\n              this[element.key] = element.initializer!.call(this);\n            }\n          },\n          finisher(clazz: typeof UpdatingElement) {\n            clazz.createProperty(element.key, options);\n          }\n        };\n      }\n    };\n\nconst legacyProperty = (options: PropertyDeclaration, proto: Object,\n                        name: PropertyKey) => {\n  (proto.constructor as typeof UpdatingElement).createProperty(name!, options);\n};\n\n/**\n * A property decorator which creates a LitElement property which reflects a\n * corresponding attribute value. A `PropertyDeclaration` may optionally be\n * supplied to configure property features.\n *\n * @ExportDecoratedItems\n */\nexport function property(options?: PropertyDeclaration) {\n  return (protoOrDescriptor: Object|ClassElement, name?: PropertyKey): any =>\n             (name !== undefined)\n                 ? legacyProperty(options!, protoOrDescriptor as Object, name)\n                 : standardProperty(options!,\n                                    protoOrDescriptor as ClassElement);\n}\n\n/**\n * A property decorator that converts a class property into a getter that\n * executes a querySelector on the element's renderRoot.\n */\nexport const query = _query((target: NodeSelector, selector: string) =>\n                                target.querySelector(selector));\n\n/**\n * A property decorator that converts a class property into a getter\n * that executes a querySelectorAll on the element's renderRoot.\n */\nexport const queryAll = _query((target: NodeSelector, selector: string) =>\n                                   target.querySelectorAll(selector));\n\nconst legacyQuery =\n    (descriptor: PropertyDescriptor, proto: Object,\n     name: PropertyKey) => { Object.defineProperty(proto, name, descriptor); };\n\nconst standardQuery = (descriptor: PropertyDescriptor, element: ClassElement) =>\n    ({\n      kind : 'method',\n      placement : 'prototype',\n      key : element.key,\n      descriptor,\n    });\n\n/**\n * Base-implementation of `@query` and `@queryAll` decorators.\n *\n * @param queryFn exectute a `selector` (ie, querySelector or querySelectorAll)\n * against `target`.\n * @suppress {visibility} The descriptor accesses an internal field on the\n * element.\n */\nfunction _query<T>(queryFn: (target: NodeSelector, selector: string) => T) {\n  return (selector: string) => (protoOrDescriptor: Object|ClassElement,\n                                name?: PropertyKey): any => {\n    const descriptor = {\n      get(this: LitElement) { return queryFn(this.renderRoot!, selector); },\n      enumerable : true,\n      configurable : true,\n    };\n    return (name !== undefined)\n               ? legacyQuery(descriptor, protoOrDescriptor as Object, name)\n               : standardQuery(descriptor, protoOrDescriptor as ClassElement);\n  };\n}\n\nconst standardEventOptions =\n    (options: AddEventListenerOptions, element: ClassElement) => {\n      return {\n        ...element,\n        finisher(clazz: typeof UpdatingElement) {\n          Object.assign(clazz.prototype[element.key as keyof UpdatingElement],\n                        options);\n        }\n      };\n    };\n\nconst legacyEventOptions =\n    (options: AddEventListenerOptions, proto: any,\n     name: PropertyKey) => { Object.assign(proto[name], options); };\n\n/**\n * Adds event listener options to a method used as an event listener in a\n * lit-html template.\n *\n * @param options An object that specifis event listener options as accepted by\n * `EventTarget#addEventListener` and `EventTarget#removeEventListener`.\n *\n * Current browsers support the `capture`, `passive`, and `once` options. See:\n * https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Parameters\n *\n * @example\n *\n *     class MyElement {\n *\n *       clicked = false;\n *\n *       render() {\n *         return html`<div @click=${this._onClick}`><button></button></div>`;\n *       }\n *\n *       @eventOptions({capture: true})\n *       _onClick(e) {\n *         this.clicked = true;\n *       }\n *     }\n */\nexport const eventOptions = (options: AddEventListenerOptions) =>\n    // Return value typed as any to prevent TypeScript from complaining that\n    // standard decorator function signature does not match TypeScript decorator\n    // signature\n    // TODO(kschaaf): unclear why it was only failing on this decorator and not\n    // the others\n    ((protoOrDescriptor: Object|ClassElement, name?: string) =>\n         (name !== undefined)\n             ? legacyEventOptions(options, protoOrDescriptor as Object, name)\n             : standardEventOptions(options,\n                                    protoOrDescriptor as ClassElement)) as any;\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * When using Closure Compiler, JSCompiler_renameProperty(property, object) is\n * replaced at compile time by the munged name for object[property]. We cannot\n * alias this function, so we have to use a small shim that has the same\n * behavior when not compiling.\n */\nexport const JSCompiler_renameProperty = (prop: PropertyKey, _obj: any) => prop;\n\n/**\n * Converts property values to and from attribute values.\n */\nexport interface ComplexAttributeConverter<Type = any, TypeHint = any> {\n\n  /**\n   * Function called to convert an attribute value to a property\n   * value.\n   */\n  fromAttribute?(value: string, type?: TypeHint): Type;\n\n  /**\n   * Function called to convert a property value to an attribute\n   * value.\n   */\n  toAttribute?(value: Type, type?: TypeHint): string|null;\n}\n\ntype AttributeConverter<Type = any, TypeHint = any> =\n    ComplexAttributeConverter<Type>|((value: string, type?: TypeHint) => Type);\n\n/**\n * Defines options for a property accessor.\n */\nexport interface PropertyDeclaration<Type = any, TypeHint = any> {\n\n  /**\n   * Indicates how and whether the property becomes an observed attribute.\n   * If the value is `false`, the property is not added to `observedAttributes`.\n   * If true or absent, the lowercased property name is observed (e.g. `fooBar`\n   * becomes `foobar`). If a string, the string value is observed (e.g\n   * `attribute: 'foo-bar'`).\n   */\n  attribute?: boolean|string;\n\n  /**\n   * Indicates the type of the property. This is used only as a hint for the\n   * `converter` to determine how to convert the attribute\n   * to/from a property.\n   */\n  type?: TypeHint;\n\n  /**\n   * Indicates how to convert the attribute to/from a property. If this value\n   * is a function, it is used to convert the attribute value a the property\n   * value. If it's an object, it can have keys for `fromAttribute` and\n   * `toAttribute`. If no `toAttribute` function is provided and\n   * `reflect` is set to `true`, the property value is set directly to the\n   * attribute. A default `converter` is used if none is provided; it supports\n   * `Boolean`, `String`, `Number`, `Object`, and `Array`. Note,\n   * when a property changes and the converter is used to update the attribute,\n   * the property is never updated again as a result of the attribute changing,\n   * and vice versa.\n   */\n  converter?: AttributeConverter<Type, TypeHint>;\n\n  /**\n   * Indicates if the property should reflect to an attribute.\n   * If `true`, when the property is set, the attribute is set using the\n   * attribute name determined according to the rules for the `attribute`\n   * property option and the value of the property converted using the rules\n   * from the `converter` property option.\n   */\n  reflect?: boolean;\n\n  /**\n   * A function that indicates if a property should be considered changed when\n   * it is set. The function should take the `newValue` and `oldValue` and\n   * return `true` if an update should be requested.\n   */\n  hasChanged?(value: Type, oldValue: Type): boolean;\n\n  /**\n   * Indicates whether an accessor will be created for this property. By\n   * default, an accessor will be generated for this property that requests an\n   * update when set. If this flag is `true`, no accessor will be created, and\n   * it will be the user's responsibility to call\n   * `this.requestUpdate(propertyName, oldValue)` to request an update when\n   * the property changes.\n   */\n  noAccessor?: boolean;\n}\n\n/**\n * Map of properties to PropertyDeclaration options. For each property an\n * accessor is made, and the property is processed according to the\n * PropertyDeclaration options.\n */\nexport interface PropertyDeclarations {\n  [key: string]: PropertyDeclaration;\n}\n\ntype PropertyDeclarationMap = Map<PropertyKey, PropertyDeclaration>;\n\ntype AttributeMap = Map<string, PropertyKey>;\n\nexport type PropertyValues = Map<PropertyKey, unknown>;\n\nexport const defaultConverter: ComplexAttributeConverter = {\n\n  toAttribute(value: any, type?: any) {\n    switch (type) {\n    case Boolean:\n      return value ? '' : null;\n    case Object:\n    case Array:\n      // if the value is `null` or `undefined` pass this through\n      // to allow removing/no change behavior.\n      return value == null ? value : JSON.stringify(value);\n    }\n    return value;\n  },\n\n  fromAttribute(value: any, type?: any) {\n    switch (type) {\n    case Boolean:\n      return value !== null;\n    case Number:\n      return value === null ? null : Number(value);\n    case Object:\n    case Array:\n      return JSON.parse(value);\n    }\n    return value;\n  }\n\n};\n\nexport interface HasChanged {\n  (value: unknown, old: unknown): boolean;\n}\n\n/**\n * Change function that returns true if `value` is different from `oldValue`.\n * This method is used as the default for a property's `hasChanged` function.\n */\nexport const notEqual: HasChanged = (value: unknown, old: unknown): boolean => {\n  // This ensures (old==NaN, value==NaN) always returns false\n  return old !== value && (old === old || value === value);\n};\n\nconst defaultPropertyDeclaration: PropertyDeclaration = {\n  attribute : true,\n  type : String,\n  converter : defaultConverter,\n  reflect : false,\n  hasChanged : notEqual\n};\n\nconst microtaskPromise = Promise.resolve(true);\n\nconst STATE_HAS_UPDATED = 1;\nconst STATE_UPDATE_REQUESTED = 1 << 2;\nconst STATE_IS_REFLECTING_TO_ATTRIBUTE = 1 << 3;\nconst STATE_IS_REFLECTING_TO_PROPERTY = 1 << 4;\nconst STATE_HAS_CONNECTED = 1 << 5;\ntype UpdateState = typeof STATE_HAS_UPDATED|typeof STATE_UPDATE_REQUESTED|\n    typeof STATE_IS_REFLECTING_TO_ATTRIBUTE|\n    typeof STATE_IS_REFLECTING_TO_PROPERTY|typeof STATE_HAS_CONNECTED;\n\n/**\n * Base element class which manages element properties and attributes. When\n * properties change, the `update` method is asynchronously called. This method\n * should be supplied by subclassers to render updates as desired.\n */\nexport abstract class UpdatingElement extends HTMLElement {\n\n  /*\n   * Due to closure compiler ES6 compilation bugs, @nocollapse is required on\n   * all static methods and properties with initializers.  Reference:\n   * - https://github.com/google/closure-compiler/issues/1776\n   */\n\n  /**\n   * Maps attribute names to properties; for example `foobar` attribute to\n   * `fooBar` property. Created lazily on user subclasses when finalizing the\n   * class.\n   */\n  private static _attributeToPropertyMap: AttributeMap;\n\n  /**\n   * Marks class as having finished creating properties.\n   */\n  protected static finalized = true;\n\n  /**\n   * Memoized list of all class properties, including any superclass properties.\n   * Created lazily on user subclasses when finalizing the class.\n   */\n  private static _classProperties?: PropertyDeclarationMap;\n\n  /**\n   * User-supplied object that maps property names to `PropertyDeclaration`\n   * objects containing options for configuring the property.\n   */\n  static properties: PropertyDeclarations;\n\n  /**\n   * Returns a list of attributes corresponding to the registered properties.\n   * @nocollapse\n   */\n  static get observedAttributes() {\n    // note: piggy backing on this to ensure we're _finalized.\n    this._finalize();\n    const attributes: string[] = [];\n    // Use forEach so this works even if for/of loops are compiled to for loops\n    // expecting arrays\n    this._classProperties!.forEach((v, p) => {\n      const attr = this._attributeNameForProperty(p, v);\n      if (attr !== undefined) {\n        this._attributeToPropertyMap.set(attr, p);\n        attributes.push(attr);\n      }\n    });\n    return attributes;\n  }\n\n  /**\n   * Ensures the private `_classProperties` property metadata is created.\n   * In addition to `_finalize` this is also called in `createProperty` to\n   * ensure the `@property` decorator can add property metadata.\n   */\n  /** @nocollapse */\n  private static _ensureClassProperties() {\n    // ensure private storage for property declarations.\n    if (!this.hasOwnProperty(\n            JSCompiler_renameProperty('_classProperties', this))) {\n      this._classProperties = new Map();\n      // NOTE: Workaround IE11 not supporting Map constructor argument.\n      const superProperties = Object.getPrototypeOf(this)._classProperties;\n      if (superProperties !== undefined) {\n        superProperties.forEach((v: any, k: PropertyKey) =>\n                                    this._classProperties!.set(k, v));\n      }\n    }\n  }\n\n  /**\n   * Creates a property accessor on the element prototype if one does not exist.\n   * The property setter calls the property's `hasChanged` property option\n   * or uses a strict identity check to determine whether or not to request\n   * an update.\n   * @nocollapse\n   */\n  static createProperty(name: PropertyKey,\n                        options:\n                            PropertyDeclaration = defaultPropertyDeclaration) {\n    // Note, since this can be called by the `@property` decorator which\n    // is called before `_finalize`, we ensure storage exists for property\n    // metadata.\n    this._ensureClassProperties();\n    this._classProperties!.set(name, options);\n    // Do not generate an accessor if the prototype already has one, since\n    // it would be lost otherwise and that would never be the user's intention;\n    // Instead, we expect users to call `requestUpdate` themselves from\n    // user-defined accessors. Note that if the super has an accessor we will\n    // still overwrite it\n    if (options.noAccessor || this.prototype.hasOwnProperty(name)) {\n      return;\n    }\n    const key = typeof name === 'symbol' ? Symbol() : `__${name}`;\n    Object.defineProperty(this.prototype, name, {\n      get(): any { return (this as any)[key]; },\n      set(this: UpdatingElement, value: any) {\n        const oldValue = (this as any)[name];\n        (this as any)[key] = value;\n          this.requestUpdate(name, oldValue);\n        },\n        configurable : true,\n        enumerable : true\n      }\n    );\n  }\n\n  /**\n   * Creates property accessors for registered properties and ensures\n   * any superclasses are also finalized.\n   * @nocollapse\n   */\n  private static _finalize() {\n    if (this.hasOwnProperty(JSCompiler_renameProperty('finalized', this)) &&\n        this.finalized) {\n      return;\n    }\n    // finalize any superclasses\n    const superCtor = Object.getPrototypeOf(this);\n    if (typeof superCtor._finalize === 'function') {\n      superCtor._finalize();\n    }\n    this.finalized = true;\n    this._ensureClassProperties();\n    // initialize Map populated in observedAttributes\n    this._attributeToPropertyMap = new Map();\n    // make any properties\n    // Note, only process \"own\" properties since this element will inherit\n    // any properties defined on the superClass, and finalization ensures\n    // the entire prototype chain is finalized.\n    if (this.hasOwnProperty(JSCompiler_renameProperty('properties', this))) {\n      const props = this.properties;\n      // support symbols in properties (IE11 does not support this)\n      const propKeys = [\n        ...Object.getOwnPropertyNames(props),\n        ...(typeof Object.getOwnPropertySymbols === 'function')\n            ? Object.getOwnPropertySymbols(props)\n            : []\n      ];\n      // This for/of is ok because propKeys is an array\n      for (const p of propKeys) {\n        // note, use of `any` is due to TypeSript lack of support for symbol in\n        // index types\n        this.createProperty(p, (props as any)[p]);\n      }\n    }\n  }\n\n  /**\n   * Returns the property name for the given attribute `name`.\n   * @nocollapse\n   */\n  private static _attributeNameForProperty(name: PropertyKey,\n                                           options: PropertyDeclaration) {\n    const attribute = options.attribute;\n    return attribute === false\n               ? undefined\n               : (typeof attribute === 'string'\n                      ? attribute\n                      : (typeof name === 'string' ? name.toLowerCase()\n                                                  : undefined));\n  }\n\n  /**\n   * Returns true if a property should request an update.\n   * Called when a property value is set and uses the `hasChanged`\n   * option for the property if present or a strict identity check.\n   * @nocollapse\n   */\n  private static _valueHasChanged(value: unknown, old: unknown,\n                                  hasChanged: HasChanged = notEqual) {\n    return hasChanged(value, old);\n  }\n\n  /**\n   * Returns the property value for the given attribute value.\n   * Called via the `attributeChangedCallback` and uses the property's\n   * `converter` or `converter.fromAttribute` property option.\n   * @nocollapse\n   */\n  private static _propertyValueFromAttribute(value: string,\n                                             options: PropertyDeclaration) {\n    const type = options.type;\n    const converter = options.converter || defaultConverter;\n    const fromAttribute =\n        (typeof converter === 'function' ? converter : converter.fromAttribute);\n    return fromAttribute ? fromAttribute(value, type) : value;\n  }\n\n  /**\n   * Returns the attribute value for the given property value. If this\n   * returns undefined, the property will *not* be reflected to an attribute.\n   * If this returns null, the attribute will be removed, otherwise the\n   * attribute will be set to the value.\n   * This uses the property's `reflect` and `type.toAttribute` property options.\n   * @nocollapse\n   */\n  private static _propertyValueToAttribute(value: unknown,\n                                           options: PropertyDeclaration) {\n    if (options.reflect === undefined) {\n      return;\n    }\n    const type = options.type;\n    const converter = options.converter;\n    const toAttribute =\n        converter && (converter as ComplexAttributeConverter).toAttribute ||\n        defaultConverter.toAttribute;\n    return toAttribute!(value, type);\n  }\n\n  private _updateState: UpdateState = 0;\n  private _instanceProperties: PropertyValues|undefined = undefined;\n  private _updatePromise: Promise<unknown> = microtaskPromise;\n  private _hasConnectedResolver: (() => void)|undefined = undefined;\n\n  /**\n   * Map with keys for any properties that have changed since the last\n   * update cycle with previous values.\n   */\n  private _changedProperties: PropertyValues = new Map();\n\n  /**\n   * Map with keys of properties that should be reflected when updated.\n   */\n  private _reflectingProperties: Map<PropertyKey, PropertyDeclaration>|\n      undefined = undefined;\n\n  constructor() {\n    super();\n    this.initialize();\n  }\n\n  /**\n   * Performs element initialization. By default captures any pre-set values for\n   * registered properties.\n   */\n  protected initialize() { this._saveInstanceProperties(); }\n\n  /**\n   * Fixes any properties set on the instance before upgrade time.\n   * Otherwise these would shadow the accessor and break these properties.\n   * The properties are stored in a Map which is played back after the\n   * constructor runs. Note, on very old versions of Safari (<=9) or Chrome\n   * (<=41), properties created for native platform properties like (`id` or\n   * `name`) may not have default values set in the element constructor. On\n   * these browsers native properties appear on instances and therefore their\n   * default value will overwrite any element default (e.g. if the element sets\n   * this.id = 'id' in the constructor, the 'id' will become '' since this is\n   * the native platform default).\n   */\n  private _saveInstanceProperties() {\n    // Use forEach so this works even if for/of loops are compiled to for loops\n    // expecting arrays\n    (this.constructor as typeof UpdatingElement)\n        ._classProperties!.forEach((_v, p) => {\n          if (this.hasOwnProperty(p)) {\n            const value = this[p as keyof this];\n            delete this[p as keyof this];\n            if (!this._instanceProperties) {\n              this._instanceProperties = new Map();\n            }\n            this._instanceProperties.set(p, value);\n          }\n        });\n  }\n\n  /**\n   * Applies previously saved instance properties.\n   */\n  private _applyInstanceProperties() {\n    // Use forEach so this works even if for/of loops are compiled to for loops\n    // expecting arrays\n    this._instanceProperties!.forEach((v, p) => (this as any)[p] = v);\n    this._instanceProperties = undefined;\n  }\n\n  connectedCallback() {\n    this._updateState = this._updateState | STATE_HAS_CONNECTED;\n    // Ensure connection triggers an update. Updates cannot complete before\n    // connection and if one is pending connection the `_hasConnectionResolver`\n    // will exist. If so, resolve it to complete the update, otherwise\n    // requestUpdate.\n    if (this._hasConnectedResolver) {\n      this._hasConnectedResolver();\n      this._hasConnectedResolver = undefined;\n    } else {\n      this.requestUpdate();\n    }\n  }\n\n  /**\n   * Allows for `super.disconnectedCallback()` in extensions while\n   * reserving the possibility of making non-breaking feature additions\n   * when disconnecting at some point in the future.\n   */\n  disconnectedCallback() {}\n\n  /**\n   * Synchronizes property values when attributes change.\n   */\n  attributeChangedCallback(name: string, old: string, value: string) {\n    if (old !== value) {\n      this._attributeToProperty(name, value);\n    }\n  }\n\n  private _propertyToAttribute(\n      name: PropertyKey, value: unknown,\n      options: PropertyDeclaration = defaultPropertyDeclaration) {\n    const ctor = (this.constructor as typeof UpdatingElement);\n    const attr = ctor._attributeNameForProperty(name, options);\n    if (attr !== undefined) {\n      const attrValue = ctor._propertyValueToAttribute(value, options);\n      // an undefined value does not change the attribute.\n      if (attrValue === undefined) {\n        return;\n      }\n      // Track if the property is being reflected to avoid\n      // setting the property again via `attributeChangedCallback`. Note:\n      // 1. this takes advantage of the fact that the callback is synchronous.\n      // 2. will behave incorrectly if multiple attributes are in the reaction\n      // stack at time of calling. However, since we process attributes\n      // in `update` this should not be possible (or an extreme corner case\n      // that we'd like to discover).\n      // mark state reflecting\n      this._updateState = this._updateState | STATE_IS_REFLECTING_TO_ATTRIBUTE;\n      if (attrValue == null) {\n        this.removeAttribute(attr);\n      } else {\n        this.setAttribute(attr, attrValue);\n      }\n      // mark state not reflecting\n      this._updateState = this._updateState & ~STATE_IS_REFLECTING_TO_ATTRIBUTE;\n    }\n  }\n\n  private _attributeToProperty(name: string, value: string) {\n    // Use tracking info to avoid deserializing attribute value if it was\n    // just set from a property setter.\n    if (this._updateState & STATE_IS_REFLECTING_TO_ATTRIBUTE) {\n      return;\n    }\n    const ctor = (this.constructor as typeof UpdatingElement);\n    const propName = ctor._attributeToPropertyMap.get(name);\n    if (propName !== undefined) {\n      const options =\n          ctor._classProperties!.get(propName) || defaultPropertyDeclaration;\n      // mark state reflecting\n      this._updateState = this._updateState | STATE_IS_REFLECTING_TO_PROPERTY;\n      this[propName as keyof this] =\n          ctor._propertyValueFromAttribute(value, options);\n      // mark state not reflecting\n      this._updateState = this._updateState & ~STATE_IS_REFLECTING_TO_PROPERTY;\n    }\n  }\n\n  /**\n   * Requests an update which is processed asynchronously. This should\n   * be called when an element should update based on some state not triggered\n   * by setting a property. In this case, pass no arguments. It should also be\n   * called when manually implementing a property setter. In this case, pass the\n   * property `name` and `oldValue` to ensure that any configured property\n   * options are honored. Returns the `updateComplete` Promise which is resolved\n   * when the update completes.\n   *\n   * @param name {PropertyKey} (optional) name of requesting property\n   * @param oldValue {any} (optional) old value of requesting property\n   * @returns {Promise} A Promise that is resolved when the update completes.\n   */\n  requestUpdate(name?: PropertyKey, oldValue?: any) {\n    let shouldRequestUpdate = true;\n    // if we have a property key, perform property update steps.\n    if (name !== undefined && !this._changedProperties.has(name)) {\n      const ctor = this.constructor as typeof UpdatingElement;\n      const options =\n          ctor._classProperties!.get(name) || defaultPropertyDeclaration;\n      if (ctor._valueHasChanged(this[name as keyof this], oldValue,\n                                options.hasChanged)) {\n        // track old value when changing.\n        this._changedProperties.set(name, oldValue);\n        // add to reflecting properties set\n        if (options.reflect === true &&\n            !(this._updateState & STATE_IS_REFLECTING_TO_PROPERTY)) {\n          if (this._reflectingProperties === undefined) {\n            this._reflectingProperties = new Map();\n          }\n          this._reflectingProperties.set(name, options);\n        }\n        // abort the request if the property should not be considered changed.\n      } else {\n        shouldRequestUpdate = false;\n      }\n    }\n    if (!this._hasRequestedUpdate && shouldRequestUpdate) {\n      this._enqueueUpdate();\n    }\n    return this.updateComplete;\n  }\n\n  /**\n   * Sets up the element to asynchronously update.\n   */\n  private async _enqueueUpdate() {\n    // Mark state updating...\n    this._updateState = this._updateState | STATE_UPDATE_REQUESTED;\n    let resolve: (r: boolean) => void;\n    const previousUpdatePromise = this._updatePromise;\n    this._updatePromise = new Promise((res) => resolve = res);\n    // Ensure any previous update has resolved before updating.\n    // This `await` also ensures that property changes are batched.\n    await previousUpdatePromise;\n    // Make sure the element has connected before updating.\n    if (!this._hasConnected) {\n      await new Promise((res) => this._hasConnectedResolver = res);\n    }\n    // Allow `performUpdate` to be asynchronous to enable scheduling of updates.\n    const result = this.performUpdate();\n    // Note, this is to avoid delaying an additional microtask unless we need\n    // to.\n    if (result != null &&\n        typeof (result as PromiseLike<unknown>).then === 'function') {\n      await result;\n    }\n    resolve!(!this._hasRequestedUpdate);\n  }\n\n  private get _hasConnected() {\n    return (this._updateState & STATE_HAS_CONNECTED);\n  }\n\n  private get _hasRequestedUpdate() {\n    return (this._updateState & STATE_UPDATE_REQUESTED);\n  }\n\n  protected get hasUpdated() { return (this._updateState & STATE_HAS_UPDATED); }\n\n  /**\n   * Performs an element update.\n   *\n   * You can override this method to change the timing of updates. For instance,\n   * to schedule updates to occur just before the next frame:\n   *\n   * ```\n   * protected async performUpdate(): Promise<unknown> {\n   *   await new Promise((resolve) => requestAnimationFrame(() => resolve()));\n   *   super.performUpdate();\n   * }\n   * ```\n   */\n  protected performUpdate(): void|Promise<unknown> {\n    // Mixin instance properties once, if they exist.\n    if (this._instanceProperties) {\n      this._applyInstanceProperties();\n    }\n    if (this.shouldUpdate(this._changedProperties)) {\n      const changedProperties = this._changedProperties;\n      this.update(changedProperties);\n      this._markUpdated();\n      if (!(this._updateState & STATE_HAS_UPDATED)) {\n        this._updateState = this._updateState | STATE_HAS_UPDATED;\n        this.firstUpdated(changedProperties);\n      }\n      this.updated(changedProperties);\n    } else {\n      this._markUpdated();\n    }\n  }\n\n  private _markUpdated() {\n    this._changedProperties = new Map();\n    this._updateState = this._updateState & ~STATE_UPDATE_REQUESTED;\n  }\n\n  /**\n   * Returns a Promise that resolves when the element has completed updating.\n   * The Promise value is a boolean that is `true` if the element completed the\n   * update without triggering another update. The Promise result is `false` if\n   * a property was set inside `updated()`. This getter can be implemented to\n   * await additional state. For example, it is sometimes useful to await a\n   * rendered element before fulfilling this Promise. To do this, first await\n   * `super.updateComplete` then any subsequent state.\n   *\n   * @returns {Promise} The Promise returns a boolean that indicates if the\n   * update resolved without triggering another update.\n   */\n  get updateComplete() { return this._updatePromise; }\n\n  /**\n   * Controls whether or not `update` should be called when the element requests\n   * an update. By default, this method always returns `true`, but this can be\n   * customized to control when to update.\n   *\n   * * @param _changedProperties Map of changed properties with old values\n   */\n  protected shouldUpdate(_changedProperties: PropertyValues): boolean {\n    return true;\n  }\n\n  /**\n   * Updates the element. This method reflects property values to attributes.\n   * It can be overridden to render and keep updated element DOM.\n   * Setting properties inside this method will *not* trigger\n   * another update.\n   *\n   * * @param _changedProperties Map of changed properties with old values\n   */\n  protected update(_changedProperties: PropertyValues) {\n    if (this._reflectingProperties !== undefined &&\n        this._reflectingProperties.size > 0) {\n      // Use forEach so this works even if for/of loops are compiled to for\n      // loops expecting arrays\n      this._reflectingProperties.forEach(\n          (v, k) => this._propertyToAttribute(k, this[k as keyof this], v));\n      this._reflectingProperties = undefined;\n    }\n  }\n\n  /**\n   * Invoked whenever the element is updated. Implement to perform\n   * post-updating tasks via DOM APIs, for example, focusing an element.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * * @param _changedProperties Map of changed properties with old values\n   */\n  protected updated(_changedProperties: PropertyValues) {}\n\n  /**\n   * Invoked when the element is first updated. Implement to perform one time\n   * work on the element after update.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * * @param _changedProperties Map of changed properties with old values\n   */\n  protected firstUpdated(_changedProperties: PropertyValues) {}\n}\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nimport {TemplateResult} from 'lit-html';\nimport {render} from 'lit-html/lib/shady-render';\n\nimport {PropertyValues, UpdatingElement, JSCompiler_renameProperty} from './lib/updating-element.js';\n\nexport * from './lib/updating-element.js';\nexport * from './lib/decorators.js';\nexport {html, svg, TemplateResult, SVGTemplateResult} from 'lit-html/lit-html';\nimport {supportsAdoptingStyleSheets, CSSResult} from './lib/css-tag.js';\nexport * from './lib/css-tag.js';\n\nexport interface CSSResultArray extends Array<CSSResult | CSSResultArray> {}\n\n/**\n * Minimal implementation of Array.prototype.flat\n * @param arr the array to flatten\n * @param result the accumlated result\n */\nfunction arrayFlat(styles: CSSResultArray, result: CSSResult[] = []): CSSResult[] {\n  for (let i = 0, length = styles.length; i < length; i++) {\n    const value = styles[i];\n    if (Array.isArray(value)) {\n      arrayFlat(value, result);\n    } else {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\n/** Deeply flattens styles array. Uses native flat if available. */\nconst flattenStyles = (styles: CSSResultArray): CSSResult[] => styles.flat ? styles.flat(Infinity) : arrayFlat(styles);\n\nexport class LitElement extends UpdatingElement {\n\n  /**\n   * Ensure this class is marked as `finalized` as an optimization ensuring\n   * it will not needlessly try to `finalize`.\n   */\n  protected static finalized = true;\n\n  /**\n   * Render method used to render the lit-html TemplateResult to the element's\n   * DOM.\n   * @param {TemplateResult} Template to render.\n   * @param {Element|DocumentFragment} Node into which to render.\n   * @param {String} Element name.\n   * @nocollapse\n   */\n  static render = render;\n\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the `css` tag function.\n   */\n  static styles?: CSSResult | CSSResultArray;\n\n  private static _styles: CSSResult[]|undefined;\n\n  private static get _uniqueStyles(): CSSResult[] {\n    if (!this.hasOwnProperty(JSCompiler_renameProperty('_styles', this))) {\n      // Inherit styles from superclass if none have been set.\n      if (!this.hasOwnProperty(JSCompiler_renameProperty('styles', this))) {\n        this._styles = this._styles !== undefined ? this._styles : [];\n      } else {\n        // Take care not to call `this.styles` multiple times since this generates\n        // new CSSResults each time.\n        // TODO(sorvell): Since we do not cache CSSResults by input, any\n        // shared styles will generate new stylesheet objects, which is wasteful.\n        // This should be addressed when a browser ships constructable\n        // stylesheets.\n        const userStyles = this.styles;\n        if (Array.isArray(userStyles)) {\n          const styles = flattenStyles(userStyles);\n          // As a performance optimization to avoid duplicated styling that can\n          // occur especially when composing via subclassing, de-duplicate styles\n          // preserving the last item in the list. The last item is kept to\n          // try to preserve cascade order with the assumption that it's most\n          // important that last added styles override previous styles.\n          const styleSet = styles.reduceRight((set, s) => {\n            set.add(s);\n            // on IE set.add does not return the set.\n            return set;\n          }, new Set<CSSResult>());\n          // Array.from does not work on Set in IE\n          this._styles = [];\n          styleSet.forEach((v) => this._styles!.unshift(v));\n        } else {\n          this._styles = userStyles ? [userStyles] : [];\n        }\n      }\n    }\n    return this._styles as CSSResult[];\n  }\n\n  private _needsShimAdoptedStyleSheets?: boolean;\n\n  /**\n   * Node or ShadowRoot into which element DOM should be rendered. Defaults\n   * to an open shadowRoot.\n   */\n  protected renderRoot?: Element|DocumentFragment;\n\n  /**\n   * Performs element initialization. By default this calls `createRenderRoot`\n   * to create the element `renderRoot` node and captures any pre-set values for\n   * registered properties.\n   */\n  protected initialize() {\n    super.initialize();\n    this.renderRoot = this.createRenderRoot();\n    // Note, if renderRoot is not a shadowRoot, styles would/could apply to the\n    // element's getRootNode(). While this could be done, we're choosing not to\n    // support this now since it would require different logic around de-duping.\n    if (window.ShadowRoot && this.renderRoot instanceof window.ShadowRoot) {\n      this.adoptStyles();\n    }\n  }\n\n  /**\n   * Returns the node into which the element should render and by default\n   * creates and returns an open shadowRoot. Implement to customize where the\n   * element's DOM is rendered. For example, to render into the element's\n   * childNodes, return `this`.\n   * @returns {Element|DocumentFragment} Returns a node into which to render.\n   */\n  protected createRenderRoot(): Element|ShadowRoot {\n    return this.attachShadow({mode : 'open'});\n  }\n\n  /**\n   * Applies styling to the element shadowRoot using the `static get styles`\n   * property. Styling will apply using `shadowRoot.adoptedStyleSheets` where\n   * available and will fallback otherwise. When Shadow DOM is polyfilled,\n   * ShadyCSS scopes styles and adds them to the document. When Shadow DOM\n   * is available but `adoptedStyleSheets` is not, styles are appended to the\n   * end of the `shadowRoot` to [mimic spec\n   * behavior](https://wicg.github.io/construct-stylesheets/#using-constructed-stylesheets).\n   */\n  protected adoptStyles() {\n    const styles = (this.constructor as typeof LitElement)._uniqueStyles;\n    if (styles.length === 0) {\n      return;\n    }\n    // There are three separate cases here based on Shadow DOM support.\n    // (1) shadowRoot polyfilled: use ShadyCSS\n    // (2) shadowRoot.adoptedStyleSheets available: use it.\n    // (3) shadowRoot.adoptedStyleSheets polyfilled: append styles after\n    // rendering\n    if (window.ShadyCSS !== undefined && !window.ShadyCSS.nativeShadow) {\n      window.ShadyCSS.ScopingShim.prepareAdoptedCssText(\n          styles.map((s) => s.cssText), this.localName);\n    } else if (supportsAdoptingStyleSheets) {\n      (this.renderRoot as ShadowRoot).adoptedStyleSheets =\n          styles.map((s) => s.styleSheet!);\n    } else {\n      // This must be done after rendering so the actual style insertion is done\n      // in `update`.\n      this._needsShimAdoptedStyleSheets = true;\n    }\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    // Note, first update/render handles styleElement so we only call this if\n    // connected after first update.\n    if (this.hasUpdated && window.ShadyCSS !== undefined) {\n      window.ShadyCSS.styleElement(this);\n    }\n  }\n\n  /**\n   * Updates the element. This method reflects property values to attributes\n   * and calls `render` to render DOM via lit-html. Setting properties inside\n   * this method will *not* trigger another update.\n   * * @param _changedProperties Map of changed properties with old values\n   */\n  protected update(changedProperties: PropertyValues) {\n    super.update(changedProperties);\n    const templateResult = this.render() as any;\n    if (templateResult instanceof TemplateResult) {\n      (this.constructor as typeof LitElement)\n          .render(templateResult, this.renderRoot!,\n                  {scopeName : this.localName!, eventContext : this});\n    }\n    // When native Shadow DOM is used but adoptedStyles are not supported,\n    // insert styling after rendering to ensure adoptedStyles have highest\n    // priority.\n    if (this._needsShimAdoptedStyleSheets) {\n      this._needsShimAdoptedStyleSheets = false;\n      (this.constructor as typeof LitElement)._uniqueStyles.forEach((s) => {\n        const style = document.createElement('style');\n        style.textContent = s.cssText;\n        this.renderRoot!.appendChild(style);\n      });\n    }\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  protected render(): TemplateResult|void {}\n}\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\nimport {DirectiveFn} from '../lib/directive.js';\nimport {createMarker, directive, NodePart, Part, removeNodes, reparentNodes} from '../lit-html.js';\n\nexport type KeyFn<T> = (item: T, index: number) => any;\nexport type ItemTemplate<T> = (item: T, index: number) => any;\n\n// Helper functions for manipulating parts\n// TODO(kschaaf): Refactor into Part API?\nconst createAndInsertPart =\n    (containerPart: NodePart, beforePart?: NodePart): NodePart => {\n      const container = containerPart.startNode.parentNode as Node;\n      const beforeNode = beforePart === undefined ? containerPart.endNode :\n                                                    beforePart.startNode;\n      const startNode = container.insertBefore(createMarker(), beforeNode);\n      container.insertBefore(createMarker(), beforeNode);\n      const newPart = new NodePart(containerPart.options);\n      newPart.insertAfterNode(startNode);\n      return newPart;\n    };\n\nconst updatePart = (part: NodePart, value: unknown) => {\n  part.setValue(value);\n  part.commit();\n  return part;\n};\n\nconst insertPartBefore =\n    (containerPart: NodePart, part: NodePart, ref?: NodePart) => {\n      const container = containerPart.startNode.parentNode as Node;\n      const beforeNode = ref ? ref.startNode : containerPart.endNode;\n      const endNode = part.endNode.nextSibling;\n      if (endNode !== beforeNode) {\n        reparentNodes(container, part.startNode, endNode, beforeNode);\n      }\n    };\n\nconst removePart = (part: NodePart) => {\n  removeNodes(\n      part.startNode.parentNode!, part.startNode, part.endNode.nextSibling);\n};\n\n// Helper for generating a map of array item to its index over a subset\n// of an array (used to lazily generate `newKeyToIndexMap` and\n// `oldKeyToIndexMap`)\nconst generateMap = (list: unknown[], start: number, end: number) => {\n  const map = new Map();\n  for (let i = start; i <= end; i++) {\n    map.set(list[i], i);\n  }\n  return map;\n};\n\n// Stores previous ordered list of parts and map of key to index\nconst partListCache = new WeakMap<NodePart, (NodePart | null)[]>();\nconst keyListCache = new WeakMap<NodePart, unknown[]>();\n\n/**\n * A directive that repeats a series of values (usually `TemplateResults`)\n * generated from an iterable, and updates those items efficiently when the\n * iterable changes based on user-provided `keys` associated with each item.\n *\n * Note that if a `keyFn` is provided, strict key-to-DOM mapping is maintained,\n * meaning previous DOM for a given key is moved into the new position if\n * needed, and DOM will never be reused with values for different keys (new DOM\n * will always be created for new keys). This is generally the most efficient\n * way to use `repeat` since it performs minimum unnecessary work for insertions\n * amd removals.\n *\n * IMPORTANT: If providing a `keyFn`, keys *must* be unique for all items in a\n * given call to `repeat`. The behavior when two or more items have the same key\n * is undefined.\n *\n * If no `keyFn` is provided, this directive will perform similar to mapping\n * items to values, and DOM will be reused against potentially different items.\n */\nexport const repeat = directive(\n    <T>(items: Iterable<T>,\n        keyFnOrTemplate: KeyFn<T>|ItemTemplate<T>,\n        template?: ItemTemplate<T>): DirectiveFn => {\n      let keyFn: KeyFn<T>;\n      if (template === undefined) {\n        template = keyFnOrTemplate;\n      } else if (keyFnOrTemplate !== undefined) {\n        keyFn = keyFnOrTemplate as KeyFn<T>;\n      }\n\n      return (containerPart: Part): void => {\n        if (!(containerPart instanceof NodePart)) {\n          throw new Error('repeat can only be used in text bindings');\n        }\n        // Old part & key lists are retrieved from the last update (associated\n        // with the part for this instance of the directive)\n        const oldParts = partListCache.get(containerPart) || [];\n        const oldKeys = keyListCache.get(containerPart) || [];\n\n        // New part list will be built up as we go (either reused from old parts\n        // or created for new keys in this update). This is saved in the above\n        // cache at the end of the update.\n        const newParts: NodePart[] = [];\n\n        // New value list is eagerly generated from items along with a parallel\n        // array indicating its key.\n        const newValues: unknown[] = [];\n        const newKeys: unknown[] = [];\n        let index = 0;\n        for (const item of items) {\n          newKeys[index] = keyFn ? keyFn(item, index) : index;\n          newValues[index] = template !(item, index);\n          index++;\n        }\n\n        // Maps from key to index for current and previous update; these are\n        // generated lazily only when needed as a performance optimization,\n        // since they are only required for multiple non-contiguous changes in\n        // the list, which are less common.\n        let newKeyToIndexMap!: Map<unknown, number>;\n        let oldKeyToIndexMap!: Map<unknown, number>;\n\n        // Head and tail pointers to old parts and new values\n        let oldHead = 0;\n        let oldTail = oldParts.length - 1;\n        let newHead = 0;\n        let newTail = newValues.length - 1;\n\n        // Overview of O(n) reconciliation algorithm (general approach based on\n        // ideas found in ivi, vue, snabbdom, etc.):\n        //\n        // * We start with the list of old parts and new values (and arrays of\n        //   their respective keys), head/tail pointers into each, and we build\n        //   up the new list of parts by updating (and when needed, moving) old\n        //   parts or creating new ones. The initial scenario might look like\n        //   this (for brevity of the diagrams, the numbers in the array reflect\n        //   keys associated with the old parts or new values, although keys and\n        //   parts/values are actually stored in parallel arrays indexed using\n        //   the same head/tail pointers):\n        //\n        //      oldHead v                 v oldTail\n        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n        //   newParts: [ ,  ,  ,  ,  ,  ,  ]\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6] <- reflects the user's new item\n        //   order\n        //      newHead ^                 ^ newTail\n        //\n        // * Iterate old & new lists from both sides, updating, swapping, or\n        //   removing parts at the head/tail locations until neither head nor\n        //   tail can move.\n        //\n        // * Example below: keys at head pointers match, so update old part 0\n        // in-\n        //   place (no need to move it) and record part 0 in the `newParts`\n        //   list. The last thing we do is advance the `oldHead` and `newHead`\n        //   pointers (will be reflected in the next diagram).\n        //\n        //      oldHead v                 v oldTail\n        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n        //   newParts: [0,  ,  ,  ,  ,  ,  ] <- heads matched: update 0 and\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    advance both oldHead & newHead\n        //      newHead ^                 ^ newTail\n        //\n        // * Example below: head pointers don't match, but tail pointers do, so\n        //   update part 6 in place (no need to move it), and record part 6 in\n        //   the `newParts` list. Last, advance the `oldTail` and `oldHead`\n        //   pointers.\n        //\n        //         oldHead v              v oldTail\n        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n        //   newParts: [0,  ,  ,  ,  ,  , 6] <- tails matched: update 6 and\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    advance both oldTail & newTail\n        //         newHead ^              ^ newTail\n        //\n        // * If neither head nor tail match; next check if one of the old\n        // head/tail\n        //   items was removed. We first need to generate the reverse map of new\n        //   keys to index (`newKeyToIndexMap`), which is done once lazily as a\n        //   performance optimization, since we only hit this case if multiple\n        //   non-contiguous changes were made. Note that for contiguous removal\n        //   anywhere in the list, the head and tails would advance from either\n        //   end and pass each other before we get to this case and removals\n        //   would be handled in the final while loop without needing to\n        //   generate the map.\n        //\n        // * Example below: The key at `oldTail` was removed (no longer in the\n        //   `newKeyToIndexMap`), so remove that part from the DOM and advance\n        //   just the `oldTail` pointer.\n        //\n        //         oldHead v           v oldTail\n        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n        //   newParts: [0,  ,  ,  ,  ,  , 6] <- 5 not in new map; remove 5 and\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    advance oldTail\n        //         newHead ^           ^ newTail\n        //\n        // * Once head and tail cannot move, any mismatches are due to either\n        // new or\n        //   moved items; if a new key is in the previous \"old key to old index\"\n        //   map, move the old part to the new location, otherwise create and\n        //   insert a new part. Note that when moving an old part we null its\n        //   position in the oldParts array if it lies between the head and tail\n        //   so we know to skip it when the pointers get there.\n        //\n        // * Example below: neither head nor tail match, and neither were\n        // removed;\n        //   so find the `newHead` key in the `oldKeyToIndexMap`, and move that\n        //   old part's DOM into the next head position (before\n        //   `oldParts[oldHead]`). Last, null the part in the `oldPart` array\n        //   since it was somewhere in the remaining oldParts still to be\n        //   scanned (between the head and tail pointers) so that we know to\n        //   skip that old part on future iterations.\n        //\n        //         oldHead v        v oldTail\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n        //   newParts: [0, 2,  ,  ,  ,  , 6] <- stuck; update & move 2 into\n        //   place newKeys:  [0, 2, 1, 4, 3, 7, 6]    and advance newHead\n        //         newHead ^           ^ newTail\n        //\n        // * Note that for moves/insertions like the one above, a part inserted\n        // at\n        //   the head pointer is inserted before the current\n        //   `oldParts[oldHead]`, and a part inserted at the tail pointer is\n        //   inserted before `newParts[newTail+1]`. The seeming asymmetry lies\n        //   in the fact that new parts are moved into place outside in, so to\n        //   the right of the head pointer are old parts, and to the right of\n        //   the tail pointer are new parts.\n        //\n        // * We always restart back from the top of the algorithm, allowing\n        // matching\n        //   and simple updates in place to continue...\n        //\n        // * Example below: the head pointers once again match, so simply update\n        //   part 1 and record it in the `newParts` array.  Last, advance both\n        //   head pointers.\n        //\n        //         oldHead v        v oldTail\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n        //   newParts: [0, 2, 1,  ,  ,  , 6] <- heads matched; update 1 and\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    advance both oldHead & newHead\n        //            newHead ^        ^ newTail\n        //\n        // * As mentioned above, items that were moved as a result of being\n        // stuck\n        //   (the final else clause in the code below) are marked with null, so\n        //   we always advance old pointers over these so we're comparing the\n        //   next actual old value on either end.\n        //\n        // * Example below: `oldHead` is null (already placed in newParts), so\n        //   advance `oldHead`.\n        //\n        //            oldHead v     v oldTail\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6] // old head already used; advance\n        //   newParts: [0, 2, 1,  ,  ,  , 6] // oldHead\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]\n        //               newHead ^     ^ newTail\n        //\n        // * Note it's not critical to mark old parts as null when they are\n        // moved\n        //   from head to tail or tail to head, since they will be outside the\n        //   pointer range and never visited again.\n        //\n        // * Example below: Here the old tail key matches the new head key, so\n        //   the part at the `oldTail` position and move its DOM to the new\n        //   head position (before `oldParts[oldHead]`). Last, advance `oldTail`\n        //   and `newHead` pointers.\n        //\n        //               oldHead v  v oldTail\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n        //   newParts: [0, 2, 1, 4,  ,  , 6] <- old tail matches new head:\n        //   update newKeys:  [0, 2, 1, 4, 3, 7, 6]   & move 4, advance oldTail\n        //   & newHead\n        //               newHead ^     ^ newTail\n        //\n        // * Example below: Old and new head keys match, so update the old head\n        //   part in place, and advance the `oldHead` and `newHead` pointers.\n        //\n        //               oldHead v oldTail\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n        //   newParts: [0, 2, 1, 4, 3,   ,6] <- heads match: update 3 and\n        //   advance newKeys:  [0, 2, 1, 4, 3, 7, 6]    oldHead & newHead\n        //                  newHead ^  ^ newTail\n        //\n        // * Once the new or old pointers move past each other then all we have\n        //   left is additions (if old list exhausted) or removals (if new list\n        //   exhausted). Those are handled in the final while loops at the end.\n        //\n        // * Example below: `oldHead` exceeded `oldTail`, so we're done with the\n        //   main loop.  Create the remaining part and insert it at the new head\n        //   position, and the update is complete.\n        //\n        //                   (oldHead > oldTail)\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n        //   newParts: [0, 2, 1, 4, 3, 7 ,6] <- create and insert 7\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]\n        //                     newHead ^ newTail\n        //\n        // * Note that the order of the if/else clauses is not important to the\n        //   algorithm, as long as the null checks come first (to ensure we're\n        //   always working on valid old parts) and that the final else clause\n        //   comes last (since that's where the expensive moves occur). The\n        //   order of remaining clauses is is just a simple guess at which cases\n        //   will be most common.\n        //\n        // * TODO(kschaaf) Note, we could calculate the longest increasing\n        //   subsequence (LIS) of old items in new position, and only move those\n        //   not in the LIS set. However that costs O(nlogn) time and adds a bit\n        //   more code, and only helps make rare types of mutations require\n        //   fewer moves. The above handles removes, adds, reversal, swaps, and\n        //   single moves of contiguous items in linear time, in the minimum\n        //   number of moves. As the number of multiple moves where LIS might\n        //   help approaches a random shuffle, the LIS optimization becomes less\n        //   helpful, so it seems not worth the code at this point. Could\n        //   reconsider if a compelling case arises.\n\n        while (oldHead <= oldTail && newHead <= newTail) {\n          if (oldParts[oldHead] === null) {\n            // `null` means old part at head has already been used below; skip\n            oldHead++;\n          } else if (oldParts[oldTail] === null) {\n            // `null` means old part at tail has already been used below; skip\n            oldTail--;\n          } else if (oldKeys[oldHead] === newKeys[newHead]) {\n            // Old head matches new head; update in place\n            newParts[newHead] =\n                updatePart(oldParts[oldHead]!, newValues[newHead]);\n            oldHead++;\n            newHead++;\n          } else if (oldKeys[oldTail] === newKeys[newTail]) {\n            // Old tail matches new tail; update in place\n            newParts[newTail] =\n                updatePart(oldParts[oldTail]!, newValues[newTail]);\n            oldTail--;\n            newTail--;\n          } else if (oldKeys[oldHead] === newKeys[newTail]) {\n            // Old head matches new tail; update and move to new tail\n            newParts[newTail] =\n                updatePart(oldParts[oldHead]!, newValues[newTail]);\n            insertPartBefore(\n                containerPart, oldParts[oldHead]!, newParts[newTail + 1]);\n            oldHead++;\n            newTail--;\n          } else if (oldKeys[oldTail] === newKeys[newHead]) {\n            // Old tail matches new head; update and move to new head\n            newParts[newHead] =\n                updatePart(oldParts[oldTail]!, newValues[newHead]);\n            insertPartBefore(\n                containerPart, oldParts[oldTail]!, oldParts[oldHead]!);\n            oldTail--;\n            newHead++;\n          } else {\n            if (newKeyToIndexMap === undefined) {\n              // Lazily generate key-to-index maps, used for removals & moves\n              // below\n              newKeyToIndexMap = generateMap(newKeys, newHead, newTail);\n              oldKeyToIndexMap = generateMap(oldKeys, oldHead, oldTail);\n            }\n            if (!newKeyToIndexMap.has(oldKeys[oldHead])) {\n              // Old head is no longer in new list; remove\n              removePart(oldParts[oldHead]!);\n              oldHead++;\n            } else if (!newKeyToIndexMap.has(oldKeys[oldTail])) {\n              // Old tail is no longer in new list; remove\n              removePart(oldParts[oldTail]!);\n              oldTail--;\n            } else {\n              // Any mismatches at this point are due to additions or moves; see\n              // if we have an old part we can reuse and move into place\n              const oldIndex = oldKeyToIndexMap.get(newKeys[newHead]);\n              const oldPart =\n                  oldIndex !== undefined ? oldParts[oldIndex] : null;\n              if (oldPart === null) {\n                // No old part for this value; create a new one and insert it\n                const newPart =\n                    createAndInsertPart(containerPart, oldParts[oldHead]!);\n                updatePart(newPart, newValues[newHead]);\n                newParts[newHead] = newPart;\n              } else {\n                // Reuse old part\n                newParts[newHead] = updatePart(oldPart, newValues[newHead]);\n                insertPartBefore(containerPart, oldPart, oldParts[oldHead]!);\n                // This marks the old part as having been used, so that it will\n                // be skipped in the first two checks above\n                oldParts[oldIndex as number] = null;\n              }\n              newHead++;\n            }\n          }\n        }\n        // Add parts for any remaining new values\n        while (newHead <= newTail) {\n          // For all remaining additions, we insert before last new tail,\n          // since old pointers are no longer valid\n          const newPart =\n              createAndInsertPart(containerPart, newParts[newTail + 1]!);\n          updatePart(newPart, newValues[newHead]);\n          newParts[newHead++] = newPart;\n        }\n        // Remove any remaining unused old parts\n        while (oldHead <= oldTail) {\n          const oldPart = oldParts[oldHead++];\n          if (oldPart !== null) {\n            removePart(oldPart);\n          }\n        }\n        // Save order of new parts for next round\n        partListCache.set(containerPart, newParts);\n        keyListCache.set(containerPart, newKeys);\n      };\n    });\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {Part} from './part.js';\nimport {AttributeCommitter, BooleanAttributePart, EventPart, NodePart, PropertyCommitter} from './parts.js';\nimport {RenderOptions} from './render-options.js';\nimport {TemplateProcessor} from './template-processor.js';\n\n/**\n * Creates Parts when a template is instantiated.\n */\nexport class DefaultTemplateProcessor implements TemplateProcessor {\n  /**\n   * Create parts for an attribute-position binding, given the event, attribute\n   * name, and string literals.\n   *\n   * @param element The element containing the binding\n   * @param name  The attribute name\n   * @param strings The string literals. There are always at least two strings,\n   *   event for fully-controlled bindings with a single expression.\n   */\n  handleAttributeExpressions(\n      element: Element, name: string, strings: string[],\n      options: RenderOptions): Part[] {\n    const prefix = name[0];\n    if (prefix === '.') {\n      const comitter = new PropertyCommitter(element, name.slice(1), strings);\n      return comitter.parts;\n    }\n    if (prefix === '@') {\n      return [new EventPart(element, name.slice(1), options.eventContext)];\n    }\n    if (prefix === '?') {\n      return [new BooleanAttributePart(element, name.slice(1), strings)];\n    }\n    const comitter = new AttributeCommitter(element, name, strings);\n    return comitter.parts;\n  }\n  /**\n   * Create parts for a text-position binding.\n   * @param templateFactory\n   */\n  handleTextExpression(options: RenderOptions) {\n    return new NodePart(options);\n  }\n}\n\nexport const defaultTemplateProcessor = new DefaultTemplateProcessor();\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {Part} from './part.js';\n\nconst directives = new WeakMap<any, Boolean>();\n\nexport type DirectiveFn = (part: Part) => void;\n\n/**\n * Brands a function as a directive so that lit-html will call the function\n * during template rendering, rather than passing as a value.\n *\n * @param f The directive factory function. Must be a function that returns a\n * function of the signature `(part: Part) => void`. The returned function will\n * be called with the part object\n *\n * @example\n *\n * ```\n * import {directive, html} from 'lit-html';\n *\n * const immutable = directive((v) => (part) => {\n *   if (part.value !== v) {\n *     part.setValue(v)\n *   }\n * });\n * ```\n */\nexport const directive = <F extends Function>(f: F): F =>\n    ((...args: any[]) => {\n      const d = f(...args);\n      directives.set(d, true);\n      return d;\n    }) as unknown as F;\n\nexport const isDirective = (o: any) =>\n    typeof o === 'function' && directives.has(o);\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\n/**\n * True if the custom elements polyfill is in use.\n */\nexport const isCEPolyfill = window.customElements !== undefined &&\n    (window.customElements as any).polyfillWrapFlushCallback !== undefined;\n\n/**\n * Reparents nodes, starting from `startNode` (inclusive) to `endNode`\n * (exclusive), into another container (could be the same container), before\n * `beforeNode`. If `beforeNode` is null, it appends the nodes to the\n * container.\n */\nexport const reparentNodes =\n    (container: Node,\n     start: Node|null,\n     end: Node|null = null,\n     before: Node|null = null): void => {\n      let node = start;\n      while (node !== end) {\n        const n = node!.nextSibling;\n        container.insertBefore(node!, before as Node);\n        node = n;\n      }\n    };\n\n/**\n * Removes nodes, starting from `startNode` (inclusive) to `endNode`\n * (exclusive), from `container`.\n */\nexport const removeNodes =\n    (container: Node, startNode: Node|null, endNode: Node|null = null):\n        void => {\n          let node = startNode;\n          while (node !== endNode) {\n            const n = node!.nextSibling;\n            container.removeChild(node!);\n            node = n;\n          }\n        };\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module shady-render\n */\n\nimport {isTemplatePartActive, Template, TemplatePart} from './template.js';\n\nconst walkerNodeFilter = 133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */;\n\n/**\n * Removes the list of nodes from a Template safely. In addition to removing\n * nodes from the Template, the Template part indices are updated to match\n * the mutated Template DOM.\n *\n * As the template is walked the removal state is tracked and\n * part indices are adjusted as needed.\n *\n * div\n *   div#1 (remove) <-- start removing (removing node is div#1)\n *     div\n *       div#2 (remove)  <-- continue removing (removing node is still div#1)\n *         div\n * div <-- stop removing since previous sibling is the removing node (div#1,\n * removed 4 nodes)\n */\nexport function removeNodesFromTemplate(\n    template: Template, nodesToRemove: Set<Node>) {\n  const {element: {content}, parts} = template;\n  const walker =\n      document.createTreeWalker(content, walkerNodeFilter, null as any, false);\n  let partIndex = nextActiveIndexInTemplateParts(parts);\n  let part = parts[partIndex];\n  let nodeIndex = -1;\n  let removeCount = 0;\n  const nodesToRemoveInTemplate = [];\n  let currentRemovingNode: Node|null = null;\n  while (walker.nextNode()) {\n    nodeIndex++;\n    const node = walker.currentNode as Element;\n    // End removal if stepped past the removing node\n    if (node.previousSibling === currentRemovingNode) {\n      currentRemovingNode = null;\n    }\n    // A node to remove was found in the template\n    if (nodesToRemove.has(node)) {\n      nodesToRemoveInTemplate.push(node);\n      // Track node we're removing\n      if (currentRemovingNode === null) {\n        currentRemovingNode = node;\n      }\n    }\n    // When removing, increment count by which to adjust subsequent part indices\n    if (currentRemovingNode !== null) {\n      removeCount++;\n    }\n    while (part !== undefined && part.index === nodeIndex) {\n      // If part is in a removed node deactivate it by setting index to -1 or\n      // adjust the index as needed.\n      part.index = currentRemovingNode !== null ? -1 : part.index - removeCount;\n      // go to the next active part.\n      partIndex = nextActiveIndexInTemplateParts(parts, partIndex);\n      part = parts[partIndex];\n    }\n  }\n  nodesToRemoveInTemplate.forEach((n) => n.parentNode!.removeChild(n));\n}\n\nconst countNodes = (node: Node) => {\n  let count = (node.nodeType === 11 /* Node.DOCUMENT_FRAGMENT_NODE */) ? 0 : 1;\n  const walker =\n      document.createTreeWalker(node, walkerNodeFilter, null as any, false);\n  while (walker.nextNode()) {\n    count++;\n  }\n  return count;\n};\n\nconst nextActiveIndexInTemplateParts =\n    (parts: TemplatePart[], startIndex: number = -1) => {\n      for (let i = startIndex + 1; i < parts.length; i++) {\n        const part = parts[i];\n        if (isTemplatePartActive(part)) {\n          return i;\n        }\n      }\n      return -1;\n    };\n\n/**\n * Inserts the given node into the Template, optionally before the given\n * refNode. In addition to inserting the node into the Template, the Template\n * part indices are updated to match the mutated Template DOM.\n */\nexport function insertNodeIntoTemplate(\n    template: Template, node: Node, refNode: Node|null = null) {\n  const {element: {content}, parts} = template;\n  // If there's no refNode, then put node at end of template.\n  // No part indices need to be shifted in this case.\n  if (refNode === null || refNode === undefined) {\n    content.appendChild(node);\n    return;\n  }\n  const walker =\n      document.createTreeWalker(content, walkerNodeFilter, null as any, false);\n  let partIndex = nextActiveIndexInTemplateParts(parts);\n  let insertCount = 0;\n  let walkerIndex = -1;\n  while (walker.nextNode()) {\n    walkerIndex++;\n    const walkerNode = walker.currentNode as Element;\n    if (walkerNode === refNode) {\n      insertCount = countNodes(node);\n      refNode.parentNode!.insertBefore(node, refNode);\n    }\n    while (partIndex !== -1 && parts[partIndex].index === walkerIndex) {\n      // If we've inserted the node, simply adjust all subsequent parts\n      if (insertCount > 0) {\n        while (partIndex !== -1) {\n          parts[partIndex].index += insertCount;\n          partIndex = nextActiveIndexInTemplateParts(parts, partIndex);\n        }\n        return;\n      }\n      partIndex = nextActiveIndexInTemplateParts(parts, partIndex);\n    }\n  }\n}\n","/**\n * @license\n * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\n/**\n * The Part interface represents a dynamic part of a template instance rendered\n * by lit-html.\n */\nexport interface Part {\n  value: any;\n\n  /**\n   * Sets the current part value, but does not write it to the DOM.\n   * @param value The value that will be committed.\n   */\n  setValue(value: any): void;\n\n  /**\n   * Commits the current part value, cause it to actually be written to the DOM.\n   */\n  commit(): void;\n}\n\n/**\n * A sentinel value that signals that a value was handled by a directive and\n * should not be written to the DOM.\n */\nexport const noChange = {};\n\n/**\n * A sentinel value that signals a NodePart to fully clear its content.\n */\nexport const nothing = {};\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {isDirective} from './directive.js';\nimport {removeNodes} from './dom.js';\nimport {noChange, nothing, Part} from './part.js';\nimport {RenderOptions} from './render-options.js';\nimport {TemplateInstance} from './template-instance.js';\nimport {TemplateResult} from './template-result.js';\nimport {createMarker} from './template.js';\n\nexport const isPrimitive = (value: any) =>\n    (value === null ||\n     !(typeof value === 'object' || typeof value === 'function'));\n\n/**\n * Sets attribute values for AttributeParts, so that the value is only set once\n * even if there are multiple parts for an attribute.\n */\nexport class AttributeCommitter {\n  element: Element;\n  name: string;\n  strings: string[];\n  parts: AttributePart[];\n  dirty = true;\n\n  constructor(element: Element, name: string, strings: string[]) {\n    this.element = element;\n    this.name = name;\n    this.strings = strings;\n    this.parts = [];\n    for (let i = 0; i < strings.length - 1; i++) {\n      this.parts[i] = this._createPart();\n    }\n  }\n\n  /**\n   * Creates a single part. Override this to create a differnt type of part.\n   */\n  protected _createPart(): AttributePart {\n    return new AttributePart(this);\n  }\n\n  protected _getValue(): any {\n    const strings = this.strings;\n    const l = strings.length - 1;\n    let text = '';\n\n    for (let i = 0; i < l; i++) {\n      text += strings[i];\n      const part = this.parts[i];\n      if (part !== undefined) {\n        const v = part.value;\n        if (v != null &&\n            (Array.isArray(v) || typeof v !== 'string' && v[Symbol.iterator])) {\n          for (const t of v) {\n            text += typeof t === 'string' ? t : String(t);\n          }\n        } else {\n          text += typeof v === 'string' ? v : String(v);\n        }\n      }\n    }\n\n    text += strings[l];\n    return text;\n  }\n\n  commit(): void {\n    if (this.dirty) {\n      this.dirty = false;\n      this.element.setAttribute(this.name, this._getValue());\n    }\n  }\n}\n\nexport class AttributePart implements Part {\n  committer: AttributeCommitter;\n  value: any = undefined;\n\n  constructor(comitter: AttributeCommitter) {\n    this.committer = comitter;\n  }\n\n  setValue(value: any): void {\n    if (value !== noChange && (!isPrimitive(value) || value !== this.value)) {\n      this.value = value;\n      // If the value is a not a directive, dirty the committer so that it'll\n      // call setAttribute. If the value is a directive, it'll dirty the\n      // committer if it calls setValue().\n      if (!isDirective(value)) {\n        this.committer.dirty = true;\n      }\n    }\n  }\n\n  commit() {\n    while (isDirective(this.value)) {\n      const directive = this.value;\n      this.value = noChange;\n      directive(this);\n    }\n    if (this.value === noChange) {\n      return;\n    }\n    this.committer.commit();\n  }\n}\n\nexport class NodePart implements Part {\n  options: RenderOptions;\n  startNode!: Node;\n  endNode!: Node;\n  value: any = undefined;\n  _pendingValue: any = undefined;\n\n  constructor(options: RenderOptions) {\n    this.options = options;\n  }\n\n  /**\n   * Inserts this part into a container.\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n  appendInto(container: Node) {\n    this.startNode = container.appendChild(createMarker());\n    this.endNode = container.appendChild(createMarker());\n  }\n\n  /**\n   * Inserts this part between `ref` and `ref`'s next sibling. Both `ref` and\n   * its next sibling must be static, unchanging nodes such as those that appear\n   * in a literal section of a template.\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n  insertAfterNode(ref: Node) {\n    this.startNode = ref;\n    this.endNode = ref.nextSibling!;\n  }\n\n  /**\n   * Appends this part into a parent part.\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n  appendIntoPart(part: NodePart) {\n    part._insert(this.startNode = createMarker());\n    part._insert(this.endNode = createMarker());\n  }\n\n  /**\n   * Appends this part after `ref`\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n  insertAfterPart(ref: NodePart) {\n    ref._insert(this.startNode = createMarker());\n    this.endNode = ref.endNode;\n    ref.endNode = this.startNode;\n  }\n\n  setValue(value: any): void {\n    this._pendingValue = value;\n  }\n\n  commit() {\n    while (isDirective(this._pendingValue)) {\n      const directive = this._pendingValue;\n      this._pendingValue = noChange;\n      directive(this);\n    }\n    const value = this._pendingValue;\n    if (value === noChange) {\n      return;\n    }\n    if (isPrimitive(value)) {\n      if (value !== this.value) {\n        this._commitText(value);\n      }\n    } else if (value instanceof TemplateResult) {\n      this._commitTemplateResult(value);\n    } else if (value instanceof Node) {\n      this._commitNode(value);\n    } else if (Array.isArray(value) || value[Symbol.iterator]) {\n      this._commitIterable(value);\n    } else if (value === nothing) {\n      this.value = nothing;\n      this.clear();\n    } else {\n      // Fallback, will render the string representation\n      this._commitText(value);\n    }\n  }\n\n  private _insert(node: Node) {\n    this.endNode.parentNode!.insertBefore(node, this.endNode);\n  }\n\n  private _commitNode(value: Node): void {\n    if (this.value === value) {\n      return;\n    }\n    this.clear();\n    this._insert(value);\n    this.value = value;\n  }\n\n  private _commitText(value: string): void {\n    const node = this.startNode.nextSibling!;\n    value = value == null ? '' : value;\n    if (node === this.endNode.previousSibling &&\n        node.nodeType === 3 /* Node.TEXT_NODE */) {\n      // If we only have a single text node between the markers, we can just\n      // set its value, rather than replacing it.\n      // TODO(justinfagnani): Can we just check if this.value is primitive?\n      (node as Text).data = value;\n    } else {\n      this._commitNode(document.createTextNode(\n          typeof value === 'string' ? value : String(value)));\n    }\n    this.value = value;\n  }\n\n  private _commitTemplateResult(value: TemplateResult): void {\n    const template = this.options.templateFactory(value);\n    if (this.value && this.value.template === template) {\n      this.value.update(value.values);\n    } else {\n      // Make sure we propagate the template processor from the TemplateResult\n      // so that we use its syntax extension, etc. The template factory comes\n      // from the render function options so that it can control template\n      // caching and preprocessing.\n      const instance =\n          new TemplateInstance(template, value.processor, this.options);\n      const fragment = instance._clone();\n      instance.update(value.values);\n      this._commitNode(fragment);\n      this.value = instance;\n    }\n  }\n\n  private _commitIterable(value: any): void {\n    // For an Iterable, we create a new InstancePart per item, then set its\n    // value to the item. This is a little bit of overhead for every item in\n    // an Iterable, but it lets us recurse easily and efficiently update Arrays\n    // of TemplateResults that will be commonly returned from expressions like:\n    // array.map((i) => html`${i}`), by reusing existing TemplateInstances.\n\n    // If _value is an array, then the previous render was of an\n    // iterable and _value will contain the NodeParts from the previous\n    // render. If _value is not an array, clear this part and make a new\n    // array for NodeParts.\n    if (!Array.isArray(this.value)) {\n      this.value = [];\n      this.clear();\n    }\n\n    // Lets us keep track of how many items we stamped so we can clear leftover\n    // items from a previous render\n    const itemParts = this.value as NodePart[];\n    let partIndex = 0;\n    let itemPart: NodePart|undefined;\n\n    for (const item of value) {\n      // Try to reuse an existing part\n      itemPart = itemParts[partIndex];\n\n      // If no existing part, create a new one\n      if (itemPart === undefined) {\n        itemPart = new NodePart(this.options);\n        itemParts.push(itemPart);\n        if (partIndex === 0) {\n          itemPart.appendIntoPart(this);\n        } else {\n          itemPart.insertAfterPart(itemParts[partIndex - 1]);\n        }\n      }\n      itemPart.setValue(item);\n      itemPart.commit();\n      partIndex++;\n    }\n\n    if (partIndex < itemParts.length) {\n      // Truncate the parts array so _value reflects the current state\n      itemParts.length = partIndex;\n      this.clear(itemPart && itemPart!.endNode);\n    }\n  }\n\n  clear(startNode: Node = this.startNode) {\n    removeNodes(\n        this.startNode.parentNode!, startNode.nextSibling!, this.endNode);\n  }\n}\n\n/**\n * Implements a boolean attribute, roughly as defined in the HTML\n * specification.\n *\n * If the value is truthy, then the attribute is present with a value of\n * ''. If the value is falsey, the attribute is removed.\n */\nexport class BooleanAttributePart implements Part {\n  element: Element;\n  name: string;\n  strings: string[];\n  value: any = undefined;\n  _pendingValue: any = undefined;\n\n  constructor(element: Element, name: string, strings: string[]) {\n    if (strings.length !== 2 || strings[0] !== '' || strings[1] !== '') {\n      throw new Error(\n          'Boolean attributes can only contain a single expression');\n    }\n    this.element = element;\n    this.name = name;\n    this.strings = strings;\n  }\n\n  setValue(value: any): void {\n    this._pendingValue = value;\n  }\n\n  commit() {\n    while (isDirective(this._pendingValue)) {\n      const directive = this._pendingValue;\n      this._pendingValue = noChange;\n      directive(this);\n    }\n    if (this._pendingValue === noChange) {\n      return;\n    }\n    const value = !!this._pendingValue;\n    if (this.value !== value) {\n      if (value) {\n        this.element.setAttribute(this.name, '');\n      } else {\n        this.element.removeAttribute(this.name);\n      }\n    }\n    this.value = value;\n    this._pendingValue = noChange;\n  }\n}\n\n/**\n * Sets attribute values for PropertyParts, so that the value is only set once\n * even if there are multiple parts for a property.\n *\n * If an expression controls the whole property value, then the value is simply\n * assigned to the property under control. If there are string literals or\n * multiple expressions, then the strings are expressions are interpolated into\n * a string first.\n */\nexport class PropertyCommitter extends AttributeCommitter {\n  single: boolean;\n\n  constructor(element: Element, name: string, strings: string[]) {\n    super(element, name, strings);\n    this.single =\n        (strings.length === 2 && strings[0] === '' && strings[1] === '');\n  }\n\n  protected _createPart(): PropertyPart {\n    return new PropertyPart(this);\n  }\n\n  _getValue() {\n    if (this.single) {\n      return this.parts[0].value;\n    }\n    return super._getValue();\n  }\n\n  commit(): void {\n    if (this.dirty) {\n      this.dirty = false;\n      (this.element as any)[this.name] = this._getValue();\n    }\n  }\n}\n\nexport class PropertyPart extends AttributePart {}\n\n// Detect event listener options support. If the `capture` property is read\n// from the options object, then options are supported. If not, then the thrid\n// argument to add/removeEventListener is interpreted as the boolean capture\n// value so we should only pass the `capture` property.\nlet eventOptionsSupported = false;\n\ntry {\n  const options = {\n    get capture() {\n      eventOptionsSupported = true;\n      return false;\n    }\n  };\n  window.addEventListener('test', options as any, options);\n  window.removeEventListener('test', options as any, options);\n} catch (_e) {\n}\n\nexport class EventPart implements Part {\n  element: Element;\n  eventName: string;\n  eventContext?: EventTarget;\n  value: any = undefined;\n  _options?: AddEventListenerOptions;\n  _pendingValue: any = undefined;\n  _boundHandleEvent: (event: Event) => void;\n\n  constructor(element: Element, eventName: string, eventContext?: EventTarget) {\n    this.element = element;\n    this.eventName = eventName;\n    this.eventContext = eventContext;\n    this._boundHandleEvent = (e) => this.handleEvent(e);\n  }\n\n  setValue(value: any): void {\n    this._pendingValue = value;\n  }\n\n  commit() {\n    while (isDirective(this._pendingValue)) {\n      const directive = this._pendingValue;\n      this._pendingValue = noChange;\n      directive(this);\n    }\n    if (this._pendingValue === noChange) {\n      return;\n    }\n\n    const newListener = this._pendingValue;\n    const oldListener = this.value;\n    const shouldRemoveListener = newListener == null ||\n        oldListener != null &&\n            (newListener.capture !== oldListener.capture ||\n             newListener.once !== oldListener.once ||\n             newListener.passive !== oldListener.passive);\n    const shouldAddListener =\n        newListener != null && (oldListener == null || shouldRemoveListener);\n\n    if (shouldRemoveListener) {\n      this.element.removeEventListener(\n          this.eventName, this._boundHandleEvent, this._options);\n    }\n    if (shouldAddListener) {\n      this._options = getOptions(newListener);\n      this.element.addEventListener(\n          this.eventName, this._boundHandleEvent, this._options);\n    }\n    this.value = newListener;\n    this._pendingValue = noChange;\n  }\n\n  handleEvent(event: Event) {\n    if (typeof this.value === 'function') {\n      this.value.call(this.eventContext || this.element, event);\n    } else {\n      this.value.handleEvent(event);\n    }\n  }\n}\n\n// We copy options because of the inconsistent behavior of browsers when reading\n// the third argument of add/removeEventListener. IE11 doesn't support options\n// at all. Chrome 41 only reads `capture` if the argument is an object.\nconst getOptions = (o: any) => o &&\n    (eventOptionsSupported ?\n         {capture: o.capture, passive: o.passive, once: o.once} :\n         o.capture);\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {removeNodes} from './dom.js';\nimport {NodePart} from './parts.js';\nimport {RenderOptions} from './render-options.js';\nimport {templateFactory} from './template-factory.js';\nimport {TemplateResult} from './template-result.js';\n\nexport const parts = new WeakMap<Node, NodePart>();\n\n/**\n * Renders a template to a container.\n *\n * To update a container with new values, reevaluate the template literal and\n * call `render` with the new result.\n *\n * @param result a TemplateResult created by evaluating a template tag like\n *     `html` or `svg`.\n * @param container A DOM parent to render to. The entire contents are either\n *     replaced, or efficiently updated if the same result type was previous\n *     rendered there.\n * @param options RenderOptions for the entire render tree rendered to this\n *     container. Render options must *not* change between renders to the same\n *     container, as those changes will not effect previously rendered DOM.\n */\nexport const render =\n    (result: TemplateResult,\n     container: Element|DocumentFragment,\n     options?: Partial<RenderOptions>) => {\n      let part = parts.get(container);\n      if (part === undefined) {\n        removeNodes(container, container.firstChild);\n        parts.set(container, part = new NodePart({\n                               templateFactory,\n                               ...options,\n                             }));\n        part.appendInto(container);\n      }\n      part.setValue(result);\n      part.commit();\n    };\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * Module to add shady DOM/shady CSS polyfill support to lit-html template\n * rendering. See the [[render]] method for details.\n *\n * @module shady-render\n * @preferred\n */\n\n/**\n * Do not remove this comment; it keeps typedoc from misplacing the module\n * docs.\n */\nimport {removeNodes} from './dom.js';\nimport {insertNodeIntoTemplate, removeNodesFromTemplate} from './modify-template.js';\nimport {RenderOptions} from './render-options.js';\nimport {parts, render as litRender} from './render.js';\nimport {templateCaches} from './template-factory.js';\nimport {TemplateInstance} from './template-instance.js';\nimport {TemplateResult} from './template-result.js';\nimport {marker, Template} from './template.js';\n\nexport {html, svg, TemplateResult} from '../lit-html.js';\n\n// Get a key to lookup in `templateCaches`.\nconst getTemplateCacheKey = (type: string, scopeName: string) =>\n    `${type}--${scopeName}`;\n\nlet compatibleShadyCSSVersion = true;\n\nif (typeof window.ShadyCSS === 'undefined') {\n  compatibleShadyCSSVersion = false;\n} else if (typeof window.ShadyCSS.prepareTemplateDom === 'undefined') {\n  console.warn(\n      `Incompatible ShadyCSS version detected.` +\n      `Please update to at least @webcomponents/webcomponentsjs@2.0.2 and` +\n      `@webcomponents/shadycss@1.3.1.`);\n  compatibleShadyCSSVersion = false;\n}\n\n/**\n * Template factory which scopes template DOM using ShadyCSS.\n * @param scopeName {string}\n */\nconst shadyTemplateFactory = (scopeName: string) =>\n    (result: TemplateResult) => {\n      const cacheKey = getTemplateCacheKey(result.type, scopeName);\n      let templateCache = templateCaches.get(cacheKey);\n      if (templateCache === undefined) {\n        templateCache = {\n          stringsArray: new WeakMap<TemplateStringsArray, Template>(),\n          keyString: new Map<string, Template>()\n        };\n        templateCaches.set(cacheKey, templateCache);\n      }\n\n      let template = templateCache.stringsArray.get(result.strings);\n      if (template !== undefined) {\n        return template;\n      }\n\n      const key = result.strings.join(marker);\n      template = templateCache.keyString.get(key);\n      if (template === undefined) {\n        const element = result.getTemplateElement();\n        if (compatibleShadyCSSVersion) {\n          window.ShadyCSS!.prepareTemplateDom(element, scopeName);\n        }\n        template = new Template(result, element);\n        templateCache.keyString.set(key, template);\n      }\n      templateCache.stringsArray.set(result.strings, template);\n      return template;\n    };\n\nconst TEMPLATE_TYPES = ['html', 'svg'];\n\n/**\n * Removes all style elements from Templates for the given scopeName.\n */\nconst removeStylesFromLitTemplates = (scopeName: string) => {\n  TEMPLATE_TYPES.forEach((type) => {\n    const templates = templateCaches.get(getTemplateCacheKey(type, scopeName));\n    if (templates !== undefined) {\n      templates.keyString.forEach((template) => {\n        const {element: {content}} = template;\n        // IE 11 doesn't support the iterable param Set constructor\n        const styles = new Set<Element>();\n        Array.from(content.querySelectorAll('style')).forEach((s: Element) => {\n          styles.add(s);\n        });\n        removeNodesFromTemplate(template, styles);\n      });\n    }\n  });\n};\n\nconst shadyRenderSet = new Set<string>();\n\n/**\n * For the given scope name, ensures that ShadyCSS style scoping is performed.\n * This is done just once per scope name so the fragment and template cannot\n * be modified.\n * (1) extracts styles from the rendered fragment and hands them to ShadyCSS\n * to be scoped and appended to the document\n * (2) removes style elements from all lit-html Templates for this scope name.\n *\n * Note, <style> elements can only be placed into templates for the\n * initial rendering of the scope. If <style> elements are included in templates\n * dynamically rendered to the scope (after the first scope render), they will\n * not be scoped and the <style> will be left in the template and rendered\n * output.\n */\nconst prepareTemplateStyles =\n    (renderedDOM: DocumentFragment, template: Template, scopeName: string) => {\n      shadyRenderSet.add(scopeName);\n      // Move styles out of rendered DOM and store.\n      const styles = renderedDOM.querySelectorAll('style');\n      // If there are no styles, skip unnecessary work\n      if (styles.length === 0) {\n        // Ensure prepareTemplateStyles is called to support adding\n        // styles via `prepareAdoptedCssText` since that requires that\n        // `prepareTemplateStyles` is called.\n        window.ShadyCSS!.prepareTemplateStyles(template.element, scopeName);\n        return;\n      }\n      const condensedStyle = document.createElement('style');\n      // Collect styles into a single style. This helps us make sure ShadyCSS\n      // manipulations will not prevent us from being able to fix up template\n      // part indices.\n      // NOTE: collecting styles is inefficient for browsers but ShadyCSS\n      // currently does this anyway. When it does not, this should be changed.\n      for (let i = 0; i < styles.length; i++) {\n        const style = styles[i];\n        style.parentNode!.removeChild(style);\n        condensedStyle.textContent! += style.textContent;\n      }\n      // Remove styles from nested templates in this scope.\n      removeStylesFromLitTemplates(scopeName);\n      // And then put the condensed style into the \"root\" template passed in as\n      // `template`.\n      insertNodeIntoTemplate(\n          template, condensedStyle, template.element.content.firstChild);\n      // Note, it's important that ShadyCSS gets the template that `lit-html`\n      // will actually render so that it can update the style inside when\n      // needed (e.g. @apply native Shadow DOM case).\n      window.ShadyCSS!.prepareTemplateStyles(template.element, scopeName);\n      if (window.ShadyCSS!.nativeShadow) {\n        // When in native Shadow DOM, re-add styling to rendered content using\n        // the style ShadyCSS produced.\n        const style = template.element.content.querySelector('style')!;\n        renderedDOM.insertBefore(style.cloneNode(true), renderedDOM.firstChild);\n      } else {\n        // When not in native Shadow DOM, at this point ShadyCSS will have\n        // removed the style from the lit template and parts will be broken as a\n        // result. To fix this, we put back the style node ShadyCSS removed\n        // and then tell lit to remove that node from the template.\n        // NOTE, ShadyCSS creates its own style so we can safely add/remove\n        // `condensedStyle` here.\n        template.element.content.insertBefore(\n            condensedStyle, template.element.content.firstChild);\n        const removes = new Set();\n        removes.add(condensedStyle);\n        removeNodesFromTemplate(template, removes);\n      }\n    };\n\nexport interface ShadyRenderOptions extends Partial<RenderOptions> {\n  scopeName: string;\n}\n\n/**\n * Extension to the standard `render` method which supports rendering\n * to ShadowRoots when the ShadyDOM (https://github.com/webcomponents/shadydom)\n * and ShadyCSS (https://github.com/webcomponents/shadycss) polyfills are used\n * or when the webcomponentsjs\n * (https://github.com/webcomponents/webcomponentsjs) polyfill is used.\n *\n * Adds a `scopeName` option which is used to scope element DOM and stylesheets\n * when native ShadowDOM is unavailable. The `scopeName` will be added to\n * the class attribute of all rendered DOM. In addition, any style elements will\n * be automatically re-written with this `scopeName` selector and moved out\n * of the rendered DOM and into the document `<head>`.\n *\n * It is common to use this render method in conjunction with a custom element\n * which renders a shadowRoot. When this is done, typically the element's\n * `localName` should be used as the `scopeName`.\n *\n * In addition to DOM scoping, ShadyCSS also supports a basic shim for css\n * custom properties (needed only on older browsers like IE11) and a shim for\n * a deprecated feature called `@apply` that supports applying a set of css\n * custom properties to a given location.\n *\n * Usage considerations:\n *\n * * Part values in `<style>` elements are only applied the first time a given\n * `scopeName` renders. Subsequent changes to parts in style elements will have\n * no effect. Because of this, parts in style elements should only be used for\n * values that will never change, for example parts that set scope-wide theme\n * values or parts which render shared style elements.\n *\n * * Note, due to a limitation of the ShadyDOM polyfill, rendering in a\n * custom element's `constructor` is not supported. Instead rendering should\n * either done asynchronously, for example at microtask timing (for example\n * `Promise.resolve()`), or be deferred until the first time the element's\n * `connectedCallback` runs.\n *\n * Usage considerations when using shimmed custom properties or `@apply`:\n *\n * * Whenever any dynamic changes are made which affect\n * css custom properties, `ShadyCSS.styleElement(element)` must be called\n * to update the element. There are two cases when this is needed:\n * (1) the element is connected to a new parent, (2) a class is added to the\n * element that causes it to match different custom properties.\n * To address the first case when rendering a custom element, `styleElement`\n * should be called in the element's `connectedCallback`.\n *\n * * Shimmed custom properties may only be defined either for an entire\n * shadowRoot (for example, in a `:host` rule) or via a rule that directly\n * matches an element with a shadowRoot. In other words, instead of flowing from\n * parent to child as do native css custom properties, shimmed custom properties\n * flow only from shadowRoots to nested shadowRoots.\n *\n * * When using `@apply` mixing css shorthand property names with\n * non-shorthand names (for example `border` and `border-width`) is not\n * supported.\n */\nexport const render =\n    (result: TemplateResult,\n     container: Element|DocumentFragment,\n     options: ShadyRenderOptions) => {\n      const scopeName = options.scopeName;\n      const hasRendered = parts.has(container);\n      const needsScoping = container instanceof ShadowRoot &&\n          compatibleShadyCSSVersion && result instanceof TemplateResult;\n      // Handle first render to a scope specially...\n      const firstScopeRender = needsScoping && !shadyRenderSet.has(scopeName);\n      // On first scope render, render into a fragment; this cannot be a single\n      // fragment that is reused since nested renders can occur synchronously.\n      const renderContainer =\n          firstScopeRender ? document.createDocumentFragment() : container;\n      litRender(\n          result,\n          renderContainer,\n          {templateFactory: shadyTemplateFactory(scopeName), ...options} as\n              RenderOptions);\n      // When performing first scope render,\n      // (1) We've rendered into a fragment so that there's a chance to\n      // `prepareTemplateStyles` before sub-elements hit the DOM\n      // (which might cause them to render based on a common pattern of\n      // rendering in a custom element's `connectedCallback`);\n      // (2) Scope the template with ShadyCSS one time only for this scope.\n      // (3) Render the fragment into the container and make sure the\n      // container knows its `part` is the one we just rendered. This ensures\n      // DOM will be re-used on subsequent renders.\n      if (firstScopeRender) {\n        const part = parts.get(renderContainer)!;\n        parts.delete(renderContainer);\n        if (part.value instanceof TemplateInstance) {\n          prepareTemplateStyles(\n              renderContainer as DocumentFragment,\n              part.value.template,\n              scopeName);\n        }\n        removeNodes(container, container.firstChild);\n        container.appendChild(renderContainer);\n        parts.set(container, part);\n      }\n      // After elements have hit the DOM, update styling if this is the\n      // initial render to this container.\n      // This is needed whenever dynamic changes are made so it would be\n      // safest to do every render; however, this would regress performance\n      // so we leave it up to the user to call `ShadyCSSS.styleElement`\n      // for dynamic changes.\n      if (!hasRendered && needsScoping) {\n        window.ShadyCSS!.styleElement((container as ShadowRoot).host);\n      }\n    };\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {TemplateResult} from './template-result.js';\nimport {marker, Template} from './template.js';\n\n/**\n * A function type that creates a Template from a TemplateResult.\n *\n * This is a hook into the template-creation process for rendering that\n * requires some modification of templates before they're used, like ShadyCSS,\n * which must add classes to elements and remove styles.\n *\n * Templates should be cached as aggressively as possible, so that many\n * TemplateResults produced from the same expression only do the work of\n * creating the Template the first time.\n *\n * Templates are usually cached by TemplateResult.strings and\n * TemplateResult.type, but may be cached by other keys if this function\n * modifies the template.\n *\n * Note that currently TemplateFactories must not add, remove, or reorder\n * expressions, because there is no way to describe such a modification\n * to render() so that values are interpolated to the correct place in the\n * template instances.\n */\nexport type TemplateFactory = (result: TemplateResult) => Template;\n\n/**\n * The default TemplateFactory which caches Templates keyed on\n * result.type and result.strings.\n */\nexport function templateFactory(result: TemplateResult) {\n  let templateCache = templateCaches.get(result.type);\n  if (templateCache === undefined) {\n    templateCache = {\n      stringsArray: new WeakMap<TemplateStringsArray, Template>(),\n      keyString: new Map<string, Template>()\n    };\n    templateCaches.set(result.type, templateCache);\n  }\n\n  let template = templateCache.stringsArray.get(result.strings);\n  if (template !== undefined) {\n    return template;\n  }\n\n  // If the TemplateStringsArray is new, generate a key from the strings\n  // This key is shared between all templates with identical content\n  const key = result.strings.join(marker);\n\n  // Check if we already have a Template for this key\n  template = templateCache.keyString.get(key);\n  if (template === undefined) {\n    // If we have not seen this key before, create a new Template\n    template = new Template(result, result.getTemplateElement());\n    // Cache the Template for this key\n    templateCache.keyString.set(key, template);\n  }\n\n  // Cache all future queries for this TemplateStringsArray\n  templateCache.stringsArray.set(result.strings, template);\n  return template;\n}\n\n/**\n * The first argument to JS template tags retain identity across multiple\n * calls to a tag for the same literal, so we can cache work done per literal\n * in a Map.\n *\n * Safari currently has a bug which occasionally breaks this behaviour, so we\n * need to cache the Template at two levels. We first cache the\n * TemplateStringsArray, and if that fails, we cache a key constructed by\n * joining the strings array.\n */\nexport type templateCache = {\n  stringsArray: WeakMap<TemplateStringsArray, Template>;\n  keyString: Map<string, Template>;\n};\n\nexport const templateCaches = new Map<string, templateCache>();\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {isCEPolyfill} from './dom.js';\nimport {Part} from './part.js';\nimport {RenderOptions} from './render-options.js';\nimport {TemplateProcessor} from './template-processor.js';\nimport {isTemplatePartActive, Template} from './template.js';\n\n/**\n * An instance of a `Template` that can be attached to the DOM and updated\n * with new values.\n */\nexport class TemplateInstance {\n  _parts: Array<Part|undefined> = [];\n  processor: TemplateProcessor;\n  options: RenderOptions;\n  template: Template;\n\n  constructor(\n      template: Template, processor: TemplateProcessor,\n      options: RenderOptions) {\n    this.template = template;\n    this.processor = processor;\n    this.options = options;\n  }\n\n  update(values: any[]) {\n    let i = 0;\n    for (const part of this._parts) {\n      if (part !== undefined) {\n        part.setValue(values[i]);\n      }\n      i++;\n    }\n    for (const part of this._parts) {\n      if (part !== undefined) {\n        part.commit();\n      }\n    }\n  }\n\n  _clone(): DocumentFragment {\n    // When using the Custom Elements polyfill, clone the node, rather than\n    // importing it, to keep the fragment in the template's document. This\n    // leaves the fragment inert so custom elements won't upgrade and\n    // potentially modify their contents by creating a polyfilled ShadowRoot\n    // while we traverse the tree.\n    const fragment = isCEPolyfill ?\n        this.template.element.content.cloneNode(true) as DocumentFragment :\n        document.importNode(this.template.element.content, true);\n\n    const parts = this.template.parts;\n    let partIndex = 0;\n    let nodeIndex = 0;\n    const _prepareInstance = (fragment: DocumentFragment) => {\n      // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be\n      // null\n      const walker = document.createTreeWalker(\n          fragment,\n          133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */,\n          null as any,\n          false);\n      let node = walker.nextNode();\n      // Loop through all the nodes and parts of a template\n      while (partIndex < parts.length && node !== null) {\n        const part = parts[partIndex];\n        // Consecutive Parts may have the same node index, in the case of\n        // multiple bound attributes on an element. So each iteration we either\n        // increment the nodeIndex, if we aren't on a node with a part, or the\n        // partIndex if we are. By not incrementing the nodeIndex when we find a\n        // part, we allow for the next part to be associated with the current\n        // node if neccessasry.\n        if (!isTemplatePartActive(part)) {\n          this._parts.push(undefined);\n          partIndex++;\n        } else if (nodeIndex === part.index) {\n          if (part.type === 'node') {\n            const part = this.processor.handleTextExpression(this.options);\n            part.insertAfterNode(node.previousSibling!);\n            this._parts.push(part);\n          } else {\n            this._parts.push(...this.processor.handleAttributeExpressions(\n                node as Element, part.name, part.strings, this.options));\n          }\n          partIndex++;\n        } else {\n          nodeIndex++;\n          if (node.nodeName === 'TEMPLATE') {\n            _prepareInstance((node as HTMLTemplateElement).content);\n          }\n          node = walker.nextNode();\n        }\n      }\n    };\n    _prepareInstance(fragment);\n    if (isCEPolyfill) {\n      document.adoptNode(fragment);\n      customElements.upgrade(fragment);\n    }\n    return fragment;\n  }\n}\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {reparentNodes} from './dom.js';\nimport {TemplateProcessor} from './template-processor.js';\nimport {boundAttributeSuffix, lastAttributeNameRegex, marker, nodeMarker} from './template.js';\n\n/**\n * The return type of `html`, which holds a Template and the values from\n * interpolated expressions.\n */\nexport class TemplateResult {\n  strings: TemplateStringsArray;\n  values: any[];\n  type: string;\n  processor: TemplateProcessor;\n\n  constructor(\n      strings: TemplateStringsArray, values: any[], type: string,\n      processor: TemplateProcessor) {\n    this.strings = strings;\n    this.values = values;\n    this.type = type;\n    this.processor = processor;\n  }\n\n  /**\n   * Returns a string of HTML used to create a `<template>` element.\n   */\n  getHTML(): string {\n    const endIndex = this.strings.length - 1;\n    let html = '';\n    for (let i = 0; i < endIndex; i++) {\n      const s = this.strings[i];\n      // This exec() call does two things:\n      // 1) Appends a suffix to the bound attribute name to opt out of special\n      // attribute value parsing that IE11 and Edge do, like for style and\n      // many SVG attributes. The Template class also appends the same suffix\n      // when looking up attributes to create Parts.\n      // 2) Adds an unquoted-attribute-safe marker for the first expression in\n      // an attribute. Subsequent attribute expressions will use node markers,\n      // and this is safe since attributes with multiple expressions are\n      // guaranteed to be quoted.\n      const match = lastAttributeNameRegex.exec(s);\n      if (match) {\n        // We're starting a new bound attribute.\n        // Add the safe attribute suffix, and use unquoted-attribute-safe\n        // marker.\n        html += s.substr(0, match.index) + match[1] + match[2] +\n            boundAttributeSuffix + match[3] + marker;\n      } else {\n        // We're either in a bound node, or trailing bound attribute.\n        // Either way, nodeMarker is safe to use.\n        html += s + nodeMarker;\n      }\n    }\n    return html + this.strings[endIndex];\n  }\n\n  getTemplateElement(): HTMLTemplateElement {\n    const template = document.createElement('template');\n    template.innerHTML = this.getHTML();\n    return template;\n  }\n}\n\n/**\n * A TemplateResult for SVG fragments.\n *\n * This class wraps HTMl in an `<svg>` tag in order to parse its contents in the\n * SVG namespace, then modifies the template to remove the `<svg>` tag so that\n * clones only container the original fragment.\n */\nexport class SVGTemplateResult extends TemplateResult {\n  getHTML(): string {\n    return `<svg>${super.getHTML()}</svg>`;\n  }\n\n  getTemplateElement(): HTMLTemplateElement {\n    const template = super.getTemplateElement();\n    const content = template.content;\n    const svgElement = content.firstChild!;\n    content.removeChild(svgElement);\n    reparentNodes(content, svgElement.firstChild);\n    return template;\n  }\n}\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {TemplateResult} from './template-result.js';\n\n/**\n * An expression marker with embedded unique key to avoid collision with\n * possible text in templates.\n */\nexport const marker = `{{lit-${String(Math.random()).slice(2)}}}`;\n\n/**\n * An expression marker used text-positions, multi-binding attributes, and\n * attributes with markup-like text values.\n */\nexport const nodeMarker = `<!--${marker}-->`;\n\nexport const markerRegex = new RegExp(`${marker}|${nodeMarker}`);\n\n/**\n * Suffix appended to all bound attribute names.\n */\nexport const boundAttributeSuffix = '$lit$';\n\n/**\n * An updateable Template that tracks the location of dynamic parts.\n */\nexport class Template {\n  parts: TemplatePart[] = [];\n  element: HTMLTemplateElement;\n\n  constructor(result: TemplateResult, element: HTMLTemplateElement) {\n    this.element = element;\n    let index = -1;\n    let partIndex = 0;\n    const nodesToRemove: Node[] = [];\n    const _prepareTemplate = (template: HTMLTemplateElement) => {\n      const content = template.content;\n      // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be\n      // null\n      const walker = document.createTreeWalker(\n          content,\n          133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */,\n          null as any,\n          false);\n      // Keeps track of the last index associated with a part. We try to delete\n      // unnecessary nodes, but we never want to associate two different parts\n      // to the same index. They must have a constant node between.\n      let lastPartIndex = 0;\n      while (walker.nextNode()) {\n        index++;\n        const node = walker.currentNode as Element | Comment | Text;\n        if (node.nodeType === 1 /* Node.ELEMENT_NODE */) {\n          if ((node as Element).hasAttributes()) {\n            const attributes = (node as Element).attributes;\n            // Per\n            // https://developer.mozilla.org/en-US/docs/Web/API/NamedNodeMap,\n            // attributes are not guaranteed to be returned in document order.\n            // In particular, Edge/IE can return them out of order, so we cannot\n            // assume a correspondance between part index and attribute index.\n            let count = 0;\n            for (let i = 0; i < attributes.length; i++) {\n              if (attributes[i].value.indexOf(marker) >= 0) {\n                count++;\n              }\n            }\n            while (count-- > 0) {\n              // Get the template literal section leading up to the first\n              // expression in this attribute\n              const stringForPart = result.strings[partIndex];\n              // Find the attribute name\n              const name = lastAttributeNameRegex.exec(stringForPart)![2];\n              // Find the corresponding attribute\n              // All bound attributes have had a suffix added in\n              // TemplateResult#getHTML to opt out of special attribute\n              // handling. To look up the attribute value we also need to add\n              // the suffix.\n              const attributeLookupName =\n                  name.toLowerCase() + boundAttributeSuffix;\n              const attributeValue =\n                  (node as Element).getAttribute(attributeLookupName)!;\n              const strings = attributeValue.split(markerRegex);\n              this.parts.push({type: 'attribute', index, name, strings});\n              (node as Element).removeAttribute(attributeLookupName);\n              partIndex += strings.length - 1;\n            }\n          }\n          if ((node as Element).tagName === 'TEMPLATE') {\n            _prepareTemplate(node as HTMLTemplateElement);\n          }\n        } else if (node.nodeType === 3 /* Node.TEXT_NODE */) {\n          const data = (node as Text).data!;\n          if (data.indexOf(marker) >= 0) {\n            const parent = node.parentNode!;\n            const strings = data.split(markerRegex);\n            const lastIndex = strings.length - 1;\n            // Generate a new text node for each literal section\n            // These nodes are also used as the markers for node parts\n            for (let i = 0; i < lastIndex; i++) {\n              parent.insertBefore(\n                  (strings[i] === '') ? createMarker() :\n                                        document.createTextNode(strings[i]),\n                  node);\n              this.parts.push({type: 'node', index: ++index});\n            }\n            // If there's no text, we must insert a comment to mark our place.\n            // Else, we can trust it will stick around after cloning.\n            if (strings[lastIndex] === '') {\n              parent.insertBefore(createMarker(), node);\n              nodesToRemove.push(node);\n            } else {\n              (node as Text).data = strings[lastIndex];\n            }\n            // We have a part for each match found\n            partIndex += lastIndex;\n          }\n        } else if (node.nodeType === 8 /* Node.COMMENT_NODE */) {\n          if ((node as Comment).data === marker) {\n            const parent = node.parentNode!;\n            // Add a new marker node to be the startNode of the Part if any of\n            // the following are true:\n            //  * We don't have a previousSibling\n            //  * The previousSibling is already the start of a previous part\n            if (node.previousSibling === null || index === lastPartIndex) {\n              index++;\n              parent.insertBefore(createMarker(), node);\n            }\n            lastPartIndex = index;\n            this.parts.push({type: 'node', index});\n            // If we don't have a nextSibling, keep this node so we have an end.\n            // Else, we can remove it to save future costs.\n            if (node.nextSibling === null) {\n              (node as Comment).data = '';\n            } else {\n              nodesToRemove.push(node);\n              index--;\n            }\n            partIndex++;\n          } else {\n            let i = -1;\n            while ((i = (node as Comment).data!.indexOf(marker, i + 1)) !==\n                   -1) {\n              // Comment node has a binding marker inside, make an inactive part\n              // The binding won't work, but subsequent bindings will\n              // TODO (justinfagnani): consider whether it's even worth it to\n              // make bindings in comments work\n              this.parts.push({type: 'node', index: -1});\n            }\n          }\n        }\n      }\n    };\n    _prepareTemplate(element);\n    // Remove text binding nodes after the walk to not disturb the TreeWalker\n    for (const n of nodesToRemove) {\n      n.parentNode!.removeChild(n);\n    }\n  }\n}\n\n/**\n * A placeholder for a dynamic expression in an HTML template.\n *\n * There are two built-in part types: AttributePart and NodePart. NodeParts\n * always represent a single dynamic expression, while AttributeParts may\n * represent as many expressions are contained in the attribute.\n *\n * A Template's parts are mutable, so parts can be replaced or modified\n * (possibly to implement different template semantics). The contract is that\n * parts can only be replaced, not removed, added or reordered, and parts must\n * always consume the correct number of values in their `update()` method.\n *\n * TODO(justinfagnani): That requirement is a little fragile. A\n * TemplateInstance could instead be more careful about which values it gives\n * to Part.update().\n */\nexport type TemplatePart = {\n  type: 'node',\n  index: number\n}|{type: 'attribute', index: number, name: string, strings: string[]};\n\nexport const isTemplatePartActive = (part: TemplatePart) => part.index !== -1;\n\n// Allows `document.createComment('')` to be renamed for a\n// small manual size-savings.\nexport const createMarker = () => document.createComment('');\n\n/**\n * This regex extracts the attribute name preceding an attribute-position\n * expression. It does this by matching the syntax allowed for attributes\n * against the string literal directly preceding the expression, assuming that\n * the expression is in an attribute-value position.\n *\n * See attributes in the HTML spec:\n * https://www.w3.org/TR/html5/syntax.html#attributes-0\n *\n * \"\\0-\\x1F\\x7F-\\x9F\" are Unicode control characters\n *\n * \" \\x09\\x0a\\x0c\\x0d\" are HTML space characters:\n * https://www.w3.org/TR/html5/infrastructure.html#space-character\n *\n * So an attribute is:\n *  * The name: any character except a control character, space character, ('),\n *    (\"), \">\", \"=\", or \"/\"\n *  * Followed by zero or more space characters\n *  * Followed by \"=\"\n *  * Followed by zero or more space characters\n *  * Followed by:\n *    * Any character except space, ('), (\"), \"<\", \">\", \"=\", (`), or\n *    * (\") then any non-(\"), or\n *    * (') then any non-(')\n */\nexport const lastAttributeNameRegex =\n    /([ \\x09\\x0a\\x0c\\x0d])([^\\0-\\x1F\\x7F-\\x9F \\x09\\x0a\\x0c\\x0d\"'>=/]+)([ \\x09\\x0a\\x0c\\x0d]*=[ \\x09\\x0a\\x0c\\x0d]*(?:[^ \\x09\\x0a\\x0c\\x0d\"'`<>=]*|\"[^\"]*|'[^']*))$/;\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n *\n * Main lit-html module.\n *\n * Main exports:\n *\n * -  [[html]]\n * -  [[svg]]\n * -  [[render]]\n *\n * @module lit-html\n * @preferred\n */\n\n/**\n * Do not remove this comment; it keeps typedoc from misplacing the module\n * docs.\n */\nimport {defaultTemplateProcessor} from './lib/default-template-processor.js';\nimport {SVGTemplateResult, TemplateResult} from './lib/template-result.js';\n\nexport {DefaultTemplateProcessor, defaultTemplateProcessor} from './lib/default-template-processor.js';\nexport {directive, DirectiveFn, isDirective} from './lib/directive.js';\n// TODO(justinfagnani): remove line when we get NodePart moving methods\nexport {removeNodes, reparentNodes} from './lib/dom.js';\nexport {noChange, nothing, Part} from './lib/part.js';\nexport {AttributeCommitter, AttributePart, BooleanAttributePart, EventPart, isPrimitive, NodePart, PropertyCommitter, PropertyPart} from './lib/parts.js';\nexport {RenderOptions} from './lib/render-options.js';\nexport {parts, render} from './lib/render.js';\nexport {templateCaches, templateFactory} from './lib/template-factory.js';\nexport {TemplateInstance} from './lib/template-instance.js';\nexport {TemplateProcessor} from './lib/template-processor.js';\nexport {SVGTemplateResult, TemplateResult} from './lib/template-result.js';\nexport {createMarker, isTemplatePartActive, Template} from './lib/template.js';\n\n/**\n * Interprets a template literal as an HTML template that can efficiently\n * render to and update a container.\n */\nexport const html = (strings: TemplateStringsArray, ...values: any[]) =>\n    new TemplateResult(strings, values, 'html', defaultTemplateProcessor);\n\n/**\n * Interprets a template literal as an SVG template that can efficiently\n * render to and update a container.\n */\nexport const svg = (strings: TemplateStringsArray, ...values: any[]) =>\n    new SVGTemplateResult(strings, values, 'svg', defaultTemplateProcessor);\n","module.exports = \"//#define PHYSICAL\\n\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float roughness;\\nuniform float metalness;\\nuniform float opacity;\\n\\n#ifndef STANDARD\\n\\tuniform float clearCoat;\\n\\tuniform float clearCoatRoughness;\\n#endif\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n\\n//#include <uv_pars_fragment>\\n//#include <uv2_pars_fragment>\\n// REPLACED WITH\\n#if defined(USE_MAP) || defined(USE_BUMPMAP) || defined(USE_NORMALMAP) || defined(USE_SPECULARMAP) || defined(USE_ALPHAMAP) || defined(USE_EMISSIVEMAP) || defined(USE_ROUGHNESSMAP) || defined(USE_METALNESSMAP) || defined(USE_LIGHTMAP) || defined(USE_AOMAP)\\n\\tvarying vec2 vUv;\\n#endif\\n\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <bsdfs>\\n#include <cube_uv_reflection_fragment>\\n#include <envmap_pars_fragment>\\n#include <envmap_physical_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <lights_pars_begin>\\n#include <lights_physical_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <roughnessmap_pars_fragment>\\n#include <metalnessmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\n\\n#ifdef USE_AOMAP\\n    uniform vec3 aoMapMix;\\n#endif\\n\\n#ifdef MODE_XRAY\\n    varying float vIntensity;\\n#endif\\n\\n#ifdef CUT_PLANE\\n    varying vec3 vWorldPosition;\\n    uniform vec4 cutPlaneDirection;\\n    uniform vec3 cutPlaneColor;\\n#endif\\n\\nvoid main() {\\n    #ifdef CUT_PLANE\\n        if (dot(vWorldPosition, cutPlaneDirection.xyz) < cutPlaneDirection.w) {\\n            discard;\\n        }\\n    #endif\\n\\n\\t#include <clipping_planes_fragment>\\n\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <roughnessmap_fragment>\\n\\t#include <metalnessmap_fragment>\\n\\t#include <normal_fragment_begin>\\n    #include <normal_fragment_maps>\\n\\n\\t#ifdef CUT_PLANE\\n\\t    // on the cut surface (back facing fragments revealed), replace normal with cut plane direction\\n        if (!gl_FrontFacing) {\\n            normal = -cutPlaneDirection.xyz;\\n            diffuseColor.rgb = cutPlaneColor.rgb;\\n        }\\n\\t#endif\\n\\n\\t#include <emissivemap_fragment>\\n\\n\\t// accumulation\\n    #if defined(USE_LIGHTMAP) || defined(USE_AOMAP)\\n        vec2 vUv2 = vUv;\\n    #endif\\n\\n\\t#include <lights_physical_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\n\\t// modulation\\n\\t//#include <aomap_fragment>\\n\\t// REPLACED WITH\\n\\t#ifdef USE_AOMAP\\n\\t    // if cut plane is enabled, disable ambient occlusion on back facing fragments\\n\\t    #ifdef CUT_PLANE\\n            if (gl_FrontFacing) {\\n\\t    #endif\\n\\n    \\t// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\\n    \\tvec3 aoSample = texture2D(aoMap, vUv).rgb;\\n    \\tvec3 aoFactors = mix(vec3(1.0), aoSample, clamp(aoMapMix * aoMapIntensity, 0.0, 1.0));\\n    \\tfloat ambientOcclusion = aoFactors.x * aoFactors.y * aoFactors.z;\\n    \\tfloat ambientOcclusion2 = ambientOcclusion * ambientOcclusion;\\n    \\treflectedLight.directDiffuse *= ambientOcclusion2;\\n    \\treflectedLight.directSpecular *= ambientOcclusion;\\n    \\t//reflectedLight.indirectDiffuse *= ambientOcclusion;\\n\\n    \\t#if defined(USE_ENVMAP) && defined(PHYSICAL)\\n    \\t\\tfloat dotNV = saturate(dot(geometry.normal, geometry.viewDir));\\n    \\t\\treflectedLight.indirectSpecular *= computeSpecularOcclusion(dotNV, ambientOcclusion, material.specularRoughness);\\n    \\t#endif\\n\\n    \\t#ifdef CUT_PLANE\\n    \\t    }\\n    \\t#endif\\n    #endif\\n\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\n\\tgl_FragColor = vec4(outgoingLight, diffuseColor.a);\\n\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n\\n    #ifdef MODE_NORMALS\\n        gl_FragColor = vec4(vec3(normal * 0.5 + 0.5), 1.0);\\n    #endif\\n\\n    #ifdef MODE_XRAY\\n        gl_FragColor = vec4(vec3(0.4, 0.7, 1.0) * vIntensity, 1.0);\\n    #endif\\n}\\n\"","module.exports = \"//#define PHYSICAL\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n\\n#include <common>\\n\\n//#include <uv_pars_vertex>\\n//#include <uv2_pars_vertex>\\n// REPLACED WITH\\n#if defined(USE_MAP) || defined(USE_BUMPMAP) || defined(USE_NORMALMAP) || defined(USE_SPECULARMAP) || defined(USE_ALPHAMAP) || defined(USE_EMISSIVEMAP) || defined(USE_ROUGHNESSMAP) || defined(USE_METALNESSMAP) || defined(USE_LIGHTMAP) || defined(USE_AOMAP)\\n\\tvarying vec2 vUv;\\n\\tuniform mat3 uvTransform;\\n#endif\\n\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\n\\n#ifdef MODE_XRAY\\n    varying float vIntensity;\\n#endif\\n\\n#ifdef CUT_PLANE\\n    varying vec3 vWorldPosition;\\n#endif\\n\\nvoid main() {\\n\\n//\\t#include <uv_vertex>\\n//\\t#include <uv2_vertex>\\n//  REPLACED WITH\\n#if defined(USE_MAP) || defined(USE_BUMPMAP) || defined(USE_NORMALMAP) || defined(USE_SPECULARMAP) || defined(USE_ALPHAMAP) || defined(USE_EMISSIVEMAP) || defined(USE_ROUGHNESSMAP) || defined(USE_METALNESSMAP) || defined(USE_LIGHTMAP) || defined(USE_AOMAP)\\n\\tvUv = (uvTransform * vec3(uv, 1)).xy;\\n#endif\\n\\n\\t#include <color_vertex>\\n\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\\n\\tvNormal = normalize(transformedNormal);\\n#endif\\n\\n#ifdef MODE_XRAY\\n    vIntensity = pow(abs(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0)))), 3.0);\\n#endif\\n\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\n\\tvViewPosition = -mvPosition.xyz;\\n\\n\\t// #include <worldpos_vertex>\\n\\t// REPLACED WITH\\n\\t#if defined(USE_ENVMAP) || defined(DISTANCE) || defined(USE_SHADOWMAP) || defined(CUT_PLANE)\\n    \\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\\n    #endif\\n\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n\\n#ifdef CUT_PLANE\\n    vWorldPosition = worldPosition.xyz / worldPosition.w;\\n#endif\\n\\n#ifdef MODE_NORMALS\\n    vNormal = normal;\\n#endif\\n}\\n\"","function isAbsolute(pathname) {\n  return pathname.charAt(0) === '/';\n}\n\n// About 1.5x faster than the two-arg version of Array#splice()\nfunction spliceOne(list, index) {\n  for (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1) {\n    list[i] = list[k];\n  }\n\n  list.pop();\n}\n\n// This implementation is based heavily on node's url.parse\nfunction resolvePathname(to, from) {\n  if (from === undefined) from = '';\n\n  var toParts = (to && to.split('/')) || [];\n  var fromParts = (from && from.split('/')) || [];\n\n  var isToAbs = to && isAbsolute(to);\n  var isFromAbs = from && isAbsolute(from);\n  var mustEndAbs = isToAbs || isFromAbs;\n\n  if (to && isAbsolute(to)) {\n    // to is absolute\n    fromParts = toParts;\n  } else if (toParts.length) {\n    // to is relative, drop the filename\n    fromParts.pop();\n    fromParts = fromParts.concat(toParts);\n  }\n\n  if (!fromParts.length) return '/';\n\n  var hasTrailingSlash;\n  if (fromParts.length) {\n    var last = fromParts[fromParts.length - 1];\n    hasTrailingSlash = last === '.' || last === '..' || last === '';\n  } else {\n    hasTrailingSlash = false;\n  }\n\n  var up = 0;\n  for (var i = fromParts.length; i >= 0; i--) {\n    var part = fromParts[i];\n\n    if (part === '.') {\n      spliceOne(fromParts, i);\n    } else if (part === '..') {\n      spliceOne(fromParts, i);\n      up++;\n    } else if (up) {\n      spliceOne(fromParts, i);\n      up--;\n    }\n  }\n\n  if (!mustEndAbs) for (; up--; up) fromParts.unshift('..');\n\n  if (\n    mustEndAbs &&\n    fromParts[0] !== '' &&\n    (!fromParts[0] || !isAbsolute(fromParts[0]))\n  )\n    fromParts.unshift('');\n\n  var result = fromParts.join('/');\n\n  if (hasTrailingSlash && result.substr(-1) !== '/') result += '/';\n\n  return result;\n}\n\nexport default resolvePathname;\n","// Copyright 2016 The Draco Authors.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n//\n'use strict';\n\n/**\n * @param {THREE.LoadingManager} manager\n */\nTHREE.DRACOLoader = function(manager) {\n    this.timeLoaded = 0;\n    this.manager = manager || THREE.DefaultLoadingManager;\n    this.materials = null;\n    this.verbosity = 0;\n    this.attributeOptions = {};\n    this.drawMode = THREE.TrianglesDrawMode;\n    // Native Draco attribute type to Three.JS attribute type.\n    this.nativeAttributeMap = {\n      'position' : 'POSITION',\n      'normal' : 'NORMAL',\n      'color' : 'COLOR',\n      'uv' : 'TEX_COORD'\n    };\n};\n\nTHREE.DRACOLoader.prototype = {\n\n    constructor: THREE.DRACOLoader,\n\n    load: function(url, onLoad, onProgress, onError) {\n        var scope = this;\n        var loader = new THREE.FileLoader(scope.manager);\n        loader.setPath(this.path);\n        loader.setResponseType('arraybuffer');\n        loader.load(url, function(blob) {\n            scope.decodeDracoFile(blob, onLoad);\n        }, onProgress, onError);\n    },\n\n    setPath: function(value) {\n        this.path = value;\n        return this;\n    },\n\n    setVerbosity: function(level) {\n        this.verbosity = level;\n        return this;\n    },\n\n    /**\n     *  Sets desired mode for generated geometry indices.\n     *  Can be either:\n     *      THREE.TrianglesDrawMode\n     *      THREE.TriangleStripDrawMode\n     */\n    setDrawMode: function(drawMode) {\n        this.drawMode = drawMode;\n        return this;\n    },\n\n    /**\n     * Skips dequantization for a specific attribute.\n     * |attributeName| is the THREE.js name of the given attribute type.\n     * The only currently supported |attributeName| is 'position', more may be\n     * added in future.\n     */\n    setSkipDequantization: function(attributeName, skip) {\n        var skipDequantization = true;\n        if (typeof skip !== 'undefined')\n          skipDequantization = skip;\n        this.getAttributeOptions(attributeName).skipDequantization =\n            skipDequantization;\n        return this;\n    },\n\n    /**\n     * Decompresses a Draco buffer. Names of attributes (for ID and type maps)\n     * must be one of the supported three.js types, including: position, color,\n     * normal, uv, uv2, skinIndex, skinWeight.\n     *\n     * @param {ArrayBuffer} rawBuffer\n     * @param {Function} callback\n     * @param {Object|undefined} attributeUniqueIdMap Provides a pre-defined ID\n     *     for each attribute in the geometry to be decoded. If given,\n     *     `attributeTypeMap` is required and `nativeAttributeMap` will be\n     *     ignored.\n     * @param {Object|undefined} attributeTypeMap Provides a predefined data\n     *     type (as a typed array constructor) for each attribute in the\n     *     geometry to be decoded.\n     */\n    decodeDracoFile: function(rawBuffer, callback, attributeUniqueIdMap,\n                              attributeTypeMap) {\n      var scope = this;\n      THREE.DRACOLoader.getDecoderModule()\n          .then( function ( module ) {\n            scope.decodeDracoFileInternal( rawBuffer, module.decoder, callback,\n              attributeUniqueIdMap, attributeTypeMap);\n          });\n    },\n\n    decodeDracoFileInternal: function(rawBuffer, dracoDecoder, callback,\n                                      attributeUniqueIdMap, attributeTypeMap) {\n      /*\n       * Here is how to use Draco Javascript decoder and get the geometry.\n       */\n      var buffer = new dracoDecoder.DecoderBuffer();\n      buffer.Init(new Int8Array(rawBuffer), rawBuffer.byteLength);\n      var decoder = new dracoDecoder.Decoder();\n\n      /*\n       * Determine what type is this file: mesh or point cloud.\n       */\n      var geometryType = decoder.GetEncodedGeometryType(buffer);\n      if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n        if (this.verbosity > 0) {\n          console.log('Loaded a mesh.');\n        }\n      } else if (geometryType == dracoDecoder.POINT_CLOUD) {\n        if (this.verbosity > 0) {\n          console.log('Loaded a point cloud.');\n        }\n      } else {\n        var errorMsg = 'THREE.DRACOLoader: Unknown geometry type.';\n        console.error(errorMsg);\n        throw new Error(errorMsg);\n      }\n      callback(this.convertDracoGeometryTo3JS(dracoDecoder, decoder,\n          geometryType, buffer, attributeUniqueIdMap, attributeTypeMap));\n    },\n\n    addAttributeToGeometry: function(dracoDecoder, decoder, dracoGeometry,\n                                     attributeName, attributeType, attribute,\n                                     geometry, geometryBuffer) {\n      if (attribute.ptr === 0) {\n        var errorMsg = 'THREE.DRACOLoader: No attribute ' + attributeName;\n        console.error(errorMsg);\n        throw new Error(errorMsg);\n      }\n\n      var numComponents = attribute.num_components();\n      var numPoints = dracoGeometry.num_points();\n      var numValues = numPoints * numComponents;\n      var attributeData;\n      var TypedBufferAttribute;\n\n      switch ( attributeType ) {\n\n        case Float32Array:\n          attributeData = new dracoDecoder.DracoFloat32Array();\n          decoder.GetAttributeFloatForAllPoints(\n            dracoGeometry, attribute, attributeData);\n          geometryBuffer[ attributeName ] = new Float32Array( numValues );\n          TypedBufferAttribute = THREE.Float32BufferAttribute;\n          break;\n\n        case Int8Array:\n          attributeData = new dracoDecoder.DracoInt8Array();\n          decoder.GetAttributeInt8ForAllPoints(\n            dracoGeometry, attribute, attributeData );\n          geometryBuffer[ attributeName ] = new Int8Array( numValues );\n          TypedBufferAttribute = THREE.Int8BufferAttribute;\n          break;\n\n        case Int16Array:\n          attributeData = new dracoDecoder.DracoInt16Array();\n          decoder.GetAttributeInt16ForAllPoints(\n            dracoGeometry, attribute, attributeData);\n          geometryBuffer[ attributeName ] = new Int16Array( numValues );\n          TypedBufferAttribute = THREE.Int16BufferAttribute;\n          break;\n\n        case Int32Array:\n          attributeData = new dracoDecoder.DracoInt32Array();\n          decoder.GetAttributeInt32ForAllPoints(\n            dracoGeometry, attribute, attributeData);\n          geometryBuffer[ attributeName ] = new Int32Array( numValues );\n          TypedBufferAttribute = THREE.Int32BufferAttribute;\n          break;\n\n        case Uint8Array:\n          attributeData = new dracoDecoder.DracoUInt8Array();\n          decoder.GetAttributeUInt8ForAllPoints(\n            dracoGeometry, attribute, attributeData);\n          geometryBuffer[ attributeName ] = new Uint8Array( numValues );\n          TypedBufferAttribute = THREE.Uint8BufferAttribute;\n          break;\n\n        case Uint16Array:\n          attributeData = new dracoDecoder.DracoUInt16Array();\n          decoder.GetAttributeUInt16ForAllPoints(\n            dracoGeometry, attribute, attributeData);\n          geometryBuffer[ attributeName ] = new Uint16Array( numValues );\n          TypedBufferAttribute = THREE.Uint16BufferAttribute;\n          break;\n\n        case Uint32Array:\n          attributeData = new dracoDecoder.DracoUInt32Array();\n          decoder.GetAttributeUInt32ForAllPoints(\n            dracoGeometry, attribute, attributeData);\n          geometryBuffer[ attributeName ] = new Uint32Array( numValues );\n          TypedBufferAttribute = THREE.Uint32BufferAttribute;\n          break;\n\n        default:\n          var errorMsg = 'THREE.DRACOLoader: Unexpected attribute type.';\n          console.error( errorMsg );\n          throw new Error( errorMsg );\n\n      }\n\n      // Copy data from decoder.\n      for (var i = 0; i < numValues; i++) {\n        geometryBuffer[attributeName][i] = attributeData.GetValue(i);\n      }\n      // Add attribute to THREEJS geometry for rendering.\n      geometry.addAttribute(attributeName,\n          new TypedBufferAttribute(geometryBuffer[attributeName],\n            numComponents));\n      dracoDecoder.destroy(attributeData);\n    },\n\n    convertDracoGeometryTo3JS: function(dracoDecoder, decoder, geometryType,\n                                        buffer, attributeUniqueIdMap,\n                                        attributeTypeMap) {\n        // TODO: Should not assume native Draco attribute IDs apply.\n        if (this.getAttributeOptions('position').skipDequantization === true) {\n          decoder.SkipAttributeTransform(dracoDecoder.POSITION);\n        }\n        var dracoGeometry;\n        var decodingStatus;\n        var start_time = performance.now();\n        if (geometryType === dracoDecoder.TRIANGULAR_MESH) {\n          dracoGeometry = new dracoDecoder.Mesh();\n          decodingStatus = decoder.DecodeBufferToMesh(buffer, dracoGeometry);\n        } else {\n          dracoGeometry = new dracoDecoder.PointCloud();\n          decodingStatus =\n              decoder.DecodeBufferToPointCloud(buffer, dracoGeometry);\n        }\n        if (!decodingStatus.ok() || dracoGeometry.ptr == 0) {\n          var errorMsg = 'THREE.DRACOLoader: Decoding failed: ';\n          errorMsg += decodingStatus.error_msg();\n          console.error(errorMsg);\n          dracoDecoder.destroy(decoder);\n          dracoDecoder.destroy(dracoGeometry);\n          throw new Error(errorMsg);\n        }\n\n        var decode_end = performance.now();\n        dracoDecoder.destroy(buffer);\n        /*\n         * Example on how to retrieve mesh and attributes.\n         */\n        var numFaces;\n        if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n          numFaces = dracoGeometry.num_faces();\n          if (this.verbosity > 0) {\n            console.log('Number of faces loaded: ' + numFaces.toString());\n          }\n        } else {\n          numFaces = 0;\n        }\n\n        var numPoints = dracoGeometry.num_points();\n        var numAttributes = dracoGeometry.num_attributes();\n        if (this.verbosity > 0) {\n          console.log('Number of points loaded: ' + numPoints.toString());\n          console.log('Number of attributes loaded: ' +\n              numAttributes.toString());\n        }\n\n        // Verify if there is position attribute.\n        // TODO: Should not assume native Draco attribute IDs apply.\n        var posAttId = decoder.GetAttributeId(dracoGeometry,\n                                              dracoDecoder.POSITION);\n        if (posAttId == -1) {\n          var errorMsg = 'THREE.DRACOLoader: No position attribute found.';\n          console.error(errorMsg);\n          dracoDecoder.destroy(decoder);\n          dracoDecoder.destroy(dracoGeometry);\n          throw new Error(errorMsg);\n        }\n        var posAttribute = decoder.GetAttribute(dracoGeometry, posAttId);\n\n        // Structure for converting to THREEJS geometry later.\n        var geometryBuffer = {};\n        // Import data to Three JS geometry.\n        var geometry = new THREE.BufferGeometry();\n\n        // Do not use both the native attribute map and a provided (e.g. glTF) map.\n        if ( attributeUniqueIdMap ) {\n\n          // Add attributes of user specified unique id. E.g. GLTF models.\n          for (var attributeName in attributeUniqueIdMap) {\n            var attributeType = attributeTypeMap[attributeName];\n            var attributeId = attributeUniqueIdMap[attributeName];\n            var attribute = decoder.GetAttributeByUniqueId(dracoGeometry,\n                                                           attributeId);\n            this.addAttributeToGeometry(dracoDecoder, decoder, dracoGeometry,\n                attributeName, attributeType, attribute, geometry, geometryBuffer);\n          }\n\n        } else {\n\n          // Add native Draco attribute type to geometry.\n          for (var attributeName in this.nativeAttributeMap) {\n            var attId = decoder.GetAttributeId(dracoGeometry,\n                dracoDecoder[this.nativeAttributeMap[attributeName]]);\n            if (attId !== -1) {\n              if (this.verbosity > 0) {\n                console.log('Loaded ' + attributeName + ' attribute.');\n              }\n              var attribute = decoder.GetAttribute(dracoGeometry, attId);\n              this.addAttributeToGeometry(dracoDecoder, decoder, dracoGeometry,\n                  attributeName, Float32Array, attribute, geometry, geometryBuffer);\n            }\n          }\n\n        }\n\n        // For mesh, we need to generate the faces.\n        if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n          if (this.drawMode === THREE.TriangleStripDrawMode) {\n            var stripsArray = new dracoDecoder.DracoInt32Array();\n            var numStrips = decoder.GetTriangleStripsFromMesh(\n                dracoGeometry, stripsArray);\n            geometryBuffer.indices = new Uint32Array(stripsArray.size());\n            for (var i = 0; i < stripsArray.size(); ++i) {\n              geometryBuffer.indices[i] = stripsArray.GetValue(i);\n            }\n            dracoDecoder.destroy(stripsArray);\n          } else {\n            var numIndices = numFaces * 3;\n            geometryBuffer.indices = new Uint32Array(numIndices);\n            var ia = new dracoDecoder.DracoInt32Array();\n            for (var i = 0; i < numFaces; ++i) {\n              decoder.GetFaceFromMesh(dracoGeometry, i, ia);\n              var index = i * 3;\n              geometryBuffer.indices[index] = ia.GetValue(0);\n              geometryBuffer.indices[index + 1] = ia.GetValue(1);\n              geometryBuffer.indices[index + 2] = ia.GetValue(2);\n            }\n            dracoDecoder.destroy(ia);\n         }\n        }\n\n        geometry.drawMode = this.drawMode;\n        if (geometryType == dracoDecoder.TRIANGULAR_MESH) {\n          geometry.setIndex(new(geometryBuffer.indices.length > 65535 ?\n                THREE.Uint32BufferAttribute : THREE.Uint16BufferAttribute)\n              (geometryBuffer.indices, 1));\n        }\n\n        // TODO: Should not assume native Draco attribute IDs apply.\n        // TODO: Can other attribute types be quantized?\n        var posTransform = new dracoDecoder.AttributeQuantizationTransform();\n        if (posTransform.InitFromAttribute(posAttribute)) {\n          // Quantized attribute. Store the quantization parameters into the\n          // THREE.js attribute.\n          geometry.attributes['position'].isQuantized = true;\n          geometry.attributes['position'].maxRange = posTransform.range();\n          geometry.attributes['position'].numQuantizationBits =\n              posTransform.quantization_bits();\n          geometry.attributes['position'].minValues = new Float32Array(3);\n          for (var i = 0; i < 3; ++i) {\n            geometry.attributes['position'].minValues[i] =\n                posTransform.min_value(i);\n          }\n        }\n        dracoDecoder.destroy(posTransform);\n        dracoDecoder.destroy(decoder);\n        dracoDecoder.destroy(dracoGeometry);\n\n        this.decode_time = decode_end - start_time;\n        this.import_time = performance.now() - decode_end;\n\n        if (this.verbosity > 0) {\n          console.log('Decode time: ' + this.decode_time);\n          console.log('Import time: ' + this.import_time);\n        }\n        return geometry;\n    },\n\n    isVersionSupported: function(version, callback) {\n        THREE.DRACOLoader.getDecoderModule()\n            .then( function ( module ) {\n              callback( module.decoder.isVersionSupported( version ) );\n            });\n    },\n\n    getAttributeOptions: function(attributeName) {\n        if (typeof this.attributeOptions[attributeName] === 'undefined')\n          this.attributeOptions[attributeName] = {};\n        return this.attributeOptions[attributeName];\n    }\n};\n\nTHREE.DRACOLoader.decoderPath = './';\nTHREE.DRACOLoader.decoderConfig = {};\nTHREE.DRACOLoader.decoderModulePromise = null;\n\n/**\n * Sets the base path for decoder source files.\n * @param {string} path\n */\nTHREE.DRACOLoader.setDecoderPath = function ( path ) {\n  THREE.DRACOLoader.decoderPath = path;\n};\n\n/**\n * Sets decoder configuration and releases singleton decoder module. Module\n * will be recreated with the next decoding call.\n * @param {Object} config\n */\nTHREE.DRACOLoader.setDecoderConfig = function ( config ) {\n  var wasmBinary = THREE.DRACOLoader.decoderConfig.wasmBinary;\n  THREE.DRACOLoader.decoderConfig = config || {};\n  THREE.DRACOLoader.releaseDecoderModule();\n\n  // Reuse WASM binary.\n  if ( wasmBinary ) THREE.DRACOLoader.decoderConfig.wasmBinary = wasmBinary;\n};\n\n/**\n * Releases the singleton DracoDecoderModule instance. Module will be recreated\n * with the next decoding call.\n */\nTHREE.DRACOLoader.releaseDecoderModule = function () {\n  THREE.DRACOLoader.decoderModulePromise = null;\n};\n\n/**\n * Gets WebAssembly or asm.js singleton instance of DracoDecoderModule\n * after testing for browser support. Returns Promise that resolves when\n * module is available.\n * @return {Promise<{decoder: DracoDecoderModule}>}\n */\nTHREE.DRACOLoader.getDecoderModule = function () {\n  var scope = this;\n  var path = THREE.DRACOLoader.decoderPath;\n  var config = THREE.DRACOLoader.decoderConfig;\n  var promise = THREE.DRACOLoader.decoderModulePromise;\n\n  if ( promise ) return promise;\n\n  // Load source files.\n  if ( typeof DracoDecoderModule !== 'undefined' ) {\n    // Loaded externally.\n    promise = Promise.resolve();\n  } else if ( typeof WebAssembly !== 'object' || config.type === 'js' ) {\n    // Load with asm.js.\n    promise = THREE.DRACOLoader._loadScript( path + 'draco_decoder.js' );\n  } else {\n    // Load with WebAssembly.\n    config.wasmBinaryFile = path + 'draco_decoder.wasm';\n    promise = THREE.DRACOLoader._loadScript( path + 'draco_wasm_wrapper.js' )\n        .then( function () {\n          return THREE.DRACOLoader._loadArrayBuffer( config.wasmBinaryFile );\n        } )\n        .then( function ( wasmBinary ) {\n          config.wasmBinary = wasmBinary;\n        } );\n  }\n\n  // Wait for source files, then create and return a decoder.\n  promise = promise.then( function () {\n    return new Promise( function ( resolve ) {\n      config.onModuleLoaded = function ( decoder ) {\n        scope.timeLoaded = performance.now();\n        // Module is Promise-like. Wrap before resolving to avoid loop.\n        resolve( { decoder: decoder } );\n      };\n      DracoDecoderModule( config );\n    } );\n  } );\n\n  THREE.DRACOLoader.decoderModulePromise = promise;\n  return promise;\n};\n\n/**\n * @param {string} src\n * @return {Promise}\n */\nTHREE.DRACOLoader._loadScript = function ( src ) {\n  var prevScript = document.getElementById( 'decoder_script' );\n  if ( prevScript !== null ) {\n    prevScript.parentNode.removeChild( prevScript );\n  }\n  var head = document.getElementsByTagName( 'head' )[ 0 ];\n  var script = document.createElement( 'script' );\n  script.id = 'decoder_script';\n  script.type = 'text/javascript';\n  script.src = src;\n  return new Promise( function ( resolve ) {\n    script.onload = resolve;\n    head.appendChild( script );\n  });\n};\n\n/**\n * @param {string} src\n * @return {Promise}\n */\nTHREE.DRACOLoader._loadArrayBuffer = function ( src ) {\n  var loader = new THREE.FileLoader();\n  loader.setResponseType( 'arraybuffer' );\n  return new Promise( function( resolve, reject ) {\n    loader.load( src, resolve, undefined, reject );\n  });\n};\n","/**\n * @author Rich Tibbett / https://github.com/richtr\n * @author mrdoob / http://mrdoob.com/\n * @author Tony Parisi / http://www.tonyparisi.com/\n * @author Takahiro / https://github.com/takahirox\n * @author Don McCurdy / https://www.donmccurdy.com\n */\n\nTHREE.GLTFLoader = ( function () {\n\n\tfunction GLTFLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\t\tthis.dracoLoader = null;\n\n\t}\n\n\tGLTFLoader.prototype = {\n\n\t\tconstructor: GLTFLoader,\n\n\t\tcrossOrigin: 'anonymous',\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar resourcePath;\n\n\t\t\tif ( this.resourcePath !== undefined ) {\n\n\t\t\t\tresourcePath = this.resourcePath;\n\n\t\t\t} else if ( this.path !== undefined ) {\n\n\t\t\t\tresourcePath = this.path;\n\n\t\t\t} else {\n\n\t\t\t\tresourcePath = THREE.LoaderUtils.extractUrlBase( url );\n\n\t\t\t}\n\n\t\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tvar _onError = function ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t};\n\n\t\t\tvar loader = new THREE.FileLoader( scope.manager );\n\n\t\t\tloader.setPath( this.path );\n\t\t\tloader.setResponseType( 'arraybuffer' );\n\n\t\t\tloader.load( url, function ( data ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t\t}, _onError );\n\n\t\t\t\t} catch ( e ) {\n\n\t\t\t\t\t_onError( e );\n\n\t\t\t\t}\n\n\t\t\t}, onProgress, _onError );\n\n\t\t},\n\n\t\tsetCrossOrigin: function ( value ) {\n\n\t\t\tthis.crossOrigin = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetPath: function ( value ) {\n\n\t\t\tthis.path = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetResourcePath: function ( value ) {\n\n\t\t\tthis.resourcePath = value;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetDRACOLoader: function ( dracoLoader ) {\n\n\t\t\tthis.dracoLoader = dracoLoader;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tparse: function ( data, path, onLoad, onError ) {\n\n\t\t\tvar content;\n\t\t\tvar extensions = {};\n\n\t\t\tif ( typeof data === 'string' ) {\n\n\t\t\t\tcontent = data;\n\n\t\t\t} else {\n\n\t\t\t\tvar magic = THREE.LoaderUtils.decodeText( new Uint8Array( data, 0, 4 ) );\n\n\t\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcontent = extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcontent = THREE.LoaderUtils.decodeText( new Uint8Array( data ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar json = JSON.parse( content );\n\n\t\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead.' ) );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( json.extensionsUsed ) {\n\n\t\t\t\tfor ( var i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\t\tvar extensionName = json.extensionsUsed[ i ];\n\t\t\t\t\tvar extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_LIGHTS_PUNCTUAL:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFLightsExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsPbrSpecularGlossinessExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.MSFT_TEXTURE_DDS:\n\t\t\t\t\t\t\textensions[ EXTENSIONS.MSFT_TEXTURE_DDS ] = new GLTFTextureDDSExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\t\textensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] = new GLTFTextureTransformExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 ) {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar parser = new GLTFParser( json, extensions, {\n\n\t\t\t\tpath: path || this.resourcePath || '',\n\t\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\t\tmanager: this.manager\n\n\t\t\t} );\n\n\t\t\tparser.parse( function ( scene, scenes, cameras, animations, json ) {\n\n\t\t\t\tvar glTF = {\n\t\t\t\t\tscene: scene,\n\t\t\t\t\tscenes: scenes,\n\t\t\t\t\tcameras: cameras,\n\t\t\t\t\tanimations: animations,\n\t\t\t\t\tasset: json.asset,\n\t\t\t\t\tparser: parser,\n\t\t\t\t\tuserData: {}\n\t\t\t\t};\n\n\t\t\t\taddUnknownExtensionsToUserData( extensions, glTF, json );\n\n\t\t\t\tonLoad( glTF );\n\n\t\t\t}, onError );\n\n\t\t}\n\n\t};\n\n\t/* GLTFREGISTRY */\n\n\tfunction GLTFRegistry() {\n\n\t\tvar objects = {};\n\n\t\treturn\t{\n\n\t\t\tget: function ( key ) {\n\n\t\t\t\treturn objects[ key ];\n\n\t\t\t},\n\n\t\t\tadd: function ( key, object ) {\n\n\t\t\t\tobjects[ key ] = object;\n\n\t\t\t},\n\n\t\t\tremove: function ( key ) {\n\n\t\t\t\tdelete objects[ key ];\n\n\t\t\t},\n\n\t\t\tremoveAll: function () {\n\n\t\t\t\tobjects = {};\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/*********************************/\n\t/********** EXTENSIONS ***********/\n\t/*********************************/\n\n\tvar EXTENSIONS = {\n\t\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\t\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\t\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\t\tKHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n\t\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\t\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\t\tMSFT_TEXTURE_DDS: 'MSFT_texture_dds'\n\t};\n\n\t/**\n\t * DDS Texture Extension\n\t *\n\t * Specification:\n\t * https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/MSFT_texture_dds\n\t *\n\t */\n\tfunction GLTFTextureDDSExtension() {\n\n\t\tif ( ! THREE.DDSLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.MSFT_TEXTURE_DDS;\n\t\tthis.ddsLoader = new THREE.DDSLoader();\n\n\t}\n\n\t/**\n\t * Lights Extension\n\t *\n\t * Specification: PENDING\n\t */\n\tfunction GLTFLightsExtension( json ) {\n\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\tvar extension = ( json.extensions && json.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ] ) || {};\n\t\tthis.lightDefs = extension.lights || [];\n\n\t}\n\n\tGLTFLightsExtension.prototype.loadLight = function ( lightIndex ) {\n\n\t\tvar lightDef = this.lightDefs[ lightIndex ];\n\t\tvar lightNode;\n\n\t\tvar color = new THREE.Color( 0xffffff );\n\t\tif ( lightDef.color !== undefined ) color.fromArray( lightDef.color );\n\n\t\tvar range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new THREE.DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, -1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new THREE.PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new THREE.SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, -1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type, \"' + lightDef.type + '\".' );\n\n\t\t}\n\n\t\tlightNode.decay = 2;\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = lightDef.name || ( 'light_' + lightIndex );\n\n\t\treturn Promise.resolve( lightNode );\n\n\t};\n\n\t/**\n\t * Unlit Materials Extension (pending)\n\t *\n\t * PR: https://github.com/KhronosGroup/glTF/pull/1163\n\t */\n\tfunction GLTFMaterialsUnlitExtension( json ) {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tGLTFMaterialsUnlitExtension.prototype.getMaterialType = function ( material ) {\n\n\t\treturn THREE.MeshBasicMaterial;\n\n\t};\n\n\tGLTFMaterialsUnlitExtension.prototype.extendParams = function ( materialParams, material, parser ) {\n\n\t\tvar pending = [];\n\n\t\tmaterialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tvar metallicRoughness = material.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tvar array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t};\n\n\t/* BINARY EXTENSION */\n\n\tvar BINARY_EXTENSION_BUFFER_NAME = 'binary_glTF';\n\tvar BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\n\tvar BINARY_EXTENSION_HEADER_LENGTH = 12;\n\tvar BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\n\tfunction GLTFBinaryExtension( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tvar headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\n\t\tthis.header = {\n\t\t\tmagic: THREE.LoaderUtils.decodeText( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.' );\n\n\t\t}\n\n\t\tvar chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tvar chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkView.byteLength ) {\n\n\t\t\tvar chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tvar chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tvar contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = THREE.LoaderUtils.decodeText( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tvar byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * DRACO Mesh Compression Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/pull/874\n\t */\n\tfunction GLTFDracoMeshCompressionExtension( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tTHREE.DRACOLoader.getDecoderModule();\n\n\t}\n\n\tGLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function ( primitive, parser ) {\n\n\t\tvar json = this.json;\n\t\tvar dracoLoader = this.dracoLoader;\n\t\tvar bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tvar gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tvar threeAttributeMap = {};\n\t\tvar attributeNormalizedMap = {};\n\t\tvar attributeTypeMap = {};\n\n\t\tfor ( var attributeName in gltfAttributeMap ) {\n\n\t\t\tif ( ! ( attributeName in ATTRIBUTES ) ) continue;\n\n\t\t\tthreeAttributeMap[ ATTRIBUTES[ attributeName ] ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( attributeName in primitive.attributes ) {\n\n\t\t\tif ( ATTRIBUTES[ attributeName ] !== undefined && gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tvar accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tvar componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ ATTRIBUTES[ attributeName ] ] = componentType;\n\t\t\t\tattributeNormalizedMap[ ATTRIBUTES[ attributeName ] ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( var attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tvar attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tvar normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap );\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Texture Transform Extension\n\t *\n\t * Specification:\n\t */\n\tfunction GLTFTextureTransformExtension( json ) {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\tGLTFTextureTransformExtension.prototype.extendTexture = function ( texture, transform ) {\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.' );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t};\n\n\t/**\n\t * Specular-Glossiness Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n\t */\n\tfunction GLTFMaterialsPbrSpecularGlossinessExtension() {\n\n\t\treturn {\n\n\t\t\tname: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\n\n\t\t\tspecularGlossinessParams: [\n\t\t\t\t'color',\n\t\t\t\t'map',\n\t\t\t\t'lightMap',\n\t\t\t\t'lightMapIntensity',\n\t\t\t\t'aoMap',\n\t\t\t\t'aoMapIntensity',\n\t\t\t\t'emissive',\n\t\t\t\t'emissiveIntensity',\n\t\t\t\t'emissiveMap',\n\t\t\t\t'bumpMap',\n\t\t\t\t'bumpScale',\n\t\t\t\t'normalMap',\n\t\t\t\t'displacementMap',\n\t\t\t\t'displacementScale',\n\t\t\t\t'displacementBias',\n\t\t\t\t'specularMap',\n\t\t\t\t'specular',\n\t\t\t\t'glossinessMap',\n\t\t\t\t'glossiness',\n\t\t\t\t'alphaMap',\n\t\t\t\t'envMap',\n\t\t\t\t'envMapIntensity',\n\t\t\t\t'refractionRatio',\n\t\t\t],\n\n\t\t\tgetMaterialType: function () {\n\n\t\t\t\treturn THREE.ShaderMaterial;\n\n\t\t\t},\n\n\t\t\textendParams: function ( params, material, parser ) {\n\n\t\t\t\tvar pbrSpecularGlossiness = material.extensions[ this.name ];\n\n\t\t\t\tvar shader = THREE.ShaderLib[ 'standard' ];\n\n\t\t\t\tvar uniforms = THREE.UniformsUtils.clone( shader.uniforms );\n\n\t\t\t\tvar specularMapParsFragmentChunk = [\n\t\t\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t\t\t'\tuniform sampler2D specularMap;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar glossinessMapParsFragmentChunk = [\n\t\t\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t\t\t'\tuniform sampler2D glossinessMap;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar specularMapFragmentChunk = [\n\t\t\t\t\t'vec3 specularFactor = specular;',\n\t\t\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t\t\t'\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n\t\t\t\t\t'\ttexelSpecular = sRGBToLinear( texelSpecular );',\n\t\t\t\t\t'\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t\t\t'\tspecularFactor *= texelSpecular.rgb;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar glossinessMapFragmentChunk = [\n\t\t\t\t\t'float glossinessFactor = glossiness;',\n\t\t\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t\t\t'\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n\t\t\t\t\t'\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t\t\t'\tglossinessFactor *= texelGlossiness.a;',\n\t\t\t\t\t'#endif'\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar lightPhysicalFragmentChunk = [\n\t\t\t\t\t'PhysicalMaterial material;',\n\t\t\t\t\t'material.diffuseColor = diffuseColor.rgb;',\n\t\t\t\t\t'material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );',\n\t\t\t\t\t'material.specularColor = specularFactor.rgb;',\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tvar fragmentShader = shader.fragmentShader\n\t\t\t\t\t.replace( 'uniform float roughness;', 'uniform vec3 specular;' )\n\t\t\t\t\t.replace( 'uniform float metalness;', 'uniform float glossiness;' )\n\t\t\t\t\t.replace( '#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk )\n\t\t\t\t\t.replace( '#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk )\n\t\t\t\t\t.replace( '#include <roughnessmap_fragment>', specularMapFragmentChunk )\n\t\t\t\t\t.replace( '#include <metalnessmap_fragment>', glossinessMapFragmentChunk )\n\t\t\t\t\t.replace( '#include <lights_physical_fragment>', lightPhysicalFragmentChunk );\n\n\t\t\t\tdelete uniforms.roughness;\n\t\t\t\tdelete uniforms.metalness;\n\t\t\t\tdelete uniforms.roughnessMap;\n\t\t\t\tdelete uniforms.metalnessMap;\n\n\t\t\t\tuniforms.specular = { value: new THREE.Color().setHex( 0x111111 ) };\n\t\t\t\tuniforms.glossiness = { value: 0.5 };\n\t\t\t\tuniforms.specularMap = { value: null };\n\t\t\t\tuniforms.glossinessMap = { value: null };\n\n\t\t\t\tparams.vertexShader = shader.vertexShader;\n\t\t\t\tparams.fragmentShader = fragmentShader;\n\t\t\t\tparams.uniforms = uniforms;\n\t\t\t\tparams.defines = { 'STANDARD': '' };\n\n\t\t\t\tparams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\t\t\tparams.opacity = 1.0;\n\n\t\t\t\tvar pending = [];\n\n\t\t\t\tif ( Array.isArray( pbrSpecularGlossiness.diffuseFactor ) ) {\n\n\t\t\t\t\tvar array = pbrSpecularGlossiness.diffuseFactor;\n\n\t\t\t\t\tparams.color.fromArray( array );\n\t\t\t\t\tparams.opacity = array[ 3 ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( pbrSpecularGlossiness.diffuseTexture !== undefined ) {\n\n\t\t\t\t\tpending.push( parser.assignTexture( params, 'map', pbrSpecularGlossiness.diffuseTexture ) );\n\n\t\t\t\t}\n\n\t\t\t\tparams.emissive = new THREE.Color( 0.0, 0.0, 0.0 );\n\t\t\t\tparams.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n\t\t\t\tparams.specular = new THREE.Color( 1.0, 1.0, 1.0 );\n\n\t\t\t\tif ( Array.isArray( pbrSpecularGlossiness.specularFactor ) ) {\n\n\t\t\t\t\tparams.specular.fromArray( pbrSpecularGlossiness.specularFactor );\n\n\t\t\t\t}\n\n\t\t\t\tif ( pbrSpecularGlossiness.specularGlossinessTexture !== undefined ) {\n\n\t\t\t\t\tvar specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n\t\t\t\t\tpending.push( parser.assignTexture( params, 'glossinessMap', specGlossMapDef ) );\n\t\t\t\t\tpending.push( parser.assignTexture( params, 'specularMap', specGlossMapDef ) );\n\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all( pending );\n\n\t\t\t},\n\n\t\t\tcreateMaterial: function ( params ) {\n\n\t\t\t\t// setup material properties based on MeshStandardMaterial for Specular-Glossiness\n\n\t\t\t\tvar material = new THREE.ShaderMaterial( {\n\t\t\t\t\tdefines: params.defines,\n\t\t\t\t\tvertexShader: params.vertexShader,\n\t\t\t\t\tfragmentShader: params.fragmentShader,\n\t\t\t\t\tuniforms: params.uniforms,\n\t\t\t\t\tfog: true,\n\t\t\t\t\tlights: true,\n\t\t\t\t\topacity: params.opacity,\n\t\t\t\t\ttransparent: params.transparent\n\t\t\t\t} );\n\n\t\t\t\tmaterial.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t\t\tmaterial.color = params.color;\n\n\t\t\t\tmaterial.map = params.map === undefined ? null : params.map;\n\n\t\t\t\tmaterial.lightMap = null;\n\t\t\t\tmaterial.lightMapIntensity = 1.0;\n\n\t\t\t\tmaterial.aoMap = params.aoMap === undefined ? null : params.aoMap;\n\t\t\t\tmaterial.aoMapIntensity = 1.0;\n\n\t\t\t\tmaterial.emissive = params.emissive;\n\t\t\t\tmaterial.emissiveIntensity = 1.0;\n\t\t\t\tmaterial.emissiveMap = params.emissiveMap === undefined ? null : params.emissiveMap;\n\n\t\t\t\tmaterial.bumpMap = params.bumpMap === undefined ? null : params.bumpMap;\n\t\t\t\tmaterial.bumpScale = 1;\n\n\t\t\t\tmaterial.normalMap = params.normalMap === undefined ? null : params.normalMap;\n\t\t\t\tif ( params.normalScale ) material.normalScale = params.normalScale;\n\n\t\t\t\tmaterial.displacementMap = null;\n\t\t\t\tmaterial.displacementScale = 1;\n\t\t\t\tmaterial.displacementBias = 0;\n\n\t\t\t\tmaterial.specularMap = params.specularMap === undefined ? null : params.specularMap;\n\t\t\t\tmaterial.specular = params.specular;\n\n\t\t\t\tmaterial.glossinessMap = params.glossinessMap === undefined ? null : params.glossinessMap;\n\t\t\t\tmaterial.glossiness = params.glossiness;\n\n\t\t\t\tmaterial.alphaMap = null;\n\n\t\t\t\tmaterial.envMap = params.envMap === undefined ? null : params.envMap;\n\t\t\t\tmaterial.envMapIntensity = 1.0;\n\n\t\t\t\tmaterial.refractionRatio = 0.98;\n\n\t\t\t\tmaterial.extensions.derivatives = true;\n\n\t\t\t\treturn material;\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Clones a GLTFSpecularGlossinessMaterial instance. The ShaderMaterial.copy() method can\n\t\t\t * copy only properties it knows about or inherits, and misses many properties that would\n\t\t\t * normally be defined by MeshStandardMaterial.\n\t\t\t *\n\t\t\t * This method allows GLTFSpecularGlossinessMaterials to be cloned in the process of\n\t\t\t * loading a glTF model, but cloning later (e.g. by the user) would require these changes\n\t\t\t * AND also updating `.onBeforeRender` on the parent mesh.\n\t\t\t *\n\t\t\t * @param  {THREE.ShaderMaterial} source\n\t\t\t * @return {THREE.ShaderMaterial}\n\t\t\t */\n\t\t\tcloneMaterial: function ( source ) {\n\n\t\t\t\tvar target = source.clone();\n\n\t\t\t\ttarget.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t\t\tvar params = this.specularGlossinessParams;\n\n\t\t\t\tfor ( var i = 0, il = params.length; i < il; i ++ ) {\n\n\t\t\t\t\ttarget[ params[ i ] ] = source[ params[ i ] ];\n\n\t\t\t\t}\n\n\t\t\t\treturn target;\n\n\t\t\t},\n\n\t\t\t// Here's based on refreshUniformsCommon() and refreshUniformsStandard() in WebGLRenderer.\n\t\t\trefreshUniforms: function ( renderer, scene, camera, geometry, material, group ) {\n\n\t\t\t\tif ( material.isGLTFSpecularGlossinessMaterial !== true ) {\n\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tvar uniforms = material.uniforms;\n\t\t\t\tvar defines = material.defines;\n\n\t\t\t\tuniforms.opacity.value = material.opacity;\n\n\t\t\t\tuniforms.diffuse.value.copy( material.color );\n\t\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\n\n\t\t\t\tuniforms.map.value = material.map;\n\t\t\t\tuniforms.specularMap.value = material.specularMap;\n\t\t\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\t\t\tuniforms.lightMap.value = material.lightMap;\n\t\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\n\n\t\t\t\tuniforms.aoMap.value = material.aoMap;\n\t\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\n\n\t\t\t\t// uv repeat and offset setting priorities\n\t\t\t\t// 1. color map\n\t\t\t\t// 2. specular map\n\t\t\t\t// 3. normal map\n\t\t\t\t// 4. bump map\n\t\t\t\t// 5. alpha map\n\t\t\t\t// 6. emissive map\n\n\t\t\t\tvar uvScaleMap;\n\n\t\t\t\tif ( material.map ) {\n\n\t\t\t\t\tuvScaleMap = material.map;\n\n\t\t\t\t} else if ( material.specularMap ) {\n\n\t\t\t\t\tuvScaleMap = material.specularMap;\n\n\t\t\t\t} else if ( material.displacementMap ) {\n\n\t\t\t\t\tuvScaleMap = material.displacementMap;\n\n\t\t\t\t} else if ( material.normalMap ) {\n\n\t\t\t\t\tuvScaleMap = material.normalMap;\n\n\t\t\t\t} else if ( material.bumpMap ) {\n\n\t\t\t\t\tuvScaleMap = material.bumpMap;\n\n\t\t\t\t} else if ( material.glossinessMap ) {\n\n\t\t\t\t\tuvScaleMap = material.glossinessMap;\n\n\t\t\t\t} else if ( material.alphaMap ) {\n\n\t\t\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t\t\t} else if ( material.emissiveMap ) {\n\n\t\t\t\t\tuvScaleMap = material.emissiveMap;\n\n\t\t\t\t}\n\n\t\t\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\t\t\t// backwards compatibility\n\t\t\t\t\tif ( uvScaleMap.isWebGLRenderTarget ) {\n\n\t\t\t\t\t\tuvScaleMap = uvScaleMap.texture;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\n\n\t\t\t\t\t\tuvScaleMap.updateMatrix();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\n\n\t\t\t\t}\n\n\t\t\t\tif ( material.envMap ) {\n\n\t\t\t\t\tuniforms.envMap.value = material.envMap;\n\t\t\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\n\n\t\t\t\t\t// don't flip CubeTexture envMaps, flip everything else:\n\t\t\t\t\t//  WebGLRenderTargetCube will be flipped for backwards compatibility\n\t\t\t\t\t//  WebGLRenderTargetCube.texture will be flipped because it's a Texture and NOT a CubeTexture\n\t\t\t\t\t// this check must be handled differently, or removed entirely, if WebGLRenderTargetCube uses a CubeTexture in the future\n\t\t\t\t\tuniforms.flipEnvMap.value = material.envMap.isCubeTexture ? - 1 : 1;\n\n\t\t\t\t\tuniforms.reflectivity.value = material.reflectivity;\n\t\t\t\t\tuniforms.refractionRatio.value = material.refractionRatio;\n\n\t\t\t\t\tuniforms.maxMipLevel.value = renderer.properties.get( material.envMap ).__maxMipLevel;\n\t\t\t\t}\n\n\t\t\t\tuniforms.specular.value.copy( material.specular );\n\t\t\t\tuniforms.glossiness.value = material.glossiness;\n\n\t\t\t\tuniforms.glossinessMap.value = material.glossinessMap;\n\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\n\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t\t\tif ( uniforms.glossinessMap.value !== null && defines.USE_GLOSSINESSMAP === undefined ) {\n\n\t\t\t\t\tdefines.USE_GLOSSINESSMAP = '';\n\t\t\t\t\t// set USE_ROUGHNESSMAP to enable vUv\n\t\t\t\t\tdefines.USE_ROUGHNESSMAP = '';\n\n\t\t\t\t}\n\n\t\t\t\tif ( uniforms.glossinessMap.value === null && defines.USE_GLOSSINESSMAP !== undefined ) {\n\n\t\t\t\t\tdelete defines.USE_GLOSSINESSMAP;\n\t\t\t\t\tdelete defines.USE_ROUGHNESSMAP;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/*********************************/\n\t/********** INTERPOLATION ********/\n\t/*********************************/\n\n\t// Spline Interpolation\n\t// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\n\tfunction GLTFCubicSplineInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tTHREE.Interpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tGLTFCubicSplineInterpolant.prototype = Object.create( THREE.Interpolant.prototype );\n\tGLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant;\n\n\tGLTFCubicSplineInterpolant.prototype.copySampleValue_ = function ( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tvar result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( var i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t};\n\n\tGLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n\tGLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n\tGLTFCubicSplineInterpolant.prototype.interpolate_ = function ( i1, t0, t, t1 ) {\n\n\t\tvar result = this.resultBuffer;\n\t\tvar values = this.sampleValues;\n\t\tvar stride = this.valueSize;\n\n\t\tvar stride2 = stride * 2;\n\t\tvar stride3 = stride * 3;\n\n\t\tvar td = t1 - t0;\n\n\t\tvar p = ( t - t0 ) / td;\n\t\tvar pp = p * p;\n\t\tvar ppp = pp * p;\n\n\t\tvar offset1 = i1 * stride3;\n\t\tvar offset0 = offset1 - stride3;\n\n\t\tvar s2 = - 2 * ppp + 3 * pp;\n\t\tvar s3 = ppp - pp;\n\t\tvar s0 = 1 - s2;\n\t\tvar s1 = s3 - pp + p;\n\n\t\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\t\tfor ( var i = 0; i !== stride; i ++ ) {\n\n\t\t\tvar p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\t\tvar m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\t\tvar p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\t\tvar m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t\t}\n\n\t\treturn result;\n\n\t};\n\n\t/*********************************/\n\t/********** INTERNALS ************/\n\t/*********************************/\n\n\t/* CONSTANTS */\n\n\tvar WEBGL_CONSTANTS = {\n\t\tFLOAT: 5126,\n\t\t//FLOAT_MAT2: 35674,\n\t\tFLOAT_MAT3: 35675,\n\t\tFLOAT_MAT4: 35676,\n\t\tFLOAT_VEC2: 35664,\n\t\tFLOAT_VEC3: 35665,\n\t\tFLOAT_VEC4: 35666,\n\t\tLINEAR: 9729,\n\t\tREPEAT: 10497,\n\t\tSAMPLER_2D: 35678,\n\t\tPOINTS: 0,\n\t\tLINES: 1,\n\t\tLINE_LOOP: 2,\n\t\tLINE_STRIP: 3,\n\t\tTRIANGLES: 4,\n\t\tTRIANGLE_STRIP: 5,\n\t\tTRIANGLE_FAN: 6,\n\t\tUNSIGNED_BYTE: 5121,\n\t\tUNSIGNED_SHORT: 5123\n\t};\n\n\tvar WEBGL_TYPE = {\n\t\t5126: Number,\n\t\t//35674: THREE.Matrix2,\n\t\t35675: THREE.Matrix3,\n\t\t35676: THREE.Matrix4,\n\t\t35664: THREE.Vector2,\n\t\t35665: THREE.Vector3,\n\t\t35666: THREE.Vector4,\n\t\t35678: THREE.Texture\n\t};\n\n\tvar WEBGL_COMPONENT_TYPES = {\n\t\t5120: Int8Array,\n\t\t5121: Uint8Array,\n\t\t5122: Int16Array,\n\t\t5123: Uint16Array,\n\t\t5125: Uint32Array,\n\t\t5126: Float32Array\n\t};\n\n\tvar WEBGL_FILTERS = {\n\t\t9728: THREE.NearestFilter,\n\t\t9729: THREE.LinearFilter,\n\t\t9984: THREE.NearestMipMapNearestFilter,\n\t\t9985: THREE.LinearMipMapNearestFilter,\n\t\t9986: THREE.NearestMipMapLinearFilter,\n\t\t9987: THREE.LinearMipMapLinearFilter\n\t};\n\n\tvar WEBGL_WRAPPINGS = {\n\t\t33071: THREE.ClampToEdgeWrapping,\n\t\t33648: THREE.MirroredRepeatWrapping,\n\t\t10497: THREE.RepeatWrapping\n\t};\n\n\tvar WEBGL_SIDES = {\n\t\t1028: THREE.BackSide, // Culling front\n\t\t1029: THREE.FrontSide // Culling back\n\t\t//1032: THREE.NoSide   // Culling front and back, what to do?\n\t};\n\n\tvar WEBGL_DEPTH_FUNCS = {\n\t\t512: THREE.NeverDepth,\n\t\t513: THREE.LessDepth,\n\t\t514: THREE.EqualDepth,\n\t\t515: THREE.LessEqualDepth,\n\t\t516: THREE.GreaterEqualDepth,\n\t\t517: THREE.NotEqualDepth,\n\t\t518: THREE.GreaterEqualDepth,\n\t\t519: THREE.AlwaysDepth\n\t};\n\n\tvar WEBGL_BLEND_EQUATIONS = {\n\t\t32774: THREE.AddEquation,\n\t\t32778: THREE.SubtractEquation,\n\t\t32779: THREE.ReverseSubtractEquation\n\t};\n\n\tvar WEBGL_BLEND_FUNCS = {\n\t\t0: THREE.ZeroFactor,\n\t\t1: THREE.OneFactor,\n\t\t768: THREE.SrcColorFactor,\n\t\t769: THREE.OneMinusSrcColorFactor,\n\t\t770: THREE.SrcAlphaFactor,\n\t\t771: THREE.OneMinusSrcAlphaFactor,\n\t\t772: THREE.DstAlphaFactor,\n\t\t773: THREE.OneMinusDstAlphaFactor,\n\t\t774: THREE.DstColorFactor,\n\t\t775: THREE.OneMinusDstColorFactor,\n\t\t776: THREE.SrcAlphaSaturateFactor\n\t\t// The followings are not supported by Three.js yet\n\t\t//32769: CONSTANT_COLOR,\n\t\t//32770: ONE_MINUS_CONSTANT_COLOR,\n\t\t//32771: CONSTANT_ALPHA,\n\t\t//32772: ONE_MINUS_CONSTANT_COLOR\n\t};\n\n\tvar WEBGL_TYPE_SIZES = {\n\t\t'SCALAR': 1,\n\t\t'VEC2': 2,\n\t\t'VEC3': 3,\n\t\t'VEC4': 4,\n\t\t'MAT2': 4,\n\t\t'MAT3': 9,\n\t\t'MAT4': 16\n\t};\n\n\tvar ATTRIBUTES = {\n\t\tPOSITION: 'position',\n\t\tNORMAL: 'normal',\n\t\tTEXCOORD_0: 'uv',\n\t\tTEXCOORD_1: 'uv2',\n\t\tCOLOR_0: 'color',\n\t\tWEIGHTS_0: 'skinWeight',\n\t\tJOINTS_0: 'skinIndex',\n\t};\n\n\tvar PATH_PROPERTIES = {\n\t\tscale: 'scale',\n\t\ttranslation: 'position',\n\t\trotation: 'quaternion',\n\t\tweights: 'morphTargetInfluences'\n\t};\n\n\tvar INTERPOLATION = {\n\t\tCUBICSPLINE: THREE.InterpolateSmooth, // We use custom interpolation GLTFCubicSplineInterpolation for CUBICSPLINE.\n\t\t                                      // KeyframeTrack.optimize() can't handle glTF Cubic Spline output values layout,\n\t\t                                      // using THREE.InterpolateSmooth for KeyframeTrack instantiation to prevent optimization.\n\t\t                                      // See KeyframeTrack.optimize() for the detail.\n\t\tLINEAR: THREE.InterpolateLinear,\n\t\tSTEP: THREE.InterpolateDiscrete\n\t};\n\n\tvar STATES_ENABLES = {\n\t\t2884: 'CULL_FACE',\n\t\t2929: 'DEPTH_TEST',\n\t\t3042: 'BLEND',\n\t\t3089: 'SCISSOR_TEST',\n\t\t32823: 'POLYGON_OFFSET_FILL',\n\t\t32926: 'SAMPLE_ALPHA_TO_COVERAGE'\n\t};\n\n\tvar ALPHA_MODES = {\n\t\tOPAQUE: 'OPAQUE',\n\t\tMASK: 'MASK',\n\t\tBLEND: 'BLEND'\n\t};\n\n\tvar MIME_TYPE_FORMATS = {\n\t\t'image/png': THREE.RGBAFormat,\n\t\t'image/jpeg': THREE.RGBFormat\n\t};\n\n\t/* UTILITY FUNCTIONS */\n\n\tfunction resolveURL( url, path ) {\n\n\t\t// Invalid URL\n\t\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t\t// Absolute URL http://,https://,//\n\t\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t\t// Data URI\n\t\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t\t// Blob URL\n\t\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t\t// Relative URL\n\t\treturn path + url;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n\t */\n\tfunction createDefaultMaterial() {\n\n\t\treturn new THREE.MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: THREE.FrontSide\n\t\t} );\n\n\t}\n\n\tfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t\t// Add unknown glTF extensions to an object's userData.\n\n\t\tfor ( var name in objectDef.extensions ) {\n\n\t\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * @param {THREE.Object3D|THREE.Material|THREE.BufferGeometry} object\n\t * @param {GLTF.definition} gltfDef\n\t */\n\tfunction assignExtrasToUserData( object, gltfDef ) {\n\n\t\tif ( gltfDef.extras !== undefined ) {\n\n\t\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\t\tobject.userData = gltfDef.extras;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n\t *\n\t * @param {THREE.BufferGeometry} geometry\n\t * @param {Array<GLTF.Target>} targets\n\t * @param {GLTFParser} parser\n\t * @return {Promise<THREE.BufferGeometry>}\n\t */\n\tfunction addMorphTargets( geometry, targets, parser ) {\n\n\t\tvar hasMorphPosition = false;\n\t\tvar hasMorphNormal = false;\n\n\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tvar target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\n\t\t\tif ( hasMorphPosition && hasMorphNormal ) break;\n\n\t\t}\n\n\t\tif ( ! hasMorphPosition && ! hasMorphNormal ) return Promise.resolve( geometry );\n\n\t\tvar pendingPositionAccessors = [];\n\t\tvar pendingNormalAccessors = [];\n\n\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tvar target = targets[ i ];\n\n\t\t\tif ( hasMorphPosition ) {\n\n\t\t\t\t// TODO: Error-prone use of a callback inside a loop.\n\t\t\t\tvar accessor = target.POSITION !== undefined\n\t\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t\t\t.then( function ( accessor ) {\n\t\t\t\t\t\t\t// Cloning not to pollute original accessor below\n\t\t\t\t\t\t\treturn cloneBufferAttribute( accessor );\n\t\t\t\t\t\t} )\n\t\t\t\t\t: geometry.attributes.position;\n\n\t\t\t\tpendingPositionAccessors.push( accessor );\n\n\t\t\t}\n\n\t\t\tif ( hasMorphNormal ) {\n\n\t\t\t\t// TODO: Error-prone use of a callback inside a loop.\n\t\t\t\tvar accessor = target.NORMAL !== undefined\n\t\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t\t\t.then( function ( accessor ) {\n\t\t\t\t\t\t\treturn cloneBufferAttribute( accessor );\n\t\t\t\t\t\t} )\n\t\t\t\t\t: geometry.attributes.normal;\n\n\t\t\t\tpendingNormalAccessors.push( accessor );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( [\n\t\t\tPromise.all( pendingPositionAccessors ),\n\t\t\tPromise.all( pendingNormalAccessors )\n\t\t] ).then( function ( accessors ) {\n\n\t\t\tvar morphPositions = accessors[ 0 ];\n\t\t\tvar morphNormals = accessors[ 1 ];\n\n\t\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\t\tvar target = targets[ i ];\n\t\t\t\tvar attributeName = 'morphTarget' + i;\n\n\t\t\t\tif ( hasMorphPosition ) {\n\n\t\t\t\t\t// Three.js morph position is absolute value. The formula is\n\t\t\t\t\t//   basePosition\n\t\t\t\t\t//     + weight0 * ( morphPosition0 - basePosition )\n\t\t\t\t\t//     + weight1 * ( morphPosition1 - basePosition )\n\t\t\t\t\t//     ...\n\t\t\t\t\t// while the glTF one is relative\n\t\t\t\t\t//   basePosition\n\t\t\t\t\t//     + weight0 * glTFmorphPosition0\n\t\t\t\t\t//     + weight1 * glTFmorphPosition1\n\t\t\t\t\t//     ...\n\t\t\t\t\t// then we need to convert from relative to absolute here.\n\n\t\t\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\t\t\tvar positionAttribute = morphPositions[ i ];\n\t\t\t\t\t\tpositionAttribute.name = attributeName;\n\n\t\t\t\t\t\tvar position = geometry.attributes.position;\n\n\t\t\t\t\t\tfor ( var j = 0, jl = positionAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tpositionAttribute.setXYZ(\n\t\t\t\t\t\t\t\tj,\n\t\t\t\t\t\t\t\tpositionAttribute.getX( j ) + position.getX( j ),\n\t\t\t\t\t\t\t\tpositionAttribute.getY( j ) + position.getY( j ),\n\t\t\t\t\t\t\t\tpositionAttribute.getZ( j ) + position.getZ( j )\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasMorphNormal ) {\n\n\t\t\t\t\t// see target.POSITION's comment\n\n\t\t\t\t\tif ( target.NORMAL !== undefined ) {\n\n\t\t\t\t\t\tvar normalAttribute = morphNormals[ i ];\n\t\t\t\t\t\tnormalAttribute.name = attributeName;\n\n\t\t\t\t\t\tvar normal = geometry.attributes.normal;\n\n\t\t\t\t\t\tfor ( var j = 0, jl = normalAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tnormalAttribute.setXYZ(\n\t\t\t\t\t\t\t\tj,\n\t\t\t\t\t\t\t\tnormalAttribute.getX( j ) + normal.getX( j ),\n\t\t\t\t\t\t\t\tnormalAttribute.getY( j ) + normal.getY( j ),\n\t\t\t\t\t\t\t\tnormalAttribute.getZ( j ) + normal.getZ( j )\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\n\t\t\treturn geometry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * @param {THREE.Mesh} mesh\n\t * @param {GLTF.Mesh} meshDef\n\t */\n\tfunction updateMorphTargets( mesh, meshDef ) {\n\n\t\tmesh.updateMorphTargets();\n\n\t\tif ( meshDef.weights !== undefined ) {\n\n\t\t\tfor ( var i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\t\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\t\tvar targetNames = meshDef.extras.targetNames;\n\n\t\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\t\tfor ( var i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction isPrimitiveEqual( a, b ) {\n\n\t\tvar dracoExtA = a.extensions ? a.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] : undefined;\n\t\tvar dracoExtB = b.extensions ? b.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] : undefined;\n\n\t\tif ( dracoExtA && dracoExtB ) {\n\n\t\t\tif ( dracoExtA.bufferView !== dracoExtB.bufferView ) return false;\n\n\t\t\treturn isObjectEqual( dracoExtA.attributes, dracoExtB.attributes );\n\n\t\t}\n\n\t\tif ( a.indices !== b.indices ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn isObjectEqual( a.attributes, b.attributes );\n\n\t}\n\n\tfunction isObjectEqual( a, b ) {\n\n\t\tif ( Object.keys( a ).length !== Object.keys( b ).length ) return false;\n\n\t\tfor ( var key in a ) {\n\n\t\t\tif ( a[ key ] !== b[ key ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfunction isArrayEqual( a, b ) {\n\n\t\tif ( a.length !== b.length ) return false;\n\n\t\tfor ( var i = 0, il = a.length; i < il; i ++ ) {\n\n\t\t\tif ( a[ i ] !== b[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfunction getCachedGeometry( cache, newPrimitive ) {\n\n\t\tfor ( var i = 0, il = cache.length; i < il; i ++ ) {\n\n\t\t\tvar cached = cache[ i ];\n\n\t\t\tif ( isPrimitiveEqual( cached.primitive, newPrimitive ) ) return cached.promise;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tfunction getCachedCombinedGeometry( cache, geometries ) {\n\n\t\tfor ( var i = 0, il = cache.length; i < il; i ++ ) {\n\n\t\t\tvar cached = cache[ i ];\n\n\t\t\tif ( isArrayEqual( geometries, cached.baseGeometries ) ) return cached.geometry;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tfunction getCachedMultiPassGeometry( cache, geometry, primitives ) {\n\n\t\tfor ( var i = 0, il = cache.length; i < il; i ++ ) {\n\n\t\t\tvar cached = cache[ i ];\n\n\t\t\tif ( geometry === cached.baseGeometry && isArrayEqual( primitives, cached.primitives ) ) return cached.geometry;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tfunction cloneBufferAttribute( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tvar count = attribute.count;\n\t\t\tvar itemSize = attribute.itemSize;\n\t\t\tvar array = attribute.array.slice( 0, count * itemSize );\n\n\t\t\tfor ( var i = 0, j = 0; i < count; ++ i ) {\n\n\t\t\t\tarray[ j ++ ] = attribute.getX( i );\n\t\t\t\tif ( itemSize >= 2 ) array[ j ++ ] = attribute.getY( i );\n\t\t\t\tif ( itemSize >= 3 ) array[ j ++ ] = attribute.getZ( i );\n\t\t\t\tif ( itemSize >= 4 ) array[ j ++ ] = attribute.getW( i );\n\n\t\t\t}\n\n\t\t\treturn new THREE.BufferAttribute( array, itemSize, attribute.normalized );\n\n\t\t}\n\n\t\treturn attribute.clone();\n\n\t}\n\n\t/**\n\t * Checks if we can build a single Mesh with MultiMaterial from multiple primitives.\n\t * Returns true if all primitives use the same attributes/morphAttributes/mode\n\t * and also have index. Otherwise returns false.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Boolean}\n\t */\n\tfunction isMultiPassGeometry( primitives ) {\n\n\t\tif ( primitives.length < 2 ) return false;\n\n\t\tvar primitive0 = primitives[ 0 ];\n\t\tvar targets0 = primitive0.targets || [];\n\n\t\tif ( primitive0.indices === undefined ) return false;\n\n\t\tfor ( var i = 1, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tvar primitive = primitives[ i ];\n\n\t\t\tif ( primitive0.mode !== primitive.mode ) return false;\n\t\t\tif ( primitive.indices === undefined ) return false;\n\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) return false;\n\t\t\tif ( ! isObjectEqual( primitive0.attributes, primitive.attributes ) ) return false;\n\n\t\t\tvar targets = primitive.targets || [];\n\n\t\t\tif ( targets0.length !== targets.length ) return false;\n\n\t\t\tfor ( var j = 0, jl = targets0.length; j < jl; j ++ ) {\n\n\t\t\t\tif ( ! isObjectEqual( targets0[ j ], targets[ j ] ) ) return false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\t/* GLTF PARSER */\n\n\tfunction GLTFParser( json, extensions, options ) {\n\n\t\tthis.json = json || {};\n\t\tthis.extensions = extensions || {};\n\t\tthis.options = options || {};\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = [];\n\t\tthis.multiplePrimitivesCache = [];\n\t\tthis.multiPassGeometryCache = [];\n\n\t\tthis.textureLoader = new THREE.TextureLoader( this.options.manager );\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\n\t\tthis.fileLoader = new THREE.FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t}\n\n\tGLTFParser.prototype.parse = function ( onLoad, onError ) {\n\n\t\tvar json = this.json;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis.markDefs();\n\n\t\t// Fire the callback on complete\n\t\tthis.getMultiDependencies( [\n\n\t\t\t'scene',\n\t\t\t'animation',\n\t\t\t'camera'\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tvar scenes = dependencies.scenes || [];\n\t\t\tvar scene = scenes[ json.scene || 0 ];\n\t\t\tvar animations = dependencies.animations || [];\n\t\t\tvar cameras = dependencies.cameras || [];\n\n\t\t\tonLoad( scene, scenes, cameras, animations, json );\n\n\t\t} ).catch( onError );\n\n\t};\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\tGLTFParser.prototype.markDefs = function () {\n\n\t\tvar nodeDefs = this.json.nodes || [];\n\t\tvar skinDefs = this.json.skins || [];\n\t\tvar meshDefs = this.json.meshes || [];\n\n\t\tvar meshReferences = {};\n\t\tvar meshUses = {};\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( var skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tvar joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( var i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Meshes can (and should) be reused by multiple nodes in a glTF asset. To\n\t\t// avoid having more than one THREE.Mesh with the same name, count\n\t\t// references and rename instances below.\n\t\t//\n\t\t// Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t\tfor ( var nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tvar nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tif ( meshReferences[ nodeDef.mesh ] === undefined ) {\n\n\t\t\t\t\tmeshReferences[ nodeDef.mesh ] = meshUses[ nodeDef.mesh ] = 0;\n\n\t\t\t\t}\n\n\t\t\t\tmeshReferences[ nodeDef.mesh ] ++;\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.json.meshReferences = meshReferences;\n\t\tthis.json.meshUses = meshUses;\n\n\t};\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<THREE.Object3D|THREE.Material|THREE.Texture|THREE.AnimationClip|ArrayBuffer|Object>}\n\t */\n\tGLTFParser.prototype.getDependency = function ( type, index ) {\n\n\t\tvar cacheKey = type + ':' + index;\n\t\tvar dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this.loadNode( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this.loadMesh( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this.loadBufferView( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this.loadMaterial( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this.loadTexture( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this.loadAnimation( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'light':\n\t\t\t\t\tdependency = this.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].loadLight( index );\n\t\t\t\t\tbreak\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t};\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tGLTFParser.prototype.getDependencies = function ( type ) {\n\n\t\tvar dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tvar parser = this;\n\t\t\tvar defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t};\n\n\t/**\n\t * Requests all multiple dependencies of the specified types asynchronously, with caching.\n\t * @param {Array<string>} types\n\t * @return {Promise<Object<Array<Object>>>}\n\t */\n\tGLTFParser.prototype.getMultiDependencies = function ( types ) {\n\n\t\tvar results = {};\n\t\tvar pending = [];\n\n\t\tfor ( var i = 0, il = types.length; i < il; i ++ ) {\n\n\t\t\tvar type = types[ i ];\n\t\t\tvar value = this.getDependencies( type );\n\n\t\t\t// TODO: Error-prone use of a callback inside a loop.\n\t\t\tvalue = value.then( function ( key, value ) {\n\n\t\t\t\tresults[ key ] = value;\n\n\t\t\t}.bind( this, type + ( type === 'mesh' ? 'es' : 's' ) ) );\n\n\t\t\tpending.push( value );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\treturn results;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tGLTFParser.prototype.loadBuffer = function ( bufferIndex ) {\n\n\t\tvar bufferDef = this.json.buffers[ bufferIndex ];\n\t\tvar loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tvar options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tGLTFParser.prototype.loadBufferView = function ( bufferViewIndex ) {\n\n\t\tvar bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tvar byteLength = bufferViewDef.byteLength || 0;\n\t\t\tvar byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<THREE.BufferAttribute|THREE.InterleavedBufferAttribute>}\n\t */\n\tGLTFParser.prototype.loadAccessor = function ( accessorIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\n\t\tvar accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\t// Ignore empty accessors, which may be used to declare runtime\n\t\t\t// information about attributes coming from another source (e.g. Draco\n\t\t\t// compression extension).\n\t\t\treturn Promise.resolve( null );\n\n\t\t}\n\n\t\tvar pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tvar bufferView = bufferViews[ 0 ];\n\n\t\t\tvar itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tvar TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tvar elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tvar itemBytes = elementBytes * itemSize;\n\t\t\tvar byteOffset = accessorDef.byteOffset || 0;\n\t\t\tvar byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tvar normalized = accessorDef.normalized === true;\n\t\t\tvar array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\tvar ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType;\n\t\t\t\tvar ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\t// Use the full buffer if it's interleaved.\n\t\t\t\t\tarray = new TypedArray( bufferView );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new THREE.InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new THREE.InterleavedBufferAttribute( ib, itemSize, byteOffset / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new THREE.BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tvar itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tvar TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tvar byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tvar byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tvar sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tvar sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute.setArray( bufferAttribute.array.slice() );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture>}\n\t */\n\tGLTFParser.prototype.loadTexture = function ( textureIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar options = this.options;\n\t\tvar textureLoader = this.textureLoader;\n\n\t\tvar URL = window.URL || window.webkitURL;\n\n\t\tvar textureDef = json.textures[ textureIndex ];\n\n\t\tvar textureExtensions = textureDef.extensions || {};\n\n\t\tvar source;\n\n\t\tif ( textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ] ) {\n\n\t\t\tsource = json.images[ textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].source ];\n\n\t\t} else {\n\n\t\t\tsource = json.images[ textureDef.source ];\n\n\t\t}\n\n\t\tvar sourceURI = source.uri;\n\t\tvar isObjectURL = false;\n\n\t\tif ( source.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', source.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tvar blob = new Blob( [ bufferView ], { type: source.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\t// Load Texture resource.\n\n\t\t\tvar loader = THREE.Loader.Handlers.get( sourceURI );\n\n\t\t\tif ( ! loader ) {\n\n\t\t\t\tloader = textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ]\n\t\t\t\t\t? parser.extensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].ddsLoader\n\t\t\t\t\t: textureLoader;\n\n\t\t\t}\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tloader.load( resolveURL( sourceURI, options.path ), resolve, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\ttexture.flipY = false;\n\n\t\t\tif ( textureDef.name !== undefined ) texture.name = textureDef.name;\n\n\t\t\t// Ignore unknown mime types, like DDS files.\n\t\t\tif ( source.mimeType in MIME_TYPE_FORMATS ) {\n\n\t\t\t\ttexture.format = MIME_TYPE_FORMATS[ source.mimeType ];\n\n\t\t\t}\n\n\t\t\tvar samplers = json.samplers || {};\n\t\t\tvar sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || THREE.LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || THREE.LinearMipMapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || THREE.RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || THREE.RepeatWrapping;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise}\n\t */\n\tGLTFParser.prototype.assignTexture = function ( materialParams, mapName, mapDef ) {\n\n\t\tvar parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tvar transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<THREE.Material>}\n\t */\n\tGLTFParser.prototype.loadMaterial = function ( materialIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\t\tvar materialDef = json.materials[ materialIndex ];\n\n\t\tvar materialType;\n\t\tvar materialParams = {};\n\t\tvar materialExtensions = materialDef.extensions || {};\n\n\t\tvar pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ] ) {\n\n\t\t\tvar sgExtension = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ];\n\t\t\tmaterialType = sgExtension.getMaterialType( materialDef );\n\t\t\tpending.push( sgExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else if ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tvar kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType( materialDef );\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tmaterialType = THREE.MeshStandardMaterial;\n\n\t\t\tvar metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new THREE.Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tvar array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = THREE.DoubleSide;\n\n\t\t}\n\n\t\tvar alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new THREE.Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tmaterialParams.normalScale.set( materialDef.normalTexture.scale, materialDef.normalTexture.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tmaterialParams.emissive = new THREE.Color().fromArray( materialDef.emissiveFactor );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== THREE.MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tvar material;\n\n\t\t\tif ( materialType === THREE.ShaderMaterial ) {\n\n\t\t\t\tmaterial = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].createMaterial( materialParams );\n\n\t\t\t} else {\n\n\t\t\t\tmaterial = new materialType( materialParams );\n\n\t\t\t}\n\n\t\t\tif ( materialDef.name !== undefined ) material.name = materialDef.name;\n\n\t\t\t// Normal map textures use OpenGL conventions:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#materialnormaltexture\n\t\t\tif ( material.normalScale ) {\n\n\t\t\t\tmaterial.normalScale.y = - material.normalScale.y;\n\n\t\t\t}\n\n\t\t\t// baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n\t\t\tif ( material.map ) material.map.encoding = THREE.sRGBEncoding;\n\t\t\tif ( material.emissiveMap ) material.emissiveMap.encoding = THREE.sRGBEncoding;\n\t\t\tif ( material.specularMap ) material.specularMap.encoding = THREE.sRGBEncoding;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * @param {THREE.BufferGeometry} geometry\n\t * @param {GLTF.Primitive} primitiveDef\n\t * @param {GLTFParser} parser\n\t * @return {Promise<THREE.BufferGeometry>}\n\t */\n\tfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\t\tvar attributes = primitiveDef.attributes;\n\n\t\tvar pending = [];\n\n\t\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t\t.then( function ( accessor ) {\n\n\t\t\t\t\tgeometry.addAttribute( attributeName, accessor );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tfor ( var gltfAttributeName in attributes ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ gltfAttributeName ];\n\n\t\t\tif ( ! threeAttributeName ) continue;\n\n\t\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t\t}\n\n\t\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\t\tvar accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\t\tgeometry.setIndex( accessor );\n\n\t\t\t} );\n\n\t\t\tpending.push( accessor );\n\n\t\t}\n\n\t\tassignExtrasToUserData( geometry, primitiveDef );\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\treturn primitiveDef.targets !== undefined\n\t\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t\t: geometry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t * If we can build a single BufferGeometry with .groups from multiple primitives, returns one BufferGeometry.\n\t * Otherwise, returns BufferGeometries without .groups as many as primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<THREE.BufferGeometry>>}\n\t */\n\tGLTFParser.prototype.loadGeometries = function ( primitives ) {\n\n\t\tvar parser = this;\n\t\tvar extensions = this.extensions;\n\t\tvar cache = this.primitiveCache;\n\n\t\tvar isMultiPass = isMultiPassGeometry( primitives );\n\t\tvar originalPrimitives;\n\n\t\tif ( isMultiPass ) {\n\n\t\t\toriginalPrimitives = primitives; // save original primitives and use later\n\n\t\t\t// We build a single BufferGeometry with .groups from multiple primitives\n\t\t\t// because all primitives share the same attributes/morph/mode and have indices.\n\n\t\t\tprimitives = [ primitives[ 0 ] ];\n\n\t\t\t// Sets .groups and combined indices to a geometry later in this method.\n\n\t\t}\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tvar pending = [];\n\n\t\tfor ( var i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tvar primitive = primitives[ i ];\n\n\t\t\t// See if we've already created this geometry\n\t\t\tvar cached = getCachedGeometry( cache, primitive );\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached );\n\n\t\t\t} else {\n\n\t\t\t\tvar geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new THREE.BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache.push( { primitive: primitive, promise: geometryPromise } );\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( geometries ) {\n\n\t\t\tif ( isMultiPass ) {\n\n\t\t\t\tvar baseGeometry = geometries[ 0 ];\n\n\t\t\t\t// See if we've already created this combined geometry\n\t\t\t\tvar cache = parser.multiPassGeometryCache;\n\t\t\t\tvar cached = getCachedMultiPassGeometry( cache, baseGeometry, originalPrimitives );\n\n\t\t\t\tif ( cached !== null ) return [ cached.geometry ];\n\n\t\t\t\t// Cloning geometry because of index override.\n\t\t\t\t// Attributes can be reused so cloning by myself here.\n\t\t\t\tvar geometry = new THREE.BufferGeometry();\n\n\t\t\t\tgeometry.name = baseGeometry.name;\n\t\t\t\tgeometry.userData = baseGeometry.userData;\n\n\t\t\t\tfor ( var key in baseGeometry.attributes ) geometry.addAttribute( key, baseGeometry.attributes[ key ] );\n\t\t\t\tfor ( var key in baseGeometry.morphAttributes ) geometry.morphAttributes[ key ] = baseGeometry.morphAttributes[ key ];\n\n\t\t\t\tvar pendingIndices = [];\n\n\t\t\t\tfor ( var i = 0, il = originalPrimitives.length; i < il; i ++ ) {\n\n\t\t\t\t\tpendingIndices.push( parser.getDependency( 'accessor', originalPrimitives[ i ].indices ) );\n\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all( pendingIndices ).then( function ( accessors ) {\n\n\t\t\t\t\tvar indices = [];\n\t\t\t\t\tvar offset = 0;\n\n\t\t\t\t\tfor ( var i = 0, il = originalPrimitives.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar accessor = accessors[ i ];\n\n\t\t\t\t\t\tfor ( var j = 0, jl = accessor.count; j < jl; j ++ ) indices.push( accessor.array[ j ] );\n\n\t\t\t\t\t\tgeometry.addGroup( offset, accessor.count, i );\n\n\t\t\t\t\t\toffset += accessor.count;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tgeometry.setIndex( indices );\n\n\t\t\t\t\tcache.push( { geometry: geometry, baseGeometry: baseGeometry, primitives: originalPrimitives } );\n\n\t\t\t\t\treturn [ geometry ];\n\n\t\t\t\t} );\n\n\t\t\t} else if ( geometries.length > 1 && THREE.BufferGeometryUtils !== undefined ) {\n\n\t\t\t\t// Tries to merge geometries with BufferGeometryUtils if possible\n\n\t\t\t\tfor ( var i = 1, il = primitives.length; i < il; i ++ ) {\n\n\t\t\t\t\t// can't merge if draw mode is different\n\t\t\t\t\tif ( primitives[ 0 ].mode !== primitives[ i ].mode ) return geometries;\n\n\t\t\t\t}\n\n\t\t\t\t// See if we've already created this combined geometry\n\t\t\t\tvar cache = parser.multiplePrimitivesCache;\n\t\t\t\tvar cached = getCachedCombinedGeometry( cache, geometries );\n\n\t\t\t\tif ( cached ) {\n\n\t\t\t\t\tif ( cached.geometry !== null ) return [ cached.geometry ];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvar geometry = THREE.BufferGeometryUtils.mergeBufferGeometries( geometries, true );\n\n\t\t\t\t\tcache.push( { geometry: geometry, baseGeometries: geometries } );\n\n\t\t\t\t\tif ( geometry !== null ) return [ geometry ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn geometries;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<THREE.Group|THREE.Mesh|THREE.SkinnedMesh>}\n\t */\n\tGLTFParser.prototype.loadMesh = function ( meshIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\n\t\tvar meshDef = json.meshes[ meshIndex ];\n\t\tvar primitives = meshDef.primitives;\n\n\t\tvar pending = [];\n\n\t\tfor ( var i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tvar material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial()\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( originalMaterials ) {\n\n\t\t\treturn parser.loadGeometries( primitives ).then( function ( geometries ) {\n\n\t\t\t\tvar isMultiMaterial = geometries.length === 1 && geometries[ 0 ].groups.length > 0;\n\n\t\t\t\tvar meshes = [];\n\n\t\t\t\tfor ( var i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar geometry = geometries[ i ];\n\t\t\t\t\tvar primitive = primitives[ i ];\n\n\t\t\t\t\t// 1. create Mesh\n\n\t\t\t\t\tvar mesh;\n\n\t\t\t\t\tvar material = isMultiMaterial ? originalMaterials : originalMaterials[ i ];\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See .markDefs()\n\t\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t\t? new THREE.SkinnedMesh( geometry, material )\n\t\t\t\t\t\t\t: new THREE.Mesh( geometry, material );\n\n\t\t\t\t\t\tif ( mesh.isSkinnedMesh === true ) mesh.normalizeSkinWeights(); // #15319\n\n\t\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\t\tmesh.drawMode = THREE.TriangleStripDrawMode;\n\n\t\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\t\tmesh.drawMode = THREE.TriangleFanDrawMode;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\t\tmesh = new THREE.LineSegments( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\t\tmesh = new THREE.Line( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\t\tmesh = new THREE.LineLoop( geometry, material );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\t\tmesh = new THREE.Points( geometry, material );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmesh.name = meshDef.name || ( 'mesh_' + meshIndex );\n\n\t\t\t\t\tif ( geometries.length > 1 ) mesh.name += '_' + i;\n\n\t\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\t\tmeshes.push( mesh );\n\n\t\t\t\t\t// 2. update Material depending on Mesh and BufferGeometry\n\n\t\t\t\t\tvar materials = isMultiMaterial ? mesh.material : [ mesh.material ];\n\n\t\t\t\t\tvar useVertexColors = geometry.attributes.color !== undefined;\n\t\t\t\t\tvar useFlatShading = geometry.attributes.normal === undefined;\n\t\t\t\t\tvar useSkinning = mesh.isSkinnedMesh === true;\n\t\t\t\t\tvar useMorphTargets = Object.keys( geometry.morphAttributes ).length > 0;\n\t\t\t\t\tvar useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;\n\n\t\t\t\t\tfor ( var j = 0, jl = materials.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tvar material = materials[ j ];\n\n\t\t\t\t\t\tif ( mesh.isPoints ) {\n\n\t\t\t\t\t\t\tvar cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\t\t\t\t\tvar pointsMaterial = parser.cache.get( cacheKey );\n\n\t\t\t\t\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\t\t\t\t\tpointsMaterial = new THREE.PointsMaterial();\n\t\t\t\t\t\t\t\tTHREE.Material.prototype.copy.call( pointsMaterial, material );\n\t\t\t\t\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\t\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\t\t\t\t\tpointsMaterial.lights = false; // PointsMaterial doesn't support lights yet\n\n\t\t\t\t\t\t\t\tparser.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tmaterial = pointsMaterial;\n\n\t\t\t\t\t\t} else if ( mesh.isLine ) {\n\n\t\t\t\t\t\t\tvar cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\t\t\t\t\tvar lineMaterial = parser.cache.get( cacheKey );\n\n\t\t\t\t\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\t\t\t\t\tlineMaterial = new THREE.LineBasicMaterial();\n\t\t\t\t\t\t\t\tTHREE.Material.prototype.copy.call( lineMaterial, material );\n\t\t\t\t\t\t\t\tlineMaterial.color.copy( material.color );\n\t\t\t\t\t\t\t\tlineMaterial.lights = false; // LineBasicMaterial doesn't support lights yet\n\n\t\t\t\t\t\t\t\tparser.cache.add( cacheKey, lineMaterial );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tmaterial = lineMaterial;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Clone the material if it will be modified\n\t\t\t\t\t\tif ( useVertexColors || useFlatShading || useSkinning || useMorphTargets ) {\n\n\t\t\t\t\t\t\tvar cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\t\t\t\t\tif ( material.isGLTFSpecularGlossinessMaterial ) cacheKey += 'specular-glossiness:';\n\t\t\t\t\t\t\tif ( useSkinning ) cacheKey += 'skinning:';\n\t\t\t\t\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\t\t\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\t\t\t\t\t\t\tif ( useMorphTargets ) cacheKey += 'morph-targets:';\n\t\t\t\t\t\t\tif ( useMorphNormals ) cacheKey += 'morph-normals:';\n\n\t\t\t\t\t\t\tvar cachedMaterial = parser.cache.get( cacheKey );\n\n\t\t\t\t\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\t\t\t\t\tcachedMaterial = material.isGLTFSpecularGlossinessMaterial\n\t\t\t\t\t\t\t\t\t? extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].cloneMaterial( material )\n\t\t\t\t\t\t\t\t\t: material.clone();\n\n\t\t\t\t\t\t\t\tif ( useSkinning ) cachedMaterial.skinning = true;\n\t\t\t\t\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = THREE.VertexColors;\n\t\t\t\t\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\t\t\t\t\t\t\t\tif ( useMorphTargets ) cachedMaterial.morphTargets = true;\n\t\t\t\t\t\t\t\tif ( useMorphNormals ) cachedMaterial.morphNormals = true;\n\n\t\t\t\t\t\t\t\tparser.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tmaterial = cachedMaterial;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmaterials[ j ] = material;\n\n\t\t\t\t\t\t// workarounds for mesh and geometry\n\n\t\t\t\t\t\tif ( material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined ) {\n\n\t\t\t\t\t\t\tconsole.log( 'THREE.GLTFLoader: Duplicating UVs to support aoMap.' );\n\t\t\t\t\t\t\tgeometry.addAttribute( 'uv2', new THREE.BufferAttribute( geometry.attributes.uv.array, 2 ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( material.isGLTFSpecularGlossinessMaterial ) {\n\n\t\t\t\t\t\t\t// for GLTFSpecularGlossinessMaterial(ShaderMaterial) uniforms runtime update\n\t\t\t\t\t\t\tmesh.onBeforeRender = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].refreshUniforms;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmesh.material = isMultiMaterial ? materials : materials[ 0 ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t\t}\n\n\t\t\t\tvar group = new THREE.Group();\n\n\t\t\t\tfor ( var i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\treturn group;\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tGLTFParser.prototype.loadCamera = function ( cameraIndex ) {\n\n\t\tvar camera;\n\t\tvar cameraDef = this.json.cameras[ cameraIndex ];\n\t\tvar params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new THREE.PerspectiveCamera( THREE.Math.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new THREE.OrthographicCamera( params.xmag / - 2, params.xmag / 2, params.ymag / 2, params.ymag / - 2, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name !== undefined ) camera.name = cameraDef.name;\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Object>}\n\t */\n\tGLTFParser.prototype.loadSkin = function ( skinIndex ) {\n\n\t\tvar skinDef = this.json.skins[ skinIndex ];\n\n\t\tvar skinEntry = { joints: skinDef.joints };\n\n\t\tif ( skinDef.inverseBindMatrices === undefined ) {\n\n\t\t\treturn Promise.resolve( skinEntry );\n\n\t\t}\n\n\t\treturn this.getDependency( 'accessor', skinDef.inverseBindMatrices ).then( function ( accessor ) {\n\n\t\t\tskinEntry.inverseBindMatrices = accessor;\n\n\t\t\treturn skinEntry;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<THREE.AnimationClip>}\n\t */\n\tGLTFParser.prototype.loadAnimation = function ( animationIndex ) {\n\n\t\tvar json = this.json;\n\n\t\tvar animationDef = json.animations[ animationIndex ];\n\n\t\tvar pendingNodes = [];\n\t\tvar pendingInputAccessors = [];\n\t\tvar pendingOutputAccessors = [];\n\t\tvar pendingSamplers = [];\n\t\tvar pendingTargets = [];\n\n\t\tfor ( var i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tvar channel = animationDef.channels[ i ];\n\t\t\tvar sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tvar target = channel.target;\n\t\t\tvar name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n\t\t\tvar input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tvar output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tvar nodes = dependencies[ 0 ];\n\t\t\tvar inputAccessors = dependencies[ 1 ];\n\t\t\tvar outputAccessors = dependencies[ 2 ];\n\t\t\tvar samplers = dependencies[ 3 ];\n\t\t\tvar targets = dependencies[ 4 ];\n\n\t\t\tvar tracks = [];\n\n\t\t\tfor ( var i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tvar node = nodes[ i ];\n\t\t\t\tvar inputAccessor = inputAccessors[ i ];\n\t\t\t\tvar outputAccessor = outputAccessors[ i ];\n\t\t\t\tvar sampler = samplers[ i ];\n\t\t\t\tvar target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tnode.updateMatrix();\n\t\t\t\tnode.matrixAutoUpdate = true;\n\n\t\t\t\tvar TypedKeyframeTrack;\n\n\t\t\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.QuaternionKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.position:\n\t\t\t\t\tcase PATH_PROPERTIES.scale:\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tTypedKeyframeTrack = THREE.VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tvar targetName = node.name ? node.name : node.uuid;\n\n\t\t\t\tvar interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : THREE.InterpolateLinear;\n\n\t\t\t\tvar targetNames = [];\n\n\t\t\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\t\t\t// node can be THREE.Group here but\n\t\t\t\t\t// PATH_PROPERTIES.weights(morphTargetInfluences) should be\n\t\t\t\t\t// the property of a mesh object under group.\n\n\t\t\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\t\t\tif ( object.isMesh === true && object.morphTargetInfluences ) {\n\n\t\t\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttargetNames.push( targetName );\n\n\t\t\t\t}\n\n\t\t\t\t// KeyframeTrack.optimize() will modify given 'times' and 'values'\n\t\t\t\t// buffers before creating a truncated copy to keep. Because buffers may\n\t\t\t\t// be reused by other tracks, make copies here.\n\t\t\t\tfor ( var j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\t\t\tvar track = new TypedKeyframeTrack(\n\t\t\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\t\t\tTHREE.AnimationUtils.arraySlice( inputAccessor.array, 0 ),\n\t\t\t\t\t\tTHREE.AnimationUtils.arraySlice( outputAccessor.array, 0 ),\n\t\t\t\t\t\tinterpolation\n\t\t\t\t\t);\n\n\t\t\t\t\t// Here is the trick to enable custom interpolation.\n\t\t\t\t\t// Overrides .createInterpolant in a factory method which creates custom interpolation.\n\t\t\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\t\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t\t\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t\t\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t\t\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\t\t\t\t\treturn new GLTFCubicSplineInterpolant( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// Workaround, provide an alternate way to know if the interpolant type is cubis spline to track.\n\t\t\t\t\t\t// track.getInterpolation() doesn't return valid value for custom interpolant.\n\t\t\t\t\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( track );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar name = animationDef.name !== undefined ? animationDef.name : 'animation_' + animationIndex;\n\n\t\t\treturn new THREE.AnimationClip( name, undefined, tracks );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<THREE.Object3D>}\n\t */\n\tGLTFParser.prototype.loadNode = function ( nodeIndex ) {\n\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\t\tvar parser = this;\n\n\t\tvar meshReferences = json.meshReferences;\n\t\tvar meshUses = json.meshUses;\n\n\t\tvar nodeDef = json.nodes[ nodeIndex ];\n\n\t\treturn ( function() {\n\n\t\t\t// .isBone isn't in glTF spec. See .markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\treturn Promise.resolve( new THREE.Bone() );\n\n\t\t\t} else if ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\t\t\tvar node;\n\n\t\t\t\t\tif ( meshReferences[ nodeDef.mesh ] > 1 ) {\n\n\t\t\t\t\t\tvar instanceNum = meshUses[ nodeDef.mesh ] ++;\n\n\t\t\t\t\t\tnode = mesh.clone();\n\t\t\t\t\t\tnode.name += '_instance_' + instanceNum;\n\n\t\t\t\t\t\t// onBeforeRender copy for Specular-Glossiness\n\t\t\t\t\t\tnode.onBeforeRender = mesh.onBeforeRender;\n\n\t\t\t\t\t\tfor ( var i = 0, il = node.children.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\tnode.children[ i ].name += '_instance_' + instanceNum;\n\t\t\t\t\t\t\tnode.children[ i ].onBeforeRender = mesh.children[ i ].onBeforeRender;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnode = mesh;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\t\t\tfor ( var i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn node;\n\n\t\t\t\t} );\n\n\t\t\t} else if ( nodeDef.camera !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'camera', nodeDef.camera );\n\n\t\t\t} else if ( nodeDef.extensions\n\t\t\t\t&& nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ]\n\t\t\t\t&& nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light !== undefined ) {\n\n\t\t\t\treturn parser.getDependency( 'light', nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light );\n\n\t\t\t} else {\n\n\t\t\t\treturn Promise.resolve( new THREE.Object3D() );\n\n\t\t\t}\n\n\t\t}() ).then( function ( node ) {\n\n\t\t\tif ( nodeDef.name !== undefined ) {\n\n\t\t\t\tnode.name = THREE.PropertyBinding.sanitizeNodeName( nodeDef.name );\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tvar matrix = new THREE.Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<THREE.Scene>}\n\t */\n\tGLTFParser.prototype.loadScene = function () {\n\n\t\t// scene node hierachy builder\n\n\t\tfunction buildNodeHierachy( nodeId, parentObject, json, parser ) {\n\n\t\t\tvar nodeDef = json.nodes[ nodeId ];\n\n\t\t\treturn parser.getDependency( 'node', nodeId ).then( function ( node ) {\n\n\t\t\t\tif ( nodeDef.skin === undefined ) return node;\n\n\t\t\t\t// build skeleton here as well\n\n\t\t\t\tvar skinEntry;\n\n\t\t\t\treturn parser.getDependency( 'skin', nodeDef.skin ).then( function ( skin ) {\n\n\t\t\t\t\tskinEntry = skin;\n\n\t\t\t\t\tvar pendingJoints = [];\n\n\t\t\t\t\tfor ( var i = 0, il = skinEntry.joints.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tpendingJoints.push( parser.getDependency( 'node', skinEntry.joints[ i ] ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Promise.all( pendingJoints );\n\n\t\t\t\t} ).then( function ( jointNodes ) {\n\n\t\t\t\t\tvar meshes = node.isGroup === true ? node.children : [ node ];\n\n\t\t\t\t\tfor ( var i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar mesh = meshes[ i ];\n\n\t\t\t\t\t\tvar bones = [];\n\t\t\t\t\t\tvar boneInverses = [];\n\n\t\t\t\t\t\tfor ( var j = 0, jl = jointNodes.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tvar jointNode = jointNodes[ j ];\n\n\t\t\t\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\t\t\t\tvar mat = new THREE.Matrix4();\n\n\t\t\t\t\t\t\t\tif ( skinEntry.inverseBindMatrices !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tmat.fromArray( skinEntry.inverseBindMatrices.array, j * 16 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinEntry.joints[ j ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmesh.bind( new THREE.Skeleton( bones, boneInverses ), mesh.matrixWorld );\n\n\t\t\t\t\t};\n\n\t\t\t\t\treturn node;\n\n\t\t\t\t} );\n\n\t\t\t} ).then( function ( node ) {\n\n\t\t\t\t// build node hierachy\n\n\t\t\t\tparentObject.add( node );\n\n\t\t\t\tvar pending = [];\n\n\t\t\t\tif ( nodeDef.children ) {\n\n\t\t\t\t\tvar children = nodeDef.children;\n\n\t\t\t\t\tfor ( var i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar child = children[ i ];\n\t\t\t\t\t\tpending.push( buildNodeHierachy( child, node, json, parser ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all( pending );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn function loadScene( sceneIndex ) {\n\n\t\t\tvar json = this.json;\n\t\t\tvar extensions = this.extensions;\n\t\t\tvar sceneDef = this.json.scenes[ sceneIndex ];\n\t\t\tvar parser = this;\n\n\t\t\tvar scene = new THREE.Scene();\n\t\t\tif ( sceneDef.name !== undefined ) scene.name = sceneDef.name;\n\n\t\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\t\tvar nodeIds = sceneDef.nodes || [];\n\n\t\t\tvar pending = [];\n\n\t\t\tfor ( var i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\t\tpending.push( buildNodeHierachy( nodeIds[ i ], scene, json, parser ) );\n\n\t\t\t}\n\n\t\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\t\treturn scene;\n\n\t\t\t} );\n\n\t\t};\n\n\t}();\n\n\treturn GLTFLoader;\n\n} )();\n","/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.OBJLoader = ( function () {\n\n\t// o object_name | g group_name\n\tvar object_pattern = /^[og]\\s*(.+)?/;\n\t// mtllib file_reference\n\tvar material_library_pattern = /^mtllib /;\n\t// usemtl material_name\n\tvar material_use_pattern = /^usemtl /;\n\n\tfunction ParserState() {\n\n\t\tvar state = {\n\t\t\tobjects: [],\n\t\t\tobject: {},\n\n\t\t\tvertices: [],\n\t\t\tnormals: [],\n\t\t\tcolors: [],\n\t\t\tuvs: [],\n\n\t\t\tmaterialLibraries: [],\n\n\t\t\tstartObject: function ( name, fromDeclaration ) {\n\n\t\t\t\t// If the current object (initial from reset) is not from a g/o declaration in the parsed\n\t\t\t\t// file. We need to use it for the first parsed g/o to keep things in sync.\n\t\t\t\tif ( this.object && this.object.fromDeclaration === false ) {\n\n\t\t\t\t\tthis.object.name = name;\n\t\t\t\t\tthis.object.fromDeclaration = ( fromDeclaration !== false );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tvar previousMaterial = ( this.object && typeof this.object.currentMaterial === 'function' ? this.object.currentMaterial() : undefined );\n\n\t\t\t\tif ( this.object && typeof this.object._finalize === 'function' ) {\n\n\t\t\t\t\tthis.object._finalize( true );\n\n\t\t\t\t}\n\n\t\t\t\tthis.object = {\n\t\t\t\t\tname: name || '',\n\t\t\t\t\tfromDeclaration: ( fromDeclaration !== false ),\n\n\t\t\t\t\tgeometry: {\n\t\t\t\t\t\tvertices: [],\n\t\t\t\t\t\tnormals: [],\n\t\t\t\t\t\tcolors: [],\n\t\t\t\t\t\tuvs: []\n\t\t\t\t\t},\n\t\t\t\t\tmaterials: [],\n\t\t\t\t\tsmooth: true,\n\n\t\t\t\t\tstartMaterial: function ( name, libraries ) {\n\n\t\t\t\t\t\tvar previous = this._finalize( false );\n\n\t\t\t\t\t\t// New usemtl declaration overwrites an inherited material, except if faces were declared\n\t\t\t\t\t\t// after the material, then it must be preserved for proper MultiMaterial continuation.\n\t\t\t\t\t\tif ( previous && ( previous.inherited || previous.groupCount <= 0 ) ) {\n\n\t\t\t\t\t\t\tthis.materials.splice( previous.index, 1 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar material = {\n\t\t\t\t\t\t\tindex: this.materials.length,\n\t\t\t\t\t\t\tname: name || '',\n\t\t\t\t\t\t\tmtllib: ( Array.isArray( libraries ) && libraries.length > 0 ? libraries[ libraries.length - 1 ] : '' ),\n\t\t\t\t\t\t\tsmooth: ( previous !== undefined ? previous.smooth : this.smooth ),\n\t\t\t\t\t\t\tgroupStart: ( previous !== undefined ? previous.groupEnd : 0 ),\n\t\t\t\t\t\t\tgroupEnd: - 1,\n\t\t\t\t\t\t\tgroupCount: - 1,\n\t\t\t\t\t\t\tinherited: false,\n\n\t\t\t\t\t\t\tclone: function ( index ) {\n\n\t\t\t\t\t\t\t\tvar cloned = {\n\t\t\t\t\t\t\t\t\tindex: ( typeof index === 'number' ? index : this.index ),\n\t\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\t\tmtllib: this.mtllib,\n\t\t\t\t\t\t\t\t\tsmooth: this.smooth,\n\t\t\t\t\t\t\t\t\tgroupStart: 0,\n\t\t\t\t\t\t\t\t\tgroupEnd: - 1,\n\t\t\t\t\t\t\t\t\tgroupCount: - 1,\n\t\t\t\t\t\t\t\t\tinherited: false\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tcloned.clone = this.clone.bind( cloned );\n\t\t\t\t\t\t\t\treturn cloned;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tthis.materials.push( material );\n\n\t\t\t\t\t\treturn material;\n\n\t\t\t\t\t},\n\n\t\t\t\t\tcurrentMaterial: function () {\n\n\t\t\t\t\t\tif ( this.materials.length > 0 ) {\n\n\t\t\t\t\t\t\treturn this.materials[ this.materials.length - 1 ];\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn undefined;\n\n\t\t\t\t\t},\n\n\t\t\t\t\t_finalize: function ( end ) {\n\n\t\t\t\t\t\tvar lastMultiMaterial = this.currentMaterial();\n\t\t\t\t\t\tif ( lastMultiMaterial && lastMultiMaterial.groupEnd === - 1 ) {\n\n\t\t\t\t\t\t\tlastMultiMaterial.groupEnd = this.geometry.vertices.length / 3;\n\t\t\t\t\t\t\tlastMultiMaterial.groupCount = lastMultiMaterial.groupEnd - lastMultiMaterial.groupStart;\n\t\t\t\t\t\t\tlastMultiMaterial.inherited = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Ignore objects tail materials if no face declarations followed them before a new o/g started.\n\t\t\t\t\t\tif ( end && this.materials.length > 1 ) {\n\n\t\t\t\t\t\t\tfor ( var mi = this.materials.length - 1; mi >= 0; mi -- ) {\n\n\t\t\t\t\t\t\t\tif ( this.materials[ mi ].groupCount <= 0 ) {\n\n\t\t\t\t\t\t\t\t\tthis.materials.splice( mi, 1 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Guarantee at least one empty material, this makes the creation later more straight forward.\n\t\t\t\t\t\tif ( end && this.materials.length === 0 ) {\n\n\t\t\t\t\t\t\tthis.materials.push( {\n\t\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\t\tsmooth: this.smooth\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn lastMultiMaterial;\n\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t// Inherit previous objects material.\n\t\t\t\t// Spec tells us that a declared material must be set to all objects until a new material is declared.\n\t\t\t\t// If a usemtl declaration is encountered while this new object is being parsed, it will\n\t\t\t\t// overwrite the inherited material. Exception being that there was already face declarations\n\t\t\t\t// to the inherited material, then it will be preserved for proper MultiMaterial continuation.\n\n\t\t\t\tif ( previousMaterial && previousMaterial.name && typeof previousMaterial.clone === 'function' ) {\n\n\t\t\t\t\tvar declared = previousMaterial.clone( 0 );\n\t\t\t\t\tdeclared.inherited = true;\n\t\t\t\t\tthis.object.materials.push( declared );\n\n\t\t\t\t}\n\n\t\t\t\tthis.objects.push( this.object );\n\n\t\t\t},\n\n\t\t\tfinalize: function () {\n\n\t\t\t\tif ( this.object && typeof this.object._finalize === 'function' ) {\n\n\t\t\t\t\tthis.object._finalize( true );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tparseVertexIndex: function ( value, len ) {\n\n\t\t\t\tvar index = parseInt( value, 10 );\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\n\n\t\t\t},\n\n\t\t\tparseNormalIndex: function ( value, len ) {\n\n\t\t\t\tvar index = parseInt( value, 10 );\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 3 ) * 3;\n\n\t\t\t},\n\n\t\t\tparseUVIndex: function ( value, len ) {\n\n\t\t\t\tvar index = parseInt( value, 10 );\n\t\t\t\treturn ( index >= 0 ? index - 1 : index + len / 2 ) * 2;\n\n\t\t\t},\n\n\t\t\taddVertex: function ( a, b, c ) {\n\n\t\t\t\tvar src = this.vertices;\n\t\t\t\tvar dst = this.object.geometry.vertices;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t\t},\n\n\t\t\taddVertexPoint: function ( a ) {\n\n\t\t\t\tvar src = this.vertices;\n\t\t\t\tvar dst = this.object.geometry.vertices;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\n\t\t\t},\n\n\t\t\taddVertexLine: function ( a ) {\n\n\t\t\t\tvar src = this.vertices;\n\t\t\t\tvar dst = this.object.geometry.vertices;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\n\t\t\t},\n\n\t\t\taddNormal: function ( a, b, c ) {\n\n\t\t\t\tvar src = this.normals;\n\t\t\t\tvar dst = this.object.geometry.normals;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t\t},\n\n\t\t\taddColor: function ( a, b, c ) {\n\n\t\t\t\tvar src = this.colors;\n\t\t\t\tvar dst = this.object.geometry.colors;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ], src[ a + 2 ] );\n\t\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ], src[ b + 2 ] );\n\t\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ], src[ c + 2 ] );\n\n\t\t\t},\n\n\t\t\taddUV: function ( a, b, c ) {\n\n\t\t\t\tvar src = this.uvs;\n\t\t\t\tvar dst = this.object.geometry.uvs;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ] );\n\t\t\t\tdst.push( src[ b + 0 ], src[ b + 1 ] );\n\t\t\t\tdst.push( src[ c + 0 ], src[ c + 1 ] );\n\n\t\t\t},\n\n\t\t\taddUVLine: function ( a ) {\n\n\t\t\t\tvar src = this.uvs;\n\t\t\t\tvar dst = this.object.geometry.uvs;\n\n\t\t\t\tdst.push( src[ a + 0 ], src[ a + 1 ] );\n\n\t\t\t},\n\n\t\t\taddFace: function ( a, b, c, ua, ub, uc, na, nb, nc ) {\n\n\t\t\t\tvar vLen = this.vertices.length;\n\n\t\t\t\tvar ia = this.parseVertexIndex( a, vLen );\n\t\t\t\tvar ib = this.parseVertexIndex( b, vLen );\n\t\t\t\tvar ic = this.parseVertexIndex( c, vLen );\n\n\t\t\t\tthis.addVertex( ia, ib, ic );\n\n\t\t\t\tif ( ua !== undefined && ua !== '' ) {\n\n\t\t\t\t\tvar uvLen = this.uvs.length;\n\t\t\t\t\tia = this.parseUVIndex( ua, uvLen );\n\t\t\t\t\tib = this.parseUVIndex( ub, uvLen );\n\t\t\t\t\tic = this.parseUVIndex( uc, uvLen );\n\t\t\t\t\tthis.addUV( ia, ib, ic );\n\n\t\t\t\t}\n\n\t\t\t\tif ( na !== undefined && na !== '' ) {\n\n\t\t\t\t\t// Normals are many times the same. If so, skip function call and parseInt.\n\t\t\t\t\tvar nLen = this.normals.length;\n\t\t\t\t\tia = this.parseNormalIndex( na, nLen );\n\n\t\t\t\t\tib = na === nb ? ia : this.parseNormalIndex( nb, nLen );\n\t\t\t\t\tic = na === nc ? ia : this.parseNormalIndex( nc, nLen );\n\n\t\t\t\t\tthis.addNormal( ia, ib, ic );\n\n\t\t\t\t}\n\n\t\t\t\tif ( this.colors.length > 0 ) {\n\n\t\t\t\t\tthis.addColor( ia, ib, ic );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\taddPointGeometry: function ( vertices ) {\n\n\t\t\t\tthis.object.geometry.type = 'Points';\n\n\t\t\t\tvar vLen = this.vertices.length;\n\n\t\t\t\tfor ( var vi = 0, l = vertices.length; vi < l; vi ++ ) {\n\n\t\t\t\t\tthis.addVertexPoint( this.parseVertexIndex( vertices[ vi ], vLen ) );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\taddLineGeometry: function ( vertices, uvs ) {\n\n\t\t\t\tthis.object.geometry.type = 'Line';\n\n\t\t\t\tvar vLen = this.vertices.length;\n\t\t\t\tvar uvLen = this.uvs.length;\n\n\t\t\t\tfor ( var vi = 0, l = vertices.length; vi < l; vi ++ ) {\n\n\t\t\t\t\tthis.addVertexLine( this.parseVertexIndex( vertices[ vi ], vLen ) );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var uvi = 0, l = uvs.length; uvi < l; uvi ++ ) {\n\n\t\t\t\t\tthis.addUVLine( this.parseUVIndex( uvs[ uvi ], uvLen ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tstate.startObject( '', false );\n\n\t\treturn state;\n\n\t}\n\n\t//\n\n\tfunction OBJLoader( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n\t\tthis.materials = null;\n\n\t}\n\n\tOBJLoader.prototype = {\n\n\t\tconstructor: OBJLoader,\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar loader = new THREE.FileLoader( scope.manager );\n\t\t\tloader.setPath( this.path );\n\t\t\tloader.load( url, function ( text ) {\n\n\t\t\t\tonLoad( scope.parse( text ) );\n\n\t\t\t}, onProgress, onError );\n\n\t\t},\n\n\t\tsetPath: function ( value ) {\n\n\t\t\tthis.path = value;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetMaterials: function ( materials ) {\n\n\t\t\tthis.materials = materials;\n\n\t\t\treturn this;\n\n\t\t},\n\n\t\tparse: function ( text ) {\n\n\t\t\tconsole.time( 'OBJLoader' );\n\n\t\t\tvar state = new ParserState();\n\n\t\t\tif ( text.indexOf( '\\r\\n' ) !== - 1 ) {\n\n\t\t\t\t// This is faster than String.split with regex that splits on both\n\t\t\t\ttext = text.replace( /\\r\\n/g, '\\n' );\n\n\t\t\t}\n\n\t\t\tif ( text.indexOf( '\\\\\\n' ) !== - 1 ) {\n\n\t\t\t\t// join lines separated by a line continuation character (\\)\n\t\t\t\ttext = text.replace( /\\\\\\n/g, '' );\n\n\t\t\t}\n\n\t\t\tvar lines = text.split( '\\n' );\n\t\t\tvar line = '', lineFirstChar = '';\n\t\t\tvar lineLength = 0;\n\t\t\tvar result = [];\n\n\t\t\t// Faster to just trim left side of the line. Use if available.\n\t\t\tvar trimLeft = ( typeof ''.trimLeft === 'function' );\n\n\t\t\tfor ( var i = 0, l = lines.length; i < l; i ++ ) {\n\n\t\t\t\tline = lines[ i ];\n\n\t\t\t\tline = trimLeft ? line.trimLeft() : line.trim();\n\n\t\t\t\tlineLength = line.length;\n\n\t\t\t\tif ( lineLength === 0 ) continue;\n\n\t\t\t\tlineFirstChar = line.charAt( 0 );\n\n\t\t\t\t// @todo invoke passed in handler if any\n\t\t\t\tif ( lineFirstChar === '#' ) continue;\n\n\t\t\t\tif ( lineFirstChar === 'v' ) {\n\n\t\t\t\t\tvar data = line.split( /\\s+/ );\n\n\t\t\t\t\tswitch ( data[ 0 ] ) {\n\n\t\t\t\t\t\tcase 'v':\n\t\t\t\t\t\t\tstate.vertices.push(\n\t\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 2 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 3 ] )\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif ( data.length === 8 ) {\n\n\t\t\t\t\t\t\t\tstate.colors.push(\n\t\t\t\t\t\t\t\t\tparseFloat( data[ 4 ] ),\n\t\t\t\t\t\t\t\t\tparseFloat( data[ 5 ] ),\n\t\t\t\t\t\t\t\t\tparseFloat( data[ 6 ] )\n\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'vn':\n\t\t\t\t\t\t\tstate.normals.push(\n\t\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 2 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 3 ] )\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'vt':\n\t\t\t\t\t\t\tstate.uvs.push(\n\t\t\t\t\t\t\t\tparseFloat( data[ 1 ] ),\n\t\t\t\t\t\t\t\tparseFloat( data[ 2 ] )\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( lineFirstChar === 'f' ) {\n\n\t\t\t\t\tvar lineData = line.substr( 1 ).trim();\n\t\t\t\t\tvar vertexData = lineData.split( /\\s+/ );\n\t\t\t\t\tvar faceVertices = [];\n\n\t\t\t\t\t// Parse the face vertex data into an easy to work with format\n\n\t\t\t\t\tfor ( var j = 0, jl = vertexData.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tvar vertex = vertexData[ j ];\n\n\t\t\t\t\t\tif ( vertex.length > 0 ) {\n\n\t\t\t\t\t\t\tvar vertexParts = vertex.split( '/' );\n\t\t\t\t\t\t\tfaceVertices.push( vertexParts );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Draw an edge between the first vertex and all subsequent vertices to form an n-gon\n\n\t\t\t\t\tvar v1 = faceVertices[ 0 ];\n\n\t\t\t\t\tfor ( var j = 1, jl = faceVertices.length - 1; j < jl; j ++ ) {\n\n\t\t\t\t\t\tvar v2 = faceVertices[ j ];\n\t\t\t\t\t\tvar v3 = faceVertices[ j + 1 ];\n\n\t\t\t\t\t\tstate.addFace(\n\t\t\t\t\t\t\tv1[ 0 ], v2[ 0 ], v3[ 0 ],\n\t\t\t\t\t\t\tv1[ 1 ], v2[ 1 ], v3[ 1 ],\n\t\t\t\t\t\t\tv1[ 2 ], v2[ 2 ], v3[ 2 ]\n\t\t\t\t\t\t);\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( lineFirstChar === 'l' ) {\n\n\t\t\t\t\tvar lineParts = line.substring( 1 ).trim().split( \" \" );\n\t\t\t\t\tvar lineVertices = [], lineUVs = [];\n\n\t\t\t\t\tif ( line.indexOf( \"/\" ) === - 1 ) {\n\n\t\t\t\t\t\tlineVertices = lineParts;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tfor ( var li = 0, llen = lineParts.length; li < llen; li ++ ) {\n\n\t\t\t\t\t\t\tvar parts = lineParts[ li ].split( \"/\" );\n\n\t\t\t\t\t\t\tif ( parts[ 0 ] !== \"\" ) lineVertices.push( parts[ 0 ] );\n\t\t\t\t\t\t\tif ( parts[ 1 ] !== \"\" ) lineUVs.push( parts[ 1 ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\tstate.addLineGeometry( lineVertices, lineUVs );\n\n\t\t\t\t} else if ( lineFirstChar === 'p' ) {\n\n\t\t\t\t\tvar lineData = line.substr( 1 ).trim();\n\t\t\t\t\tvar pointData = lineData.split( \" \" );\n\n\t\t\t\t\tstate.addPointGeometry( pointData );\n\n\t\t\t\t} else if ( ( result = object_pattern.exec( line ) ) !== null ) {\n\n\t\t\t\t\t// o object_name\n\t\t\t\t\t// or\n\t\t\t\t\t// g group_name\n\n\t\t\t\t\t// WORKAROUND: https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t// var name = result[ 0 ].substr( 1 ).trim();\n\t\t\t\t\tvar name = ( \" \" + result[ 0 ].substr( 1 ).trim() ).substr( 1 );\n\n\t\t\t\t\tstate.startObject( name );\n\n\t\t\t\t} else if ( material_use_pattern.test( line ) ) {\n\n\t\t\t\t\t// material\n\n\t\t\t\t\tstate.object.startMaterial( line.substring( 7 ).trim(), state.materialLibraries );\n\n\t\t\t\t} else if ( material_library_pattern.test( line ) ) {\n\n\t\t\t\t\t// mtl file\n\n\t\t\t\t\tstate.materialLibraries.push( line.substring( 7 ).trim() );\n\n\t\t\t\t} else if ( lineFirstChar === 's' ) {\n\n\t\t\t\t\tresult = line.split( ' ' );\n\n\t\t\t\t\t// smooth shading\n\n\t\t\t\t\t// @todo Handle files that have varying smooth values for a set of faces inside one geometry,\n\t\t\t\t\t// but does not define a usemtl for each face set.\n\t\t\t\t\t// This should be detected and a dummy material created (later MultiMaterial and geometry groups).\n\t\t\t\t\t// This requires some care to not create extra material on each smooth value for \"normal\" obj files.\n\t\t\t\t\t// where explicit usemtl defines geometry groups.\n\t\t\t\t\t// Example asset: examples/models/obj/cerberus/Cerberus.obj\n\n\t\t\t\t\t/*\n\t\t\t\t\t * http://paulbourke.net/dataformats/obj/\n\t\t\t\t\t * or\n\t\t\t\t\t * http://www.cs.utah.edu/~boulos/cs3505/obj_spec.pdf\n\t\t\t\t\t *\n\t\t\t\t\t * From chapter \"Grouping\" Syntax explanation \"s group_number\":\n\t\t\t\t\t * \"group_number is the smoothing group number. To turn off smoothing groups, use a value of 0 or off.\n\t\t\t\t\t * Polygonal elements use group numbers to put elements in different smoothing groups. For free-form\n\t\t\t\t\t * surfaces, smoothing groups are either turned on or off; there is no difference between values greater\n\t\t\t\t\t * than 0.\"\n\t\t\t\t\t */\n\t\t\t\t\tif ( result.length > 1 ) {\n\n\t\t\t\t\t\tvar value = result[ 1 ].trim().toLowerCase();\n\t\t\t\t\t\tstate.object.smooth = ( value !== '0' && value !== 'off' );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// ZBrush can produce \"s\" lines #11707\n\t\t\t\t\t\tstate.object.smooth = true;\n\n\t\t\t\t\t}\n\t\t\t\t\tvar material = state.object.currentMaterial();\n\t\t\t\t\tif ( material ) material.smooth = state.object.smooth;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Handle null terminated files without exception\n\t\t\t\t\tif ( line === '\\0' ) continue;\n\n\t\t\t\t\tthrow new Error( 'THREE.OBJLoader: Unexpected line: \"' + line + '\"' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstate.finalize();\n\n\t\t\tvar container = new THREE.Group();\n\t\t\tcontainer.materialLibraries = [].concat( state.materialLibraries );\n\n\t\t\tfor ( var i = 0, l = state.objects.length; i < l; i ++ ) {\n\n\t\t\t\tvar object = state.objects[ i ];\n\t\t\t\tvar geometry = object.geometry;\n\t\t\t\tvar materials = object.materials;\n\t\t\t\tvar isLine = ( geometry.type === 'Line' );\n\t\t\t\tvar isPoints = ( geometry.type === 'Points' );\n\t\t\t\tvar hasVertexColors = false;\n\n\t\t\t\t// Skip o/g line declarations that did not follow with any faces\n\t\t\t\tif ( geometry.vertices.length === 0 ) continue;\n\n\t\t\t\tvar buffergeometry = new THREE.BufferGeometry();\n\n\t\t\t\tbuffergeometry.addAttribute( 'position', new THREE.Float32BufferAttribute( geometry.vertices, 3 ) );\n\n\t\t\t\tif ( geometry.normals.length > 0 ) {\n\n\t\t\t\t\tbuffergeometry.addAttribute( 'normal', new THREE.Float32BufferAttribute( geometry.normals, 3 ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbuffergeometry.computeVertexNormals();\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometry.colors.length > 0 ) {\n\n\t\t\t\t\thasVertexColors = true;\n\t\t\t\t\tbuffergeometry.addAttribute( 'color', new THREE.Float32BufferAttribute( geometry.colors, 3 ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( geometry.uvs.length > 0 ) {\n\n\t\t\t\t\tbuffergeometry.addAttribute( 'uv', new THREE.Float32BufferAttribute( geometry.uvs, 2 ) );\n\n\t\t\t\t}\n\n\t\t\t\t// Create materials\n\n\t\t\t\tvar createdMaterials = [];\n\n\t\t\t\tfor ( var mi = 0, miLen = materials.length; mi < miLen; mi ++ ) {\n\n\t\t\t\t\tvar sourceMaterial = materials[ mi ];\n\t\t\t\t\tvar material = undefined;\n\n\t\t\t\t\tif ( this.materials !== null ) {\n\n\t\t\t\t\t\tmaterial = this.materials.create( sourceMaterial.name );\n\n\t\t\t\t\t\t// mtl etc. loaders probably can't create line materials correctly, copy properties to a line material.\n\t\t\t\t\t\tif ( isLine && material && ! ( material instanceof THREE.LineBasicMaterial ) ) {\n\n\t\t\t\t\t\t\tvar materialLine = new THREE.LineBasicMaterial();\n\t\t\t\t\t\t\tTHREE.Material.prototype.copy.call( materialLine, material );\n\t\t\t\t\t\t\tmaterialLine.color.copy( material.color );\n\t\t\t\t\t\t\tmaterialLine.lights = false;\n\t\t\t\t\t\t\tmaterial = materialLine;\n\n\t\t\t\t\t\t} else if ( isPoints && material && ! ( material instanceof THREE.PointsMaterial ) ) {\n\n\t\t\t\t\t\t\tvar materialPoints = new THREE.PointsMaterial( { size: 10, sizeAttenuation: false } );\n\t\t\t\t\t\t\tTHREE.Material.prototype.copy.call( materialPoints, material );\n\t\t\t\t\t\t\tmaterialPoints.color.copy( material.color );\n\t\t\t\t\t\t\tmaterialPoints.map = material.map;\n\t\t\t\t\t\t\tmaterialPoints.lights = false;\n\t\t\t\t\t\t\tmaterial = materialPoints;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! material ) {\n\n\t\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\t\tmaterial = new THREE.LineBasicMaterial();\n\n\t\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\t\tmaterial = new THREE.PointsMaterial( { size: 1, sizeAttenuation: false } );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tmaterial = new THREE.MeshPhongMaterial();\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmaterial.name = sourceMaterial.name;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmaterial.flatShading = sourceMaterial.smooth ? false : true;\n\t\t\t\t\tmaterial.vertexColors = hasVertexColors ? THREE.VertexColors : THREE.NoColors;\n\n\t\t\t\t\tcreatedMaterials.push( material );\n\n\t\t\t\t}\n\n\t\t\t\t// Create mesh\n\n\t\t\t\tvar mesh;\n\n\t\t\t\tif ( createdMaterials.length > 1 ) {\n\n\t\t\t\t\tfor ( var mi = 0, miLen = materials.length; mi < miLen; mi ++ ) {\n\n\t\t\t\t\t\tvar sourceMaterial = materials[ mi ];\n\t\t\t\t\t\tbuffergeometry.addGroup( sourceMaterial.groupStart, sourceMaterial.groupCount, mi );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\tmesh = new THREE.LineSegments( buffergeometry, createdMaterials );\n\n\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\tmesh = new THREE.Points( buffergeometry, createdMaterials );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tmesh = new THREE.Mesh( buffergeometry, createdMaterials );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( isLine ) {\n\n\t\t\t\t\t\tmesh = new THREE.LineSegments( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t} else if ( isPoints ) {\n\n\t\t\t\t\t\tmesh = new THREE.Points( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tmesh = new THREE.Mesh( buffergeometry, createdMaterials[ 0 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = object.name;\n\n\t\t\t\tcontainer.add( mesh );\n\n\t\t\t}\n\n\t\t\tconsole.timeEnd( 'OBJLoader' );\n\n\t\t\treturn container;\n\n\t\t}\n\n\t};\n\n\treturn OBJLoader;\n\n} )();\n","/**\n * @author Wei Meng / http://about.me/menway\n *\n * Description: A THREE loader for PLY ASCII files (known as the Polygon\n * File Format or the Stanford Triangle Format).\n *\n * Limitations: ASCII decoding assumes file is UTF-8.\n *\n * Usage:\n *\tvar loader = new THREE.PLYLoader();\n *\tloader.load('./models/ply/ascii/dolphins.ply', function (geometry) {\n *\n *\t\tscene.add( new THREE.Mesh( geometry ) );\n *\n *\t} );\n *\n * If the PLY file uses non standard property names, they can be mapped while\n * loading. For example, the following maps the properties\n * diffuse_(red|green|blue) in the file to standard color names.\n *\n * loader.setPropertyNameMapping( {\n *\tdiffuse_red: 'red',\n *\tdiffuse_green: 'green',\n *\tdiffuse_blue: 'blue'\n * } );\n *\n */\n\n\nTHREE.PLYLoader = function ( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n\tthis.propertyNameMapping = {};\n\n};\n\nTHREE.PLYLoader.prototype = {\n\n\tconstructor: THREE.PLYLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar loader = new THREE.FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tonLoad( scope.parse( text ) );\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\tsetPath: function ( value ) {\n\n\t\tthis.path = value;\n\t\treturn this;\n\n\t},\n\n\tsetPropertyNameMapping: function ( mapping ) {\n\n\t\tthis.propertyNameMapping = mapping;\n\n\t},\n\n\tparse: function ( data ) {\n\n\t\tfunction parseHeader( data ) {\n\n\t\t\tvar patternHeader = /ply([\\s\\S]*)end_header\\r?\\n/;\n\t\t\tvar headerText = '';\n\t\t\tvar headerLength = 0;\n\t\t\tvar result = patternHeader.exec( data );\n\n\t\t\tif ( result !== null ) {\n\n\t\t\t\theaderText = result[ 1 ];\n\t\t\t\theaderLength = result[ 0 ].length;\n\n\t\t\t}\n\n\t\t\tvar header = {\n\t\t\t\tcomments: [],\n\t\t\t\telements: [],\n\t\t\t\theaderLength: headerLength\n\t\t\t};\n\n\t\t\tvar lines = headerText.split( '\\n' );\n\t\t\tvar currentElement;\n\t\t\tvar lineType, lineValues;\n\n\t\t\tfunction make_ply_element_property( propertValues, propertyNameMapping ) {\n\n\t\t\t\tvar property = { type: propertValues[ 0 ] };\n\n\t\t\t\tif ( property.type === 'list' ) {\n\n\t\t\t\t\tproperty.name = propertValues[ 3 ];\n\t\t\t\t\tproperty.countType = propertValues[ 1 ];\n\t\t\t\t\tproperty.itemType = propertValues[ 2 ];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tproperty.name = propertValues[ 1 ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( property.name in propertyNameMapping ) {\n\n\t\t\t\t\tproperty.name = propertyNameMapping[ property.name ];\n\n\t\t\t\t}\n\n\t\t\t\treturn property;\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < lines.length; i ++ ) {\n\n\t\t\t\tvar line = lines[ i ];\n\t\t\t\tline = line.trim();\n\n\t\t\t\tif ( line === '' ) continue;\n\n\t\t\t\tlineValues = line.split( /\\s+/ );\n\t\t\t\tlineType = lineValues.shift();\n\t\t\t\tline = lineValues.join( ' ' );\n\n\t\t\t\tswitch ( lineType ) {\n\n\t\t\t\t\tcase 'format':\n\n\t\t\t\t\t\theader.format = lineValues[ 0 ];\n\t\t\t\t\t\theader.version = lineValues[ 1 ];\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'comment':\n\n\t\t\t\t\t\theader.comments.push( line );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'element':\n\n\t\t\t\t\t\tif ( currentElement !== undefined ) {\n\n\t\t\t\t\t\t\theader.elements.push( currentElement );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrentElement = {};\n\t\t\t\t\t\tcurrentElement.name = lineValues[ 0 ];\n\t\t\t\t\t\tcurrentElement.count = parseInt( lineValues[ 1 ] );\n\t\t\t\t\t\tcurrentElement.properties = [];\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'property':\n\n\t\t\t\t\t\tcurrentElement.properties.push( make_ply_element_property( lineValues, scope.propertyNameMapping ) );\n\n\t\t\t\t\t\tbreak;\n\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tconsole.log( 'unhandled', lineType, lineValues );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( currentElement !== undefined ) {\n\n\t\t\t\theader.elements.push( currentElement );\n\n\t\t\t}\n\n\t\t\treturn header;\n\n\t\t}\n\n\t\tfunction parseASCIINumber( n, type ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'char': case 'uchar': case 'short': case 'ushort': case 'int': case 'uint':\n\t\t\t\tcase 'int8': case 'uint8': case 'int16': case 'uint16': case 'int32': case 'uint32':\n\n\t\t\t\t\treturn parseInt( n );\n\n\t\t\t\tcase 'float': case 'double': case 'float32': case 'float64':\n\n\t\t\t\t\treturn parseFloat( n );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction parseASCIIElement( properties, line ) {\n\n\t\t\tvar values = line.split( /\\s+/ );\n\n\t\t\tvar element = {};\n\n\t\t\tfor ( var i = 0; i < properties.length; i ++ ) {\n\n\t\t\t\tif ( properties[ i ].type === 'list' ) {\n\n\t\t\t\t\tvar list = [];\n\t\t\t\t\tvar n = parseASCIINumber( values.shift(), properties[ i ].countType );\n\n\t\t\t\t\tfor ( var j = 0; j < n; j ++ ) {\n\n\t\t\t\t\t\tlist.push( parseASCIINumber( values.shift(), properties[ i ].itemType ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t\telement[ properties[ i ].name ] = list;\n\n\t\t\t\t} else {\n\n\t\t\t\t\telement[ properties[ i ].name ] = parseASCIINumber( values.shift(), properties[ i ].type );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn element;\n\n\t\t}\n\n\t\tfunction parseASCII( data, header ) {\n\n\t\t\t// PLY ascii format specification, as per http://en.wikipedia.org/wiki/PLY_(file_format)\n\n\t\t\tvar buffer = {\n\t\t\t\tindices: [],\n\t\t\t\tvertices: [],\n\t\t\t\tnormals: [],\n\t\t\t\tuvs: [],\n\t\t\t\tfaceVertexUvs: [],\n\t\t\t\tcolors: []\n\t\t\t};\n\n\t\t\tvar result;\n\n\t\t\tvar patternBody = /end_header\\s([\\s\\S]*)$/;\n\t\t\tvar body = '';\n\t\t\tif ( ( result = patternBody.exec( data ) ) !== null ) {\n\n\t\t\t\tbody = result[ 1 ];\n\n\t\t\t}\n\n\t\t\tvar lines = body.split( '\\n' );\n\t\t\tvar currentElement = 0;\n\t\t\tvar currentElementCount = 0;\n\n\t\t\tfor ( var i = 0; i < lines.length; i ++ ) {\n\n\t\t\t\tvar line = lines[ i ];\n\t\t\t\tline = line.trim();\n\t\t\t\tif ( line === '' ) {\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tif ( currentElementCount >= header.elements[ currentElement ].count ) {\n\n\t\t\t\t\tcurrentElement ++;\n\t\t\t\t\tcurrentElementCount = 0;\n\n\t\t\t\t}\n\n\t\t\t\tvar element = parseASCIIElement( header.elements[ currentElement ].properties, line );\n\n\t\t\t\thandleElement( buffer, header.elements[ currentElement ].name, element );\n\n\t\t\t\tcurrentElementCount ++;\n\n\t\t\t}\n\n\t\t\treturn postProcess( buffer );\n\n\t\t}\n\n\t\tfunction postProcess( buffer ) {\n\n\t\t\tvar geometry = new THREE.BufferGeometry();\n\n\t\t\t// mandatory buffer data\n\n\t\t\tif ( buffer.indices.length > 0 ) {\n\n\t\t\t\tgeometry.setIndex( buffer.indices );\n\n\t\t\t}\n\n\t\t\tgeometry.addAttribute( 'position', new THREE.Float32BufferAttribute( buffer.vertices, 3 ) );\n\n\t\t\t// optional buffer data\n\n\t\t\tif ( buffer.normals.length > 0 ) {\n\n\t\t\t\tgeometry.addAttribute( 'normal', new THREE.Float32BufferAttribute( buffer.normals, 3 ) );\n\n\t\t\t}\n\n\t\t\tif ( buffer.uvs.length > 0 ) {\n\n\t\t\t\tgeometry.addAttribute( 'uv', new THREE.Float32BufferAttribute( buffer.uvs, 2 ) );\n\n\t\t\t}\n\n\t\t\tif ( buffer.colors.length > 0 ) {\n\n\t\t\t\tgeometry.addAttribute( 'color', new THREE.Float32BufferAttribute( buffer.colors, 3 ) );\n\n\t\t\t}\n\n\t\t\tif ( buffer.faceVertexUvs.length > 0 ) {\n\n\t\t\t\tgeometry = geometry.toNonIndexed();\n\t\t\t\tgeometry.addAttribute( 'uv', new THREE.Float32BufferAttribute( buffer.faceVertexUvs, 2 ) );\n\n\t\t\t}\n\n\t\t\tgeometry.computeBoundingSphere();\n\n\t\t\treturn geometry;\n\n\t\t}\n\n\t\tfunction handleElement( buffer, elementName, element ) {\n\n\t\t\tif ( elementName === 'vertex' ) {\n\n\t\t\t\tbuffer.vertices.push( element.x, element.y, element.z );\n\n\t\t\t\tif ( 'nx' in element && 'ny' in element && 'nz' in element ) {\n\n\t\t\t\t\tbuffer.normals.push( element.nx, element.ny, element.nz );\n\n\t\t\t\t}\n\n\t\t\t\tif ( 's' in element && 't' in element ) {\n\n\t\t\t\t\tbuffer.uvs.push( element.s, element.t );\n\n\t\t\t\t}\n\n\t\t\t\tif ( 'red' in element && 'green' in element && 'blue' in element ) {\n\n\t\t\t\t\tbuffer.colors.push( element.red / 255.0, element.green / 255.0, element.blue / 255.0 );\n\n\t\t\t\t}\n\n\t\t\t} else if ( elementName === 'face' ) {\n\n\t\t\t\tvar vertex_indices = element.vertex_indices || element.vertex_index; // issue #9338\n\t\t\t\tvar texcoord = element.texcoord;\n\n\t\t\t\tif ( vertex_indices.length === 3 ) {\n\n\t\t\t\t\tbuffer.indices.push( vertex_indices[ 0 ], vertex_indices[ 1 ], vertex_indices[ 2 ] );\n\n\t\t\t\t\tif ( texcoord && texcoord.length === 6 ) {\n\n\t\t\t\t\t\tbuffer.faceVertexUvs.push( texcoord[ 0 ], texcoord[ 1 ] );\n\t\t\t\t\t\tbuffer.faceVertexUvs.push( texcoord[ 2 ], texcoord[ 3 ] );\n\t\t\t\t\t\tbuffer.faceVertexUvs.push( texcoord[ 4 ], texcoord[ 5 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( vertex_indices.length === 4 ) {\n\n\t\t\t\t\tbuffer.indices.push( vertex_indices[ 0 ], vertex_indices[ 1 ], vertex_indices[ 3 ] );\n\t\t\t\t\tbuffer.indices.push( vertex_indices[ 1 ], vertex_indices[ 2 ], vertex_indices[ 3 ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction binaryRead( dataview, at, type, little_endian ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\t// corespondences for non-specific length types here match rply:\n\t\t\t\tcase 'int8':\t\tcase 'char':\t return [ dataview.getInt8( at ), 1 ];\n\t\t\t\tcase 'uint8':\t\tcase 'uchar':\t return [ dataview.getUint8( at ), 1 ];\n\t\t\t\tcase 'int16':\t\tcase 'short':\t return [ dataview.getInt16( at, little_endian ), 2 ];\n\t\t\t\tcase 'uint16':\tcase 'ushort': return [ dataview.getUint16( at, little_endian ), 2 ];\n\t\t\t\tcase 'int32':\t\tcase 'int':\t\t return [ dataview.getInt32( at, little_endian ), 4 ];\n\t\t\t\tcase 'uint32':\tcase 'uint':\t return [ dataview.getUint32( at, little_endian ), 4 ];\n\t\t\t\tcase 'float32': case 'float':\t return [ dataview.getFloat32( at, little_endian ), 4 ];\n\t\t\t\tcase 'float64': case 'double': return [ dataview.getFloat64( at, little_endian ), 8 ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction binaryReadElement( dataview, at, properties, little_endian ) {\n\n\t\t\tvar element = {};\n\t\t\tvar result, read = 0;\n\n\t\t\tfor ( var i = 0; i < properties.length; i ++ ) {\n\n\t\t\t\tif ( properties[ i ].type === 'list' ) {\n\n\t\t\t\t\tvar list = [];\n\n\t\t\t\t\tresult = binaryRead( dataview, at + read, properties[ i ].countType, little_endian );\n\t\t\t\t\tvar n = result[ 0 ];\n\t\t\t\t\tread += result[ 1 ];\n\n\t\t\t\t\tfor ( var j = 0; j < n; j ++ ) {\n\n\t\t\t\t\t\tresult = binaryRead( dataview, at + read, properties[ i ].itemType, little_endian );\n\t\t\t\t\t\tlist.push( result[ 0 ] );\n\t\t\t\t\t\tread += result[ 1 ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\telement[ properties[ i ].name ] = list;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tresult = binaryRead( dataview, at + read, properties[ i ].type, little_endian );\n\t\t\t\t\telement[ properties[ i ].name ] = result[ 0 ];\n\t\t\t\t\tread += result[ 1 ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn [ element, read ];\n\n\t\t}\n\n\t\tfunction parseBinary( data, header ) {\n\n\t\t\tvar buffer = {\n\t\t\t\tindices: [],\n\t\t\t\tvertices: [],\n\t\t\t\tnormals: [],\n\t\t\t\tuvs: [],\n\t\t\t\tfaceVertexUvs: [],\n\t\t\t\tcolors: []\n\t\t\t};\n\n\t\t\tvar little_endian = ( header.format === 'binary_little_endian' );\n\t\t\tvar body = new DataView( data, header.headerLength );\n\t\t\tvar result, loc = 0;\n\n\t\t\tfor ( var currentElement = 0; currentElement < header.elements.length; currentElement ++ ) {\n\n\t\t\t\tfor ( var currentElementCount = 0; currentElementCount < header.elements[ currentElement ].count; currentElementCount ++ ) {\n\n\t\t\t\t\tresult = binaryReadElement( body, loc, header.elements[ currentElement ].properties, little_endian );\n\t\t\t\t\tloc += result[ 1 ];\n\t\t\t\t\tvar element = result[ 0 ];\n\n\t\t\t\t\thandleElement( buffer, header.elements[ currentElement ].name, element );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn postProcess( buffer );\n\n\t\t}\n\n\t\t//\n\n\t\tvar geometry;\n\t\tvar scope = this;\n\n\t\tif ( data instanceof ArrayBuffer ) {\n\n\t\t\tvar text = THREE.LoaderUtils.decodeText( new Uint8Array( data ) );\n\t\t\tvar header = parseHeader( text );\n\n\t\t\tgeometry = header.format === 'ascii' ? parseASCII( text, header ) : parseBinary( data, header );\n\n\t\t} else {\n\n\t\t\tgeometry = parseASCII( data, parseHeader( data ) );\n\n\t\t}\n\n\t\treturn geometry;\n\n\t}\n\n};\n","export function merge(...sets:Array<string>):string {\n\tif (sets.length > 1) {\n\t\tsets[0] = sets[0].slice(0, -1);\n\t\tconst xl = sets.length - 1;\n\t\tfor (let x = 1; x < xl; ++x) {\n\t\t\tsets[x] = sets[x].slice(1, -1);\n\t\t}\n\t\tsets[xl] = sets[xl].slice(1);\n\t\treturn sets.join('');\n\t} else {\n\t\treturn sets[0];\n\t}\n}\n\nexport function subexp(str:string):string {\n\treturn \"(?:\" + str + \")\";\n}\n\nexport function typeOf(o:any):string {\n\treturn o === undefined ? \"undefined\" : (o === null ? \"null\" : Object.prototype.toString.call(o).split(\" \").pop().split(\"]\").shift().toLowerCase());\n}\n\nexport function toUpperCase(str:string):string {\n\treturn str.toUpperCase();\n}\n\nexport function toArray(obj:any):Array<any> {\n\treturn obj !== undefined && obj !== null ? (obj instanceof Array ? obj : (typeof obj.length !== \"number\" || obj.split || obj.setInterval || obj.call ? [obj] : Array.prototype.slice.call(obj))) : [];\n}\n\n\nexport function assign(target: object, source: any): any {\n\tconst obj = target as any;\n\tif (source) {\n\t\tfor (const key in source) {\n\t\t\tobj[key] = source[key];\n\t\t}\n\t}\n\treturn obj;\n}","import { URIRegExps } from \"./uri\";\nimport { merge, subexp } from \"./util\";\n\nexport function buildExps(isIRI:boolean):URIRegExps {\n\tconst\n\t\tALPHA$$ = \"[A-Za-z]\",\n\t\tCR$ = \"[\\\\x0D]\",\n\t\tDIGIT$$ = \"[0-9]\",\n\t\tDQUOTE$$ = \"[\\\\x22]\",\n\t\tHEXDIG$$ = merge(DIGIT$$, \"[A-Fa-f]\"),  //case-insensitive\n\t\tLF$$ = \"[\\\\x0A]\",\n\t\tSP$$ = \"[\\\\x20]\",\n\t\tPCT_ENCODED$ = subexp(subexp(\"%[EFef]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%[89A-Fa-f]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%\" + HEXDIG$$ + HEXDIG$$)),  //expanded\n\t\tGEN_DELIMS$$ = \"[\\\\:\\\\/\\\\?\\\\#\\\\[\\\\]\\\\@]\",\n\t\tSUB_DELIMS$$ = \"[\\\\!\\\\$\\\\&\\\\'\\\\(\\\\)\\\\*\\\\+\\\\,\\\\;\\\\=]\",\n\t\tRESERVED$$ = merge(GEN_DELIMS$$, SUB_DELIMS$$),\n\t\tUCSCHAR$$ = isIRI ? \"[\\\\xA0-\\\\u200D\\\\u2010-\\\\u2029\\\\u202F-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF]\" : \"[]\",  //subset, excludes bidi control characters\n\t\tIPRIVATE$$ = isIRI ? \"[\\\\uE000-\\\\uF8FF]\" : \"[]\",  //subset\n\t\tUNRESERVED$$ = merge(ALPHA$$, DIGIT$$, \"[\\\\-\\\\.\\\\_\\\\~]\", UCSCHAR$$),\n\t\tSCHEME$ = subexp(ALPHA$$ + merge(ALPHA$$, DIGIT$$, \"[\\\\+\\\\-\\\\.]\") + \"*\"),\n\t\tUSERINFO$ = subexp(subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:]\")) + \"*\"),\n\t\tDEC_OCTET$ = subexp(subexp(\"25[0-5]\") + \"|\" + subexp(\"2[0-4]\" + DIGIT$$) + \"|\" + subexp(\"1\" + DIGIT$$ + DIGIT$$) + \"|\" + subexp(\"[1-9]\" + DIGIT$$) + \"|\" + DIGIT$$),\n\t\tDEC_OCTET_RELAXED$ = subexp(subexp(\"25[0-5]\") + \"|\" + subexp(\"2[0-4]\" + DIGIT$$) + \"|\" + subexp(\"1\" + DIGIT$$ + DIGIT$$) + \"|\" + subexp(\"0?[1-9]\" + DIGIT$$) + \"|0?0?\" + DIGIT$$),  //relaxed parsing rules\n\t\tIPV4ADDRESS$ = subexp(DEC_OCTET_RELAXED$ + \"\\\\.\" + DEC_OCTET_RELAXED$ + \"\\\\.\" + DEC_OCTET_RELAXED$ + \"\\\\.\" + DEC_OCTET_RELAXED$),\n\t\tH16$ = subexp(HEXDIG$$ + \"{1,4}\"),\n\t\tLS32$ = subexp(subexp(H16$ + \"\\\\:\" + H16$) + \"|\" + IPV4ADDRESS$),\n\t\tIPV6ADDRESS1$ = subexp(                                                            subexp(H16$ + \"\\\\:\") + \"{6}\" + LS32$), //                           6( h16 \":\" ) ls32\n\t\tIPV6ADDRESS2$ = subexp(                                                 \"\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{5}\" + LS32$), //                      \"::\" 5( h16 \":\" ) ls32\n\t\tIPV6ADDRESS3$ = subexp(subexp(                                 H16$) + \"?\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{4}\" + LS32$), //[               h16 ] \"::\" 4( h16 \":\" ) ls32\n\t\tIPV6ADDRESS4$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,1}\" + H16$) + \"?\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{3}\" + LS32$), //[ *1( h16 \":\" ) h16 ] \"::\" 3( h16 \":\" ) ls32\n\t\tIPV6ADDRESS5$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,2}\" + H16$) + \"?\\\\:\\\\:\" + subexp(H16$ + \"\\\\:\") + \"{2}\" + LS32$), //[ *2( h16 \":\" ) h16 ] \"::\" 2( h16 \":\" ) ls32\n\t\tIPV6ADDRESS6$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,3}\" + H16$) + \"?\\\\:\\\\:\" +        H16$ + \"\\\\:\"          + LS32$), //[ *3( h16 \":\" ) h16 ] \"::\"    h16 \":\"   ls32\n\t\tIPV6ADDRESS7$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,4}\" + H16$) + \"?\\\\:\\\\:\"                                + LS32$), //[ *4( h16 \":\" ) h16 ] \"::\"              ls32\n\t\tIPV6ADDRESS8$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,5}\" + H16$) + \"?\\\\:\\\\:\"                                + H16$ ), //[ *5( h16 \":\" ) h16 ] \"::\"              h16\n\t\tIPV6ADDRESS9$ = subexp(subexp(subexp(H16$ + \"\\\\:\") + \"{0,6}\" + H16$) + \"?\\\\:\\\\:\"                                       ), //[ *6( h16 \":\" ) h16 ] \"::\"\n\t\tIPV6ADDRESS$ = subexp([IPV6ADDRESS1$, IPV6ADDRESS2$, IPV6ADDRESS3$, IPV6ADDRESS4$, IPV6ADDRESS5$, IPV6ADDRESS6$, IPV6ADDRESS7$, IPV6ADDRESS8$, IPV6ADDRESS9$].join(\"|\")),\n\t\tZONEID$ = subexp(subexp(UNRESERVED$$ + \"|\" + PCT_ENCODED$) + \"+\"),  //RFC 6874\n\t\tIPV6ADDRZ$ = subexp(IPV6ADDRESS$ + \"\\\\%25\" + ZONEID$),  //RFC 6874\n\t\tIPV6ADDRZ_RELAXED$ = subexp(IPV6ADDRESS$ + subexp(\"\\\\%25|\\\\%(?!\" + HEXDIG$$ + \"{2})\") + ZONEID$),  //RFC 6874, with relaxed parsing rules\n\t\tIPVFUTURE$ = subexp(\"[vV]\" + HEXDIG$$ + \"+\\\\.\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:]\") + \"+\"),\n\t\tIP_LITERAL$ = subexp(\"\\\\[\" + subexp(IPV6ADDRZ_RELAXED$ + \"|\" + IPV6ADDRESS$ + \"|\" + IPVFUTURE$) + \"\\\\]\"),  //RFC 6874\n\t\tREG_NAME$ = subexp(subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$)) + \"*\"),\n\t\tHOST$ = subexp(IP_LITERAL$ + \"|\" + IPV4ADDRESS$ + \"(?!\" + REG_NAME$ + \")\" + \"|\" + REG_NAME$),\n\t\tPORT$ = subexp(DIGIT$$ + \"*\"),\n\t\tAUTHORITY$ = subexp(subexp(USERINFO$ + \"@\") + \"?\" + HOST$ + subexp(\"\\\\:\" + PORT$) + \"?\"),\n\t\tPCHAR$ = subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:\\\\@]\")),\n\t\tSEGMENT$ = subexp(PCHAR$ + \"*\"),\n\t\tSEGMENT_NZ$ = subexp(PCHAR$ + \"+\"),\n\t\tSEGMENT_NZ_NC$ = subexp(subexp(PCT_ENCODED$ + \"|\" + merge(UNRESERVED$$, SUB_DELIMS$$, \"[\\\\@]\")) + \"+\"),\n\t\tPATH_ABEMPTY$ = subexp(subexp(\"\\\\/\" + SEGMENT$) + \"*\"),\n\t\tPATH_ABSOLUTE$ = subexp(\"\\\\/\" + subexp(SEGMENT_NZ$ + PATH_ABEMPTY$) + \"?\"),  //simplified\n\t\tPATH_NOSCHEME$ = subexp(SEGMENT_NZ_NC$ + PATH_ABEMPTY$),  //simplified\n\t\tPATH_ROOTLESS$ = subexp(SEGMENT_NZ$ + PATH_ABEMPTY$),  //simplified\n\t\tPATH_EMPTY$ = \"(?!\" + PCHAR$ + \")\",\n\t\tPATH$ = subexp(PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_NOSCHEME$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$),\n\t\tQUERY$ = subexp(subexp(PCHAR$ + \"|\" + merge(\"[\\\\/\\\\?]\", IPRIVATE$$)) + \"*\"),\n\t\tFRAGMENT$ = subexp(subexp(PCHAR$ + \"|[\\\\/\\\\?]\") + \"*\"),\n\t\tHIER_PART$ = subexp(subexp(\"\\\\/\\\\/\" + AUTHORITY$ + PATH_ABEMPTY$) + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$),\n\t\tURI$ = subexp(SCHEME$ + \"\\\\:\" + HIER_PART$ + subexp(\"\\\\?\" + QUERY$) + \"?\" + subexp(\"\\\\#\" + FRAGMENT$) + \"?\"),\n\t\tRELATIVE_PART$ = subexp(subexp(\"\\\\/\\\\/\" + AUTHORITY$ + PATH_ABEMPTY$) + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_NOSCHEME$ + \"|\" + PATH_EMPTY$),\n\t\tRELATIVE$ = subexp(RELATIVE_PART$ + subexp(\"\\\\?\" + QUERY$) + \"?\" + subexp(\"\\\\#\" + FRAGMENT$) + \"?\"),\n\t\tURI_REFERENCE$ = subexp(URI$ + \"|\" + RELATIVE$),\n\t\tABSOLUTE_URI$ = subexp(SCHEME$ + \"\\\\:\" + HIER_PART$ + subexp(\"\\\\?\" + QUERY$) + \"?\"),\n\n\t\tGENERIC_REF$ = \"^(\" + SCHEME$ + \")\\\\:\" + subexp(subexp(\"\\\\/\\\\/(\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?)\") + \"?(\" + PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$ + \")\") + subexp(\"\\\\?(\" + QUERY$ + \")\") + \"?\" + subexp(\"\\\\#(\" + FRAGMENT$ + \")\") + \"?$\",\n\t\tRELATIVE_REF$ = \"^(){0}\" + subexp(subexp(\"\\\\/\\\\/(\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?)\") + \"?(\" + PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_NOSCHEME$ + \"|\" + PATH_EMPTY$ + \")\") + subexp(\"\\\\?(\" + QUERY$ + \")\") + \"?\" + subexp(\"\\\\#(\" + FRAGMENT$ + \")\") + \"?$\",\n\t\tABSOLUTE_REF$ = \"^(\" + SCHEME$ + \")\\\\:\" + subexp(subexp(\"\\\\/\\\\/(\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?)\") + \"?(\" + PATH_ABEMPTY$ + \"|\" + PATH_ABSOLUTE$ + \"|\" + PATH_ROOTLESS$ + \"|\" + PATH_EMPTY$ + \")\") + subexp(\"\\\\?(\" + QUERY$ + \")\") + \"?$\",\n\t\tSAMEDOC_REF$ = \"^\" + subexp(\"\\\\#(\" + FRAGMENT$ + \")\") + \"?$\",\n\t\tAUTHORITY_REF$ = \"^\" + subexp(\"(\" + USERINFO$ + \")@\") + \"?(\" + HOST$ + \")\" + subexp(\"\\\\:(\" + PORT$ + \")\") + \"?$\"\n\t;\n\n\treturn {\n\t\tNOT_SCHEME : new RegExp(merge(\"[^]\", ALPHA$$, DIGIT$$, \"[\\\\+\\\\-\\\\.]\"), \"g\"),\n\t\tNOT_USERINFO : new RegExp(merge(\"[^\\\\%\\\\:]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n\t\tNOT_HOST : new RegExp(merge(\"[^\\\\%\\\\[\\\\]\\\\:]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n\t\tNOT_PATH : new RegExp(merge(\"[^\\\\%\\\\/\\\\:\\\\@]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n\t\tNOT_PATH_NOSCHEME : new RegExp(merge(\"[^\\\\%\\\\/\\\\@]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n\t\tNOT_QUERY : new RegExp(merge(\"[^\\\\%]\", UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:\\\\@\\\\/\\\\?]\", IPRIVATE$$), \"g\"),\n\t\tNOT_FRAGMENT : new RegExp(merge(\"[^\\\\%]\", UNRESERVED$$, SUB_DELIMS$$, \"[\\\\:\\\\@\\\\/\\\\?]\"), \"g\"),\n\t\tESCAPE : new RegExp(merge(\"[^]\", UNRESERVED$$, SUB_DELIMS$$), \"g\"),\n\t\tUNRESERVED : new RegExp(UNRESERVED$$, \"g\"),\n\t\tOTHER_CHARS : new RegExp(merge(\"[^\\\\%]\", UNRESERVED$$, RESERVED$$), \"g\"),\n\t\tPCT_ENCODED : new RegExp(PCT_ENCODED$, \"g\"),\n\t\tIPV4ADDRESS : new RegExp(\"^(\" + IPV4ADDRESS$ + \")$\"),\n\t\tIPV6ADDRESS : new RegExp(\"^\\\\[?(\" + IPV6ADDRESS$ + \")\" + subexp(subexp(\"\\\\%25|\\\\%(?!\" + HEXDIG$$ + \"{2})\") + \"(\" + ZONEID$ + \")\") + \"?\\\\]?$\")  //RFC 6874, with relaxed parsing rules\n\t};\n}\n\nexport default buildExps(false);\n","import { URIRegExps } from \"./uri\";\nimport { buildExps } from \"./regexps-uri\";\n\nexport default buildExps(true);\n","'use strict';\n\n/** Highest positive signed 32-bit float value */\nconst maxInt = 2147483647; // aka. 0x7FFFFFFF or 2^31-1\n\n/** Bootstring parameters */\nconst base = 36;\nconst tMin = 1;\nconst tMax = 26;\nconst skew = 38;\nconst damp = 700;\nconst initialBias = 72;\nconst initialN = 128; // 0x80\nconst delimiter = '-'; // '\\x2D'\n\n/** Regular expressions */\nconst regexPunycode = /^xn--/;\nconst regexNonASCII = /[^\\0-\\x7E]/; // non-ASCII chars\nconst regexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g; // RFC 3490 separators\n\n/** Error messages */\nconst errors = {\n\t'overflow': 'Overflow: input needs wider integers to process',\n\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t'invalid-input': 'Invalid input'\n};\n\n/** Convenience shortcuts */\nconst baseMinusTMin = base - tMin;\nconst floor = Math.floor;\nconst stringFromCharCode = String.fromCharCode;\n\n/*--------------------------------------------------------------------------*/\n\n/**\n * A generic error utility function.\n * @private\n * @param {String} type The error type.\n * @returns {Error} Throws a `RangeError` with the applicable error message.\n */\nfunction error(type) {\n\tthrow new RangeError(errors[type]);\n}\n\n/**\n * A generic `Array#map` utility function.\n * @private\n * @param {Array} array The array to iterate over.\n * @param {Function} callback The function that gets called for every array\n * item.\n * @returns {Array} A new array of values returned by the callback function.\n */\nfunction map(array, fn) {\n\tconst result = [];\n\tlet length = array.length;\n\twhile (length--) {\n\t\tresult[length] = fn(array[length]);\n\t}\n\treturn result;\n}\n\n/**\n * A simple `Array#map`-like wrapper to work with domain name strings or email\n * addresses.\n * @private\n * @param {String} domain The domain name or email address.\n * @param {Function} callback The function that gets called for every\n * character.\n * @returns {Array} A new string of characters returned by the callback\n * function.\n */\nfunction mapDomain(string, fn) {\n\tconst parts = string.split('@');\n\tlet result = '';\n\tif (parts.length > 1) {\n\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t// the local part (i.e. everything up to `@`) intact.\n\t\tresult = parts[0] + '@';\n\t\tstring = parts[1];\n\t}\n\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\tstring = string.replace(regexSeparators, '\\x2E');\n\tconst labels = string.split('.');\n\tconst encoded = map(labels, fn).join('.');\n\treturn result + encoded;\n}\n\n/**\n * Creates an array containing the numeric code points of each Unicode\n * character in the string. While JavaScript uses UCS-2 internally,\n * this function will convert a pair of surrogate halves (each of which\n * UCS-2 exposes as separate characters) into a single code point,\n * matching UTF-16.\n * @see `punycode.ucs2.encode`\n * @see <https://mathiasbynens.be/notes/javascript-encoding>\n * @memberOf punycode.ucs2\n * @name decode\n * @param {String} string The Unicode input string (UCS-2).\n * @returns {Array} The new array of code points.\n */\nfunction ucs2decode(string) {\n\tconst output = [];\n\tlet counter = 0;\n\tconst length = string.length;\n\twhile (counter < length) {\n\t\tconst value = string.charCodeAt(counter++);\n\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t// It's a high surrogate, and there is a next character.\n\t\t\tconst extra = string.charCodeAt(counter++);\n\t\t\tif ((extra & 0xFC00) == 0xDC00) { // Low surrogate.\n\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t} else {\n\t\t\t\t// It's an unmatched surrogate; only append this code unit, in case the\n\t\t\t\t// next code unit is the high surrogate of a surrogate pair.\n\t\t\t\toutput.push(value);\n\t\t\t\tcounter--;\n\t\t\t}\n\t\t} else {\n\t\t\toutput.push(value);\n\t\t}\n\t}\n\treturn output;\n}\n\n/**\n * Creates a string based on an array of numeric code points.\n * @see `punycode.ucs2.decode`\n * @memberOf punycode.ucs2\n * @name encode\n * @param {Array} codePoints The array of numeric code points.\n * @returns {String} The new Unicode string (UCS-2).\n */\nconst ucs2encode = array => String.fromCodePoint(...array);\n\n/**\n * Converts a basic code point into a digit/integer.\n * @see `digitToBasic()`\n * @private\n * @param {Number} codePoint The basic numeric code point value.\n * @returns {Number} The numeric value of a basic code point (for use in\n * representing integers) in the range `0` to `base - 1`, or `base` if\n * the code point does not represent a value.\n */\nconst basicToDigit = function(codePoint) {\n\tif (codePoint - 0x30 < 0x0A) {\n\t\treturn codePoint - 0x16;\n\t}\n\tif (codePoint - 0x41 < 0x1A) {\n\t\treturn codePoint - 0x41;\n\t}\n\tif (codePoint - 0x61 < 0x1A) {\n\t\treturn codePoint - 0x61;\n\t}\n\treturn base;\n};\n\n/**\n * Converts a digit/integer into a basic code point.\n * @see `basicToDigit()`\n * @private\n * @param {Number} digit The numeric value of a basic code point.\n * @returns {Number} The basic code point whose value (when used for\n * representing integers) is `digit`, which needs to be in the range\n * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n * used; else, the lowercase form is used. The behavior is undefined\n * if `flag` is non-zero and `digit` has no uppercase form.\n */\nconst digitToBasic = function(digit, flag) {\n\t//  0..25 map to ASCII a..z or A..Z\n\t// 26..35 map to ASCII 0..9\n\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n};\n\n/**\n * Bias adaptation function as per section 3.4 of RFC 3492.\n * https://tools.ietf.org/html/rfc3492#section-3.4\n * @private\n */\nconst adapt = function(delta, numPoints, firstTime) {\n\tlet k = 0;\n\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\tdelta += floor(delta / numPoints);\n\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\tdelta = floor(delta / baseMinusTMin);\n\t}\n\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n};\n\n/**\n * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n * symbols.\n * @memberOf punycode\n * @param {String} input The Punycode string of ASCII-only symbols.\n * @returns {String} The resulting string of Unicode symbols.\n */\nconst decode = function(input) {\n\t// Don't use UCS-2.\n\tconst output = [];\n\tconst inputLength = input.length;\n\tlet i = 0;\n\tlet n = initialN;\n\tlet bias = initialBias;\n\n\t// Handle the basic code points: let `basic` be the number of input code\n\t// points before the last delimiter, or `0` if there is none, then copy\n\t// the first basic code points to the output.\n\n\tlet basic = input.lastIndexOf(delimiter);\n\tif (basic < 0) {\n\t\tbasic = 0;\n\t}\n\n\tfor (let j = 0; j < basic; ++j) {\n\t\t// if it's not a basic code point\n\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\terror('not-basic');\n\t\t}\n\t\toutput.push(input.charCodeAt(j));\n\t}\n\n\t// Main decoding loop: start just after the last delimiter if any basic code\n\t// points were copied; start at the beginning otherwise.\n\n\tfor (let index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t// `index` is the index of the next character to be consumed.\n\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t// which gets added to `i`. The overflow checking is easier\n\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t// value at the end to obtain `delta`.\n\t\tlet oldi = i;\n\t\tfor (let w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\tif (index >= inputLength) {\n\t\t\t\terror('invalid-input');\n\t\t\t}\n\n\t\t\tconst digit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\ti += digit * w;\n\t\t\tconst t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\tif (digit < t) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst baseMinusT = base - t;\n\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tw *= baseMinusT;\n\n\t\t}\n\n\t\tconst out = output.length + 1;\n\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t// incrementing `n` each time, so we'll fix that now:\n\t\tif (floor(i / out) > maxInt - n) {\n\t\t\terror('overflow');\n\t\t}\n\n\t\tn += floor(i / out);\n\t\ti %= out;\n\n\t\t// Insert `n` at position `i` of the output.\n\t\toutput.splice(i++, 0, n);\n\n\t}\n\n\treturn String.fromCodePoint(...output);\n};\n\n/**\n * Converts a string of Unicode symbols (e.g. a domain name label) to a\n * Punycode string of ASCII-only symbols.\n * @memberOf punycode\n * @param {String} input The string of Unicode symbols.\n * @returns {String} The resulting Punycode string of ASCII-only symbols.\n */\nconst encode = function(input) {\n\tconst output = [];\n\n\t// Convert the input in UCS-2 to an array of Unicode code points.\n\tinput = ucs2decode(input);\n\n\t// Cache the length.\n\tlet inputLength = input.length;\n\n\t// Initialize the state.\n\tlet n = initialN;\n\tlet delta = 0;\n\tlet bias = initialBias;\n\n\t// Handle the basic code points.\n\tfor (const currentValue of input) {\n\t\tif (currentValue < 0x80) {\n\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t}\n\t}\n\n\tlet basicLength = output.length;\n\tlet handledCPCount = basicLength;\n\n\t// `handledCPCount` is the number of code points that have been handled;\n\t// `basicLength` is the number of basic code points.\n\n\t// Finish the basic string with a delimiter unless it's empty.\n\tif (basicLength) {\n\t\toutput.push(delimiter);\n\t}\n\n\t// Main encoding loop:\n\twhile (handledCPCount < inputLength) {\n\n\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t// larger one:\n\t\tlet m = maxInt;\n\t\tfor (const currentValue of input) {\n\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\tm = currentValue;\n\t\t\t}\n\t\t}\n\n\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t// but guard against overflow.\n\t\tconst handledCPCountPlusOne = handledCPCount + 1;\n\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\terror('overflow');\n\t\t}\n\n\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\tn = m;\n\n\t\tfor (const currentValue of input) {\n\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\t\t\tif (currentValue == n) {\n\t\t\t\t// Represent delta as a generalized variable-length integer.\n\t\t\t\tlet q = delta;\n\t\t\t\tfor (let k = base; /* no condition */; k += base) {\n\t\t\t\t\tconst t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tconst qMinusT = q - t;\n\t\t\t\t\tconst baseMinusT = base - t;\n\t\t\t\t\toutput.push(\n\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t);\n\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t}\n\n\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\tdelta = 0;\n\t\t\t\t++handledCPCount;\n\t\t\t}\n\t\t}\n\n\t\t++delta;\n\t\t++n;\n\n\t}\n\treturn output.join('');\n};\n\n/**\n * Converts a Punycode string representing a domain name or an email address\n * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n * it doesn't matter if you call it on a string that has already been\n * converted to Unicode.\n * @memberOf punycode\n * @param {String} input The Punycoded domain name or email address to\n * convert to Unicode.\n * @returns {String} The Unicode representation of the given Punycode\n * string.\n */\nconst toUnicode = function(input) {\n\treturn mapDomain(input, function(string) {\n\t\treturn regexPunycode.test(string)\n\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t: string;\n\t});\n};\n\n/**\n * Converts a Unicode string representing a domain name or an email address to\n * Punycode. Only the non-ASCII parts of the domain name will be converted,\n * i.e. it doesn't matter if you call it with a domain that's already in\n * ASCII.\n * @memberOf punycode\n * @param {String} input The domain name or email address to convert, as a\n * Unicode string.\n * @returns {String} The Punycode representation of the given domain name or\n * email address.\n */\nconst toASCII = function(input) {\n\treturn mapDomain(input, function(string) {\n\t\treturn regexNonASCII.test(string)\n\t\t\t? 'xn--' + encode(string)\n\t\t\t: string;\n\t});\n};\n\n/*--------------------------------------------------------------------------*/\n\n/** Define the public API */\nconst punycode = {\n\t/**\n\t * A string representing the current Punycode.js version number.\n\t * @memberOf punycode\n\t * @type String\n\t */\n\t'version': '2.1.0',\n\t/**\n\t * An object of methods to convert from JavaScript's internal character\n\t * representation (UCS-2) to Unicode code points, and back.\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode\n\t * @type Object\n\t */\n\t'ucs2': {\n\t\t'decode': ucs2decode,\n\t\t'encode': ucs2encode\n\t},\n\t'decode': decode,\n\t'encode': encode,\n\t'toASCII': toASCII,\n\t'toUnicode': toUnicode\n};\n\nexport default punycode;\n","/**\n * URI.js\n *\n * @fileoverview An RFC 3986 compliant, scheme extendable URI parsing/validating/resolving library for JavaScript.\n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/uri-js\n */\n\n/**\n * Copyright 2011 Gary Court. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification, are\n * permitted provided that the following conditions are met:\n *\n *    1. Redistributions of source code must retain the above copyright notice, this list of\n *       conditions and the following disclaimer.\n *\n *    2. Redistributions in binary form must reproduce the above copyright notice, this list\n *       of conditions and the following disclaimer in the documentation and/or other materials\n *       provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY GARY COURT ``AS IS'' AND ANY EXPRESS OR IMPLIED\n * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL GARY COURT OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n * ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * The views and conclusions contained in the software and documentation are those of the\n * authors and should not be interpreted as representing official policies, either expressed\n * or implied, of Gary Court.\n */\n\nimport URI_PROTOCOL from \"./regexps-uri\";\nimport IRI_PROTOCOL from \"./regexps-iri\";\nimport punycode from \"punycode\";\nimport { toUpperCase, typeOf, assign } from \"./util\";\n\nexport interface URIComponents {\n\tscheme?:string;\n\tuserinfo?:string;\n\thost?:string;\n\tport?:number|string;\n\tpath?:string;\n\tquery?:string;\n\tfragment?:string;\n\treference?:string;\n\terror?:string;\n}\n\nexport interface URIOptions {\n\tscheme?:string;\n\treference?:string;\n\ttolerant?:boolean;\n\tabsolutePath?:boolean;\n\tiri?:boolean;\n\tunicodeSupport?:boolean;\n\tdomainHost?:boolean;\n}\n\nexport interface URISchemeHandler<Components extends URIComponents = URIComponents, Options extends URIOptions = URIOptions, ParentComponents extends URIComponents = URIComponents> {\n\tscheme:string;\n\tparse(components:ParentComponents, options:Options):Components;\n\tserialize(components:Components, options:Options):ParentComponents;\n\tunicodeSupport?:boolean;\n\tdomainHost?:boolean;\n\tabsolutePath?:boolean;\n}\n\nexport interface URIRegExps {\n\tNOT_SCHEME : RegExp,\n\tNOT_USERINFO : RegExp,\n\tNOT_HOST : RegExp,\n\tNOT_PATH : RegExp,\n\tNOT_PATH_NOSCHEME : RegExp,\n\tNOT_QUERY : RegExp,\n\tNOT_FRAGMENT : RegExp,\n\tESCAPE : RegExp,\n\tUNRESERVED : RegExp,\n\tOTHER_CHARS : RegExp,\n\tPCT_ENCODED : RegExp,\n\tIPV4ADDRESS : RegExp,\n\tIPV6ADDRESS : RegExp,\n}\n\nexport const SCHEMES:{[scheme:string]:URISchemeHandler} = {};\n\nexport function pctEncChar(chr:string):string {\n\tconst c = chr.charCodeAt(0);\n\tlet e:string;\n\n\tif (c < 16) e = \"%0\" + c.toString(16).toUpperCase();\n\telse if (c < 128) e = \"%\" + c.toString(16).toUpperCase();\n\telse if (c < 2048) e = \"%\" + ((c >> 6) | 192).toString(16).toUpperCase() + \"%\" + ((c & 63) | 128).toString(16).toUpperCase();\n\telse e = \"%\" + ((c >> 12) | 224).toString(16).toUpperCase() + \"%\" + (((c >> 6) & 63) | 128).toString(16).toUpperCase() + \"%\" + ((c & 63) | 128).toString(16).toUpperCase();\n\n\treturn e;\n}\n\nexport function pctDecChars(str:string):string {\n\tlet newStr = \"\";\n\tlet i = 0;\n\tconst il = str.length;\n\n\twhile (i < il) {\n\t\tconst c = parseInt(str.substr(i + 1, 2), 16);\n\n\t\tif (c < 128) {\n\t\t\tnewStr += String.fromCharCode(c);\n\t\t\ti += 3;\n\t\t}\n\t\telse if (c >= 194 && c < 224) {\n\t\t\tif ((il - i) >= 6) {\n\t\t\t\tconst c2 = parseInt(str.substr(i + 4, 2), 16);\n\t\t\t\tnewStr += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\n\t\t\t} else {\n\t\t\t\tnewStr += str.substr(i, 6);\n\t\t\t}\n\t\t\ti += 6;\n\t\t}\n\t\telse if (c >= 224) {\n\t\t\tif ((il - i) >= 9) {\n\t\t\t\tconst c2 = parseInt(str.substr(i + 4, 2), 16);\n\t\t\t\tconst c3 = parseInt(str.substr(i + 7, 2), 16);\n\t\t\t\tnewStr += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\n\t\t\t} else {\n\t\t\t\tnewStr += str.substr(i, 9);\n\t\t\t}\n\t\t\ti += 9;\n\t\t}\n\t\telse {\n\t\t\tnewStr += str.substr(i, 3);\n\t\t\ti += 3;\n\t\t}\n\t}\n\n\treturn newStr;\n}\n\nfunction _normalizeComponentEncoding(components:URIComponents, protocol:URIRegExps) {\n\tfunction decodeUnreserved(str:string):string {\n\t\tconst decStr = pctDecChars(str);\n\t\treturn (!decStr.match(protocol.UNRESERVED) ? str : decStr);\n\t}\n\n\tif (components.scheme) components.scheme = String(components.scheme).replace(protocol.PCT_ENCODED, decodeUnreserved).toLowerCase().replace(protocol.NOT_SCHEME, \"\");\n\tif (components.userinfo !== undefined) components.userinfo = String(components.userinfo).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_USERINFO, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n\tif (components.host !== undefined) components.host = String(components.host).replace(protocol.PCT_ENCODED, decodeUnreserved).toLowerCase().replace(protocol.NOT_HOST, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n\tif (components.path !== undefined) components.path = String(components.path).replace(protocol.PCT_ENCODED, decodeUnreserved).replace((components.scheme ? protocol.NOT_PATH : protocol.NOT_PATH_NOSCHEME), pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n\tif (components.query !== undefined) components.query = String(components.query).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_QUERY, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n\tif (components.fragment !== undefined) components.fragment = String(components.fragment).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_FRAGMENT, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);\n\n\treturn components;\n};\n\nfunction _stripLeadingZeros(str:string):string {\n\treturn str.replace(/^0*(.*)/, \"$1\") || \"0\";\n}\n\nfunction _normalizeIPv4(host:string, protocol:URIRegExps):string {\n\tconst matches = host.match(protocol.IPV4ADDRESS) || [];\n\tconst [, address] = matches;\n\t\n\tif (address) {\n\t\treturn address.split(\".\").map(_stripLeadingZeros).join(\".\");\n\t} else {\n\t\treturn host;\n\t}\n}\n\nfunction _normalizeIPv6(host:string, protocol:URIRegExps):string {\n\tconst matches = host.match(protocol.IPV6ADDRESS) || [];\n\tconst [, address, zone] = matches;\n\n\tif (address) {\n\t\tconst [last, first] = address.toLowerCase().split('::').reverse();\n\t\tconst firstFields = first ? first.split(\":\").map(_stripLeadingZeros) : [];\n\t\tconst lastFields = last.split(\":\").map(_stripLeadingZeros);\n\t\tconst isLastFieldIPv4Address = protocol.IPV4ADDRESS.test(lastFields[lastFields.length - 1]);\n\t\tconst fieldCount = isLastFieldIPv4Address ? 7 : 8;\n\t\tconst lastFieldsStart = lastFields.length - fieldCount;\n\t\tconst fields = Array<string>(fieldCount);\n\n\t\tfor (let x = 0; x < fieldCount; ++x) {\n\t\t\tfields[x] = firstFields[x] || lastFields[lastFieldsStart + x] || '';\n\t\t}\n\n\t\tif (isLastFieldIPv4Address) {\n\t\t\tfields[fieldCount - 1] = _normalizeIPv4(fields[fieldCount - 1], protocol);\n\t\t}\n\n\t\tconst allZeroFields = fields.reduce<Array<{index:number,length:number}>>((acc, field, index) => {\n\t\t\tif (!field || field === \"0\") {\n\t\t\t\tconst lastLongest = acc[acc.length - 1];\n\t\t\t\tif (lastLongest && lastLongest.index + lastLongest.length === index) {\n\t\t\t\t\tlastLongest.length++;\n\t\t\t\t} else {\n\t\t\t\t\tacc.push({ index, length : 1 });\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn acc;\n\t\t}, []);\n\n\t\tconst longestZeroFields = allZeroFields.sort((a, b) => b.length - a.length)[0];\n\n\t\tlet newHost:string;\n\t\tif (longestZeroFields && longestZeroFields.length > 1) {\n\t\t\tconst newFirst = fields.slice(0, longestZeroFields.index) ;\n\t\t\tconst newLast = fields.slice(longestZeroFields.index + longestZeroFields.length);\n\t\t\tnewHost = newFirst.join(\":\") + \"::\" + newLast.join(\":\");\n\t\t} else {\n\t\t\tnewHost = fields.join(\":\");\n\t\t}\n\n\t\tif (zone) {\n\t\t\tnewHost += \"%\" + zone;\n\t\t}\n\n\t\treturn newHost;\n\t} else {\n\t\treturn host;\n\t}\n}\n\nconst URI_PARSE = /^(?:([^:\\/?#]+):)?(?:\\/\\/((?:([^\\/?#@]*)@)?(\\[[^\\/?#\\]]+\\]|[^\\/?#:]*)(?:\\:(\\d*))?))?([^?#]*)(?:\\?([^#]*))?(?:#((?:.|\\n|\\r)*))?/i;\nconst NO_MATCH_IS_UNDEFINED = (<RegExpMatchArray>(\"\").match(/(){0}/))[1] === undefined;\n\nexport function parse(uriString:string, options:URIOptions = {}):URIComponents {\n\tconst components:URIComponents = {};\n\tconst protocol = (options.iri !== false ? IRI_PROTOCOL : URI_PROTOCOL);\n\n\tif (options.reference === \"suffix\") uriString = (options.scheme ? options.scheme + \":\" : \"\") + \"//\" + uriString;\n\n\tconst matches = uriString.match(URI_PARSE);\n\n\tif (matches) {\n\t\tif (NO_MATCH_IS_UNDEFINED) {\n\t\t\t//store each component\n\t\t\tcomponents.scheme = matches[1];\n\t\t\tcomponents.userinfo = matches[3];\n\t\t\tcomponents.host = matches[4];\n\t\t\tcomponents.port = parseInt(matches[5], 10);\n\t\t\tcomponents.path = matches[6] || \"\";\n\t\t\tcomponents.query = matches[7];\n\t\t\tcomponents.fragment = matches[8];\n\n\t\t\t//fix port number\n\t\t\tif (isNaN(components.port)) {\n\t\t\t\tcomponents.port = matches[5];\n\t\t\t}\n\t\t} else {  //IE FIX for improper RegExp matching\n\t\t\t//store each component\n\t\t\tcomponents.scheme = matches[1] || undefined;\n\t\t\tcomponents.userinfo = (uriString.indexOf(\"@\") !== -1 ? matches[3] : undefined);\n\t\t\tcomponents.host = (uriString.indexOf(\"//\") !== -1 ? matches[4] : undefined);\n\t\t\tcomponents.port = parseInt(matches[5], 10);\n\t\t\tcomponents.path = matches[6] || \"\";\n\t\t\tcomponents.query = (uriString.indexOf(\"?\") !== -1 ? matches[7] : undefined);\n\t\t\tcomponents.fragment = (uriString.indexOf(\"#\") !== -1 ? matches[8] : undefined);\n\n\t\t\t//fix port number\n\t\t\tif (isNaN(components.port)) {\n\t\t\t\tcomponents.port = (uriString.match(/\\/\\/(?:.|\\n)*\\:(?:\\/|\\?|\\#|$)/) ? matches[4] : undefined);\n\t\t\t}\n\t\t}\n\n\t\tif (components.host) {\n\t\t\t//normalize IP hosts\n\t\t\tcomponents.host = _normalizeIPv6(_normalizeIPv4(components.host, protocol), protocol);\n\t\t}\n\n\t\t//determine reference type\n\t\tif (components.scheme === undefined && components.userinfo === undefined && components.host === undefined && components.port === undefined && !components.path && components.query === undefined) {\n\t\t\tcomponents.reference = \"same-document\";\n\t\t} else if (components.scheme === undefined) {\n\t\t\tcomponents.reference = \"relative\";\n\t\t} else if (components.fragment === undefined) {\n\t\t\tcomponents.reference = \"absolute\";\n\t\t} else {\n\t\t\tcomponents.reference = \"uri\";\n\t\t}\n\n\t\t//check for reference errors\n\t\tif (options.reference && options.reference !== \"suffix\" && options.reference !== components.reference) {\n\t\t\tcomponents.error = components.error || \"URI is not a \" + options.reference + \" reference.\";\n\t\t}\n\n\t\t//find scheme handler\n\t\tconst schemeHandler = SCHEMES[(options.scheme || components.scheme || \"\").toLowerCase()];\n\n\t\t//check if scheme can't handle IRIs\n\t\tif (!options.unicodeSupport && (!schemeHandler || !schemeHandler.unicodeSupport)) {\n\t\t\t//if host component is a domain name\n\t\t\tif (components.host && (options.domainHost || (schemeHandler && schemeHandler.domainHost))) {\n\t\t\t\t//convert Unicode IDN -> ASCII IDN\n\t\t\t\ttry {\n\t\t\t\t\tcomponents.host = punycode.toASCII(components.host.replace(protocol.PCT_ENCODED, pctDecChars).toLowerCase());\n\t\t\t\t} catch (e) {\n\t\t\t\t\tcomponents.error = components.error || \"Host's domain name can not be converted to ASCII via punycode: \" + e;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//convert IRI -> URI\n\t\t\t_normalizeComponentEncoding(components, URI_PROTOCOL);\n\t\t} else {\n\t\t\t//normalize encodings\n\t\t\t_normalizeComponentEncoding(components, protocol);\n\t\t}\n\n\t\t//perform scheme specific parsing\n\t\tif (schemeHandler && schemeHandler.parse) {\n\t\t\tschemeHandler.parse(components, options);\n\t\t}\n\t} else {\n\t\tcomponents.error = components.error || \"URI can not be parsed.\";\n\t}\n\n\treturn components;\n};\n\nfunction _recomposeAuthority(components:URIComponents, options:URIOptions):string|undefined {\n\tconst protocol = (options.iri !== false ? IRI_PROTOCOL : URI_PROTOCOL);\n\tconst uriTokens:Array<string> = [];\n\n\tif (components.userinfo !== undefined) {\n\t\turiTokens.push(components.userinfo);\n\t\turiTokens.push(\"@\");\n\t}\n\n\tif (components.host !== undefined) {\n\t\t//normalize IP hosts, add brackets and escape zone separator for IPv6\n\t\turiTokens.push(_normalizeIPv6(_normalizeIPv4(String(components.host), protocol), protocol).replace(protocol.IPV6ADDRESS, (_, $1, $2) => \"[\" + $1 + ($2 ? \"%25\" + $2 : \"\") + \"]\"));\n\t}\n\n\tif (typeof components.port === \"number\") {\n\t\turiTokens.push(\":\");\n\t\turiTokens.push(components.port.toString(10));\n\t}\n\n\treturn uriTokens.length ? uriTokens.join(\"\") : undefined;\n};\n\nconst RDS1 = /^\\.\\.?\\//;\nconst RDS2 = /^\\/\\.(\\/|$)/;\nconst RDS3 = /^\\/\\.\\.(\\/|$)/;\nconst RDS4 = /^\\.\\.?$/;\nconst RDS5 = /^\\/?(?:.|\\n)*?(?=\\/|$)/;\n\nexport function removeDotSegments(input:string):string {\n\tconst output:Array<string> = [];\n\n\twhile (input.length) {\n\t\tif (input.match(RDS1)) {\n\t\t\tinput = input.replace(RDS1, \"\");\n\t\t} else if (input.match(RDS2)) {\n\t\t\tinput = input.replace(RDS2, \"/\");\n\t\t} else if (input.match(RDS3)) {\n\t\t\tinput = input.replace(RDS3, \"/\");\n\t\t\toutput.pop();\n\t\t} else if (input === \".\" || input === \"..\") {\n\t\t\tinput = \"\";\n\t\t} else {\n\t\t\tconst im = input.match(RDS5);\n\t\t\tif (im) {\n\t\t\t\tconst s = im[0];\n\t\t\t\tinput = input.slice(s.length);\n\t\t\t\toutput.push(s);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unexpected dot segment condition\");\n\t\t\t}\n\t\t}\n\t}\n\n\treturn output.join(\"\");\n};\n\nexport function serialize(components:URIComponents, options:URIOptions = {}):string {\n\tconst protocol = (options.iri ? IRI_PROTOCOL : URI_PROTOCOL);\n\tconst uriTokens:Array<string> = [];\n\n\t//find scheme handler\n\tconst schemeHandler = SCHEMES[(options.scheme || components.scheme || \"\").toLowerCase()];\n\n\t//perform scheme specific serialization\n\tif (schemeHandler && schemeHandler.serialize) schemeHandler.serialize(components, options);\n\n\tif (components.host) {\n\t\t//if host component is an IPv6 address\n\t\tif (protocol.IPV6ADDRESS.test(components.host)) {\n\t\t\t//TODO: normalize IPv6 address as per RFC 5952\n\t\t}\n\n\t\t//if host component is a domain name\n\t\telse if (options.domainHost || (schemeHandler && schemeHandler.domainHost)) {\n\t\t\t//convert IDN via punycode\n\t\t\ttry {\n\t\t\t\tcomponents.host = (!options.iri ? punycode.toASCII(components.host.replace(protocol.PCT_ENCODED, pctDecChars).toLowerCase()) : punycode.toUnicode(components.host));\n\t\t\t} catch (e) {\n\t\t\t\tcomponents.error = components.error || \"Host's domain name can not be converted to \" + (!options.iri ? \"ASCII\" : \"Unicode\") + \" via punycode: \" + e;\n\t\t\t}\n\t\t}\n\t}\n\n\t//normalize encoding\n\t_normalizeComponentEncoding(components, protocol);\n\n\tif (options.reference !== \"suffix\" && components.scheme) {\n\t\turiTokens.push(components.scheme);\n\t\turiTokens.push(\":\");\n\t}\n\n\tconst authority = _recomposeAuthority(components, options);\n\tif (authority !== undefined) {\n\t\tif (options.reference !== \"suffix\") {\n\t\t\turiTokens.push(\"//\");\n\t\t}\n\n\t\turiTokens.push(authority);\n\n\t\tif (components.path && components.path.charAt(0) !== \"/\") {\n\t\t\turiTokens.push(\"/\");\n\t\t}\n\t}\n\n\tif (components.path !== undefined) {\n\t\tlet s = components.path;\n\n\t\tif (!options.absolutePath && (!schemeHandler || !schemeHandler.absolutePath)) {\n\t\t\ts = removeDotSegments(s);\n\t\t}\n\n\t\tif (authority === undefined) {\n\t\t\ts = s.replace(/^\\/\\//, \"/%2F\");  //don't allow the path to start with \"//\"\n\t\t}\n\n\t\turiTokens.push(s);\n\t}\n\n\tif (components.query !== undefined) {\n\t\turiTokens.push(\"?\");\n\t\turiTokens.push(components.query);\n\t}\n\n\tif (components.fragment !== undefined) {\n\t\turiTokens.push(\"#\");\n\t\turiTokens.push(components.fragment);\n\t}\n\n\treturn uriTokens.join(\"\");  //merge tokens into a string\n};\n\nexport function resolveComponents(base:URIComponents, relative:URIComponents, options:URIOptions = {}, skipNormalization?:boolean):URIComponents {\n\tconst target:URIComponents = {};\n\n\tif (!skipNormalization) {\n\t\tbase = parse(serialize(base, options), options);  //normalize base components\n\t\trelative = parse(serialize(relative, options), options);  //normalize relative components\n\t}\n\toptions = options || {};\n\n\tif (!options.tolerant && relative.scheme) {\n\t\ttarget.scheme = relative.scheme;\n\t\t//target.authority = relative.authority;\n\t\ttarget.userinfo = relative.userinfo;\n\t\ttarget.host = relative.host;\n\t\ttarget.port = relative.port;\n\t\ttarget.path = removeDotSegments(relative.path || \"\");\n\t\ttarget.query = relative.query;\n\t} else {\n\t\tif (relative.userinfo !== undefined || relative.host !== undefined || relative.port !== undefined) {\n\t\t\t//target.authority = relative.authority;\n\t\t\ttarget.userinfo = relative.userinfo;\n\t\t\ttarget.host = relative.host;\n\t\t\ttarget.port = relative.port;\n\t\t\ttarget.path = removeDotSegments(relative.path || \"\");\n\t\t\ttarget.query = relative.query;\n\t\t} else {\n\t\t\tif (!relative.path) {\n\t\t\t\ttarget.path = base.path;\n\t\t\t\tif (relative.query !== undefined) {\n\t\t\t\t\ttarget.query = relative.query;\n\t\t\t\t} else {\n\t\t\t\t\ttarget.query = base.query;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (relative.path.charAt(0) === \"/\") {\n\t\t\t\t\ttarget.path = removeDotSegments(relative.path);\n\t\t\t\t} else {\n\t\t\t\t\tif ((base.userinfo !== undefined || base.host !== undefined || base.port !== undefined) && !base.path) {\n\t\t\t\t\t\ttarget.path = \"/\" + relative.path;\n\t\t\t\t\t} else if (!base.path) {\n\t\t\t\t\t\ttarget.path = relative.path;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttarget.path = base.path.slice(0, base.path.lastIndexOf(\"/\") + 1) + relative.path;\n\t\t\t\t\t}\n\t\t\t\t\ttarget.path = removeDotSegments(target.path);\n\t\t\t\t}\n\t\t\t\ttarget.query = relative.query;\n\t\t\t}\n\t\t\t//target.authority = base.authority;\n\t\t\ttarget.userinfo = base.userinfo;\n\t\t\ttarget.host = base.host;\n\t\t\ttarget.port = base.port;\n\t\t}\n\t\ttarget.scheme = base.scheme;\n\t}\n\n\ttarget.fragment = relative.fragment;\n\n\treturn target;\n};\n\nexport function resolve(baseURI:string, relativeURI:string, options?:URIOptions):string {\n\tconst schemelessOptions = assign({ scheme : 'null' }, options);\n\treturn serialize(resolveComponents(parse(baseURI, schemelessOptions), parse(relativeURI, schemelessOptions), schemelessOptions, true), schemelessOptions);\n};\n\nexport function normalize(uri:string, options?:URIOptions):string;\nexport function normalize(uri:URIComponents, options?:URIOptions):URIComponents;\nexport function normalize(uri:any, options?:URIOptions):any {\n\tif (typeof uri === \"string\") {\n\t\turi = serialize(parse(uri, options), options);\n\t} else if (typeOf(uri) === \"object\") {\n\t\turi = parse(serialize(<URIComponents>uri, options), options);\n\t}\n\n\treturn uri;\n};\n\nexport function equal(uriA:string, uriB:string, options?: URIOptions):boolean;\nexport function equal(uriA:URIComponents, uriB:URIComponents, options?:URIOptions):boolean;\nexport function equal(uriA:any, uriB:any, options?:URIOptions):boolean {\n\tif (typeof uriA === \"string\") {\n\t\turiA = serialize(parse(uriA, options), options);\n\t} else if (typeOf(uriA) === \"object\") {\n\t\turiA = serialize(<URIComponents>uriA, options);\n\t}\n\n\tif (typeof uriB === \"string\") {\n\t\turiB = serialize(parse(uriB, options), options);\n\t} else if (typeOf(uriB) === \"object\") {\n\t\turiB = serialize(<URIComponents>uriB, options);\n\t}\n\n\treturn uriA === uriB;\n};\n\nexport function escapeComponent(str:string, options?:URIOptions):string {\n\treturn str && str.toString().replace((!options || !options.iri ? URI_PROTOCOL.ESCAPE : IRI_PROTOCOL.ESCAPE), pctEncChar);\n};\n\nexport function unescapeComponent(str:string, options?:URIOptions):string {\n\treturn str && str.toString().replace((!options || !options.iri ? URI_PROTOCOL.PCT_ENCODED : IRI_PROTOCOL.PCT_ENCODED), pctDecChars);\n};\n","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\n\nconst handler:URISchemeHandler = {\n\tscheme : \"http\",\n\n\tdomainHost : true,\n\n\tparse : function (components:URIComponents, options:URIOptions):URIComponents {\n\t\t//report missing host\n\t\tif (!components.host) {\n\t\t\tcomponents.error = components.error || \"HTTP URIs must have a host.\";\n\t\t}\n\n\t\treturn components;\n\t},\n\n\tserialize : function (components:URIComponents, options:URIOptions):URIComponents {\n\t\t//normalize the default port\n\t\tif (components.port === (String(components.scheme).toLowerCase() !== \"https\" ? 80 : 443) || components.port === \"\") {\n\t\t\tcomponents.port = undefined;\n\t\t}\n\t\t\n\t\t//normalize the empty path\n\t\tif (!components.path) {\n\t\t\tcomponents.path = \"/\";\n\t\t}\n\n\t\t//NOTE: We do not parse query strings for HTTP URIs\n\t\t//as WWW Form Url Encoded query strings are part of the HTML4+ spec,\n\t\t//and not the HTTP spec.\n\n\t\treturn components;\n\t}\n};\n\nexport default handler;","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\nimport http from \"./http\";\n\nconst handler:URISchemeHandler = {\n\tscheme : \"https\",\n\tdomainHost : http.domainHost,\n\tparse : http.parse,\n\tserialize : http.serialize\n}\n\nexport default handler;","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\nimport { pctEncChar, pctDecChars, unescapeComponent } from \"../uri\";\nimport punycode from \"punycode\";\nimport { merge, subexp, toUpperCase, toArray } from \"../util\";\n\nexport interface MailtoHeaders {\n\t[hfname:string]:string\n}\n\nexport interface MailtoComponents extends URIComponents {\n\tto:Array<string>,\n\theaders?:MailtoHeaders,\n\tsubject?:string,\n\tbody?:string\n}\n\nconst O:MailtoHeaders = {};\nconst isIRI = true;\n\n//RFC 3986\nconst UNRESERVED$$ = \"[A-Za-z0-9\\\\-\\\\.\\\\_\\\\~\" + (isIRI ? \"\\\\xA0-\\\\u200D\\\\u2010-\\\\u2029\\\\u202F-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF\" : \"\") + \"]\";\nconst HEXDIG$$ = \"[0-9A-Fa-f]\";  //case-insensitive\nconst PCT_ENCODED$ = subexp(subexp(\"%[EFef]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%[89A-Fa-f]\" + HEXDIG$$ + \"%\" + HEXDIG$$ + HEXDIG$$) + \"|\" + subexp(\"%\" + HEXDIG$$ + HEXDIG$$));  //expanded\n\n//RFC 5322, except these symbols as per RFC 6068: @ : / ? # [ ] & ; =\n//const ATEXT$$ = \"[A-Za-z0-9\\\\!\\\\#\\\\$\\\\%\\\\&\\\\'\\\\*\\\\+\\\\-\\\\/\\\\=\\\\?\\\\^\\\\_\\\\`\\\\{\\\\|\\\\}\\\\~]\";\n//const WSP$$ = \"[\\\\x20\\\\x09]\";\n//const OBS_QTEXT$$ = \"[\\\\x01-\\\\x08\\\\x0B\\\\x0C\\\\x0E-\\\\x1F\\\\x7F]\";  //(%d1-8 / %d11-12 / %d14-31 / %d127)\n//const QTEXT$$ = merge(\"[\\\\x21\\\\x23-\\\\x5B\\\\x5D-\\\\x7E]\", OBS_QTEXT$$);  //%d33 / %d35-91 / %d93-126 / obs-qtext\n//const VCHAR$$ = \"[\\\\x21-\\\\x7E]\";\n//const WSP$$ = \"[\\\\x20\\\\x09]\";\n//const OBS_QP$ = subexp(\"\\\\\\\\\" + merge(\"[\\\\x00\\\\x0D\\\\x0A]\", OBS_QTEXT$$));  //%d0 / CR / LF / obs-qtext\n//const FWS$ = subexp(subexp(WSP$$ + \"*\" + \"\\\\x0D\\\\x0A\") + \"?\" + WSP$$ + \"+\");\n//const QUOTED_PAIR$ = subexp(subexp(\"\\\\\\\\\" + subexp(VCHAR$$ + \"|\" + WSP$$)) + \"|\" + OBS_QP$);\n//const QUOTED_STRING$ = subexp('\\\\\"' + subexp(FWS$ + \"?\" + QCONTENT$) + \"*\" + FWS$ + \"?\" + '\\\\\"');\nconst ATEXT$$ = \"[A-Za-z0-9\\\\!\\\\$\\\\%\\\\'\\\\*\\\\+\\\\-\\\\^\\\\_\\\\`\\\\{\\\\|\\\\}\\\\~]\";\nconst QTEXT$$ = \"[\\\\!\\\\$\\\\%\\\\'\\\\(\\\\)\\\\*\\\\+\\\\,\\\\-\\\\.0-9\\\\<\\\\>A-Z\\\\x5E-\\\\x7E]\";\nconst VCHAR$$ = merge(QTEXT$$, \"[\\\\\\\"\\\\\\\\]\");\nconst DOT_ATOM_TEXT$ = subexp(ATEXT$$ + \"+\" + subexp(\"\\\\.\" + ATEXT$$ + \"+\") + \"*\");\nconst QUOTED_PAIR$ = subexp(\"\\\\\\\\\" + VCHAR$$);\nconst QCONTENT$ = subexp(QTEXT$$ + \"|\" + QUOTED_PAIR$);\nconst QUOTED_STRING$ = subexp('\\\\\"' + QCONTENT$ + \"*\" + '\\\\\"');\n\n//RFC 6068\nconst DTEXT_NO_OBS$$ = \"[\\\\x21-\\\\x5A\\\\x5E-\\\\x7E]\";  //%d33-90 / %d94-126\nconst SOME_DELIMS$$ = \"[\\\\!\\\\$\\\\'\\\\(\\\\)\\\\*\\\\+\\\\,\\\\;\\\\:\\\\@]\";\nconst QCHAR$ = subexp(UNRESERVED$$ + \"|\" + PCT_ENCODED$ + \"|\" + SOME_DELIMS$$);\nconst DOMAIN$ = subexp(DOT_ATOM_TEXT$ + \"|\" + \"\\\\[\" + DTEXT_NO_OBS$$ + \"*\" + \"\\\\]\");\nconst LOCAL_PART$ = subexp(DOT_ATOM_TEXT$ + \"|\" + QUOTED_STRING$);\nconst ADDR_SPEC$ = subexp(LOCAL_PART$ + \"\\\\@\" + DOMAIN$);\nconst TO$ = subexp(ADDR_SPEC$ + subexp(\"\\\\,\" + ADDR_SPEC$) + \"*\");\nconst HFNAME$ = subexp(QCHAR$ + \"*\");\nconst HFVALUE$ = HFNAME$;\nconst HFIELD$ = subexp(HFNAME$ + \"\\\\=\" + HFVALUE$);\nconst HFIELDS2$ = subexp(HFIELD$ + subexp(\"\\\\&\" + HFIELD$) + \"*\");\nconst HFIELDS$ = subexp(\"\\\\?\" + HFIELDS2$);\nconst MAILTO_URI = new RegExp(\"^mailto\\\\:\" + TO$ + \"?\" + HFIELDS$ + \"?$\");\n\nconst UNRESERVED = new RegExp(UNRESERVED$$, \"g\");\nconst PCT_ENCODED = new RegExp(PCT_ENCODED$, \"g\");\nconst NOT_LOCAL_PART = new RegExp(merge(\"[^]\", ATEXT$$, \"[\\\\.]\", '[\\\\\"]', VCHAR$$), \"g\");\nconst NOT_DOMAIN = new RegExp(merge(\"[^]\", ATEXT$$, \"[\\\\.]\", \"[\\\\[]\", DTEXT_NO_OBS$$, \"[\\\\]]\"), \"g\");\nconst NOT_HFNAME = new RegExp(merge(\"[^]\", UNRESERVED$$, SOME_DELIMS$$), \"g\");\nconst NOT_HFVALUE = NOT_HFNAME;\nconst TO = new RegExp(\"^\" + TO$ + \"$\");\nconst HFIELDS = new RegExp(\"^\" + HFIELDS2$ + \"$\");\n\nfunction decodeUnreserved(str:string):string {\n\tconst decStr = pctDecChars(str);\n\treturn (!decStr.match(UNRESERVED) ? str : decStr);\n}\n\nconst handler:URISchemeHandler<MailtoComponents> =  {\n\tscheme : \"mailto\",\n\n\tparse : function (components:URIComponents, options:URIOptions):MailtoComponents {\n\t\tconst mailtoComponents = components as MailtoComponents;\n\t\tconst to = mailtoComponents.to = (mailtoComponents.path ? mailtoComponents.path.split(\",\") : []);\n\t\tmailtoComponents.path = undefined;\n\n\t\tif (mailtoComponents.query) {\n\t\t\tlet unknownHeaders = false\n\t\t\tconst headers:MailtoHeaders = {};\n\t\t\tconst hfields = mailtoComponents.query.split(\"&\");\n\n\t\t\tfor (let x = 0, xl = hfields.length; x < xl; ++x) {\n\t\t\t\tconst hfield = hfields[x].split(\"=\");\n\n\t\t\t\tswitch (hfield[0]) {\n\t\t\t\t\tcase \"to\":\n\t\t\t\t\t\tconst toAddrs = hfield[1].split(\",\");\n\t\t\t\t\t\tfor (let x = 0, xl = toAddrs.length; x < xl; ++x) {\n\t\t\t\t\t\t\tto.push(toAddrs[x]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"subject\":\n\t\t\t\t\t\tmailtoComponents.subject = unescapeComponent(hfield[1], options);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"body\":\n\t\t\t\t\t\tmailtoComponents.body = unescapeComponent(hfield[1], options);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tunknownHeaders = true;\n\t\t\t\t\t\theaders[unescapeComponent(hfield[0], options)] = unescapeComponent(hfield[1], options);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (unknownHeaders) mailtoComponents.headers = headers;\n\t\t}\n\n\t\tmailtoComponents.query = undefined;\n\n\t\tfor (let x = 0, xl = to.length; x < xl; ++x) {\n\t\t\tconst addr = to[x].split(\"@\");\n\n\t\t\taddr[0] = unescapeComponent(addr[0]);\n\n\t\t\tif (!options.unicodeSupport) {\n\t\t\t\t//convert Unicode IDN -> ASCII IDN\n\t\t\t\ttry {\n\t\t\t\t\taddr[1] = punycode.toASCII(unescapeComponent(addr[1], options).toLowerCase());\n\t\t\t\t} catch (e) {\n\t\t\t\t\tmailtoComponents.error = mailtoComponents.error || \"Email address's domain name can not be converted to ASCII via punycode: \" + e;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\taddr[1] = unescapeComponent(addr[1], options).toLowerCase();\n\t\t\t}\n\n\t\t\tto[x] = addr.join(\"@\");\n\t\t}\n\n\t\treturn mailtoComponents;\n\t},\n\n\tserialize : function (mailtoComponents:MailtoComponents, options:URIOptions):URIComponents {\n\t\tconst components = mailtoComponents as URIComponents;\n\t\tconst to = toArray(mailtoComponents.to);\n\t\tif (to) {\n\t\t\tfor (let x = 0, xl = to.length; x < xl; ++x) {\n\t\t\t\tconst toAddr = String(to[x]);\n\t\t\t\tconst atIdx = toAddr.lastIndexOf(\"@\");\n\t\t\t\tconst localPart = (toAddr.slice(0, atIdx)).replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_LOCAL_PART, pctEncChar);\n\t\t\t\tlet domain = toAddr.slice(atIdx + 1);\n\n\t\t\t\t//convert IDN via punycode\n\t\t\t\ttry {\n\t\t\t\t\tdomain = (!options.iri ? punycode.toASCII(unescapeComponent(domain, options).toLowerCase()) : punycode.toUnicode(domain));\n\t\t\t\t} catch (e) {\n\t\t\t\t\tcomponents.error = components.error || \"Email address's domain name can not be converted to \" + (!options.iri ? \"ASCII\" : \"Unicode\") + \" via punycode: \" + e;\n\t\t\t\t}\n\n\t\t\t\tto[x] = localPart + \"@\" + domain;\n\t\t\t}\n\n\t\t\tcomponents.path = to.join(\",\");\n\t\t}\n\n\t\tconst headers = mailtoComponents.headers = mailtoComponents.headers || {};\n\n\t\tif (mailtoComponents.subject) headers[\"subject\"] = mailtoComponents.subject;\n\t\tif (mailtoComponents.body) headers[\"body\"] = mailtoComponents.body;\n\n\t\tconst fields = [];\n\t\tfor (const name in headers) {\n\t\t\tif (headers[name] !== O[name]) {\n\t\t\t\tfields.push(\n\t\t\t\t\tname.replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_HFNAME, pctEncChar) +\n\t\t\t\t\t\"=\" +\n\t\t\t\t\theaders[name].replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_HFVALUE, pctEncChar)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tif (fields.length) {\n\t\t\tcomponents.query = fields.join(\"&\");\n\t\t}\n\n\t\treturn components;\n\t}\n}\n\nexport default handler;","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\nimport { pctEncChar, SCHEMES } from \"../uri\";\n\nexport interface URNComponents extends URIComponents {\n\tnid?:string;\n\tnss?:string;\n}\n\nexport interface URNOptions extends URIOptions {\n\tnid?:string;\n}\n\nconst NID$ = \"(?:[0-9A-Za-z][0-9A-Za-z\\\\-]{1,31})\";\nconst PCT_ENCODED$ = \"(?:\\\\%[0-9A-Fa-f]{2})\";\nconst TRANS$$ = \"[0-9A-Za-z\\\\(\\\\)\\\\+\\\\,\\\\-\\\\.\\\\:\\\\=\\\\@\\\\;\\\\$\\\\_\\\\!\\\\*\\\\'\\\\/\\\\?\\\\#]\";\nconst NSS$ = \"(?:(?:\" + PCT_ENCODED$ + \"|\" + TRANS$$ + \")+)\";\nconst URN_SCHEME = new RegExp(\"^urn\\\\:(\" + NID$ + \")$\");\nconst URN_PATH = new RegExp(\"^(\" + NID$ + \")\\\\:(\" + NSS$ + \")$\");\nconst URN_PARSE = /^([^\\:]+)\\:(.*)/;\nconst URN_EXCLUDED = /[\\x00-\\x20\\\\\\\"\\&\\<\\>\\[\\]\\^\\`\\{\\|\\}\\~\\x7F-\\xFF]/g;\n\n//RFC 2141\nconst handler:URISchemeHandler<URNComponents,URNOptions> = {\n\tscheme : \"urn\",\n\n\tparse : function (components:URIComponents, options:URNOptions):URNComponents {\n\t\tconst matches = components.path && components.path.match(URN_PARSE);\n\t\tlet urnComponents = components as URNComponents;\n\n\t\tif (matches) {\n\t\t\tconst scheme = options.scheme || urnComponents.scheme || \"urn\";\n\t\t\tconst nid = matches[1].toLowerCase();\n\t\t\tconst nss = matches[2];\n\t\t\tconst urnScheme = `${scheme}:${options.nid || nid}`;\n\t\t\tconst schemeHandler = SCHEMES[urnScheme];\n\n\t\t\turnComponents.nid = nid;\n\t\t\turnComponents.nss = nss;\n\t\t\turnComponents.path = undefined;\n\n\t\t\tif (schemeHandler) {\n\t\t\t\turnComponents = schemeHandler.parse(urnComponents, options) as URNComponents;\n\t\t\t}\n\t\t} else {\n\t\t\turnComponents.error = urnComponents.error || \"URN can not be parsed.\";\n\t\t}\n\n\t\treturn urnComponents;\n\t},\n\n\tserialize : function (urnComponents:URNComponents, options:URNOptions):URIComponents {\n\t\tconst scheme = options.scheme || urnComponents.scheme || \"urn\";\n\t\tconst nid = urnComponents.nid;\n\t\tconst urnScheme = `${scheme}:${options.nid || nid}`;\n\t\tconst schemeHandler = SCHEMES[urnScheme];\n\n\t\tif (schemeHandler) {\n\t\t\turnComponents = schemeHandler.serialize(urnComponents, options) as URNComponents;\n\t\t}\n\n\t\tconst uriComponents = urnComponents as URIComponents;\n\t\tconst nss = urnComponents.nss;\n\t\turiComponents.path = `${nid || options.nid}:${nss}`;\n\n\t\treturn uriComponents;\n\t},\n};\n\nexport default handler;","import { URISchemeHandler, URIComponents, URIOptions } from \"../uri\";\nimport { URNComponents } from \"./urn\";\nimport { SCHEMES } from \"../uri\";\n\nexport interface UUIDComponents extends URNComponents {\n\tuuid?: string;\n}\n\nconst UUID = /^[0-9A-Fa-f]{8}(?:\\-[0-9A-Fa-f]{4}){3}\\-[0-9A-Fa-f]{12}$/;\nconst UUID_PARSE = /^[0-9A-Fa-f\\-]{36}/;\n\n//RFC 4122\nconst handler:URISchemeHandler<UUIDComponents, URIOptions, URNComponents> = {\n\tscheme : \"urn:uuid\",\n\n\tparse : function (urnComponents:URNComponents, options:URIOptions):UUIDComponents {\n\t\tconst uuidComponents = urnComponents as UUIDComponents;\n\t\tuuidComponents.uuid = uuidComponents.nss;\n\t\tuuidComponents.nss = undefined;\n\n\t\tif (!options.tolerant && (!uuidComponents.uuid || !uuidComponents.uuid.match(UUID))) {\n\t\t\tuuidComponents.error = uuidComponents.error || \"UUID is not valid.\";\n\t\t}\n\n\t\treturn uuidComponents;\n\t},\n\n\tserialize : function (uuidComponents:UUIDComponents, options:URIOptions):URNComponents {\n\t\tconst urnComponents = uuidComponents as URNComponents;\n\t\t//normalize UUID\n\t\turnComponents.nss = (uuidComponents.uuid || \"\").toLowerCase();\n\t\treturn urnComponents;\n\t},\n};\n\nexport default handler;","import { SCHEMES } from \"./uri\";\n\nimport http from \"./schemes/http\";\nSCHEMES[http.scheme] = http;\n\nimport https from \"./schemes/https\";\nSCHEMES[https.scheme] = https;\n\nimport mailto from \"./schemes/mailto\";\nSCHEMES[mailto.scheme] = mailto;\n\nimport urn from \"./schemes/urn\";\nSCHEMES[urn.scheme] = urn;\n\nimport uuid from \"./schemes/urn-uuid\";\nSCHEMES[uuid.scheme] = uuid;\n\nexport * from \"./uri\";\n","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TUnitType, EUnitType } from \"./item\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { TUnitType, EUnitType };\n\nexport type TShaderMode = \"Default\" | \"Clay\" | \"XRay\" | \"Normals\" | \"Wireframe\";\nexport enum EShaderMode { Default, Clay, XRay, Normals, Wireframe }\n\nexport type TBackgroundType = \"Solid\" | \"LinearGradient\" | \"RadialGradient\";\nexport enum EBackgroundType { Solid, LinearGradient, RadialGradient }\n\nexport type TNavigationType = \"Orbit\" | \"Walk\";\nexport enum ENavigationType { Orbit, Walk }\n\nexport type TReaderPosition = \"Overlay\" | \"Left\" | \"Right\";\nexport enum EReaderPosition { Overlay, Left, Right }\n\n\nexport interface IConfig\n{\n    scene?: IScene;\n    reader?: IReader;\n    interface?: IInterface;\n    navigation?: INavigation;\n    background?: IBackground;\n    groundPlane?: IGroundPlane;\n    grid?: IGrid;\n    tapeTool?: ITapeTool;\n    sectionTool?: ISectionTool;\n}\n\nexport interface IScene\n{\n    units: TUnitType;\n    shader: TShaderMode;\n    exposure: number;\n    gamma: number;\n}\n\nexport interface IReader\n{\n    visible: boolean;\n    position: string;\n    url: string;\n}\n\nexport interface IInterface\n{\n    visible: boolean;\n    logo: boolean;\n}\n\nexport interface INavigation\n{\n    type: TNavigationType;\n    enabled: boolean;\n    orbit?: IOrbitNavigation;\n    walk?: IWalkNavigation;\n}\n\nexport interface IOrbitNavigation\n{\n    orbit: number[];\n    offset: number[];\n    minOrbit: number[];\n    maxOrbit: number[];\n    minOffset: number[];\n    maxOffset: number[];\n}\n\nexport interface IWalkNavigation\n{\n    position: number[];\n    rotation: number[];\n    minPosition: number[];\n    maxPosition: number[];\n}\n\nexport interface IBackground\n{\n    type: TBackgroundType;\n    color0: number[];\n    color1: number[];\n}\n\nexport interface IGroundPlane\n{\n    visible: boolean;\n    offset: number;\n    color: number[];\n    shadowVisible: boolean;\n    shadowColor: number[];\n}\n\nexport interface IGrid\n{\n    visible: boolean;\n    color: number[];\n}\n\nexport interface ITapeTool\n{\n    active: boolean;\n    startPosition: number[];\n    startDirection: number[];\n    endPosition: number[];\n    endDirection: number[];\n}\n\nexport interface ISectionTool\n{\n    active: boolean;\n    plane: number[];\n}\n","/**\r\n * 3D Foundation Project\r\n * Copyright 2018 Smithsonian Institution\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { Index, Identifier } from \"@ff/core/types\";\r\n\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nexport type TUnitType = \"mm\" | \"cm\" | \"m\" | \"in\" | \"ft\" | \"yd\";\r\nexport enum EUnitType { mm, cm, m, in, ft, yd }\r\n\r\nexport type TNormalSpaceType = \"Tangent\" | \"Object\";\r\n\r\nexport type TDerivativeUsage = \"Web2D\" | \"Web3D\" | \"Print\" | \"Editorial\";\r\nexport type TDerivativeQuality = \"Thumb\" | \"Low\" | \"Medium\" | \"High\" | \"Highest\" | \"LOD\" | \"Stream\";\r\nexport type TAssetType = \"Model\" | \"Geometry\" | \"Image\" | \"Texture\" | \"Points\" | \"Volume\";\r\nexport type TMapType = \"Color\" | \"Normal\" | \"Occlusion\" | \"Emissive\" | \"MetallicRoughness\" | \"Zone\";\r\nexport type TCurveType = \"Linear\" | \"Ease\" | \"EaseIn\" | \"EaseOut\";\r\n\r\nexport type Matrix4 = number[];\r\nexport type Vector3 = number[];\r\nexport type Vector4 = number[];\r\nexport type ColorRGB = Vector3;\r\nexport type ColorRGBA = Vector4;\r\n\r\n/**\r\n * Item node properties. Describes a Smithsonian collection item\r\n * including meta data, derivatives, annotations, tours, snapshots and process information.\r\n */\r\nexport interface IItem\r\n{\r\n    info: IItemInfo;\r\n    meta?: IMeta;\r\n    process?: IProcess;\r\n    model: IModel;\r\n    documents?: IDocuments;\r\n    annotations?: IAnnotations;\r\n}\r\n\r\nexport interface IItemInfo\r\n{\r\n    type: \"application/si-dpo-3d.item+json\";\r\n    version: string;\r\n    copyright?: string;\r\n    generator?: string;\r\n}\r\n\r\n/**\r\n * Meta data section of a collection item.\r\n */\r\nexport interface IMeta\r\n{\r\n    [id: string]: any;\r\n}\r\n\r\n/**\r\n * Model section of a collection item. Contains information about the item's\r\n * units, bounding box and derivative representations available for loading.\r\n */\r\nexport interface IModel\r\n{\r\n    units: TUnitType;\r\n    derivatives: IDerivative[];\r\n    boundingBox?: IBoundingBox;\r\n    translation?: Vector3;\r\n    rotation?: Vector4;\r\n    material?: IMaterial;\r\n}\r\n\r\n/**\r\n * Axis-aligned bounding box.\r\n */\r\nexport interface IBoundingBox\r\n{\r\n    min: Vector3;\r\n    max: Vector3;\r\n}\r\n\r\nexport interface IMaterial\r\n{\r\n    pbrMetallicRoughness?: IPBRMetallicRoughness;\r\n    normalTexture?: any;\r\n    normalSpace?: TNormalSpaceType;\r\n    occlusionTexture?: any;\r\n    occlusionStrength?: number;\r\n    emissiveTexture?: any;\r\n    emissiveFactor?: ColorRGB;\r\n    alphaMode?: any; // TODO\r\n    alphaCutoff?: number;\r\n    doubleSided?: boolean;\r\n}\r\n\r\nexport interface IPBRMetallicRoughness\r\n{\r\n    baseColorFactor?: ColorRGBA;\r\n    baseColorTexture?: any;\r\n    metallicFactor?: number;\r\n    roughnessFactor?: number;\r\n    metallicRoughnessTexture?: any;\r\n}\r\n\r\n/**\r\n * Derivative representation of a collection item.\r\n * Points to one or multiple assets (files/resources).\r\n */\r\nexport interface IDerivative\r\n{\r\n    usage: TDerivativeUsage;\r\n    quality: TDerivativeQuality;\r\n    assets: IAsset[];\r\n}\r\n\r\n/**\r\n * Describes an asset, a resource containing a mesh, model, image,\r\n * point cloud or volumetric representation.\r\n */\r\nexport interface IAsset\r\n{\r\n    uri: string;\r\n    type: TAssetType;\r\n    mimeType?: string;\r\n    byteSize?: number;\r\n    numFaces?: number;\r\n    numVertices?: number;\r\n    imageSize?: number;\r\n    mapType?: TMapType;\r\n}\r\n\r\nexport interface IDocuments\r\n{\r\n    mainDocumentId?: Identifier;\r\n    documents?: IDocument[];\r\n}\r\n\r\n/**\r\n * Refers to an external document: an article or a media file (audio, video, image).\r\n */\r\nexport interface IDocument\r\n{\r\n    id: Identifier;\r\n    title?: string;\r\n    description?: string;\r\n    uri?: string;\r\n    mimeType?: string;\r\n    thumbnailUri?: string;\r\n}\r\n\r\n/**\r\n * Describes the annotation elements of an item: anchors, documents and groups.\r\n * The top level document index points to the item's main document.\r\n */\r\nexport interface IAnnotations\r\n{\r\n    annotations?: IAnnotation[];\r\n    groups?: IGroup[];\r\n}\r\n\r\n/**\r\n * Connects annotated information to a spatial location.\r\n * Annotation targets are specific locations (spots) or areas (zones) on an item.\r\n */\r\nexport interface IAnnotation\r\n{\r\n    id: string;\r\n    title?: string;\r\n    description?: string;\r\n    style?: string;\r\n    expanded?: boolean;\r\n    documents?: Identifier[];\r\n    groups?: Identifier[];\r\n    position?: Vector3;\r\n    direction?: Vector3;\r\n    zoneIndex?: number;\r\n}\r\n\r\n/**\r\n * Anchors can be grouped. This describes an anchor group.\r\n */\r\nexport interface IGroup\r\n{\r\n    id: Identifier;\r\n    title?: string;\r\n    description?: string;\r\n    visible?: boolean;\r\n}\r\n\r\n/**\r\n * Describes the story elements of an item: snapshots and tours.\r\n */\r\nexport interface IStory\r\n{\r\n    templateUri?: string;\r\n    snapshots?: ISnapshot[];\r\n    tours?: ITour[];\r\n}\r\n\r\n/**\r\n * A snapshot captures a set of viewer/scene properties.\r\n * Snapshots can be used to bring the viewer/scene back to a specific state.\r\n */\r\nexport interface ISnapshot\r\n{\r\n    title?: string;\r\n    description?: string;\r\n    properties: ISnapshotProperty[];\r\n}\r\n\r\n/**\r\n * Unit of snapshot data.\r\n */\r\nexport interface ISnapshotProperty\r\n{\r\n    target: string;\r\n    value: any;\r\n}\r\n\r\n/**\r\n * A tour consists of a sequence of tour steps, where each step\r\n * recalls a snapshot.\r\n */\r\nexport interface ITour\r\n{\r\n    title: string;\r\n    description?: string;\r\n    steps: ITourStep[];\r\n}\r\n\r\n/**\r\n * Single step within a tour.\r\n */\r\nexport interface ITourStep\r\n{\r\n    snapshot: Index;\r\n    transitionTime?: number;\r\n    transitionCurve?: TCurveType;\r\n    transitionCutPoint?: number;\r\n}\r\n\r\n/**\r\n * Meta-data describing the capture, computation, and editorial process.\r\n */\r\nexport interface IProcess\r\n{\r\n    [key: string]: any;\r\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport resolvePathname from \"resolve-pathname\";\nimport * as THREE from \"three\";\n\nimport Component from \"@ff/graph/Component\";\n\nimport { IPresentation, IItem } from \"common/types/presentation\";\nimport Asset from \"../models/Asset\";\n\nimport JSONLoader from \"../loaders/JSONLoader\";\nimport JSONValidator from \"../loaders/JSONValidator\";\nimport ModelLoader from \"../loaders/ModelLoader\";\nimport GeometryLoader from \"../loaders/GeometryLoader\";\nimport TextureLoader from \"../loaders/TextureLoader\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _VERBOSE = false;\n\nexport default class CVLoaders extends Component\n{\n    readonly jsonLoader: JSONLoader;\n    readonly validator: JSONValidator;\n    readonly modelLoader: ModelLoader;\n    readonly geometryLoader: GeometryLoader;\n    readonly textureLoader: TextureLoader;\n\n    private _loadingManager: PrivateLoadingManager;\n\n\n    constructor(id: string)\n    {\n        super(id);\n\n        const loadingManager = this._loadingManager = new PrivateLoadingManager();\n\n        this.jsonLoader = new JSONLoader(loadingManager);\n        this.validator = new JSONValidator();\n        this.modelLoader = new ModelLoader(loadingManager);\n        this.geometryLoader = new GeometryLoader(loadingManager);\n        this.textureLoader = new TextureLoader(loadingManager);\n    }\n\n    loadJSON(url: string, path?: string): Promise<any>\n    {\n        url = resolvePathname(url, path);\n        return this.jsonLoader.load(url);\n    }\n\n    loadModel(asset: Asset, path?: string): Promise<THREE.Object3D>\n    {\n        const url = resolvePathname(asset.uri, path);\n        return this.modelLoader.load(url);\n    }\n\n    loadGeometry(asset: Asset, path?: string): Promise<THREE.Geometry>\n    {\n        const url = resolvePathname(asset.uri, path);\n        return this.geometryLoader.load(url);\n    }\n\n    loadTexture(asset: Asset, path?: string): Promise<THREE.Texture>\n    {\n        const url = resolvePathname(asset.uri, path);\n        return this.textureLoader.load(url);\n    }\n\n    validatePresentation(json: any): Promise<IPresentation>\n    {\n        return new Promise((resolve, reject) => {\n            if (!this.validator.validatePresentation(json)) {\n                return reject(new Error(\"invalid presentation data, validation failed\"));\n            }\n\n            return resolve(json as IPresentation);\n        });\n    }\n\n    validateItem(json: any): Promise<IItem>\n    {\n        return new Promise((resolve, reject) => {\n            if (!this.validator.validateItem(json)) {\n                return reject(new Error(\"invalid item data, validation failed\"));\n            }\n\n            return resolve(json as IItem);\n        });\n    }\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nclass PrivateLoadingManager extends THREE.LoadingManager\n{\n    protected onLoadingStart()\n    {\n        if (_VERBOSE) {\n            console.log(\"Loading files...\");\n        }\n    }\n\n    protected onLoadingProgress(url, itemsLoaded, itemsTotal)\n    {\n        if (_VERBOSE) {\n            console.log(`Loaded ${itemsLoaded} of ${itemsTotal} files: ${url}`);\n        }\n    }\n\n    protected onLoadingCompleted()\n    {\n        if (_VERBOSE) {\n            console.log(\"Loading completed\");\n        }\n    }\n\n    protected onLoadingError()\n    {\n        if (_VERBOSE) {\n            console.error(`Loading error`);\n        }\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as THREE from \"three\";\n\nimport * as helpers from \"@ff/three/helpers\";\n\nimport { types } from \"@ff/graph/propertyTypes\";\nimport { IComponentChangeEvent } from \"@ff/graph/Component\";\n\nimport CObject3D from \"@ff/scene/components/CObject3D\";\n\nimport { EUnitType, IModel, TUnitType, Vector3 } from \"common/types/item\";\n\nimport UberPBRMaterial, { EShaderMode } from \"../shaders/UberPBRMaterial\";\nimport Derivative, { EDerivativeQuality, EDerivativeUsage } from \"../models/Derivative\";\nimport DerivativeList from \"../models/DerivativeList\";\n\nimport CVLoaders from \"./CVLoaders\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _vec3a = new THREE.Vector3();\nconst _vec3b = new THREE.Vector3();\nconst _quat = new THREE.Quaternion();\nconst _box = new THREE.Box3();\n\nconst _unitConversionFactor = {\n    \"mm\": { \"mm\": 1, \"cm\": 0.1, \"m\": 0.001, \"in\": 0.0393701, \"ft\": 0.00328084, \"yd\": 0.00109361 },\n    \"cm\": { \"mm\": 10, \"cm\": 1, \"m\": 0.01, \"in\": 0.393701, \"ft\": 0.0328084, \"yd\": 0.0109361 },\n    \"m\": { \"mm\": 1000, \"cm\": 100, \"m\": 1, \"in\": 39.3701, \"ft\": 3.28084, \"yd\": 1.09361 },\n    \"in\": { \"mm\": 25.4, \"cm\": 2.54, \"m\": 0.0254, \"in\": 1, \"ft\": 0.0833333, \"yd\": 0.0277778 },\n    \"ft\": { \"mm\": 304.8, \"cm\": 30.48, \"m\": 0.3048, \"in\": 12, \"ft\": 1, \"yd\": 0.333334 },\n    \"yd\": { \"mm\": 914.4, \"cm\": 91.44, \"m\": 0.9144, \"in\": 36, \"ft\": 3, \"yd\": 1 },\n};\n\nexport { EShaderMode };\n\nexport interface IModelChangeEvent extends IComponentChangeEvent<CVModel>\n{\n    what: \"derivative\" | \"boundingBox\"\n}\n\nconst _inputs = {\n    units: types.Enum(\"Model.Units\", EUnitType, EUnitType.cm),\n    quality: types.Enum(\"Model.Quality\", EDerivativeQuality, EDerivativeQuality.High),\n    autoLoad: types.Boolean(\"Model.AutoLoad\", true),\n    position: types.Vector3(\"Model.Position\"),\n    rotation: types.Vector3(\"Model.Rotation\"),\n    center: types.Event(\"Model.Center\"),\n    dumpDerivatives: types.Event(\"Derivatives.Dump\"),\n};\n\nconst _outputs = {\n    globalUnits: types.Enum(\"GlobalUnits\", EUnitType, EUnitType.cm),\n    unitScale: types.Number(\"UnitScale\", { preset: 1, precision: 5 }),\n};\n\n/**\n * Renderable component representing a Voyager explorer model.\n */\nexport default class CVModel extends CObject3D\n{\n    protected static readonly rotationOrder = \"ZYX\";\n\n    ins = this.addInputs<CObject3D, typeof _inputs>(_inputs);\n    outs = this.addOutputs<CObject3D, typeof _outputs>(_outputs);\n\n    assetPath: string = \"\";\n    assetBaseName: string = \"\";\n\n    private _derivatives = new DerivativeList();\n    private _activeDerivative: Derivative = null;\n\n    private _boundingBox = new THREE.Box3();\n    private _boxFrame: THREE.Mesh = null;\n\n    get derivatives() {\n        return this._derivatives;\n    }\n    get boundingBox() {\n        return this._boundingBox;\n    }\n    get activeDerivative() {\n        return this._activeDerivative;\n    }\n\n    create()\n    {\n        super.create();\n        this.object3D = new THREE.Group();\n    }\n\n    update()\n    {\n        const ins = this.ins;\n\n        if (!this.activeDerivative && ins.autoLoad.changed && ins.autoLoad.value) {\n            this.autoLoad(ins.quality.value);\n        }\n        else if (ins.quality.changed) {\n            const derivative = this.derivatives.select(EDerivativeUsage.Web3D, ins.quality.value);\n            if (derivative && derivative !== this.activeDerivative) {\n                this.loadDerivative(derivative)\n                .catch(error => {\n                    console.warn(\"Model.update - failed to load derivative\");\n                    console.warn(error);\n                });\n            }\n        }\n\n\n        if (ins.visible.changed) {\n            this.object3D.visible = ins.visible.value;\n        }\n\n        if (ins.units.changed) {\n            this.updateUnitScale();\n            this.emit<IModelChangeEvent>({ type: \"change\", what: \"boundingBox\", component: this });\n        }\n        if (ins.center.changed) {\n            this.center();\n        }\n        if (ins.position.changed || ins.rotation.changed) {\n            this.updateMatrixFromProps();\n        }\n        if (ins.dumpDerivatives.changed) {\n            console.log(this.derivatives.toString(true));\n        }\n\n        return true;\n    }\n\n    dispose()\n    {\n        this.derivatives.clear();\n        this._activeDerivative = null;\n\n        super.dispose();\n    }\n\n    center()\n    {\n        const object3D = this.object3D;\n        const position = this.ins.position;\n\n        object3D.matrix.decompose(_vec3a, _quat, _vec3b);\n        object3D.matrix.makeRotationFromQuaternion(_quat);\n        _box.makeEmpty();\n        helpers.computeLocalBoundingBox(object3D, _box, object3D.parent);\n        _box.getCenter(_vec3a);\n        _vec3a.multiplyScalar(-1).toArray(position.value);\n        position.set();\n    }\n\n    setGlobalUnits(units: EUnitType)\n    {\n        this.outs.globalUnits.setValue(units);\n        this.updateUnitScale();\n    }\n\n    setFromMatrix(matrix: THREE.Matrix4)\n    {\n        const { position, rotation } = this.ins;\n\n        matrix.decompose(_vec3a, _quat, _vec3b);\n        _vec3a.multiplyScalar(1 / this.outs.unitScale.value).toArray(position.value);\n\n        helpers.quaternionToDegrees(_quat, CVModel.rotationOrder, rotation.value);\n\n        position.set();\n        rotation.set();\n    }\n\n    setShaderMode(shaderMode: EShaderMode)\n    {\n        this.object3D.traverse(object => {\n            const material = object[\"material\"] as UberPBRMaterial;\n            if (material && material.isUberPBRMaterial) {\n                material.setShaderMode(shaderMode);\n            }\n        });\n    }\n\n    deflate()\n    {\n        const data = this.toData();\n        return data ? { data } : null;\n    }\n\n    inflate(json: any)\n    {\n        if (json.data) {\n            this.fromData(json);\n        }\n    }\n\n    toData()\n    {\n        const ins = this.ins;\n\n        const data: IModel = {\n            units: EUnitType[ins.units.value] as TUnitType,\n            derivatives: this.derivatives.toData()\n        };\n\n        data.boundingBox = {\n            min: this._boundingBox.min.toArray() as Vector3,\n            max: this._boundingBox.max.toArray() as Vector3\n        };\n\n        const position = ins.position.value;\n        if (position[0] !== 0 || position[1] !== 0 || position[2] !== 0) {\n            data.translation = _vec3a.toArray();\n        }\n\n        const rotation = ins.rotation.value;\n        if (rotation[0] !== 0 || rotation[1] !== 0 || rotation[2] !== 0) {\n            helpers.degreesToQuaternion(rotation, CVModel.rotationOrder, _quat);\n            data.rotation = _quat.toArray();\n        }\n\n        //if (this.material) {\n        // TODO: Implement\n        //}\n\n        return data;\n    }\n\n    fromData(data: IModel)\n    {\n        const { units, position, rotation } = this.ins;\n\n        units.setValue(EUnitType[data.units] || 0);\n\n        if (data.derivatives) {\n            this.derivatives.fromData(data.derivatives);\n        }\n\n        if (data.translation || data.rotation) {\n            position.setValue(data.translation ? data.translation.slice() : [ 0, 0, 0 ]);\n\n            if (data.rotation) {\n                _quat.fromArray(data.rotation);\n                rotation.setValue(helpers.quaternionToDegrees(_quat, CVModel.rotationOrder));\n            }\n            else {\n                rotation.setValue([ 0, 0, 0 ]);\n            }\n\n            this.updateMatrixFromProps();\n        }\n\n        if (data.boundingBox) {\n            this._boundingBox.min.fromArray(data.boundingBox.min);\n            this._boundingBox.max.fromArray(data.boundingBox.max);\n\n            this._boxFrame = new THREE[\"Box3Helper\"](this._boundingBox, \"#ffffff\");\n            this.addObject3D(this._boxFrame);\n\n            this.emit<IModelChangeEvent>({ type: \"change\", what: \"derivative\", component: this });\n        }\n\n        //if (data.material) {\n        // TODO: Implement\n        //}\n\n        // automatically display new derivatives if available\n        this.ins.autoLoad.set();\n    }\n\n    inflateReferences()\n    {\n    }\n\n    protected updateUnitScale()\n    {\n        const fromUnits = EUnitType[this.ins.units.getValidatedValue()];\n        const toUnits = EUnitType[this.outs.globalUnits.value];\n        this.outs.unitScale.setValue(_unitConversionFactor[fromUnits][toUnits]);\n\n        //console.log(\"Model.updateUnitScale, from: %s, to: %s\", fromUnits, toUnits);\n\n        this.updateMatrixFromProps();\n    }\n\n    protected updateMatrixFromProps()\n    {\n        const ins = this.ins;\n        const unitScale = this.outs.unitScale.value;\n\n        _vec3a.fromArray(ins.position.value).multiplyScalar(unitScale);\n        helpers.degreesToQuaternion(ins.rotation.value, CVModel.rotationOrder, _quat);\n        _vec3b.setScalar(unitScale);\n\n        const object3D = this.object3D;\n        object3D.matrix.compose(_vec3a, _quat, _vec3b);\n        object3D.matrixWorldNeedsUpdate = true;\n    }\n\n    /**\n     * Automatically loads derivatives up to the given quality.\n     * First loads the lowest available quality (usually thumb), then\n     * loads the desired quality level.\n     * @param quality\n     */\n    protected autoLoad(quality: EDerivativeQuality): Promise<void>\n    {\n        const sequence = [];\n\n        const lowestQualityDerivative = this.derivatives.select(EDerivativeUsage.Web3D, EDerivativeQuality.Thumb);\n        if (lowestQualityDerivative) {\n            sequence.push(lowestQualityDerivative);\n        }\n\n        const targetQualityDerivative = this.derivatives.select(EDerivativeUsage.Web3D, quality);\n        if (targetQualityDerivative && targetQualityDerivative !== lowestQualityDerivative) {\n            sequence.push(targetQualityDerivative);\n        }\n\n        if (sequence.length === 0) {\n            return Promise.resolve();\n        }\n\n        // load sequence of derivatives one by one\n        return sequence.reduce((promise, derivative) => {\n            return promise.then(() => this.loadDerivative(derivative));\n        }, Promise.resolve());\n    }\n\n    /**\n     * Loads and displays the given derivative.\n     * @param derivative\n     */\n    protected loadDerivative(derivative: Derivative): Promise<void>\n    {\n        const loaders = this.system.getMainComponent(CVLoaders);\n\n        return derivative.load(loaders, this.assetPath)\n        .then(() => {\n            if (!derivative.model) {\n                return;\n            }\n\n            if (this._boxFrame) {\n                this.removeObject3D(this._boxFrame);\n                this._boxFrame.geometry.dispose();\n            }\n            if (this._activeDerivative) {\n                this.removeObject3D(this._activeDerivative.model);\n                this._activeDerivative.dispose();\n            }\n\n            helpers.computeLocalBoundingBox(derivative.model, this._boundingBox);\n\n            this._activeDerivative = derivative;\n            this.addObject3D(derivative.model);\n\n            this.emit<IModelChangeEvent>({ type: \"change\", what: \"derivative\", component: this });\n\n            // TODO: Test\n            //const bb = derivative.boundingBox;\n            //const box = { min: bb.min.toArray(), max: bb.max.toArray() };\n            //console.log(\"derivative bounding box: \", box);\n        });\n    }\n}\n\n","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Component, { types } from \"@ff/graph/Component\";\n\nimport { INavigation } from \"common/types/config\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { types };\n\nconst _inputs = {\n    enabled: types.Boolean(\"Manip.Enabled\", true),\n};\n\nexport default class CVNavigation extends Component\n{\n    ins = this.addInputs(_inputs);\n\n\n    fromData(data: INavigation)\n    {\n        this.ins.enabled.setValue(data.enabled);\n    }\n\n    toData(): Partial<INavigation>\n    {\n        return {\n            enabled: this.ins.enabled.value,\n        };\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as THREE from \"three\";\n\nimport math from \"@ff/core/math\";\n\nimport CVNavigation, { types } from \"./CVNavigation\";\n\nimport OrbitManipulator from \"@ff/three/OrbitManipulator\";\n\nimport { IPointerEvent, ITriggerEvent } from \"@ff/scene/RenderView\";\nimport CRenderer, { IActiveSceneEvent } from \"@ff/scene/components/CRenderer\";\nimport { EProjection } from \"@ff/scene/components/CCamera\";\n\nimport { INavigation } from \"common/types/config\";\n\nimport CVScene from \"./CVScene\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _box = new THREE.Box3();\nconst _size = new THREE.Vector3();\nconst _center = new THREE.Vector3();\nconst _translation = new THREE.Vector3();\n\nconst _orientationPreset = [\n    [ 0, -90, 0 ], // left\n    [ 0, 90, 0 ],  // right\n    [ -90, 0, 0 ], // top\n    [ 90, 0, 0 ],  // bottom\n    [ 0, 0, 0 ],   // front\n    [ 0, 180, 0 ], // back\n];\n\nconst _replaceNull = function(vector: number[], replacement: number)\n{\n    for (let i = 0, n = vector.length; i < n; ++i) {\n        vector[i] = vector[i] === null ? replacement : vector[i];\n    }\n    return vector;\n};\n\nexport { EProjection };\n\nexport enum EViewPreset { Left, Right, Top, Bottom, Front, Back, None }\n\nconst _inputs = {\n    preset: types.Enum(\"View.Preset\", EViewPreset, EViewPreset.None),\n    projection: types.Enum(\"View.Projection\", EProjection, EProjection.Perspective),\n    zoomExtents: types.Event(\"Manip.ZoomExtents\"),\n    orbit: types.Vector3(\"Manip.Orbit\", [ -25, -25, 0 ]),\n    offset: types.Vector3(\"Manip.Offset\", [ 0, 0, 100 ]),\n    minOrbit: types.Vector3(\"Manip.Min.Orbit\", [ -90, -Infinity, -Infinity ]),\n    minOffset: types.Vector3(\"Manip.Min.Offset\", [ -Infinity, -Infinity, 0.1 ]),\n    maxOrbit: types.Vector3(\"Manip.Max.Orbit\", [ 90, Infinity, Infinity ]),\n    maxOffset: types.Vector3(\"Manip.Max.Offset\", [ Infinity, Infinity, Infinity ])\n};\n\n/**\n * Voyager explorer orbit navigation.\n * Controls manipulation and parameters of the camera.\n */\nexport default class CVOrbitNavigation extends CVNavigation\n{\n    ins = this.addInputs<CVNavigation, typeof _inputs>(_inputs);\n\n    private _manip = new OrbitManipulator();\n    private _activeScene: CVScene = null;\n\n    get renderer() {\n        return this.system.getMainComponent(CRenderer);\n    }\n\n    create()\n    {\n        super.create();\n\n        this._manip.cameraMode = true;\n\n        this.system.on<IPointerEvent>([\"pointer-down\", \"pointer-up\", \"pointer-move\"], this.onPointer, this);\n        this.system.on<ITriggerEvent>(\"wheel\", this.onTrigger, this);\n\n        this._activeScene = this.renderer.activeSceneComponent as CVScene;\n        this.renderer.on<IActiveSceneEvent>(\"active-scene\", this.onActiveScene, this);\n    }\n\n    dispose()\n    {\n        super.dispose();\n\n        this.system.off<IPointerEvent>([\"pointer-down\", \"pointer-up\", \"pointer-move\"], this.onPointer, this);\n        this.system.off<ITriggerEvent>(\"wheel\", this.onTrigger, this);\n\n        this.renderer.off<IActiveSceneEvent>(\"active-scene\", this.onActiveScene, this);\n        this._activeScene = null;\n    }\n\n    update()\n    {\n        const manip = this._manip;\n\n        const component = this._activeScene ? this._activeScene.activeCameraComponent : null;\n        const camera = component ? component.camera : null;\n\n        const {\n            projection, preset, zoomExtents,\n            orbit, offset, minOrbit, minOffset, maxOrbit, maxOffset\n        } = this.ins;\n\n        if (camera && projection.changed) {\n            camera.setProjection(projection.value);\n            manip.orthographicMode = projection.value === EProjection.Orthographic;\n        }\n\n        if (preset.changed && preset.value !== EViewPreset.None) {\n            orbit.setValue(_orientationPreset[preset.getValidatedValue()].slice());\n        }\n\n        if (camera && zoomExtents.changed) {\n            camera.updateMatrixWorld(false);\n            _box.copy(this._activeScene.boundingBox);\n            _box.applyMatrix4(camera.matrixWorldInverse);\n            _box.getSize(_size);\n            _box.getCenter(_center);\n\n            const sizeXY = 0.75 * Math.max(_size.x, _size.y, _size.z);\n\n            if (camera.isPerspectiveCamera) {\n                offset.value[2] = sizeXY + sizeXY / (2 * Math.tan(camera.fov * math.DEG2RAD * 0.5));\n            }\n            else {\n                offset.value[2] = _size.z * 2;\n            }\n\n            offset.set();\n        }\n\n        if (orbit.changed || offset.changed) {\n            manip.orbit.fromArray(orbit.value);\n            manip.offset.fromArray(offset.value);\n        }\n\n        if (minOrbit.changed || minOffset.changed || maxOrbit.changed || maxOffset.changed) {\n            manip.minOrbit.fromArray(minOrbit.value);\n            manip.minOffset.fromArray(minOffset.value);\n            manip.maxOrbit.fromArray(maxOrbit.value);\n            manip.maxOffset.fromArray(maxOffset.value);\n        }\n\n        return true;\n    }\n\n    tick()\n    {\n        const manip = this._manip;\n        const component = this._activeScene && this._activeScene.activeCameraComponent;\n        const ins = this.ins;\n\n\n        if (ins.enabled.value) {\n\n            const manipUpdated = manip.update();\n\n            if (manipUpdated) {\n                manip.orbit.toArray(ins.orbit.value);\n                ins.orbit.set(true);\n                manip.offset.toArray(ins.offset.value);\n                ins.offset.set(true);\n                ins.preset.setValue(EViewPreset.None, true);\n            }\n\n            if (component && (manipUpdated || this.updated)) {\n                const camera = component.camera;\n                const parentComponent = component.parentComponent;\n\n                if (parentComponent) {\n                    this._manip.toObject(parentComponent.object3D);\n                }\n                else {\n                    this._manip.toObject(camera);\n                }\n\n                if (camera.isOrthographicCamera) {\n                    camera.size = this._manip.offset.z;\n                    camera.updateProjectionMatrix();\n                }\n\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    fromData(data: INavigation)\n    {\n        super.fromData(data);\n\n        const orbit = data.orbit;\n\n        this.ins.copyValues({\n            orbit: orbit.orbit.slice(),\n            offset: orbit.offset.slice(),\n            minOrbit: _replaceNull(orbit.minOrbit.slice(), -Infinity),\n            maxOrbit: _replaceNull(orbit.maxOrbit.slice(), Infinity),\n            minOffset: _replaceNull(orbit.minOffset.slice(), -Infinity),\n            maxOffset: _replaceNull(orbit.maxOffset.slice(), Infinity),\n        });\n    }\n\n    toData(): INavigation\n    {\n        const ins = this.ins;\n        const data = super.toData();\n\n        data.type = \"Orbit\";\n        data.orbit = {\n            orbit: ins.orbit.cloneValue(),\n            offset: ins.offset.cloneValue(),\n            minOrbit: ins.minOrbit.cloneValue(),\n            maxOrbit: ins.maxOrbit.cloneValue(),\n            minOffset: ins.minOffset.cloneValue(),\n            maxOffset: ins.maxOffset.cloneValue(),\n        };\n\n        return data as INavigation;\n    }\n\n    protected onPointer(event: IPointerEvent)\n    {\n        const viewport = event.viewport;\n        if (viewport.viewportCamera) {\n            return;\n        }\n\n        if (this.ins.enabled.value && this._activeScene && this._activeScene.activeCameraComponent) {\n            this._manip.setViewportSize(viewport.width, viewport.height);\n            this._manip.onPointer(event);\n            event.stopPropagation = true;\n        }\n    }\n\n    protected onTrigger(event: ITriggerEvent)\n    {\n        const viewport = event.viewport;\n        if (viewport.viewportCamera) {\n            return;\n        }\n\n        if (this.ins.enabled.value && this._activeScene && this._activeScene.activeCameraComponent) {\n            this._manip.setViewportSize(viewport.width, viewport.height);\n            this._manip.onTrigger(event);\n            event.stopPropagation = true;\n        }\n    }\n\n    protected onActiveScene(event: IActiveSceneEvent)\n    {\n        if (event.next instanceof CVScene) {\n            this._activeScene = event.next;\n            this.ins.zoomExtents.set();\n        }\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as THREE from \"three\";\n\nimport { types } from \"@ff/graph/propertyTypes\";\nimport { IComponentChangeEvent, IComponentEvent } from \"@ff/graph/Component\";\n\nimport CScene, { IRenderSceneContext } from \"@ff/scene/components/CScene\";\n\nimport { IScene, EShaderMode, TShaderMode, EUnitType, TUnitType } from \"common/types/config\";\n\nimport CVModel, { IModelChangeEvent } from \"./CVModel\";\nimport CVOrbitNavigation from \"./CVOrbitNavigation\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { EUnitType, EShaderMode };\n\nconst ins = {\n    units: types.Enum(\"Scene.Units\", EUnitType, EUnitType.cm),\n    shader: types.Enum(\"Renderer.Shader\", EShaderMode),\n    exposure: types.Number(\"Renderer.Exposure\", 1),\n    gamma: types.Number(\"Renderer.Gamma\", 1),\n    zoomExtents: types.Event(\"ZoomExtents\")\n};\n\nexport default class CVScene extends CScene\n{\n    static readonly type: string = \"CVScene\";\n\n    ins = this.addInputs<CScene, typeof ins>(ins);\n\n    boundingBox = new THREE.Box3();\n\n    private _zoomViews = false;\n\n\n    create()\n    {\n        this.scene.background = new THREE.TextureLoader().load(\"images/bg-gradient-blue.jpg\");\n        this.graph.components.on(CVModel, this.onModelComponent, this);\n    }\n\n    update(context)\n    {\n        super.update(context);\n\n        const ins = this.ins;\n\n        if (ins.units.changed) {\n            this.updateModels();\n        }\n        if (ins.shader.changed) {\n            const index = ins.shader.getValidatedValue();\n            this.graph.components.getArray(CVModel).forEach(model => model.setShaderMode(index));\n        }\n        if (ins.zoomExtents.changed) {\n            this._zoomViews = true;\n            const manip = this.system.components.get(CVOrbitNavigation);\n            if (manip) {\n                manip.ins.zoomExtents.set();\n            }\n        }\n\n        return true;\n    }\n\n    beforeRender(context: IRenderSceneContext)\n    {\n        if (this.updated) {\n            context.renderer.toneMappingExposure = this.ins.exposure.value;\n        }\n        if (this._zoomViews) {\n            context.viewport.moveCameraToView(this.boundingBox);\n        }\n    }\n\n    finalize()\n    {\n        this._zoomViews = false;\n    }\n\n    fromData(data: IScene)\n    {\n        this.ins.copyValues({\n            units: EUnitType[data.units] || EUnitType.mm,\n            shader: EShaderMode[data.shader] || EShaderMode.Default,\n            exposure: data.exposure !== undefined ? data.exposure : 1,\n            gamma: data.gamma !== undefined ? data.gamma : 1\n        });\n    }\n\n    toData(): IScene\n    {\n        const ins = this.ins;\n\n        return {\n            units: EUnitType[ins.units.value] as TUnitType,\n            shader: EShaderMode[ins.shader.value] as TShaderMode,\n            exposure: ins.exposure.value,\n            gamma: ins.gamma.value\n        };\n    }\n\n    protected onModelComponent(event: IComponentEvent<CVModel>)\n    {\n        if (event.add) {\n            event.object.setGlobalUnits(this.ins.units.value);\n            event.object.on<IModelChangeEvent>(\"change\", this.updateModels, this);\n        }\n        else if (event.remove) {\n            event.object.off<IModelChangeEvent>(\"change\", this.updateModels, this);\n        }\n    }\n\n    protected updateModels()\n    {\n        // get bounding box of all models\n        const box = this.boundingBox.makeEmpty();\n        const models = this.transform.getChildren(CVModel, true);\n        const units = this.ins.units.getValidatedValue();\n\n        models.forEach(model => {\n            model.setGlobalUnits(units);\n            box.expandByObject(model.object3D);\n        });\n\n        this.emit<IComponentChangeEvent>({\n            type: \"change\", what: \"boundingBox\", component: this\n        });\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport CVLoaders from \"./CVLoaders\";\nimport CVModel from \"./CVModel\";\nimport CVScene from \"./CVScene\";\nimport CVOrbitNavigation from \"./CVOrbitNavigation\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport {\n    CVLoaders,\n    CVModel,\n    CVScene,\n    CVOrbitNavigation\n};\n\nexport const componentTypes = [\n    CVLoaders,\n    CVModel,\n    CVScene,\n    CVOrbitNavigation\n];","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as THREE from \"three\";\n\nimport \"three/examples/js/loaders/OBJLoader\";\nconst OBJLoader = (THREE as any).OBJLoader;\n\nimport \"three/examples/js/loaders/PLYLoader\";\nconst PLYLoader = (THREE as any).PLYLoader;\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class GeometryLoader\n{\n    static readonly extensions = [ \"obj\", \"ply\" ];\n\n    protected objLoader: any;\n    protected plyLoader: any;\n\n    constructor(loadingManager: THREE.LoadingManager)\n    {\n        this.objLoader = new OBJLoader(loadingManager);\n        this.plyLoader = new PLYLoader(loadingManager);\n    }\n\n    canLoad(url: string): boolean\n    {\n        const extension = url.split(\".\").pop().toLowerCase();\n        return GeometryLoader.extensions.indexOf(extension) >= 0;\n    }\n\n    load(url: string): Promise<THREE.Geometry>\n    {\n        const extension = url.split(\".\").pop().toLowerCase();\n\n        return new Promise((resolve, reject) => {\n            if (extension === \"obj\") {\n                this.objLoader.load(url, result => {\n                    const geometry = result.children[0].geometry;\n                    console.log(geometry);\n                    if (geometry && geometry.type === \"Geometry\" || geometry.type === \"BufferGeometry\") {\n                        return resolve(geometry);\n                    }\n\n                    return reject(new Error(`Can't parse geometry from '${url}'`));\n                });\n            }\n            else if (extension === \"ply\") {\n                this.plyLoader.load(url, geometry => {\n                    if (geometry && geometry.type === \"Geometry\" || geometry.type === \"BufferGeometry\") {\n                        return resolve(geometry);\n                    }\n\n                    return reject(new Error(`Can't parse geometry from '${url}'`));\n                });\n            }\n            else {\n                throw new Error(`Can't load geometry, unknown extension: '${extension}' in '${url}'`);\n            }\n        });\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as THREE from \"three\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class JSONLoader\n{\n    private loadingManager: THREE.LoadingManager;\n\n    constructor(loadingManager: THREE.LoadingManager)\n    {\n        this.loadingManager = loadingManager;\n    }\n\n    load(url: string): Promise<any>\n    {\n        this.loadingManager.itemStart(url);\n\n        return fetch(url, {\n            headers: {\n                \"Accept\": \"application/json\"\n            }\n        }).then(result => {\n            if (!result.ok) {\n                this.loadingManager.itemError(url);\n                throw new Error(`failed to fetch from '${url}', status: ${result.status} ${result.statusText}`)\n            }\n\n            this.loadingManager.itemEnd(url);\n            return result.json();\n        });\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as Ajv from \"ajv\";\n\nimport * as mathSchema from \"common/schema/math.schema.json\";\n\nimport * as presentationSchema from \"common/schema/presentation.schema.json\";\nimport * as configSchema from \"common/schema/config.schema.json\";\n\nimport * as itemSchema from \"common/schema/item.schema.json\";\nimport * as metaSchema from \"common/schema/meta.schema.json\";\nimport * as processSchema from \"common/schema/process.schema.json\";\nimport * as modelSchema from \"common/schema/model.schema.json\";\nimport * as annotationsSchema from \"common/schema/annotations.schema.json\";\nimport * as storySchema from \"common/schema/story.schema.json\";\nimport * as documentsSchema from \"common/schema/documents.schema.json\";\n\nimport { IPresentation } from \"common/types/presentation\";\nimport { IItem } from \"common/types/item\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class JSONValidator\n{\n    private _schemaValidator;\n    private _validatePresentation;\n    private _validateItem;\n\n    constructor()\n    {\n        this._schemaValidator = new Ajv({\n            schemas: [\n                mathSchema,\n                presentationSchema,\n                configSchema,\n                itemSchema,\n                metaSchema,\n                processSchema,\n                modelSchema,\n                documentsSchema,\n                annotationsSchema,\n                storySchema\n            ],\n            allErrors: true\n        });\n\n        this._validatePresentation = this._schemaValidator.getSchema(\n            \"https://schemas.3d.si.edu/public_api/presentation.schema.json\"\n        );\n\n        this._validateItem = this._schemaValidator.getSchema(\n            \"https://schemas.3d.si.edu/public_api/item.schema.json\"\n        );\n    }\n\n    validatePresentation(presentation: IPresentation): boolean\n    {\n        if (!this._validatePresentation(presentation)) {\n            console.warn(this._schemaValidator.errorsText(\n                this._validatePresentation.errors, { separator: \", \", dataVar: \"presentation\" }));\n            return false;\n        }\n\n        console.log(\"JSONValidator.validatePresentation - OK\");\n        return true;\n    }\n\n    validateItem(item: IItem): boolean\n    {\n        if (!this._validateItem(item)) {\n            console.warn(this._schemaValidator.errorsText(\n                this._validateItem.errors, { separator: \", \", dataVar: \"item\" }));\n            return false;\n        }\n\n        console.log(\"JSONValidator.validateItem - OK\");\n        return true;\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport resolvePathname from \"resolve-pathname\";\nimport * as THREE from \"three\";\n\nimport \"three/examples/js/loaders/GLTFLoader\";\nimport \"three/examples/js/loaders/DRACOLoader\";\n\nconst GLTFLoader = (THREE as any).GLTFLoader;\nconst DRACOLoader = (THREE as any).DRACOLoader;\n\nconst dracoPath = resolvePathname(\"js/draco/\", window.location.origin + window.location.pathname);\nDRACOLoader.setDecoderPath(dracoPath);\nconsole.log(\"DRACOLoader.setDracoPath - %s\", dracoPath);\n\nimport UberPBRMaterial from \"../shaders/UberPBRMaterial\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class ModelLoader\n{\n    static readonly extensions = [ \"gltf\", \"glb\" ];\n    static readonly mimeTypes = [ \"model/gltf+json\", \"model/gltf-binary\" ];\n\n    protected loadingManager: THREE.LoadingManager;\n    protected gltfLoader;\n\n    constructor(loadingManager: THREE.LoadingManager)\n    {\n        this.loadingManager = loadingManager;\n\n        this.gltfLoader = new GLTFLoader(loadingManager);\n        this.gltfLoader.setDRACOLoader(new DRACOLoader());\n    }\n\n    canLoad(url: string): boolean\n    {\n        const extension = url.split(\".\").pop().toLowerCase();\n        return ModelLoader.extensions.indexOf(extension) >= 0;\n    }\n\n    canLoadMimeType(mimeType: string): boolean\n    {\n        return ModelLoader.mimeTypes.indexOf(mimeType) >= 0;\n    }\n\n    load(url: string): Promise<THREE.Object3D>\n    {\n        return new Promise((resolve, reject) => {\n            this.gltfLoader.load(url, gltf => {\n                resolve(this.createModelGroup(gltf));\n            }, null, error => {\n                console.error(`failed to load '${url}': ${error}`);\n                reject(new Error(error));\n            })\n        });\n    }\n\n    protected createModelGroup(gltf): THREE.Object3D\n    {\n        const scene: THREE.Scene = gltf.scene;\n        if (scene.type !== \"Scene\") {\n            throw new Error(\"not a valid gltf scene\");\n        }\n\n        const model = new THREE.Group();\n        scene.children.forEach(child => model.add(child));\n\n        model.traverse((object: any) => {\n            if (object.type === \"Mesh\") {\n                const mesh: THREE.Mesh = object;\n                const material = mesh.material as THREE.MeshStandardMaterial;\n\n                if (material.map) {\n                    material.map.encoding = THREE.LinearEncoding;\n                }\n\n                mesh.geometry.computeBoundingBox();\n\n                const uberMat = new UberPBRMaterial();\n                if (material.type === \"MeshStandardMaterial\") {\n                    uberMat.copyStandardMaterial(material);\n                }\n\n                // TODO: Temp to correct test assets\n                uberMat.roughness = 0.6;\n                uberMat.metalness = 0;\n                uberMat.enableObjectSpaceNormalMap(false);\n\n                if (!uberMat.map) {\n                    uberMat.color.set(\"#c0c0c0\");\n                }\n\n                mesh.material = uberMat;\n            }\n        });\n\n        return model;\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as THREE from \"three\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport default class TextureLoader\n{\n    static readonly extensions = [ \"jpg\", \"png\" ];\n    static readonly mimeTypes = [ \"image/jpeg\", \"image/png\" ];\n\n    protected textureLoader: THREE.TextureLoader;\n\n\n    constructor(loadingManager: THREE.LoadingManager)\n    {\n        this.textureLoader = new THREE.TextureLoader(loadingManager);\n    }\n\n    canLoad(url: string): boolean\n    {\n        const extension = url.split(\".\").pop().toLowerCase();\n        return TextureLoader.extensions.indexOf(extension) >= 0;\n    }\n\n    canLoadMimeType(mimeType: string): boolean\n    {\n        return TextureLoader.mimeTypes.indexOf(mimeType) >= 0;\n    }\n\n    load(url: string): Promise<THREE.Texture>\n    {\n        return new Promise((resolve, reject) => {\n            this.textureLoader.load(url, texture => {\n                resolve(texture);\n            }, null, errorEvent => {\n                console.error(errorEvent);\n                reject(new Error(errorEvent.message));\n            });\n        });\n    }\n\n    loadImmediate(url: string): THREE.Texture\n    {\n        return this.textureLoader.load(url, null, null, errorEvent => {\n            console.error(errorEvent);\n        });\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n////////////////////////////////////////////////////////////////////////////////\n\nimport { IAsset, TAssetType, TMapType } from \"common/types/item\";\n\nexport enum EAssetType { Model, Geometry, Image, Texture, Points, Volume }\nexport enum EMapType { Color, Normal, Occlusion, Emissive, MetallicRoughness, Zone }\n\nexport default class Asset\n{\n    static readonly mimeType = {\n        gltfJson: \"model/gltf+json\",\n        gltfBinary: \"model/gltf-binary\",\n        imageJpeg: \"image/jpeg\",\n        imagePng: \"image/png\"\n    };\n\n    uri: string = \"\";\n    mimeType: string = \"\";\n    type: EAssetType = undefined;\n    mapType: EMapType = undefined;\n    byteSize: number = 0;\n    numFaces: number = 0;\n    numVertices: number = 0;\n    imageSize: number = 0;\n\n    constructor(type: EAssetType, uri: string)\n    constructor(assetData: IAsset);\n    constructor(typeOrData, uri?)\n    {\n        if (uri === undefined) {\n            this.fromData(typeOrData);\n        }\n        else {\n            this.type = typeOrData;\n            this.uri = uri;\n        }\n    }\n\n    isValid()\n    {\n        return !!this.uri && this.type !== undefined;\n    }\n\n    fromData(assetData: IAsset)\n    {\n        this.uri = assetData.uri;\n        this.mimeType = assetData.mimeType || \"\";\n        this.type = EAssetType[assetData.type];\n        this.mapType = EMapType[assetData.mapType];\n        this.byteSize = assetData.byteSize || 0;\n        this.numFaces = assetData.numFaces || 0;\n        this.numVertices = assetData.numVertices || 0;\n        this.imageSize = assetData.imageSize || 0;\n\n        if (this.type === undefined) {\n            this.type = this.guessAssetType();\n            if (this.type === undefined) {\n                console.warn(`failed to determine asset type from asset: ${this.uri}`);\n            }\n        }\n    }\n\n    toData(): IAsset\n    {\n        const data: IAsset = {\n            uri: this.uri,\n            type: EAssetType[this.type] as TAssetType\n        };\n\n        if (this.mimeType) {\n            data.mimeType = this.mimeType;\n        }\n        if (this.mapType !== undefined) {\n            data.mapType = EMapType[this.mapType] as TMapType;\n        }\n        if (this.byteSize > 0) {\n            data.byteSize = this.byteSize;\n        }\n\n        if (this.type === EAssetType.Model || this.type === EAssetType.Geometry) {\n            if (this.numFaces > 0) {\n                data.numFaces = this.numFaces;\n            }\n            if (this.numVertices > 0) {\n                data.numVertices = this.numVertices;\n            }\n        }\n\n        if (this.type === EAssetType.Image || this.type === EAssetType.Texture) {\n            if (this.imageSize > 0) {\n                data.imageSize = this.imageSize;\n            }\n        }\n\n        return data;\n    }\n\n    toString()\n    {\n        return `Asset - type: '${EAssetType[this.type]}', uri: '${this.uri}', mime type: '${this.mimeType || \"(not set)\"}'`;\n    }\n\n    protected guessAssetType(): EAssetType\n    {\n        if (this.type !== undefined && EAssetType[this.type]) {\n            return this.type;\n        }\n\n        if (this.mimeType) {\n            if (this.mimeType === Asset.mimeType.gltfJson || this.mimeType === Asset.mimeType.gltfBinary) {\n                return EAssetType.Model;\n            }\n            if (this.mimeType === Asset.mimeType.imageJpeg || this.mimeType === Asset.mimeType.imagePng) {\n                return EAssetType.Image;\n            }\n        }\n\n        const extension = this.uri.split(\".\").pop().toLowerCase();\n\n        if (extension === \"gltf\" || extension === \"glb\") {\n            return EAssetType.Model\n        }\n        if (extension === \"obj\" || extension === \"ply\") {\n            return EAssetType.Geometry\n        }\n        if (extension === \"jpg\" || extension === \"png\") {\n            return EAssetType.Image;\n        }\n\n        return undefined;\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as THREE from \"three\";\n\nimport { disposeObject } from \"@ff/three/helpers\";\n\nimport { IDerivative, TDerivativeQuality, TDerivativeUsage } from \"common/types/item\";\n\nimport CVLoaders from \"../components/CVLoaders\";\nimport UberPBRMaterial from \"../shaders/UberPBRMaterial\";\n\nimport Asset, { EAssetType, EMapType } from \"./Asset\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { Asset, EAssetType };\n\nexport enum EDerivativeUsage { Web2D, Web3D, Print, Editorial }\nexport enum EDerivativeQuality { Thumb, Low, Medium, High, Highest, LOD, Stream }\n\nexport default class Derivative\n{\n    id: string;\n    usage: EDerivativeUsage;\n    quality: EDerivativeQuality;\n    assets: Asset[];\n\n    model: THREE.Object3D;\n\n    constructor(usage: EDerivativeUsage, quality: EDerivativeQuality);\n    constructor(data: IDerivative);\n    constructor(usageOrData, quality?)\n    {\n        this.id = \"\";\n\n        if (quality === undefined) {\n            this.fromData(usageOrData);\n        }\n        else {\n            this.usage = usageOrData;\n            this.quality = quality;\n            this.assets = [];\n        }\n\n        this.model = null;\n    }\n\n    dispose()\n    {\n        if (this.model) {\n            disposeObject(this.model);\n        }\n    }\n\n    load(loaders: CVLoaders, assetPath?: string): Promise<THREE.Object3D>\n    {\n        if (this.usage !== EDerivativeUsage.Web3D) {\n            throw new Error(\"can't load, not a Web3D derivative\");\n        }\n\n        console.log(\"Derivative.load - asset path: %s\", assetPath);\n\n        const modelAsset = this.findAsset(EAssetType.Model);\n\n        if (modelAsset) {\n            return loaders.loadModel(modelAsset, assetPath)\n            .then(object => {\n                if (this.model) {\n                    disposeObject(this.model);\n                }\n                this.model = object;\n                return object;\n            });\n        }\n\n        const geoAsset = this.findAsset(EAssetType.Geometry);\n        const imageAssets = this.findAssets(EAssetType.Image);\n\n        if (geoAsset) {\n            return loaders.loadGeometry(geoAsset, assetPath)\n            .then(geometry => {\n                this.model = new THREE.Mesh(geometry, new UberPBRMaterial());\n\n                return Promise.all(imageAssets.map(asset => loaders.loadTexture(asset, assetPath)))\n                .catch(error => {\n                    console.warn(\"failed to load texture files\");\n                    return [];\n                });\n            })\n            .then(textures => {\n                const material = (this.model as THREE.Mesh).material as UberPBRMaterial;\n                this.assignTextures(imageAssets, textures, material);\n\n                if (!material.map) {\n                    material.color.setScalar(0.5);\n                    material.roughness = 0.8;\n                    material.metalness = 0;\n                }\n\n                return this.model;\n            });\n        }\n    }\n\n    createAsset(type: EAssetType, uri: string): Asset\n    {\n        if (!uri) {\n            throw new Error(\"uri must be specified\");\n        }\n\n        const asset = new Asset(type, uri);\n        this.assets.push(asset);\n        return asset;\n    }\n\n    fromData(data: IDerivative)\n    {\n        this.usage = EDerivativeUsage[data.usage];\n        if (this.usage === undefined) {\n            throw new Error(`unknown derivative usage: ${data.usage}`);\n        }\n\n        this.quality = EDerivativeQuality[data.quality];\n        if (this.quality === undefined) {\n            throw new Error(`unknown derivative quality: ${data.quality}`);\n        }\n\n        this.assets = data.assets.map(assetData => new Asset(assetData));\n    }\n\n    toData(): IDerivative\n    {\n        return {\n            usage: EDerivativeUsage[this.usage] as TDerivativeUsage,\n            quality: EDerivativeQuality[this.quality] as TDerivativeQuality,\n            assets: this.assets.map(asset => asset.toData())\n        };\n    }\n\n    toString(verbose: boolean = false)\n    {\n        if (verbose) {\n            return `Derivative - usage: '${EDerivativeUsage[this.usage]}', quality: '${EDerivativeQuality[this.quality]}'\\n   `\n                + this.assets.map(asset => asset.toString()).join(\"\\n   \");\n        }\n        else {\n            return `Derivative - usage: '${EDerivativeUsage[this.usage]}', quality: '${EDerivativeQuality[this.quality]}', #assets: ${this.assets.length})`;\n        }\n    }\n\n    findAsset(type: EAssetType): Asset | undefined\n    {\n        return this.assets.find(asset => asset.type === type);\n    }\n\n    findAssets(type: EAssetType): Asset[]\n    {\n        return this.assets.filter(asset => asset.type === type);\n    }\n\n    protected assignTextures(assets: Asset[], textures: THREE.Texture[], material: UberPBRMaterial)\n    {\n        for (let i = 0; i < assets.length; ++i) {\n            const asset = assets[i];\n            const texture = textures[i];\n\n            switch(asset.mapType) {\n                case EMapType.Color:\n                    material.map = texture;\n                    break;\n\n                case EMapType.Occlusion:\n                    material.aoMap = texture;\n                    break;\n\n                case EMapType.Emissive:\n                    material.emissiveMap = texture;\n                    break;\n\n                case EMapType.MetallicRoughness:\n                    material.metalnessMap = texture;\n                    material.roughnessMap = texture;\n                    break;\n\n                case EMapType.Normal:\n                    material.normalMap = texture;\n                    break;\n            }\n        }\n    }\n\n    protected disposeMesh(mesh: THREE.Mesh)\n    {\n        mesh.geometry.dispose();\n        const material: any = mesh.material;\n\n        if (material.map) {\n            material.map.dispose();\n        }\n        if (material.aoMap) {\n            material.aoMap.dispose();\n        }\n        if (material.emissiveMap) {\n            material.emissiveMap.dispose();\n        }\n        if (material.metalnessMap) {\n            material.metalnessMap.dispose();\n        }\n        if (material.roughnessMap) {\n            material.roughnessMap.dispose();\n        }\n        if (material.normalMap) {\n            material.normalMap.dispose();\n        }\n    }\n}\n","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Dictionary } from \"@ff/core/types\";\n\nimport { IDerivative } from \"common/types/item\";\n\nimport Derivative, { EDerivativeQuality, EDerivativeUsage } from \"./Derivative\";\nimport { EAssetType, EMapType } from \"./Asset\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nconst _EMPTY_ARRAY = [];\n\nconst _qualityLevels = [\n    EDerivativeQuality.Thumb,\n    EDerivativeQuality.Low,\n    EDerivativeQuality.Medium,\n    EDerivativeQuality.High,\n    EDerivativeQuality.Highest\n];\n\nexport default class DerivativeList\n{\n    protected derivatives: Dictionary<Derivative[]> = {};\n\n    /**\n     * From all derivatives with the given usage (e.g. web), select a derivative as close as possible to\n     * the given quality. The selection strategy works as follows:\n     * 1. Look for a derivative matching the quality exactly. If found, return it.\n     * 2. Look for a derivative with higher quality. If found, return it.\n     * 3. Look for a derivative with lower quality. If found return it, otherwise report an error.\n     * @param quality\n     * @param usage\n     */\n    select(usage: EDerivativeUsage, quality: EDerivativeQuality): Derivative | null\n    {\n        const usageKey = EDerivativeUsage[usage];\n        const qualityKey = EDerivativeQuality[quality];\n\n        const qualityIndex = _qualityLevels.indexOf(quality);\n\n        if (qualityIndex < 0) {\n            console.warn(`derivative quality not supported: '${qualityKey}'`);\n            return null;\n        }\n\n        const derivative = this.get(usage, quality);\n        if (derivative) {\n            return derivative;\n        }\n\n        for (let i = qualityIndex + 1; i < _qualityLevels.length; ++i) {\n            const derivative = this.get(usage, _qualityLevels[i]);\n            if (derivative) {\n                console.warn(`derivative quality '${qualityKey}' not available, using higher quality`);\n                return derivative;\n            }\n        }\n\n        for (let i = qualityIndex - 1; i >= 0; --i) {\n            const derivative = this.get(usage, _qualityLevels[i]);\n            if (derivative) {\n                console.warn(`derivative quality '${qualityKey}' not available, using lower quality`);\n                return derivative;\n            }\n        }\n\n        console.warn(`no suitable derivative found for quality '${qualityKey}'`\n            + ` and usage '${usageKey}'`);\n\n        return null;\n    }\n\n    getByUsage(usage: EDerivativeUsage): Derivative[]\n    {\n        const key = EDerivativeUsage[usage];\n        return this.derivatives[key] || _EMPTY_ARRAY;\n    }\n\n    get(usage: EDerivativeUsage, quality: EDerivativeQuality): Derivative | null\n    {\n        const key = EDerivativeUsage[usage];\n        const bin = this.derivatives[key];\n\n        if (bin) {\n            for (let i = 0, n = bin.length; i < n; ++i) {\n                if (bin[i].quality === quality) {\n                    return bin[i];\n                }\n            }\n        }\n\n        return null;\n    }\n\n    getOrCreate(usage: EDerivativeUsage, quality: EDerivativeQuality): Derivative\n    {\n        const bin = this.getOrCreateBin(usage);\n        for (let i = 0, n = bin.length; i < n; ++i) {\n            if (bin[i].quality === quality) {\n                return bin[i];\n            }\n        }\n\n        const derivative = new Derivative(usage, quality);\n        bin.push(derivative);\n        return derivative;\n    }\n\n    createModelAsset(uri: string, quality: EDerivativeQuality): Derivative\n    {\n        const derivative = this.getOrCreate(EDerivativeUsage.Web3D, quality);\n        derivative.createAsset(EAssetType.Model, uri);\n        return derivative;\n    }\n\n    createMeshAsset(geoUri: string, textureUri: string, quality: EDerivativeQuality): Derivative\n    {\n        const derivative = this.getOrCreate(EDerivativeUsage.Web3D, quality);\n        derivative.createAsset(EAssetType.Geometry, geoUri);\n\n        if (textureUri) {\n            const asset = derivative.createAsset(EAssetType.Image, textureUri);\n            asset.mapType = EMapType.Color;\n        }\n\n        return derivative;\n    }\n\n    clear()\n    {\n        for (let key in this.derivatives) {\n            this.derivatives[key].forEach(derivative => derivative.dispose());\n        }\n\n        this.derivatives = {};\n    }\n\n    toData(): IDerivative[]\n    {\n        const data = [];\n\n        for (let key in this.derivatives) {\n            this.derivatives[key].forEach(derivative => data.push(derivative.toData()));\n        }\n\n        return data;\n    }\n\n    fromData(data: IDerivative[])\n    {\n        this.clear();\n\n        data.forEach(derivativeData => {\n            const bin = this.getOrCreateBin(EDerivativeUsage[derivativeData.usage]);\n            bin.push(new Derivative(derivativeData));\n        });\n    }\n\n    toString(verbose: boolean = false)\n    {\n        const derivatives = this.derivatives;\n        const keys = Object.keys(derivatives);\n\n        if (verbose) {\n            return `Derivatives (${keys.length}) \\n ` + keys.map(key => derivatives[key].map(derivative => derivative.toString(true)).join(\"\\n \")).join(\"\\n \");\n        }\n        else {\n            return `Derivatives (${keys.length}) ` + keys.map(key => `${key} (${derivatives[key].length})`).join(\", \");\n        }\n    }\n\n    protected getOrCreateBin(usage: EDerivativeUsage)\n    {\n        const key = EDerivativeUsage[usage];\n        return this.derivatives[key] || (this.derivatives[key] = []);\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as THREE from \"three\";\n\nimport * as fragmentShader from \"!raw-loader!./uberPBRShader.frag\";\nimport * as vertexShader from \"!raw-loader!./uberPBRShader.vert\";\n\nimport { EShaderMode } from \"common/types/config\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport { EShaderMode };\n\nexport interface IUberPBRShaderProps extends THREE.MeshStandardMaterialParameters\n{\n\n}\n\nexport default class UberPBRMaterial extends THREE.MeshStandardMaterial\n{\n    isUberPBRMaterial: boolean;\n    isMeshStandardMaterial: boolean;\n    isMeshPhysicalMaterial: boolean;\n\n    uniforms: {\n        aoMapMix: { value: THREE.Vector3 },\n        cutPlaneDirection: { value: THREE.Vector4 },\n        cutPlaneColor: { value: THREE.Vector3 }\n    };\n\n    vertexShader: string;\n    fragmentShader: string;\n\n    private _clayColor = new THREE.Color(\"#a67a6c\");\n    private _paramCopy: any = {};\n    private _sideCopy: THREE.Side = THREE.FrontSide;\n\n    private _aoMapMix: THREE.Vector3;\n    private _cutPlaneDirection: THREE.Vector4;\n    private _cutPlaneColor: THREE.Vector3;\n\n    constructor(params?: IUberPBRShaderProps)\n    {\n        super();\n\n        this.type = \"UberPBRMaterial\";\n\n        this.isUberPBRMaterial = true;\n        this.isMeshStandardMaterial = true;\n        this.isMeshPhysicalMaterial = false;\n\n        this.defines = {\n            \"STANDARD\": true,\n            \"PHYSICAL\": false,\n            \"OBJECTSPACE_NORMALMAP\": false,\n            \"MODE_NORMALS\": false,\n            \"MODE_XRAY\": false,\n            \"CUT_PLANE\": false\n        };\n\n        this.uniforms = THREE.UniformsUtils.merge([\n            THREE.ShaderLib.standard.uniforms,\n            {\n                aoMapMix: { value: new THREE.Vector3(0.25, 0.25, 0.25) },\n                cutPlaneDirection: { value: new THREE.Vector4(0, 0, -1, 0) },\n                cutPlaneColor: { value: new THREE.Vector3(1, 0, 0) }\n            }\n        ]);\n\n        this._aoMapMix = this.uniforms.aoMapMix.value;\n        this._cutPlaneDirection = this.uniforms.cutPlaneDirection.value;\n        this._cutPlaneColor = this.uniforms.cutPlaneColor.value;\n\n        //this.vertexShader = ShaderLib.standard.vertexShader;\n        this.vertexShader = vertexShader;\n        //this.fragmentShader = ShaderLib.standard.fragmentShader;\n        this.fragmentShader = fragmentShader;\n\n        this.color = new THREE.Color(0xffffff); // diffuse\n        this.roughness = 0.7;\n        this.metalness = 0.0;\n\n        if (params) {\n            this.setValues(params);\n        }\n    }\n\n    set cutPlaneDirection(direction: THREE.Vector4) {\n        this._cutPlaneDirection.copy(direction);\n    }\n    get cutPlaneDirection() {\n        return this._cutPlaneDirection;\n    }\n\n    set cutPlaneColor(color: THREE.Vector3) {\n        this._cutPlaneColor.copy(color);\n    }\n    get cutPlaneColor() {\n        return this._cutPlaneColor;\n    }\n\n    set aoMapMix(mix: THREE.Vector3) {\n        this._aoMapMix.copy(mix);\n    }\n    get aoMapMix() {\n        return this._aoMapMix;\n    }\n\n    setShaderMode(mode: EShaderMode)\n    {\n        Object.assign(this, this._paramCopy);\n        this.defines[\"MODE_NORMALS\"] = false;\n        this.defines[\"MODE_XRAY\"] = false;\n        this.needsUpdate = true;\n\n        switch(mode) {\n            case EShaderMode.Clay:\n                this._paramCopy = {\n                    color: this.color,\n                    map: this.map,\n                    roughness: this.roughness,\n                    metalness: this.metalness,\n                    aoMapIntensity: this.aoMapIntensity,\n                    blending: this.blending,\n                    transparent: this.transparent,\n                    depthWrite: this.depthWrite\n                };\n                this.color = this._clayColor;\n                this.map = null;\n                this.roughness = 1;\n                this.metalness = 0;\n                this.aoMapIntensity *= 1;\n                this.blending = THREE.NoBlending;\n                this.transparent = false;\n                this.depthWrite = true;\n                break;\n\n            case EShaderMode.Normals:\n                this._paramCopy = {\n                    blending: this.blending,\n                    transparent: this.transparent,\n                    depthWrite: this.depthWrite\n                };\n                this.defines[\"MODE_NORMALS\"] = true;\n                this.blending = THREE.NoBlending;\n                this.transparent = false;\n                this.depthWrite = true;\n                break;\n\n            case EShaderMode.XRay:\n                this._paramCopy = {\n                    side: this.side,\n                    blending: this.blending,\n                    transparent: this.transparent,\n                    depthWrite: this.depthWrite\n                };\n                this.defines[\"MODE_XRAY\"] = true;\n                this.side = THREE.DoubleSide;\n                this.blending = THREE.AdditiveBlending;\n                this.transparent = true;\n                this.depthWrite = false;\n                break;\n\n            case EShaderMode.Wireframe:\n                this._paramCopy = {\n                    wireframe: this.wireframe\n                };\n                this.wireframe = true;\n                break;\n        }\n    }\n\n    enableCutPlane(enabled: boolean)\n    {\n        this.defines[\"CUT_PLANE\"] = enabled;\n\n        if (enabled) {\n            this._sideCopy = this.side;\n            this.side = THREE.DoubleSide;\n        }\n        else {\n            this.side = this._sideCopy;\n        }\n    }\n\n    enableObjectSpaceNormalMap(useObjectSpace: boolean)\n    {\n        if (this.defines[\"OBJECTSPACE_NORMALMAP\"] !== useObjectSpace) {\n            this.needsUpdate = true;\n        }\n\n        this.defines[\"OBJECTSPACE_NORMALMAP\"] = useObjectSpace;\n    }\n\n    copyStandardMaterial(material: THREE.MeshStandardMaterial): this\n    {\n        this.color = material.color;\n\n        this.roughness = material.roughness;\n        this.roughnessMap = material.roughnessMap;\n\n        this.metalness = material.metalness;\n        this.metalnessMap = material.metalnessMap;\n\n        this.map = material.map;\n        this.aoMap = material.aoMap;\n        this.aoMapIntensity = material.aoMapIntensity;\n\n        this.normalMap = material.normalMap;\n\n        return this;\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ManipTarget from \"@ff/browser/ManipTarget\"\nimport System from \"@ff/graph/System\";\nimport RenderQuadView, { ILayoutChange } from \"@ff/scene/RenderQuadView\";\n\nimport QuadSplitter, { EQuadViewLayout, IQuadSplitterChangeMessage } from \"@ff/ui/QuadSplitter\";\nimport CustomElement, { customElement, property } from \"@ff/ui/CustomElement\";\n\n////////////////////////////////////////////////////////////////////////////////\n\n@customElement(\"sv-content-view\")\nexport default class ContentView extends CustomElement\n{\n    @property({ attribute: false })\n    system: System;\n\n    protected manipTarget: ManipTarget;\n\n    protected view: RenderQuadView = null;\n    protected canvas: HTMLCanvasElement = null;\n    protected overlay: HTMLDivElement = null;\n    protected splitter: QuadSplitter = null;\n\n    constructor(system?: System)\n    {\n        super();\n\n        this.onResize = this.onResize.bind(this);\n\n        this.system = system;\n        this.manipTarget = new ManipTarget();\n\n        this.addEventListener(\"pointerdown\", this.manipTarget.onPointerDown);\n        this.addEventListener(\"pointermove\", this.manipTarget.onPointerMove);\n        this.addEventListener(\"pointerup\", this.manipTarget.onPointerUpOrCancel);\n        this.addEventListener(\"pointercancel\", this.manipTarget.onPointerUpOrCancel);\n        this.addEventListener(\"wheel\", this.manipTarget.onWheel);\n        this.addEventListener(\"contextmenu\", this.manipTarget.onContextMenu);\n    }\n\n    protected firstConnected()\n    {\n        this.setStyle({\n            position: \"absolute\",\n            top: \"0\", bottom: \"0\", left: \"0\", right: \"0\",\n            touchAction: \"none\",\n        });\n\n        this.setAttribute(\"touch-action\", \"none\");\n\n        this.canvas = this.createElement(\"canvas\", {\n            display: \"block\",\n            width: \"100%\",\n            height: \"100%\"\n        }, this);\n\n        this.overlay = this.createElement(\"div\", {\n            position: \"absolute\",\n            top: \"0\", bottom: \"0\", left: \"0\", right: \"0\",\n            overflow: \"hidden\"\n        }, this);\n\n        this.splitter = this.createElement(QuadSplitter, {\n            position: \"absolute\",\n            top: \"0\", bottom: \"0\", left: \"0\", right: \"0\",\n            overflow: \"hidden\"\n        }, this);\n\n        this.splitter.onChange = (message: IQuadSplitterChangeMessage) => {\n            this.view.horizontalSplit = message.horizontalSplit;\n            this.view.verticalSplit = message.verticalSplit;\n        };\n\n        this.view = new RenderQuadView(this.system, this.canvas, this.overlay);\n        this.view.on<ILayoutChange>(\"layout\", event => this.splitter.layout = event.layout);\n\n        this.view.layout = EQuadViewLayout.Single;\n        this.splitter.layout = EQuadViewLayout.Single;\n\n        //this.view.viewports[0].enableCameraManip(true);\n        //this.view.addViewport().setSize(0, 0, 0.5, 1);\n        //this.view.addViewport().setSize(0.5, 0, 0.5, 1);\n\n        this.manipTarget.next = this.view;\n    }\n\n    protected connected()\n    {\n        this.view.attach();\n\n        window.addEventListener(\"resize\", this.onResize);\n        window.dispatchEvent(new CustomEvent(\"resize\"));\n    }\n\n    protected disconnected()\n    {\n        this.view.detach();\n\n        window.removeEventListener(\"resize\", this.onResize);\n    }\n\n    protected onResize()\n    {\n        this.view.resize();\n    }\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport parseUrlParameter from \"@ff/browser/parseUrlParameter\";\n\nimport Commander from \"@ff/core/Commander\";\nimport ClassRegistry from \"@ff/core/ClassRegistry\";\n\nimport System from \"@ff/graph/System\";\nimport CPulse from \"@ff/graph/components/CPulse\";\n\nimport CRenderer from \"@ff/scene/components/CRenderer\";\n\nimport CVLoaders from \"../core/components/CVLoaders\";\nimport CVOrbitNavigation from \"../core/components/CVOrbitNavigation\";\n\nimport CMini from \"./components/CMini\";\n\nimport { componentTypes as graphComponents } from \"@ff/graph/components\";\nimport { componentTypes as sceneComponents } from \"@ff/scene/components\";\nimport { componentTypes as coreComponents } from \"../core/components\";\nimport { componentTypes as miniComponents } from \"./components\";\n\nimport MainView from \"./ui/MainView\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport interface IMiniApplicationProps\n{\n    /** URL of the item to load and display at startup. */\n    item?: string;\n    /** URL of a model (supported formats: gltf, glb) to load and display at startup. */\n    model?: string;\n    /** URL of a geometry (supported formats: obj, ply) to load and display at startup. */\n    geometry?: string;\n    /** If a geometry URL is given, optional URL of a color texture to use with the geometry. */\n    texture?: string;\n}\n\nexport default class MiniApplication\n{\n    protected static splashMessage = [\n        \"Voyager - 3D Explorer and Tool Suite\",\n        \"3D Foundation Project\",\n        \"(c) 2018 Smithsonian Institution\",\n        \"https://3d.si.edu\"\n    ].join(\"\\n\");\n\n    readonly props: IMiniApplicationProps;\n    readonly system: System;\n    readonly commander: Commander;\n\n\n    constructor(element?: HTMLElement, props?: IMiniApplicationProps)\n    {\n        console.log(MiniApplication.splashMessage);\n\n        // register components\n        const registry = new ClassRegistry();\n        registry.add(graphComponents);\n        registry.add(sceneComponents);\n        registry.add(coreComponents);\n        registry.add(miniComponents);\n\n        this.commander = new Commander();\n        const system = this.system = new System(registry);\n\n        const node = system.graph.createNode(\"Mini\");\n\n        node.createComponent(CPulse);\n        node.createComponent(CRenderer);\n\n        node.createComponent(CVLoaders);\n        node.createComponent(CVOrbitNavigation);\n\n        node.createComponent(CMini).createActions(this.commander);\n\n        // create main view if not given\n        if (element) {\n            new MainView(this).appendTo(element);\n        }\n\n        // start rendering\n        node.components.get(CPulse).start();\n\n        // start loading from properties\n        this.props = this.initFromProps(props);\n    }\n\n    protected initFromProps(props: IMiniApplicationProps): IMiniApplicationProps\n    {\n        const miniController = this.system.components.get(CMini);\n\n        props.item = props.item || parseUrlParameter(\"item\") || parseUrlParameter(\"i\");\n        props.model = props.model || parseUrlParameter(\"model\") || parseUrlParameter(\"m\");\n        props.geometry = props.geometry || parseUrlParameter(\"geometry\") || parseUrlParameter(\"g\");\n        props.texture = props.texture || parseUrlParameter(\"texture\") || parseUrlParameter(\"tex\");\n\n        if (props.item) {\n            miniController.loadItem(props.item);\n        }\n        else if (props.model) {\n            miniController.loadModel(props.model);\n        }\n        else if (props.geometry) {\n            miniController.loadGeometryAndTexture(\n                props.geometry, props.texture);\n        }\n\n        return props;\n    }\n}\n\nwindow[\"VoyagerMini\"] = MiniApplication;","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport resolvePathname from \"resolve-pathname\";\n\nimport CController, { Commander, Actions } from \"@ff/graph/components/CController\";\n\n/////////////////////////////////////////////////////////////////////////////////\n\nexport type MiniActions = Actions<CMini>;\n\n/**\n * Voyager Mini controller component. Manages presentation of items and assets.\n */\nexport default class CMini extends CController<CMini>\n{\n    static readonly type: string = \"CMini\";\n\n    loadItem(itemUrl: string, templateUrl?: string)\n    {\n        // TODO: Implement\n    }\n\n    loadModel(modelUrl: string, quality?: string, itemUrl?: string, templateUrl?: string)\n    {\n        // TODO: Implement\n    }\n\n    loadGeometryAndTexture(geometryUrl: string, textureUrl?: string, quality?: string, itemUrl?: string, templateUrl?: string)\n    {\n        // TODO: Implement\n    }\n\n}","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport CMini from \"./CMini\";\n\n////////////////////////////////////////////////////////////////////////////////\n\nexport {\n    CMini\n};\n\nexport const componentTypes = [\n    CMini\n];\n","/**\n * 3D Foundation Project\n * Copyright 2018 Smithsonian Institution\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport CustomElement, { customElement } from \"@ff/ui/CustomElement\";\n\nimport MiniApplication, { IMiniApplicationProps } from \"../MiniApplication\";\n\nimport ContentView from \"../../explorer/ui/ContentView\";\n\nimport \"./styles.scss\";\n\n////////////////////////////////////////////////////////////////////////////////\n\n/**\n * Main UI view for the Voyager Mini application.\n */\n@customElement(\"voyager-mini\")\nexport default class MainView extends CustomElement\n{\n    readonly application: MiniApplication;\n\n    constructor(application?: MiniApplication)\n    {\n        super();\n\n        if (application) {\n            this.application = application;\n        }\n        else {\n            const props: IMiniApplicationProps = {\n                item: this.getAttribute(\"item\"),\n                model: this.getAttribute(\"model\"),\n                geometry: this.getAttribute(\"geometry\"),\n                texture: this.getAttribute(\"texture\")\n            };\n\n            this.application = new MiniApplication(null, props);\n        }\n    }\n\n    protected firstConnected()\n    {\n        const system = this.application.system;\n        new ContentView(system).appendTo(this);\n    }\n}","// extracted by mini-css-extract-plugin","module.exports = THREE;"],"sourceRoot":""}